var LS={storage:false,ver_id:VER_ID,_getObject:function(){var self=this,res=JSON.parse(localStorage.getItem(self.ver_id));return res},_setObject:function(data){var self=this;return localStorage.setItem(self.ver_id,JSON.stringify(data))},set:function(key,value){var self=this,data=self._getObject();if(!data){data={}}if(value==null){delete data[key]}else{data[key]=value}return self._setObject(data)},get:function(key){var self=this,data=self._getObject();if(data==null||typeof data!='object'||!(key in data)){return{}}return data[key]},push:function(key,value){var self=this,data=self._getObject();data[key].push(value);return self._setObject(data)},remove:function(key){var self=this;return self.set(key,null)},check:function(){if(typeof localStorage=='undefined'){return false}return true}};!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(e,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),n(t),t}:n(jQuery)}(function(t){var e,n,s,p,r,o,h,f,g,m,y,v,i,a,_,s=((u=t&&t.fn&&t.fn.select2&&t.fn.select2.amd?t.fn.select2.amd:u)&&u.requirejs||(u?n=u:u={},g={},m={},y={},v={},i=Object.prototype.hasOwnProperty,a=[].slice,_=/\.js$/,h=function(e,t){var n,s,i=c(e),r=i[0],t=t[1];return e=i[1],r&&(n=x(r=l(r,t))),r?e=n&&n.normalize?n.normalize(e,(s=t,function(e){return l(e,s)})):l(e,t):(r=(i=c(e=l(e,t)))[0],e=i[1],r&&(n=x(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},f={require:function(e){return w(e)},exports:function(e){var t=g[e];return void 0!==t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:(t=e,function(){return y&&y.config&&y.config[t]||{}})};var t}},r=function(e,t,n,s){var i,r,o,a,l,c=[],u=typeof n,d=A(s=s||e);if("undefined"==u||"function"==u){for(t=!t.length&&n.length?["require","exports","module"]:t,a=0;a<t.length;a+=1)if("require"===(r=(o=h(t[a],d)).f))c[a]=f.require(e);else if("exports"===r)c[a]=f.exports(e),l=!0;else if("module"===r)i=c[a]=f.module(e);else if(b(g,r)||b(m,r)||b(v,r))c[a]=x(r);else{if(!o.p)throw new Error(e+" missing "+r);o.p.load(o.n,w(s,!0),function(t){return function(e){g[t]=e}}(r),{}),c[a]=g[r]}u=n?n.apply(g[e],c):void 0,e&&(i&&i.exports!==p&&i.exports!==g[e]?g[e]=i.exports:u===p&&l||(g[e]=u))}else e&&(g[e]=n)},e=n=o=function(e,t,n,s,i){if("string"==typeof e)return f[e]?f[e](t):x(h(e,A(t)).f);if(!e.splice){if((y=e).deps&&o(y.deps,y.callback),!t)return;t.splice?(e=t,t=n,n=null):e=p}return t=t||function(){},"function"==typeof n&&(n=s,s=i),s?r(p,e,t,n):setTimeout(function(){r(p,e,t,n)},4),o},o.config=function(e){return o(e)},e._defined=g,(s=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),b(g,e)||b(m,e)||(m[e]=[e,t,n])}).amd={jQuery:!0},u.requirejs=e,u.require=n,u.define=s),u.define("almond",function(){}),u.define("jquery",[],function(){var e=t||$;return null==e&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),e}),u.define("select2/utils",["jquery"],function(r){var s={};function c(e){var t,n=e.prototype,s=[];for(t in n)"function"==typeof n[t]&&"constructor"!==t&&s.push(t);return s}s.Extend=function(e,t){var n,s={}.hasOwnProperty;function i(){this.constructor=e}for(n in t)s.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},s.Decorate=function(s,i){var e=c(i),t=c(s);function r(){var e=Array.prototype.unshift,t=i.prototype.constructor.length,n=s.prototype.constructor;0<t&&(e.call(arguments,s.prototype.constructor),n=i.prototype.constructor),n.apply(this,arguments)}i.displayName=s.displayName,r.prototype=new function(){this.constructor=r};for(var n=0;n<t.length;n++){var o=t[n];r.prototype[o]=s.prototype[o]}for(var a=0;a<e.length;a++){var l=e[a];r.prototype[l]=function(e){var t=function(){};e in r.prototype&&(t=r.prototype[e]);var n=i.prototype[e];return function(){return Array.prototype.unshift.call(arguments,t),n.apply(this,arguments)}}(l)}return r};function e(){this.listeners={}}e.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},e.prototype.trigger=function(e){var t=Array.prototype.slice,n=t.call(arguments,1);this.listeners=this.listeners||{},0===(n=null==n?[]:n).length&&n.push({}),(n[0]._type=e)in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},e.prototype.invoke=function(e,t){for(var n=0,s=e.length;n<s;n++)e[n].apply(this,t)},s.Observable=e,s.generateChars=function(e){for(var t="",n=0;n<e;n++)t+=Math.floor(36*Math.random()).toString(36);return t},s.bind=function(e,t){return function(){e.apply(t,arguments)}},s._convertData=function(e){for(var t in e){var n=t.split("-"),s=e;if(1!==n.length){for(var i=0;i<n.length;i++){var r=n[i];(r=r.substring(0,1).toLowerCase()+r.substring(1))in s||(s[r]={}),i==n.length-1&&(s[r]=e[t]),s=s[r]}delete e[t]}}return e},s.hasScroll=function(e,t){var n=r(t),s=t.style.overflowX,i=t.style.overflowY;return(s!==i||"hidden"!==i&&"visible"!==i)&&("scroll"===s||"scroll"===i||(n.innerHeight()<t.scrollHeight||n.innerWidth()<t.scrollWidth))},s.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},s.__cache={};var n=0;return s.GetUniqueElementId=function(e){var t=e.getAttribute("data-select2-id");return null!=t||(t=e.id?"select2-data-"+e.id:"select2-data-"+(++n).toString()+"-"+s.generateChars(4),e.setAttribute("data-select2-id",t)),t},s.StoreData=function(e,t,n){e=s.GetUniqueElementId(e);s.__cache[e]||(s.__cache[e]={}),s.__cache[e][t]=n},s.GetData=function(e,t){var n=s.GetUniqueElementId(e);return t?s.__cache[n]&&null!=s.__cache[n][t]?s.__cache[n][t]:r(e).data(t):s.__cache[n]},s.RemoveData=function(e){var t=s.GetUniqueElementId(e);null!=s.__cache[t]&&delete s.__cache[t],e.removeAttribute("data-select2-id")},s.copyNonInternalCssClasses=function(e,t){var n=(n=e.getAttribute("class").trim().split(/\s+/)).filter(function(e){return 0===e.indexOf("select2-")}),t=(t=t.getAttribute("class").trim().split(/\s+/)).filter(function(e){return 0!==e.indexOf("select2-")}),t=n.concat(t);e.setAttribute("class",t.join(" "))},s}),u.define("select2/results",["jquery","./utils"],function(d,p){function s(e,t,n){this.$element=e,this.data=n,this.options=t,s.__super__.constructor.call(this)}return p.Extend(s,p.Observable),s.prototype.render=function(){var e=d('<ul class="select2-results__options" role="listbox"></ul>');return this.options.get("multiple")&&e.attr("aria-multiselectable","true"),this.$results=e},s.prototype.clear=function(){this.$results.empty()},s.prototype.displayMessage=function(e){var t=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=d('<li role="alert" aria-live="assertive" class="select2-results__option"></li>'),s=this.options.get("translations").get(e.message);n.append(t(s(e.args))),n[0].className+=" select2-results__message",this.$results.append(n)},s.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},s.prototype.append=function(e){this.hideLoading();var t=[];if(null!=e.results&&0!==e.results.length){e.results=this.sort(e.results);for(var n=0;n<e.results.length;n++){var s=e.results[n],s=this.option(s);t.push(s)}this.$results.append(t)}else 0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"})},s.prototype.position=function(e,t){t.find(".select2-results").append(e)},s.prototype.sort=function(e){return this.options.get("sorter")(e)},s.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option--selectable"),t=e.filter(".select2-results__option--selected");(0<t.length?t:e).first().trigger("mouseenter"),this.ensureHighlightVisible()},s.prototype.setClasses=function(){var t=this;this.data.current(function(e){var s=e.map(function(e){return e.id.toString()});t.$results.find(".select2-results__option--selectable").each(function(){var e=d(this),t=p.GetData(this,"data"),n=""+t.id;null!=t.element&&t.element.selected||null==t.element&&-1<s.indexOf(n)?(this.classList.add("select2-results__option--selected"),e.attr("aria-selected","true")):(this.classList.remove("select2-results__option--selected"),e.attr("aria-selected","false"))})})},s.prototype.showLoading=function(e){this.hideLoading();e={disabled:!0,loading:!0,text:this.options.get("translations").get("searching")(e)},e=this.option(e);e.className+=" loading-results",this.$results.prepend(e)},s.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},s.prototype.option=function(e){var t=document.createElement("li");t.classList.add("select2-results__option"),t.classList.add("select2-results__option--selectable");var n,s={role:"option"},i=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;for(n in(null!=e.element&&i.call(e.element,":disabled")||null==e.element&&e.disabled)&&(s["aria-disabled"]="true",t.classList.remove("select2-results__option--selectable"),t.classList.add("select2-results__option--disabled")),null==e.id&&t.classList.remove("select2-results__option--selectable"),null!=e._resultId&&(t.id=e._resultId),e.title&&(t.title=e.title),e.children&&(s.role="group",s["aria-label"]=e.text,t.classList.remove("select2-results__option--selectable"),t.classList.add("select2-results__option--group")),s){var r=s[n];t.setAttribute(n,r)}if(e.children){var o=d(t),a=document.createElement("strong");a.className="select2-results__group",this.template(e,a);for(var l=[],c=0;c<e.children.length;c++){var u=e.children[c],u=this.option(u);l.push(u)}i=d("<ul></ul>",{class:"select2-results__options select2-results__options--nested",role:"none"});i.append(l),o.append(a),o.append(i)}else this.template(e,t);return p.StoreData(t,"data",e),t},s.prototype.bind=function(t,e){var i=this,n=t.id+"-results";this.$results.attr("id",n),t.on("results:all",function(e){i.clear(),i.append(e.data),t.isOpen()&&(i.setClasses(),i.highlightFirstItem())}),t.on("results:append",function(e){i.append(e.data),t.isOpen()&&i.setClasses()}),t.on("query",function(e){i.hideMessages(),i.showLoading(e)}),t.on("select",function(){t.isOpen()&&(i.setClasses(),i.options.get("scrollAfterSelect")&&i.highlightFirstItem())}),t.on("unselect",function(){t.isOpen()&&(i.setClasses(),i.options.get("scrollAfterSelect")&&i.highlightFirstItem())}),t.on("open",function(){i.$results.attr("aria-expanded","true"),i.$results.attr("aria-hidden","false"),i.setClasses(),i.ensureHighlightVisible()}),t.on("close",function(){i.$results.attr("aria-expanded","false"),i.$results.attr("aria-hidden","true"),i.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=i.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e,t=i.getHighlightedResults();0!==t.length&&(e=p.GetData(t[0],"data"),t.hasClass("select2-results__option--selected")?i.trigger("close",{}):i.trigger("select",{data:e}))}),t.on("results:previous",function(){var e,t=i.getHighlightedResults(),n=i.$results.find(".select2-results__option--selectable"),s=n.index(t);s<=0||(e=s-1,0===t.length&&(e=0),(s=n.eq(e)).trigger("mouseenter"),t=i.$results.offset().top,n=s.offset().top,s=i.$results.scrollTop()+(n-t),0===e?i.$results.scrollTop(0):n-t<0&&i.$results.scrollTop(s))}),t.on("results:next",function(){var e,t=i.getHighlightedResults(),n=i.$results.find(".select2-results__option--selectable"),s=n.index(t)+1;s>=n.length||((e=n.eq(s)).trigger("mouseenter"),t=i.$results.offset().top+i.$results.outerHeight(!1),n=e.offset().top+e.outerHeight(!1),e=i.$results.scrollTop()+n-t,0===s?i.$results.scrollTop(0):t<n&&i.$results.scrollTop(e))}),t.on("results:focus",function(e){e.element[0].classList.add("select2-results__option--highlighted"),e.element[0].setAttribute("aria-selected","true")}),t.on("results:message",function(e){i.displayMessage(e)}),d.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=i.$results.scrollTop(),n=i.$results.get(0).scrollHeight-t+e.deltaY,t=0<e.deltaY&&t-e.deltaY<=0,n=e.deltaY<0&&n<=i.$results.height();t?(i.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):n&&(i.$results.scrollTop(i.$results.get(0).scrollHeight-i.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option--selectable",function(e){var t=d(this),n=p.GetData(this,"data");t.hasClass("select2-results__option--selected")?i.options.get("multiple")?i.trigger("unselect",{originalEvent:e,data:n}):i.trigger("close",{}):i.trigger("select",{originalEvent:e,data:n})}),this.$results.on("mouseenter",".select2-results__option--selectable",function(e){var t=p.GetData(this,"data");i.getHighlightedResults().removeClass("select2-results__option--highlighted").attr("aria-selected","false"),i.trigger("results:focus",{data:t,element:d(this)})})},s.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},s.prototype.destroy=function(){this.$results.remove()},s.prototype.ensureHighlightVisible=function(){var e,t,n,s,i=this.getHighlightedResults();0!==i.length&&(e=this.$results.find(".select2-results__option--selectable").index(i),s=this.$results.offset().top,t=i.offset().top,n=this.$results.scrollTop()+(t-s),s=t-s,n-=2*i.outerHeight(!1),e<=2?this.$results.scrollTop(0):(s>this.$results.outerHeight()||s<0)&&this.$results.scrollTop(n))},s.prototype.template=function(e,t){var n=this.options.get("templateResult"),s=this.options.get("escapeMarkup"),e=n(e,t);null==e?t.style.display="none":"string"==typeof e?t.innerHTML=s(e):d(t).append(e)},s}),u.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),u.define("select2/selection/base",["jquery","../utils","../keys"],function(n,s,i){function r(e,t){this.$element=e,this.options=t,r.__super__.constructor.call(this)}return s.Extend(r,s.Observable),r.prototype.render=function(){var e=n('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=s.GetData(this.$element[0],"old-tabindex")?this._tabindex=s.GetData(this.$element[0],"old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),e.attr("title",this.$element.attr("title")),e.attr("tabindex",this._tabindex),e.attr("aria-disabled","false"),this.$selection=e},r.prototype.bind=function(e,t){var n=this,s=e.id+"-results";this.container=e,this.$selection.on("focus",function(e){n.trigger("focus",e)}),this.$selection.on("blur",function(e){n._handleBlur(e)}),this.$selection.on("keydown",function(e){n.trigger("keypress",e),e.which===i.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){n.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){n.update(e.data)}),e.on("open",function(){n.$selection.attr("aria-expanded","true"),n.$selection.attr("aria-owns",s),n._attachCloseHandler(e)}),e.on("close",function(){n.$selection.attr("aria-expanded","false"),n.$selection.removeAttr("aria-activedescendant"),n.$selection.removeAttr("aria-owns"),n.$selection.trigger("focus"),n._detachCloseHandler(e)}),e.on("enable",function(){n.$selection.attr("tabindex",n._tabindex),n.$selection.attr("aria-disabled","false")}),e.on("disable",function(){n.$selection.attr("tabindex","-1"),n.$selection.attr("aria-disabled","true")})},r.prototype._handleBlur=function(e){var t=this;window.setTimeout(function(){document.activeElement==t.$selection[0]||n.contains(t.$selection[0],document.activeElement)||t.trigger("blur",e)},1)},r.prototype._attachCloseHandler=function(e){n(document.body).on("mousedown.select2."+e.id,function(e){var t=n(e.target).closest(".select2");n(".select2.select2-container--open").each(function(){this!=t[0]&&s.GetData(this,"element").select2("close")})})},r.prototype._detachCloseHandler=function(e){n(document.body).off("mousedown.select2."+e.id)},r.prototype.position=function(e,t){t.find(".selection").append(e)},r.prototype.destroy=function(){this._detachCloseHandler(this.container)},r.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},r.prototype.isEnabled=function(){return!this.isDisabled()},r.prototype.isDisabled=function(){return this.options.get("disabled")},r}),u.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,n,s){function i(){i.__super__.constructor.apply(this,arguments)}return n.Extend(i,t),i.prototype.render=function(){var e=i.__super__.render.call(this);return e[0].classList.add("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},i.prototype.bind=function(t,e){var n=this;i.__super__.bind.apply(this,arguments);var s=t.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",s).attr("role","textbox").attr("aria-readonly","true"),this.$selection.attr("aria-labelledby",s),this.$selection.attr("aria-controls",s),this.$selection.on("mousedown",function(e){1===e.which&&n.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(e){}),this.$selection.on("blur",function(e){}),t.on("focus",function(e){t.isOpen()||n.$selection.trigger("focus")})},i.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty(),e.removeAttr("title")},i.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},i.prototype.selectionContainer=function(){return e("<span></span>")},i.prototype.update=function(e){var t,n;0!==e.length?(n=e[0],t=this.$selection.find(".select2-selection__rendered"),e=this.display(n,t),t.empty().append(e),(n=n.title||n.text)?t.attr("title",n):t.removeAttr("title")):this.clear()},i}),u.define("select2/selection/multiple",["jquery","./base","../utils"],function(i,e,c){function r(e,t){r.__super__.constructor.apply(this,arguments)}return c.Extend(r,e),r.prototype.render=function(){var e=r.__super__.render.call(this);return e[0].classList.add("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},r.prototype.bind=function(e,t){var n=this;r.__super__.bind.apply(this,arguments);var s=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",s),this.$selection.on("click",function(e){n.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(e){var t;n.isDisabled()||(t=i(this).parent(),t=c.GetData(t[0],"data"),n.trigger("unselect",{originalEvent:e,data:t}))}),this.$selection.on("keydown",".select2-selection__choice__remove",function(e){n.isDisabled()||e.stopPropagation()})},r.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty(),e.removeAttr("title")},r.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},r.prototype.selectionContainer=function(){return i('<li class="select2-selection__choice"><button type="button" class="select2-selection__choice__remove" tabindex="-1"><span aria-hidden="true">&times;</span></button><span class="select2-selection__choice__display"></span></li>')},r.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],n=this.$selection.find(".select2-selection__rendered").attr("id")+"-choice-",s=0;s<e.length;s++){var i=e[s],r=this.selectionContainer(),o=this.display(i,r),a=n+c.generateChars(4)+"-";i.id?a+=i.id:a+=c.generateChars(4),r.find(".select2-selection__choice__display").append(o).attr("id",a);var l=i.title||i.text;l&&r.attr("title",l);o=this.options.get("translations").get("removeItem"),l=r.find(".select2-selection__choice__remove");l.attr("title",o()),l.attr("aria-label",o()),l.attr("aria-describedby",a),c.StoreData(r[0],"data",i),t.push(r)}this.$selection.find(".select2-selection__rendered").append(t)}},r}),u.define("select2/selection/placeholder",[],function(){function e(e,t,n){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n)}return e.prototype.normalizePlaceholder=function(e,t){return t="string"==typeof t?{id:"",text:t}:t},e.prototype.createPlaceholder=function(e,t){var n=this.selectionContainer();n.html(this.display(t)),n[0].classList.add("select2-selection__placeholder"),n[0].classList.remove("select2-selection__choice");t=t.title||t.text||n.text();return this.$selection.find(".select2-selection__rendered").attr("title",t),n},e.prototype.update=function(e,t){var n=1==t.length&&t[0].id!=this.placeholder.id;if(1<t.length||n)return e.call(this,t);this.clear();t=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(t)},e}),u.define("select2/selection/allowClear",["jquery","../keys","../utils"],function(i,s,a){function e(){}return e.prototype.bind=function(e,t,n){var s=this;e.call(this,t,n),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){s._handleClear(e)}),t.on("keypress",function(e){s._handleKeyboardClear(e,t)})},e.prototype._handleClear=function(e,t){if(!this.isDisabled()){var n=this.$selection.find(".select2-selection__clear");if(0!==n.length){t.stopPropagation();var s=a.GetData(n[0],"data"),i=this.$element.val();this.$element.val(this.placeholder.id);var r={data:s};if(this.trigger("clear",r),r.prevented)this.$element.val(i);else{for(var o=0;o<s.length;o++)if(r={data:s[o]},this.trigger("unselect",r),r.prevented)return void this.$element.val(i);this.$element.trigger("input").trigger("change"),this.trigger("toggle",{})}}}},e.prototype._handleKeyboardClear=function(e,t,n){n.isOpen()||t.which!=s.DELETE&&t.which!=s.BACKSPACE||this._handleClear(t)},e.prototype.update=function(e,t){var n,s;e.call(this,t),this.$selection.find(".select2-selection__clear").remove(),this.$selection[0].classList.remove("select2-selection--clearable"),0<this.$selection.find(".select2-selection__placeholder").length||0===t.length||(n=this.$selection.find(".select2-selection__rendered").attr("id"),s=this.options.get("translations").get("removeAllItems"),(e=i('<button type="button" class="select2-selection__clear" tabindex="-1"><span aria-hidden="true">&times;</span></button>')).attr("title",s()),e.attr("aria-label",s()),e.attr("aria-describedby",n),a.StoreData(e[0],"data",t),this.$selection.prepend(e),this.$selection[0].classList.add("select2-selection--clearable"))},e}),u.define("select2/selection/search",["jquery","../utils","../keys"],function(s,a,l){function e(e,t,n){e.call(this,t,n)}return e.prototype.render=function(e){var t=this.options.get("translations").get("search"),n=s('<span class="select2-search select2-search--inline"><textarea class="select2-search__field" type="search" tabindex="-1" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" ></textarea></span>');this.$searchContainer=n,this.$search=n.find("textarea"),this.$search.prop("autocomplete",this.options.get("autocomplete")),this.$search.attr("aria-label",t());e=e.call(this);return this._transferTabIndex(),e.append(this.$searchContainer),e},e.prototype.bind=function(e,t,n){var s=this,i=t.id+"-results",r=t.id+"-container";e.call(this,t,n),s.$search.attr("aria-describedby",r),t.on("open",function(){s.$search.attr("aria-controls",i),s.$search.trigger("focus")}),t.on("close",function(){s.$search.val(""),s.resizeSearch(),s.$search.removeAttr("aria-controls"),s.$search.removeAttr("aria-activedescendant"),s.$search.trigger("focus")}),t.on("enable",function(){s.$search.prop("disabled",!1),s._transferTabIndex()}),t.on("disable",function(){s.$search.prop("disabled",!0)}),t.on("focus",function(e){s.$search.trigger("focus")}),t.on("results:focus",function(e){e.data._resultId?s.$search.attr("aria-activedescendant",e.data._resultId):s.$search.removeAttr("aria-activedescendant")}),this.$selection.on("focusin",".select2-search--inline",function(e){s.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){s._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){var t;e.stopPropagation(),s.trigger("keypress",e),s._keyUpPrevented=e.isDefaultPrevented(),e.which!==l.BACKSPACE||""!==s.$search.val()||0<(t=s.$selection.find(".select2-selection__choice").last()).length&&(t=a.GetData(t[0],"data"),s.searchRemoveChoice(t),e.preventDefault())}),this.$selection.on("click",".select2-search--inline",function(e){s.$search.val()&&e.stopPropagation()});var t=document.documentMode,o=t&&t<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){o?s.$selection.off("input.search input.searchcheck"):s.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){var t;o&&"input"===e.type?s.$selection.off("input.search input.searchcheck"):(t=e.which)!=l.SHIFT&&t!=l.CTRL&&t!=l.ALT&&t!=l.TAB&&s.handleSearch(e)})},e.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},e.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},e.prototype.update=function(e,t){var n=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.resizeSearch(),n&&this.$search.trigger("focus")},e.prototype.handleSearch=function(){var e;this.resizeSearch(),this._keyUpPrevented||(e=this.$search.val(),this.trigger("query",{term:e})),this._keyUpPrevented=!1},e.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},e.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="100%";""===this.$search.attr("placeholder")&&(e=.75*(this.$search.val().length+1)+"em"),this.$search.css("width",e)},e}),u.define("select2/selection/selectionCss",["../utils"],function(n){function e(){}return e.prototype.render=function(e){var t=e.call(this),e=this.options.get("selectionCssClass")||"";return-1!==e.indexOf(":all:")&&(e=e.replace(":all:",""),n.copyNonInternalCssClasses(t[0],this.$element[0])),t.addClass(e),t},e}),u.define("select2/selection/eventRelay",["jquery"],function(o){function e(){}return e.prototype.bind=function(e,t,n){var s=this,i=["open","opening","close","closing","select","selecting","unselect","unselecting","clear","clearing"],r=["opening","closing","selecting","unselecting","clearing"];e.call(this,t,n),t.on("*",function(e,t){var n;-1!==i.indexOf(e)&&(t=t||{},n=o.Event("select2:"+e,{params:t}),s.$element.trigger(n),-1!==r.indexOf(e)&&(t.prevented=n.isDefaultPrevented()))})},e}),u.define("select2/translation",["jquery","require"],function(t,n){function s(e){this.dict=e||{}}return s.prototype.all=function(){return this.dict},s.prototype.get=function(e){return this.dict[e]},s.prototype.extend=function(e){this.dict=t.extend({},e.all(),this.dict)},s._cache={},s.loadPath=function(e){var t;return e in s._cache||(t=n(e),s._cache[e]=t),new s(s._cache[e])},s}),u.define("select2/diacritics",[],function(){return{"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Œ":"OE","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","œ":"oe","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ώ":"ω","ς":"σ","’":"'"}}),u.define("select2/data/base",["../utils"],function(n){function s(e,t){s.__super__.constructor.call(this)}return n.Extend(s,n.Observable),s.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},s.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},s.prototype.bind=function(e,t){},s.prototype.destroy=function(){},s.prototype.generateResultId=function(e,t){e=e.id+"-result-";return e+=n.generateChars(4),null!=t.id?e+="-"+t.id.toString():e+="-"+n.generateChars(4),e},s}),u.define("select2/data/select",["./base","../utils","jquery"],function(e,a,l){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return a.Extend(n,e),n.prototype.current=function(e){var t=this;e(Array.prototype.map.call(this.$element[0].querySelectorAll(":checked"),function(e){return t.item(l(e))}))},n.prototype.select=function(i){var e,r=this;if(i.selected=!0,null!=i.element&&"option"===i.element.tagName.toLowerCase())return i.element.selected=!0,void this.$element.trigger("input").trigger("change");this.$element.prop("multiple")?this.current(function(e){var t=[];(i=[i]).push.apply(i,e);for(var n=0;n<i.length;n++){var s=i[n].id;-1===t.indexOf(s)&&t.push(s)}r.$element.val(t),r.$element.trigger("input").trigger("change")}):(e=i.id,this.$element.val(e),this.$element.trigger("input").trigger("change"))},n.prototype.unselect=function(i){var r=this;if(this.$element.prop("multiple")){if(i.selected=!1,null!=i.element&&"option"===i.element.tagName.toLowerCase())return i.element.selected=!1,void this.$element.trigger("input").trigger("change");this.current(function(e){for(var t=[],n=0;n<e.length;n++){var s=e[n].id;s!==i.id&&-1===t.indexOf(s)&&t.push(s)}r.$element.val(t),r.$element.trigger("input").trigger("change")})}},n.prototype.bind=function(e,t){var n=this;(this.container=e).on("select",function(e){n.select(e.data)}),e.on("unselect",function(e){n.unselect(e.data)})},n.prototype.destroy=function(){this.$element.find("*").each(function(){a.RemoveData(this)})},n.prototype.query=function(t,e){var n=[],s=this;this.$element.children().each(function(){var e;"option"!==this.tagName.toLowerCase()&&"optgroup"!==this.tagName.toLowerCase()||(e=l(this),e=s.item(e),null!==(e=s.matches(t,e))&&n.push(e))}),e({results:n})},n.prototype.addOptions=function(e){this.$element.append(e)},n.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup")).label=e.text:void 0!==(t=document.createElement("option")).textContent?t.textContent=e.text:t.innerText=e.text,void 0!==e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);e=this._normalizeItem(e);return e.element=t,a.StoreData(t,"data",e),l(t)},n.prototype.item=function(e){var t={};if(null!=(t=a.GetData(e[0],"data")))return t;var n=e[0];if("option"===n.tagName.toLowerCase())t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if("optgroup"===n.tagName.toLowerCase()){t={text:e.prop("label"),children:[],title:e.prop("title")};for(var s=e.children("option"),i=[],r=0;r<s.length;r++){var o=l(s[r]),o=this.item(o);i.push(o)}t.children=i}return(t=this._normalizeItem(t)).element=e[0],a.StoreData(e[0],"data",t),t},n.prototype._normalizeItem=function(e){e!==Object(e)&&(e={id:e,text:e});return null!=(e=l.extend({},{text:""},e)).id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),l.extend({},{selected:!1,disabled:!1},e)},n.prototype.matches=function(e,t){return this.options.get("matcher")(e,t)},n}),u.define("select2/data/array",["./select","../utils","jquery"],function(e,t,c){function s(e,t){this._dataToConvert=t.get("data")||[],s.__super__.constructor.call(this,e,t)}return t.Extend(s,e),s.prototype.bind=function(e,t){s.__super__.bind.call(this,e,t),this.addOptions(this.convertToOptions(this._dataToConvert))},s.prototype.select=function(n){var e=this.$element.find("option").filter(function(e,t){return t.value==n.id.toString()});0===e.length&&(e=this.option(n),this.addOptions(e)),s.__super__.select.call(this,n)},s.prototype.convertToOptions=function(e){var t=this,n=this.$element.find("option"),s=n.map(function(){return t.item(c(this)).id}).get(),i=[];for(var r=0;r<e.length;r++){var o,a,l=this._normalizeItem(e[r]);0<=s.indexOf(l.id)?(o=n.filter(function(e){return function(){return c(this).val()==e.id}}(l)),a=this.item(o),a=c.extend(!0,{},l,a),a=this.option(a),o.replaceWith(a)):(a=this.option(l),l.children&&(l=this.convertToOptions(l.children),a.append(l)),i.push(a))}return i},s}),u.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,r){function n(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),n.__super__.constructor.call(this,e,t)}return t.Extend(n,e),n.prototype._applyDefaults=function(e){var t={data:function(e){return r.extend({},e,{q:e.term})},transport:function(e,t,n){e=r.ajax(e);return e.then(t),e.fail(n),e}};return r.extend({},t,e,!0)},n.prototype.processResults=function(e){return e},n.prototype.query=function(t,n){var s=this;null!=this._request&&("function"==typeof this._request.abort&&this._request.abort(),this._request=null);var i=r.extend({type:"GET"},this.ajaxOptions);function e(){var e=i.transport(i,function(e){e=s.processResults(e,t);s.options.get("debug")&&window.console&&console.error&&(e&&e.results&&Array.isArray(e.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),n(e)},function(){"status"in e&&(0===e.status||"0"===e.status)||s.trigger("results:message",{message:"errorLoading"})});s._request=e}"function"==typeof i.url&&(i.url=i.url.call(this.$element,t)),"function"==typeof i.data&&(i.data=i.data.call(this.$element,t)),this.ajaxOptions.delay&&null!=t.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(e,this.ajaxOptions.delay)):e()},n}),u.define("select2/data/tags",["jquery"],function(t){function e(e,t,n){var s=n.get("tags"),i=n.get("createTag");void 0!==i&&(this.createTag=i);i=n.get("insertTag");if(void 0!==i&&(this.insertTag=i),e.call(this,t,n),Array.isArray(s))for(var r=0;r<s.length;r++){var o=s[r],o=this._normalizeItem(o),o=this.option(o);this.$element.append(o)}}return e.prototype.query=function(e,c,u){var d=this;this._removeOldTags(),null!=c.term&&null==c.page?e.call(this,c,function e(t,n){for(var s=t.results,i=0;i<s.length;i++){var r=s[i],o=null!=r.children&&!e({results:r.children},!0);if((r.text||"").toUpperCase()===(c.term||"").toUpperCase()||o)return!n&&(t.data=s,void u(t))}if(n)return!0;var a,l=d.createTag(c);null!=l&&((a=d.option(l)).attr("data-select2-tag","true"),d.addOptions([a]),d.insertTag(s,l)),t.results=s,u(t)}):e.call(this,c,u)},e.prototype.createTag=function(e,t){if(null==t.term)return null;t=t.term.trim();return""===t?null:{id:t,text:t}},e.prototype.insertTag=function(e,t,n){t.unshift(n)},e.prototype._removeOldTags=function(e){this.$element.find("option[data-select2-tag]").each(function(){this.selected||t(this).remove()})},e}),u.define("select2/data/tokenizer",["jquery"],function(c){function e(e,t,n){var s=n.get("tokenizer");void 0!==s&&(this.tokenizer=s),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){e.call(this,t,n),this.$search=t.dropdown.$search||t.selection.$search||n.find(".select2-search__field")},e.prototype.query=function(e,t,n){var s=this;t.term=t.term||"";var i=this.tokenizer(t,this.options,function(e){var t,n=s._normalizeItem(e);s.$element.find("option").filter(function(){return c(this).val()===n.id}).length||((t=s.option(n)).attr("data-select2-tag",!0),s._removeOldTags(),s.addOptions([t])),t=n,s.trigger("select",{data:t})});i.term!==t.term&&(this.$search.length&&(this.$search.val(i.term),this.$search.trigger("focus")),t.term=i.term),e.call(this,t,n)},e.prototype.tokenizer=function(e,t,n,s){for(var i=n.get("tokenSeparators")||[],r=t.term,o=0,a=this.createTag||function(e){return{id:e.term,text:e.term}};o<r.length;){var l=r[o];-1!==i.indexOf(l)?(l=r.substr(0,o),null!=(l=a(c.extend({},t,{term:l})))?(s(l),r=r.substr(o+1)||"",o=0):o++):o++}return{term:r}},e}),u.define("select2/data/minimumInputLength",[],function(){function e(e,t,n){this.minimumInputLength=n.get("minimumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.term=t.term||"",t.term.length<this.minimumInputLength?this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}}):e.call(this,t,n)},e}),u.define("select2/data/maximumInputLength",[],function(){function e(e,t,n){this.maximumInputLength=n.get("maximumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.term=t.term||"",0<this.maximumInputLength&&t.term.length>this.maximumInputLength?this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}}):e.call(this,t,n)},e}),u.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,n){this.maximumSelectionLength=n.get("maximumSelectionLength"),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){var s=this;e.call(this,t,n),t.on("select",function(){s._checkIfMaximumSelected()})},e.prototype.query=function(e,t,n){var s=this;this._checkIfMaximumSelected(function(){e.call(s,t,n)})},e.prototype._checkIfMaximumSelected=function(e,t){var n=this;this.current(function(e){e=null!=e?e.length:0;0<n.maximumSelectionLength&&e>=n.maximumSelectionLength?n.trigger("results:message",{message:"maximumSelected",args:{maximum:n.maximumSelectionLength}}):t&&t()})},e}),u.define("select2/dropdown",["jquery","./utils"],function(t,e){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return e.Extend(n,e.Observable),n.prototype.render=function(){var e=t('<span class="select2-dropdown"><span class="select2-results"></span></span>');return e.attr("dir",this.options.get("dir")),this.$dropdown=e},n.prototype.bind=function(){},n.prototype.position=function(e,t){},n.prototype.destroy=function(){this.$dropdown.remove()},n}),u.define("select2/dropdown/search",["jquery"],function(r){function e(){}return e.prototype.render=function(e){var t=e.call(this),n=this.options.get("translations").get("search"),e=r('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" /></span>');return this.$searchContainer=e,this.$search=e.find("input"),this.$search.prop("autocomplete",this.options.get("autocomplete")),this.$search.attr("aria-label",n()),t.prepend(e),t},e.prototype.bind=function(e,t,n){var s=this,i=t.id+"-results";e.call(this,t,n),this.$search.on("keydown",function(e){s.trigger("keypress",e),s._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(e){r(this).off("keyup")}),this.$search.on("keyup input",function(e){s.handleSearch(e)}),t.on("open",function(){s.$search.attr("tabindex",0),s.$search.attr("aria-controls",i),s.$search.trigger("focus"),window.setTimeout(function(){s.$search.trigger("focus")},0)}),t.on("close",function(){s.$search.attr("tabindex",-1),s.$search.removeAttr("aria-controls"),s.$search.removeAttr("aria-activedescendant"),s.$search.val(""),s.$search.trigger("blur")}),t.on("focus",function(){t.isOpen()||s.$search.trigger("focus")}),t.on("results:all",function(e){null!=e.query.term&&""!==e.query.term||(s.showSearch(e)?s.$searchContainer[0].classList.remove("select2-search--hide"):s.$searchContainer[0].classList.add("select2-search--hide"))}),t.on("results:focus",function(e){e.data._resultId?s.$search.attr("aria-activedescendant",e.data._resultId):s.$search.removeAttr("aria-activedescendant")})},e.prototype.handleSearch=function(e){var t;this._keyUpPrevented||(t=this.$search.val(),this.trigger("query",{term:t})),this._keyUpPrevented=!1},e.prototype.showSearch=function(e,t){return!0},e}),u.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,n,s){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n,s)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return t="string"==typeof t?{id:"",text:t}:t},e.prototype.removePlaceholder=function(e,t){for(var n=t.slice(0),s=t.length-1;0<=s;s--){var i=t[s];this.placeholder.id===i.id&&n.splice(s,1)}return n},e}),u.define("select2/dropdown/infiniteScroll",["jquery"],function(n){function e(e,t,n,s){this.lastParams={},e.call(this,t,n,s),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return e.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&(this.$results.append(this.$loadingMore),this.loadMoreIfNeeded())},e.prototype.bind=function(e,t,n){var s=this;e.call(this,t,n),t.on("query",function(e){s.lastParams=e,s.loading=!0}),t.on("query:append",function(e){s.lastParams=e,s.loading=!0}),this.$results.on("scroll",this.loadMoreIfNeeded.bind(this))},e.prototype.loadMoreIfNeeded=function(){var e=n.contains(document.documentElement,this.$loadingMore[0]);!this.loading&&e&&(e=this.$results.offset().top+this.$results.outerHeight(!1),this.$loadingMore.offset().top+this.$loadingMore.outerHeight(!1)<=e+50&&this.loadMore())},e.prototype.loadMore=function(){this.loading=!0;var e=n.extend({},{page:1},this.lastParams);e.page++,this.trigger("query:append",e)},e.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},e.prototype.createLoadingMore=function(){var e=n('<li class="select2-results__option select2-results__option--load-more"role="option" aria-disabled="true"></li>'),t=this.options.get("translations").get("loadingMore");return e.html(t(this.lastParams)),e},e}),u.define("select2/dropdown/attachBody",["jquery","../utils"],function(u,o){function e(e,t,n){this.$dropdownParent=u(n.get("dropdownParent")||document.body),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){var s=this;e.call(this,t,n),t.on("open",function(){s._showDropdown(),s._attachPositioningHandler(t),s._bindContainerResultHandlers(t)}),t.on("close",function(){s._hideDropdown(),s._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},e.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},e.prototype.position=function(e,t,n){t.attr("class",n.attr("class")),t[0].classList.remove("select2"),t[0].classList.add("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=n},e.prototype.render=function(e){var t=u("<span></span>"),e=e.call(this);return t.append(e),this.$dropdownContainer=t},e.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},e.prototype._bindContainerResultHandlers=function(e,t){var n;this._containerResultsHandlersBound||(n=this,t.on("results:all",function(){n._positionDropdown(),n._resizeDropdown()}),t.on("results:append",function(){n._positionDropdown(),n._resizeDropdown()}),t.on("results:message",function(){n._positionDropdown(),n._resizeDropdown()}),t.on("select",function(){n._positionDropdown(),n._resizeDropdown()}),t.on("unselect",function(){n._positionDropdown(),n._resizeDropdown()}),this._containerResultsHandlersBound=!0)},e.prototype._attachPositioningHandler=function(e,t){var n=this,s="scroll.select2."+t.id,i="resize.select2."+t.id,r="orientationchange.select2."+t.id,t=this.$container.parents().filter(o.hasScroll);t.each(function(){o.StoreData(this,"select2-scroll-position",{x:u(this).scrollLeft(),y:u(this).scrollTop()})}),t.on(s,function(e){var t=o.GetData(this,"select2-scroll-position");u(this).scrollTop(t.y)}),u(window).on(s+" "+i+" "+r,function(e){n._positionDropdown(),n._resizeDropdown()})},e.prototype._detachPositioningHandler=function(e,t){var n="scroll.select2."+t.id,s="resize.select2."+t.id,t="orientationchange.select2."+t.id;this.$container.parents().filter(o.hasScroll).off(n),u(window).off(n+" "+s+" "+t)},e.prototype._positionDropdown=function(){var e=u(window),t=this.$dropdown[0].classList.contains("select2-dropdown--above"),n=this.$dropdown[0].classList.contains("select2-dropdown--below"),s=null,i=this.$container.offset();i.bottom=i.top+this.$container.outerHeight(!1);var r={height:this.$container.outerHeight(!1)};r.top=i.top,r.bottom=i.top+r.height;var o=this.$dropdown.outerHeight(!1),a=e.scrollTop(),l=e.scrollTop()+e.height(),c=a<i.top-o,e=l>i.bottom+o,a={left:i.left,top:r.bottom},l=this.$dropdownParent;"static"===l.css("position")&&(l=l.offsetParent());i={top:0,left:0};(u.contains(document.body,l[0])||l[0].isConnected)&&(i=l.offset()),a.top-=i.top,a.left-=i.left,t||n||(s="below"),e||!c||t?!c&&e&&t&&(s="below"):s="above",("above"==s||t&&"below"!==s)&&(a.top=r.top-i.top-o),null!=s&&(this.$dropdown[0].classList.remove("select2-dropdown--below"),this.$dropdown[0].classList.remove("select2-dropdown--above"),this.$dropdown[0].classList.add("select2-dropdown--"+s),this.$container[0].classList.remove("select2-container--below"),this.$container[0].classList.remove("select2-container--above"),this.$container[0].classList.add("select2-container--"+s)),this.$dropdownContainer.css(a)},e.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},e.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},e}),u.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(e,t,n,s){this.minimumResultsForSearch=n.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,n,s)}return e.prototype.showSearch=function(e,t){return!(function e(t){for(var n=0,s=0;s<t.length;s++){var i=t[s];i.children?n+=e(i.children):n++}return n}(t.data.results)<this.minimumResultsForSearch)&&e.call(this,t)},e}),u.define("select2/dropdown/selectOnClose",["../utils"],function(s){function e(){}return e.prototype.bind=function(e,t,n){var s=this;e.call(this,t,n),t.on("close",function(e){s._handleSelectOnClose(e)})},e.prototype._handleSelectOnClose=function(e,t){if(t&&null!=t.originalSelect2Event){var n=t.originalSelect2Event;if("select"===n._type||"unselect"===n._type)return}n=this.getHighlightedResults();n.length<1||(null!=(n=s.GetData(n[0],"data")).element&&n.element.selected||null==n.element&&n.selected||this.trigger("select",{data:n}))},e}),u.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var s=this;e.call(this,t,n),t.on("select",function(e){s._selectTriggered(e)}),t.on("unselect",function(e){s._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var n=t.originalEvent;n&&(n.ctrlKey||n.metaKey)||this.trigger("close",{originalEvent:n,originalSelect2Event:t})},e}),u.define("select2/dropdown/dropdownCss",["../utils"],function(n){function e(){}return e.prototype.render=function(e){var t=e.call(this),e=this.options.get("dropdownCssClass")||"";return-1!==e.indexOf(":all:")&&(e=e.replace(":all:",""),n.copyNonInternalCssClasses(t[0],this.$element[0])),t.addClass(e),t},e}),u.define("select2/dropdown/tagsSearchHighlight",["../utils"],function(s){function e(){}return e.prototype.highlightFirstItem=function(e){var t=this.$results.find(".select2-results__option--selectable:not(.select2-results__option--selected)");if(0<t.length){var n=t.first(),t=s.GetData(n[0],"data").element;if(t&&t.getAttribute&&"true"===t.getAttribute("data-select2-tag"))return void n.trigger("mouseenter")}e.call(this)},e}),u.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,e="Please delete "+t+" character";return 1!=t&&(e+="s"),e},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching…"},removeAllItems:function(){return"Remove all items"},removeItem:function(){return"Remove item"},search:function(){return"Search"}}}),u.define("select2/defaults",["jquery","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/selectionCss","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./dropdown/dropdownCss","./dropdown/tagsSearchHighlight","./i18n/en"],function(l,r,o,a,c,u,d,p,h,f,g,t,m,y,v,_,b,$,w,x,A,D,S,E,O,C,L,T,q,I,e){function n(){this.reset()}return n.prototype.apply=function(e){var t;null==(e=l.extend(!0,{},this.defaults,e)).dataAdapter&&(null!=e.ajax?e.dataAdapter=v:null!=e.data?e.dataAdapter=y:e.dataAdapter=m,0<e.minimumInputLength&&(e.dataAdapter=f.Decorate(e.dataAdapter,$)),0<e.maximumInputLength&&(e.dataAdapter=f.Decorate(e.dataAdapter,w)),0<e.maximumSelectionLength&&(e.dataAdapter=f.Decorate(e.dataAdapter,x)),e.tags&&(e.dataAdapter=f.Decorate(e.dataAdapter,_)),null==e.tokenSeparators&&null==e.tokenizer||(e.dataAdapter=f.Decorate(e.dataAdapter,b))),null==e.resultsAdapter&&(e.resultsAdapter=r,null!=e.ajax&&(e.resultsAdapter=f.Decorate(e.resultsAdapter,E)),null!=e.placeholder&&(e.resultsAdapter=f.Decorate(e.resultsAdapter,S)),e.selectOnClose&&(e.resultsAdapter=f.Decorate(e.resultsAdapter,L)),e.tags&&(e.resultsAdapter=f.Decorate(e.resultsAdapter,I))),null==e.dropdownAdapter&&(e.multiple?e.dropdownAdapter=A:(t=f.Decorate(A,D),e.dropdownAdapter=t),0!==e.minimumResultsForSearch&&(e.dropdownAdapter=f.Decorate(e.dropdownAdapter,C)),e.closeOnSelect&&(e.dropdownAdapter=f.Decorate(e.dropdownAdapter,T)),null!=e.dropdownCssClass&&(e.dropdownAdapter=f.Decorate(e.dropdownAdapter,q)),e.dropdownAdapter=f.Decorate(e.dropdownAdapter,O)),null==e.selectionAdapter&&(e.multiple?e.selectionAdapter=a:e.selectionAdapter=o,null!=e.placeholder&&(e.selectionAdapter=f.Decorate(e.selectionAdapter,c)),e.allowClear&&(e.selectionAdapter=f.Decorate(e.selectionAdapter,u)),e.multiple&&(e.selectionAdapter=f.Decorate(e.selectionAdapter,d)),null!=e.selectionCssClass&&(e.selectionAdapter=f.Decorate(e.selectionAdapter,p)),e.selectionAdapter=f.Decorate(e.selectionAdapter,h)),e.language=this._resolveLanguage(e.language),e.language.push("en");for(var n=[],s=0;s<e.language.length;s++){var i=e.language[s];-1===n.indexOf(i)&&n.push(i)}return e.language=n,e.translations=this._processTranslations(e.language,e.debug),e},n.prototype.reset=function(){function a(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return t[e]||e})}this.defaults={amdLanguageBase:"./i18n/",autocomplete:"off",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:f.escapeMarkup,language:{},matcher:function e(t,n){if(null==t.term||""===t.term.trim())return n;if(n.children&&0<n.children.length){for(var s=l.extend(!0,{},n),i=n.children.length-1;0<=i;i--)null==e(t,n.children[i])&&s.children.splice(i,1);return 0<s.children.length?s:e(t,s)}var r=a(n.text).toUpperCase(),o=a(t.term).toUpperCase();return-1<r.indexOf(o)?n:null},minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,scrollAfterSelect:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},n.prototype.applyFromElement=function(e,t){var n=e.language,s=this.defaults.language,i=t.prop("lang"),t=t.closest("[lang]").prop("lang"),t=Array.prototype.concat.call(this._resolveLanguage(i),this._resolveLanguage(n),this._resolveLanguage(s),this._resolveLanguage(t));return e.language=t,e},n.prototype._resolveLanguage=function(e){if(!e)return[];if(l.isEmptyObject(e))return[];if(l.isPlainObject(e))return[e];for(var t,n=Array.isArray(e)?e:[e],s=[],i=0;i<n.length;i++)s.push(n[i]),"string"==typeof n[i]&&0<n[i].indexOf("-")&&(t=n[i].split("-")[0],s.push(t));return s},n.prototype._processTranslations=function(e,t){for(var n=new g,s=0;s<e.length;s++){var i=new g,r=e[s];if("string"==typeof r)try{i=g.loadPath(r)}catch(e){try{r=this.defaults.amdLanguageBase+r,i=g.loadPath(r)}catch(e){t&&window.console&&console.warn&&console.warn('Select2: The language file for "'+r+'" could not be automatically loaded. A fallback will be used instead.')}}else i=l.isPlainObject(r)?new g(r):r;n.extend(i)}return n},n.prototype.set=function(e,t){var n={};n[l.camelCase(e)]=t;n=f._convertData(n);l.extend(!0,this.defaults,n)},new n}),u.define("select2/options",["jquery","./defaults","./utils"],function(c,n,u){function e(e,t){this.options=e,null!=t&&this.fromElement(t),null!=t&&(this.options=n.applyFromElement(this.options,t)),this.options=n.apply(this.options)}return e.prototype.fromElement=function(e){var t=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.autocomplete&&e.prop("autocomplete")&&(this.options.autocomplete=e.prop("autocomplete")),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),u.GetData(e[0],"select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),u.StoreData(e[0],"data",u.GetData(e[0],"select2Tags")),u.StoreData(e[0],"tags",!0)),u.GetData(e[0],"ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",u.GetData(e[0],"ajaxUrl")),u.StoreData(e[0],"ajax-Url",u.GetData(e[0],"ajaxUrl")));var n={};function s(e,t){return t.toUpperCase()}for(var i=0;i<e[0].attributes.length;i++){var r=e[0].attributes[i].name,o="data-";r.substr(0,o.length)==o&&(r=r.substring(o.length),o=u.GetData(e[0],r),n[r.replace(/-([a-z])/g,s)]=o)}c.fn.jquery&&"1."==c.fn.jquery.substr(0,2)&&e[0].dataset&&(n=c.extend(!0,{},e[0].dataset,n));var a,l=c.extend(!0,{},u.GetData(e[0]),n);for(a in l=u._convertData(l))-1<t.indexOf(a)||(c.isPlainObject(this.options[a])?c.extend(this.options[a],l[a]):this.options[a]=l[a]);return this},e.prototype.get=function(e){return this.options[e]},e.prototype.set=function(e,t){this.options[e]=t},e}),u.define("select2/core",["jquery","./options","./utils","./keys"],function(t,i,r,s){var o=function(e,t){null!=r.GetData(e[0],"select2")&&r.GetData(e[0],"select2").destroy(),this.$element=e,this.id=this._generateId(e),t=t||{},this.options=new i(t,e),o.__super__.constructor.call(this);var n=e.attr("tabindex")||0;r.StoreData(e[0],"old-tabindex",n),e.attr("tabindex","-1");t=this.options.get("dataAdapter");this.dataAdapter=new t(e,this.options);n=this.render();this._placeContainer(n);t=this.options.get("selectionAdapter");this.selection=new t(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,n);t=this.options.get("dropdownAdapter");this.dropdown=new t(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,n);n=this.options.get("resultsAdapter");this.results=new n(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var s=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){s.trigger("selection:update",{data:e})}),e[0].classList.add("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),r.StoreData(e[0],"select2",this),e.data("select2",this)};return r.Extend(o,r.Observable),o.prototype._generateId=function(e){return"select2-"+(null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+r.generateChars(2):r.generateChars(4)).replace(/(:|\.|\[|\]|,)/g,"")},o.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},o.prototype._resolveWidth=function(e,t){var n=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var s=this._resolveWidth(e,"style");return null!=s?s:this._resolveWidth(e,"element")}if("element"==t){s=e.outerWidth(!1);return s<=0?"auto":s+"px"}if("style"!=t)return"computedstyle"!=t?t:window.getComputedStyle(e[0]).width;e=e.attr("style");if("string"!=typeof e)return null;for(var i=e.split(";"),r=0,o=i.length;r<o;r+=1){var a=i[r].replace(/\s/g,"").match(n);if(null!==a&&1<=a.length)return a[1]}return null},o.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},o.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this.$element.on("focus.select2",function(e){t.trigger("focus",e)}),this._syncA=r.bind(this._syncAttributes,this),this._syncS=r.bind(this._syncSubtree,this),this._observer=new window.MutationObserver(function(e){t._syncA(),t._syncS(e)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})},o.prototype._registerDataEvents=function(){var n=this;this.dataAdapter.on("*",function(e,t){n.trigger(e,t)})},o.prototype._registerSelectionEvents=function(){var n=this,s=["toggle","focus"];this.selection.on("toggle",function(){n.toggleDropdown()}),this.selection.on("focus",function(e){n.focus(e)}),this.selection.on("*",function(e,t){-1===s.indexOf(e)&&n.trigger(e,t)})},o.prototype._registerDropdownEvents=function(){var n=this;this.dropdown.on("*",function(e,t){n.trigger(e,t)})},o.prototype._registerResultsEvents=function(){var n=this;this.results.on("*",function(e,t){n.trigger(e,t)})},o.prototype._registerEvents=function(){var n=this;this.on("open",function(){n.$container[0].classList.add("select2-container--open")}),this.on("close",function(){n.$container[0].classList.remove("select2-container--open")}),this.on("enable",function(){n.$container[0].classList.remove("select2-container--disabled")}),this.on("disable",function(){n.$container[0].classList.add("select2-container--disabled")}),this.on("blur",function(){n.$container[0].classList.remove("select2-container--focus")}),this.on("query",function(t){n.isOpen()||n.trigger("open",{}),this.dataAdapter.query(t,function(e){n.trigger("results:all",{data:e,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(e){n.trigger("results:append",{data:e,query:t})})}),this.on("keypress",function(e){var t=e.which;n.isOpen()?t===s.ESC||t===s.UP&&e.altKey?(n.close(e),e.preventDefault()):t===s.ENTER||t===s.TAB?(n.trigger("results:select",{}),e.preventDefault()):t===s.SPACE&&e.ctrlKey?(n.trigger("results:toggle",{}),e.preventDefault()):t===s.UP?(n.trigger("results:previous",{}),e.preventDefault()):t===s.DOWN&&(n.trigger("results:next",{}),e.preventDefault()):(t===s.ENTER||t===s.SPACE||t===s.DOWN&&e.altKey)&&(n.open(),e.preventDefault())})},o.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.isDisabled()?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},o.prototype._isChangeMutation=function(e){var t=this;if(e.addedNodes&&0<e.addedNodes.length){for(var n=0;n<e.addedNodes.length;n++)if(e.addedNodes[n].selected)return!0}else{if(e.removedNodes&&0<e.removedNodes.length)return!0;if(Array.isArray(e))return e.some(function(e){return t._isChangeMutation(e)})}return!1},o.prototype._syncSubtree=function(e){var e=this._isChangeMutation(e),t=this;e&&this.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})},o.prototype.trigger=function(e,t){var n=o.__super__.trigger,s={open:"opening",close:"closing",select:"selecting",unselect:"unselecting",clear:"clearing"};if(void 0===t&&(t={}),e in s){var i=s[e],s={prevented:!1,name:e,args:t};if(n.call(this,i,s),s.prevented)return void(t.prevented=!0)}n.call(this,e,t)},o.prototype.toggleDropdown=function(){this.isDisabled()||(this.isOpen()?this.close():this.open())},o.prototype.open=function(){this.isOpen()||this.isDisabled()||this.trigger("query",{})},o.prototype.close=function(e){this.isOpen()&&this.trigger("close",{originalEvent:e})},o.prototype.isEnabled=function(){return!this.isDisabled()},o.prototype.isDisabled=function(){return this.options.get("disabled")},o.prototype.isOpen=function(){return this.$container[0].classList.contains("select2-container--open")},o.prototype.hasFocus=function(){return this.$container[0].classList.contains("select2-container--focus")},o.prototype.focus=function(e){this.hasFocus()||(this.$container[0].classList.add("select2-container--focus"),this.trigger("focus",{}))},o.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.');e=!(e=null==e||0===e.length?[!0]:e)[0];this.$element.prop("disabled",e)},o.prototype.data=function(){this.options.get("debug")&&0<arguments.length&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var t=[];return this.dataAdapter.current(function(e){t=e}),t},o.prototype.val=function(e){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==e||0===e.length)return this.$element.val();e=e[0];Array.isArray(e)&&(e=e.map(function(e){return e.toString()})),this.$element.val(e).trigger("input").trigger("change")},o.prototype.destroy=function(){r.RemoveData(this.$container[0]),this.$container.remove(),this._observer.disconnect(),this._observer=null,this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",r.GetData(this.$element[0],"old-tabindex")),this.$element[0].classList.remove("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),r.RemoveData(this.$element[0]),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},o.prototype.render=function(){var e=t('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return e.attr("dir",this.options.get("dir")),this.$container=e,this.$container[0].classList.add("select2-container--"+this.options.get("theme")),r.StoreData(e[0],"element",this.$element),e},o}),u.define("jquery-mousewheel",["jquery"],function(e){return e}),u.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults","./select2/utils"],function(i,e,r,t,o){var a;return null==i.fn.select2&&(a=["open","close","destroy"],i.fn.select2=function(t){if("object"==typeof(t=t||{}))return this.each(function(){var e=i.extend(!0,{},t);new r(i(this),e)}),this;if("string"!=typeof t)throw new Error("Invalid arguments for Select2: "+t);var n,s=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=o.GetData(this,"select2");null==e&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2."),n=e[t].apply(e,s)}),-1<a.indexOf(t)?this:n}),null==i.fn.select2.defaults&&(i.fn.select2.defaults=t),r}),{define:u.define,require:u.require});function b(e,t){return i.call(e,t)}function l(e,t){var n,s,i,r,o,a,l,c,u,d,p=t&&t.split("/"),h=y.map,f=h&&h["*"]||{};if(e){for(t=(e=e.split("/")).length-1,y.nodeIdCompat&&_.test(e[t])&&(e[t]=e[t].replace(_,"")),"."===e[0].charAt(0)&&p&&(e=p.slice(0,p.length-1).concat(e)),c=0;c<e.length;c++)"."===(d=e[c])?(e.splice(c,1),--c):".."===d&&(0===c||1===c&&".."===e[2]||".."===e[c-1]||0<c&&(e.splice(c-1,2),c-=2));e=e.join("/")}if((p||f)&&h){for(c=(n=e.split("/")).length;0<c;--c){if(s=n.slice(0,c).join("/"),p)for(u=p.length;0<u;--u)if(i=h[p.slice(0,u).join("/")],i=i&&i[s]){r=i,o=c;break}if(r)break;!a&&f&&f[s]&&(a=f[s],l=c)}!r&&a&&(r=a,o=l),r&&(n.splice(0,o,r),e=n.join("/"))}return e}function w(t,n){return function(){var e=a.call(arguments,0);return"string"!=typeof e[0]&&1===e.length&&e.push(null),o.apply(p,e.concat([t,n]))}}function x(e){var t;if(b(m,e)&&(t=m[e],delete m[e],v[e]=!0,r.apply(p,t)),!b(g,e)&&!b(v,e))throw new Error("No "+e);return g[e]}function c(e){var t,n=e?e.indexOf("!"):-1;return-1<n&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function A(e){return e?c(e):[]}var u=s.require("jquery.select2");return t.fn.select2.amd=s,u});(function($){$.fn.yandexMapSearcher=function(){this.each(function(){var $this=$(this);var yandexApiKey=$this.data('yandex-apikey');var mapIdContainer='yandex-map';var centerCoordinates=[55.76,37.64];var zoomValue=10;var controlsMap=['zoomControl'];var myMap;var myPlacemark;var $form=$this.closest('form');var $searchInput=$this.find('#suggest');var $searchButton=$this.find('#suggest-button');var $addressInput=$this.find('input[name=address]');var $coordsInput=$this.find('input[name=coords]');var $addressList=$this.find('.map-address');YandexMapController.loadScript(yandexApiKey,function(){ymaps.ready(async function(){if(yandexApiKey){await YandexMapController.testApiKey(yandexApiKey)}yandexApiKey=YandexMapController.apikey;init()})});function init(){myMap=new ymaps.Map(mapIdContainer,{center:centerCoordinates,zoom:zoomValue,controls:controlsMap,},{searchControlProvider:'yandex#search',});myMap.events.add('click',function(e){var coords=e.get('coords');addPlacemarkByValue(coords);$searchInput.val('')});if(yandexApiKey){var suggestView=new ymaps.SuggestView('suggest',{provider:'yandex#map',results:10,width:360,offset:[0,4]});suggestView.events.add('select',function(event){ymaps.geocode(event.get('item').value,{results:1}).then(function(res){var firstGeoObject=res.geoObjects.get(0),coords=firstGeoObject.geometry.getCoordinates(),bounds=firstGeoObject.properties.get('boundedBy');addAddressByCoords(coords);myMap.setBounds(bounds,{checkZoomRange:true,})})})}if($coordsInput.val()){var coords=$coordsInput.val().split(',');myMap.setCenter(coords);addPlacemarkByValue(coords)}}async function addPlacemarkByValue(value){if(!value)return;if(!yandexApiKey){try{if(!_isCoords(value)){throw new Error(s3.loc('JS_COORDINATES_ARE_INCORRECT'))}if(typeof value==="object"){addPlacemark(value)}else{addPlacemark(value.split(','))}$coordsInput.val(value);addAddressItem(value)}catch(e){s3.alert(e.message)}return}try{var coords=_isCoords(value)?value:await getCoords(value);addAddressByCoords(coords)}catch(e){s3.alert(s3.loc('JS_NOTHING_FOUND'))}}async function addAddressByCoords(coords){try{var address=await getAddress(coords);var coordsInputVal=Array.isArray(coords)?coords.join(','):coords;var placemarkCoords=Array.isArray(coords)?coords:coords.split(',');addPlacemark(placemarkCoords);$addressInput.val(address);$coordsInput.val(coordsInputVal);addAddressItem(address)}catch(e){s3.alert(s3.loc('JS_COORDINATES_ARE_INCORRECT'))}}function addAddressItem(address){$addressList.html('');if(!yandexApiKey){$addressList.prepend(getAddressItemHTML(address,''))}else{var draftAddress=address.split(',');var title='';var note='';if(draftAddress.length>=3){note=draftAddress.shift()+', '+draftAddress.shift();title=draftAddress.join(', ')}else{title=address}$addressList.prepend(getAddressItemHTML(title,note))}$addressList.removeClass('hide')}function getAddressItemHTML(title,note=''){return`<div class="map-address__item"><div class="map-address__title">${title}</div><div class="map-address__note">${note}</div></div>`}function addPlacemark(coords){if(myPlacemark){myPlacemark.geometry.setCoordinates(coords)}else{myPlacemark=createPlacemark(coords);myMap.geoObjects.add(myPlacemark);myPlacemark.events.add('dragend',dragendPlacemarkCallback)}}function dragendPlacemarkCallback(){addPlacemarkByValue(myPlacemark.geometry.getCoordinates())}function createPlacemark(coords){return new ymaps.Placemark(coords,{},{preset:'islands#darkGreenIcon',draggable:true,})}async function getAddress(coords){return await ymaps.geocode(coords).then(function(res){var firstGeoObject=res.geoObjects.get(0);return firstGeoObject.getAddressLine()})}async function getCoords(address){return await ymaps.geocode(address,{results:1}).then(function(res){var firstGeoObject=res.geoObjects.get(0);return firstGeoObject.geometry.getCoordinates()})}function _isCoords(value){return/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/.test(value)}async function setCenterMap(coords){if(!coords)return;coords=_isCoords(coords)?coords.split(','):await getCoords(coords);myMap.setCenter(coords)}$searchButton.on('click',async function(){var inputValue=$searchInput.val();await setCenterMap(inputValue);await addPlacemarkByValue(inputValue)});$form.on('keydown',function(e){if(e.key!=="Enter"||e.keyCode!==13)return;e.preventDefault();var inputValue=$searchInput.val();setCenterMap(inputValue);addPlacemarkByValue(inputValue)})})}})(jQuery);(function($){$.fn.yandexMapGeocode=function(){this.each(function(){var $this=$(this);var yandexApiKey=$this.parent().data('yandex-apikey');var coords=$this.data('yandex-coords');YandexMapController.loadScript(yandexApiKey,function(){ymaps.ready(async function(){if(yandexApiKey){await YandexMapController.testApiKey(yandexApiKey)}yandexApiKey=YandexMapController.apikey;init()})});async function init(){if(!yandexApiKey){return}var $title=$this.find('.map-coords-item__title');var $note=$this.find('.map-coords-item__note');var address=await getAddressByCoords(coords);var draftAddress=address.split(',');if(draftAddress.length>=3){$note.html(draftAddress.shift()+', '+draftAddress.shift());$title.html(draftAddress.join(','))}else{$title.html(address)}}async function getAddressByCoords(coords){return await ymaps.geocode(coords).then(function(res){var firstGeoObject=res.geoObjects.get(0);return firstGeoObject.getAddressLine()})}})}})(jQuery);var YandexMapController={};(function($){YandexMapController={set apikey(value){this._apikey=value},get apikey(){return this._apikey},testApiKey:async function(apikey){await ymaps.geocode('55.7584,37.6221').then(function(){YandexMapController.apikey=apikey},function(){YandexMapController.apikey=''})},loadScript:function(apikey,callback){var isInitYmaps=typeof(window['ymaps'])!=='undefined';var isJSInit=isInitYmaps&&typeof(window['ymaps']['s3_js_init'])!=='undefined';if(!isInitYmaps||(isInitYmaps&&!isJSInit)){if(isInitYmaps){delete window['ymaps']}$.getScript(this.getScriptUrl(apikey)).done(function(){if(typeof callback==='function')callback();window['ymaps']['s3_js_init']=true})}else{if(typeof callback==='function')callback()}},deleteItem:function(ctx){s3.confirm(s3.loc('JS_CONFIRM_DELETE'),function(){popupController.closeLastPopup();$(ctx.closest('ul')).addClass('hide');$(ctx.closest('ul')).next().removeClass('hide');ctx.closest('li').remove()})},getScriptUrl:function(apiKey){const paramApiKey=apiKey?'&apikey='+apiKey:'';return'//api-maps.yandex.ru/2.1/?lang=ru_RU'+paramApiKey},}})(jQuery);(function($){$.fn.S3Select2=function(){const AJAX_DELAY=1000;const MINIMUM_RESULTS_FOR_SEARCH=15;return this.each(function(){const $this=$(this);const placeholder=$this.data('placeholder')?$this.data('placeholder'):'';const stylelizeIfSetValue=$this.data('stylelize');const ajax=$this.data('ajax')?$this.data('ajax'):'';const valueGrayOption=$this.data('value-gray-option')??'';let options={minimumResultsForSearch:ajax?0:MINIMUM_RESULTS_FOR_SEARCH,placeholder:placeholder,dropdownAutoWidth:true,templateResult:function(data,container){const code=data.element?.dataset.code;const img=data.element?.dataset.img;if(data.id===valueGrayOption.toString()){$(container).addClass('gray')}return $(`<div class="option ${code || img ? `ref-item`:``}">${code?`<div class="image"style="background:${code};"></div>`:``}${img?`<div class="image"style="background: url(${img}); 0 0 no-repeat;"></div>`:``}${data.text}</div>`)}};if(ajax){let ajax_data=function(params){return{query:params.term}};const page_limit=($this.data('page_limit')?$this.data('page_limit'):0);if(page_limit){let ajax_data=function(params){return{query:params.term,page_limit:page_limit,page:params.page}}}options=$.extend({},options,{ajax:{url:ajax,dataType:'json',data:ajax_data,delay:AJAX_DELAY,processResults:function(data,params){return{results:data}}}})}$this.select2(options);$this.on('change',()=>{if(stylelizeIfSetValue){util.changeStyleControlIfValueASet(this,'select2')}});$this.on('select2:clearing',(event)=>{$(event.target).val([]).change()});$this.on('select2:opening select2:closing',function(){const $searchField=$(this).parent().find('.select2-search__field');$searchField.prop('disabled',true)});$this.on('select2:open',()=>{document.addEventListener('keydown',closeSelectOnEsc);setTimeout(()=>{$('.select2-container--open input.select2-search__field')[0].focus()},200)});$this.on('select2:close',()=>{document.removeEventListener('keydown',closeSelectOnEsc)});function closeSelectOnEsc(e){if(e.keyCode===27){$this.select2('close')}}if(stylelizeIfSetValue){util.changeStyleControlIfValueASet(this,'select2')}})}})(jQuery);(function($){$.fn.serializeObject=function(){var o={};var a=this.serializeArray();$.each(a,function(){if(o[this.name]!==undefined){if(!o[this.name].push){o[this.name]=[o[this.name]]}o[this.name].push(this.value||'')}else{o[this.name]=this.value||''}});return o}})(jQuery);(function($){$.fn.checkboxClickFunction=function(event,from_controller,callback,wcond){if(from_controller||$(event.target).is('input')){var el=$(this).find('input'),el_parent=$(this),el_parent_container=$(this).parents($(this).data('parent-selector')),el_parent_neighbors=$(this).data('neighbors'),group=$('input[name="'+el.eq(0).attr('name')+'"]'),add_class,class_target,callback_attr,SD,SD_chbox=$(''),folder_id=wcond,dataCountAll=0,dataCountAllWcond=0,wcond=(wcond===0||wcond===-1||parseInt(wcond)>0)?true:false,is_product_flag=$(this).parents('.product-flag-label');add_class=$(this).data('add-class');class_target=$($(this).data('class-target'));callback_attr=el.data('callback');if(el.is(':disabled')){return false}if(el.attr('target')){SD_chbox=el}else{if(el.attr('parent')){SD_chbox=$(el.attr('parent'))}}if(SD_chbox.size()){SD={'empty-text':SD_chbox.data('selector-empty-text'),'xelem-text':SD_chbox.data('selector-xelem-text'),'text-target':$(SD_chbox.data('selector-text-target')),'checked-all':$(SD_chbox.data('selector-checked-all')),'checked-all-wcond':$(SD_chbox.data('selector-checked-all-wcond')),};dataCountAll=SD['checked-all'].data('count');dataCountAllWcond=SD['checked-all-wcond'].data('count')}if(from_controller==true){if(el.is(':checked')){if(wcond){SD['checked-all'].removeClass('active');SD['checked-all-wcond'].addClass('active');SD['text-target'].html(SD['checked-all-wcond'].text()+"<span class='badge'>"+dataCountAllWcond+"</span>")}else{SD['checked-all-wcond'].removeClass('active');SD['checked-all'].addClass('active');SD['text-target'].html(SD['checked-all'].text()+"<span class='badge'>"+dataCountAll+"</span>")}return}else{el.attr('checked','checked').prop('checked',true)}}if(el.attr('target')){if(el_parent.is('.half-active')){el.attr('checked','checked').prop('checked',true)}$(el.attr('target')).find('label.s3-cb').each(function(){if($(this).hasClass('switcher')){return}var add_class,class_target;add_class=$(this).data('add-class');class_target=$($(this).data('class-target'));if(el.is(':checked')){el_parent.removeClass('half-active');$(this).addClass('active').find('input').attr('checked','checked').prop('checked',true);if(class_target.size()){class_target.addClass(add_class)}$(this).parent().addClass('full-size')}else{$(this).removeClass('active').find('input').removeAttr('checked').prop('checked',false);if(class_target.size()){class_target.removeClass(add_class)}$(this).parent().removeClass('full-size')}});if(el.is(':checked')){if(wcond){SD['checked-all'].removeClass('active');SD['checked-all-wcond'].addClass('active');SD['text-target'].html(SD['checked-all-wcond'].text()+"<span class='badge'>"+dataCountAllWcond+"</span>")}else{SD['checked-all-wcond'].removeClass('active');SD['checked-all'].addClass('active');SD['text-target'].html(SD['checked-all'].text()+"<span class='badge'>"+dataCountAll+"</span>")}}else{SD['checked-all'].removeClass('active');SD['checked-all-wcond'].removeClass('active');SD['text-target'].text(SD['empty-text'])}}if(el.attr('parent')){var parent_chbox=$(el.attr('parent')),parent=parent_chbox.parent(),parent_add_class=parent.data('add-class'),parent_class_target=$(parent.data('class-target')),group=el.parents('.cb-group:first'),$labels=group.find('label.s3-cb').not('.switcher'),checked_size=0,unchecked_size=0,all_size=0;$labels.each(function(){all_size++;if($(this).find('input').is(':checked')){checked_size++}else{unchecked_size++}});if(el.is(':checked')){if(all_size==checked_size&&all_size!=0){parent.removeClass('half-active').addClass('active').find('input').attr('checked','checked').prop('checked',true);parent_class_target.addClass(parent_add_class);if(wcond){SD['checked-all'].removeClass('active');SD['checked-all-wcond'].addClass('active')}else{SD['checked-all-wcond'].removeClass('active');SD['checked-all'].addClass('active')}SD['text-target'].html(SD['checked-all'].text()+"<span class='badge'>"+dataCountAll+"</span>")}else{parent.addClass('half-active').find('input').removeAttr('checked').prop('checked',false);parent_class_target.addClass(parent_add_class);SD['checked-all'].removeClass('active');SD['checked-all-wcond'].removeClass('active');SD['text-target'].html(SD['xelem-text']+"<span class='badge'>"+checked_size+"</span>")}el_parent_container.find(el_parent_neighbors).addClass('full-size')}else{if(unchecked_size==all_size&&all_size!=0){parent.removeClass('active').removeClass('half-active').find('input').removeAttr('checked').prop('checked',false);parent_class_target.removeClass(parent_add_class);SD['checked-all'].removeClass('active');SD['checked-all-wcond'].removeClass('active');SD['text-target'].text(SD['empty-text']);el_parent_container.find(el_parent_neighbors).removeClass('full-size')}else{if(checked_size!=0&&unchecked_size!=0){parent.removeClass('active').addClass('half-active').find('input').removeAttr('checked').prop('checked',false);parent_class_target.addClass(parent_add_class);SD['checked-all'].removeClass('active');SD['checked-all-wcond'].removeClass('active');SD['text-target'].html(SD['xelem-text']+"<span class='badge'>"+checked_size+"</span>")}}}}if(el.is(':checked')){if(el.attr('type')=='radio'){group.each(function(){$(this).removeAttr('checked').prop('checked',false).parent().removeClass('active')})}el.attr('checked','checked').prop('checked',true);$(this).addClass('active');if(UsersController.folder_id===false||UsersController.folder_id!==folder_id){UsersController.folder_id=folder_id}if(ImageController.folder_id===false||ImageController.folder_id!==folder_id){ImageController.folder_id=folder_id}if(FileController.folder_id===false||FileController.folder_id!==folder_id){FileController.folder_id=folder_id}if(TagsController.folder_id!==folder_id){TagsController.folder_id=folder_id}if(Shop2VendorsController.folder_id!==folder_id){Shop2VendorsController.folder_id=folder_id}if(BoardController.folder_id!==folder_id){BoardController.folder_id=folder_id}if(OrderController.folder_id!==folder_id){OrderController.folder_id=folder_id}if(Shop2Controller.folder_id!==folder_id){Shop2Controller.folder_id=folder_id}if(MarketplaceController.folder_id!==folder_id){MarketplaceController.folder_id=folder_id}if(MarketplaceOrderController.folder_id!==folder_id){MarketplaceOrderController.folder_id=folder_id}}else{el.removeAttr('checked').prop('checked',false);$(this).removeClass('active');if(typeof UsersController.folder_id=='number'){UsersController.folder_id=false}if(typeof ImageController.folder_id=='number'){ImageController.folder_id=false}if(typeof Shop2Controller.folder_id=='number'){Shop2Controller.folder_id=false}if(typeof FileController.folder_id=='number'){FileController.folder_id=false}if(typeof OrderController.folder_id=='number'){OrderController.folder_id=false}if(typeof Shop2VendorsController.folder_id=='number'){Shop2VendorsController.folder_id=false}if(typeof TagsController.folder_id=='number'){TagsController.folder_id=false}if(typeof BoardController.folder_id=='number'){BoardController.folder_id=false}if(typeof MarketplaceController.folder_id=='number'){MarketplaceController.folder_id=false}if(typeof MarketplaceOrderController.folder_id=='number'){MarketplaceOrderController.folder_id=false}}if(el.is(':checked')){if(class_target.size()){class_target.addClass(add_class)}}else{if(class_target.size()){class_target.removeClass(add_class)}}if(is_product_flag){var f_name=el.prop('name');var flag_date_name=f_name+'_date_till';if(el.is(':checked')){$('input[name*=\''+flag_date_name+'\']').prop('disabled',false)}else{$('input[name*=\''+flag_date_name+'\']').prop('disabled',true)}}try{eval(callback_attr)}catch(e){}if(callback!=undefined&&typeof callback=='function'){callback(event,el.is(':checked'))}el.trigger('cb.change')}};$.fn.S3changeCheckboxAndRadio=function(callback){return this.each(function(){var $this=$(this),el=$this.find('input[type="checkbox"], input[type="radio"]'),add_class,class_target,folder_id;if($this.data('s3ControlInit')){if(el.is(':disabled')){$this.addClass('disabled')}else{$this.removeClass('disabled')}if(el.is(':checked')){$this.addClass('active')}else{$this.removeClass('active')}}else{$this.data('s3ControlInit',true);add_class=$this.data('add-class');class_target=$($this.data('class-target'));folder_id=$this.data('folder-id');$('<span class="ico"></span>').insertAfter(el);el.hide();if(el.is(':disabled')){$this.addClass('disabled')}if(el.is(':checked')){$this.addClass('active')}$this.click(function(event){if(folder_id>=0){$this.checkboxClickFunction(event,false,callback,folder_id)}else{$this.checkboxClickFunction(event,false,callback)}})}})}})(jQuery);(function($){$.fn.S3ChangeControls=function(callback){try{const foundWidgets=$(this).find('[id$=\'Widget\']').toArray();if(foundWidgets.length){foundWidgets.forEach((widgetContainer)=>{const widgetId=widgetContainer.id.replace('Widget','');const widget=WidgetsInModal.manager.getWidgetById(widgetId);if(widget){widget.mount()}})}}catch(e){}return this.each(function(){var self=$(this);self.find('.s3-select, .s3-group-operations-actions-list').each(function(){var select=$(this),select_width=select.attr('data-width'),is_watermark_select=select.parent().find('#watermark_on').length,is_with_icons_select=select.hasClass('with-icons');if(is_watermark_select){switchWatermarkSettings($(this).val())}if(!select_width&&select.width()>150){select_width=select.width()+10}if(!(/\%$/.test(select_width))&&!(/(px)%/.test(select_width))){if(select_width){select_width+='px'}else{select_width='auto'}}if(select.attr('data-placeholder')){var select_placeholder=select.attr('data-placeholder')}else{var select_placeholder=' '}var hideChozen=function(node){var chznDrop=$(node).parent().find("div.chzn-drop");var chznResults=$(".active-result",chznDrop);if(!chznResults.length){$(node).data("chosen").results_hide()}};select.chosen({width:select_width,no_results_text:JS_NOTHING_FOUND,placeholder_text_single:select_placeholder,placeholder_text_multiple:JS_SELECT_SOME_VALUES,disable_search_threshold:(select.is('.without-search')?99999:10)}).change(function(){var actionBtn=$(this).parent().find('span.action');if(actionBtn.get(0)&&$(this).val()!=''){actionBtn.addClass('visible')}else{actionBtn.removeClass('visible')}if(is_watermark_select){switchWatermarkSettings($(this).val())}if($(this).is('.without-map-key')){if($(this).val()=="google"){self.find('.google-key-error').show()}else{self.find('.google-key-error').hide()}}if(is_with_icons_select){var optionClass=(select.find('option:selected').attr('data-icon-class'))?select.find('option:selected').attr('data-icon-class'):'';select.next().find('.chzn-single > span').addClass(optionClass)}hideChozen(this)}).on("liszt:showing_dropdown",function(_,{chosen}){hideChozen(this);const tabsWrapper=$(this).closest('#tabs');const scrollWrapper=tabsWrapper.find('.tabs-container').find('> div:visible');if(scrollWrapper.length!==1){return}const TOP_OFFSET=15;const $chosenDropdown=chosen.dropdown;const chosenDropdownOuterHeight=$chosenDropdown.outerHeight();const chosenContainerOffsetTop=chosen.container[0].offsetTop;const chosenDropdownHeightWithOffsetAndScroll=chosenContainerOffsetTop+chosenDropdownOuterHeight-scrollWrapper.scrollTop();if(scrollWrapper.innerHeight()<chosenDropdownHeightWithOffsetAndScroll){$chosenDropdown.css({top:-(chosenDropdownOuterHeight+TOP_OFFSET)})}else{$chosenDropdown.css({top:'initial'})}});setTimeout(function(){if(!select.attr('data-width')&&select.width()>150){select.next('.chzn-container').width(select.width()+10)}},200);if(is_with_icons_select){select.change()}});self.find('.s3-watermark-on-select').each(function(){const select=$(this);const is_watermark_select=select.parent().find('#watermark_on').length;if(is_watermark_select){switchWatermarkSettings($(this).val())}select.change(function(){if(is_watermark_select){switchWatermarkSettings($(this).val())}})});self.find('.s3-select2').S3Select2();self.find('.yandex-map-container').yandexMapSearcher();self.find('.yandex-map-geocode').yandexMapGeocode();self.find('.s3-rb, .s3-cb').S3changeCheckboxAndRadio(callback);self.find('.s3-file').changeFileInput();self.find('.s3-toggle').toggleBlock();self.find('.s3-json-map-coords').placepicker();self.find('.s3-popup-tabs').popupTabController();self.find('.s3-tooltip').tooltip({tooltipClass:"custom-tooltip-styling",position:{my:"left-5 top",at:"left bottom+5"}});self.find('.s3-tooltip.small').tooltip({tooltipClass:"custom-tooltip-styling small",position:{my:"left-5 top",at:"left bottom+5"}});self.find('.s3-jquery-toggles').each(function(){var e=$(this);e.toggles({on:e.data('on'),text:{on:JS_YES,off:JS_NO}})});self.find('.s3-limited-text').each(function(){var start_and_end=function(text,limit){if(text.length>limit){text_box.attr('title',text).tooltip();return text.substr(0,limit*0.4)+'...'+text.substr(text.length-limit/2,text.length)};return text};var text_box=$(this),target_text=text_box.text(),text_limit=text_box.attr('data-limit');if(!text_limit){return};target_text=start_and_end(target_text,text_limit);text_box.text(target_text)});self.find('textarea.autoresize').each(function(){var offset=this.offsetHeight-this.clientHeight,resizeTextarea=function(el,el_parent){el_parent.height($(el).height());$(el).css('height','auto');$(el).css('height',el.scrollHeight+offset+3);el_parent.css('height','auto')};var textarea=$(this),textarea_val;textarea.wrap('<div class="autoresize-wrap"></div>');textarea.on('keyup input change keyup keydown paste cut',function(event){var keyCode=event.keyCode||event.which;textarea_val=$(this).val();$(this).val(textarea_val.replace(/\n/g,' ').replace(/\t/g,' '));if(keyCode==13){event.preventDefault()}resizeTextarea(this,$(this).parent('.autoresize-wrap'))});setTimeout(function(){textarea.trigger('change')},50)});self.find('.minicolors-control').minicolors({format:'rgb',inline:false,opacity:true,position:'bottom right',swatches:[]});self.find('.s3-sortable').each(function(){if($(this).attr('data-sort-handle')){$(this).sortable({handle:$(this).attr('data-sort-handle')})}else{$(this).sortable()}});self.find('.s3-code-editor').each(function(){var textarea=$(this),textarea_mode=textarea.attr('data-editor-mode'),edDiv=$('<div>',{'class':textarea.attr('class')}).css({position:'relative',minWidth:Math.max(textarea.width(),600),width:'inherit',height:textarea.height(),});textarea.hide();edDiv.insertBefore(textarea);var ed=ace.edit(edDiv[0]),session=ed.getSession();session.setValue(textarea.val());session.setMode(textarea_mode?'ace/mode/'+textarea_mode:'ace/mode/text');ed.setOption("minLines",10);session.setUseSoftTabs(false);ed.setShowPrintMargin(false);ed.setTheme('ace/theme/chrome');ed.setFontSize(14);ed.setOption("maxLines",30);ed.getSession().setUseWorker(true);if(textarea.hasClass('readonly')){ed.setReadOnly(true)}ed.setOptions({enableBasicAutocompletion:true,enableSnippets:false,enableLiveAutocompletion:true});if(textarea_mode=="json"){ed.completers.push({getCompletions:function(editor,session,pos,prefix,callback){callback(null,[{value:"type",score:1000,meta:"s3_json"},{value:"name",score:1000,meta:"s3_json"},{value:"note",score:1000,meta:"s3_json"},{value:"in_order",score:1000,meta:"s3_json"},{value:"no_html",score:1000,meta:"s3_json"},{value:"required",score:1000,meta:"s3_json"},{value:"staff_only",score:1000,meta:"s3_json"},{value:"validator",score:1000,meta:"s3_json"},{value:"error",score:1000,meta:"s3_json"},{value:"options",score:1000,meta:"s3_json"},{value:"format_id",score:1000,meta:"s3_json"},{value:"value",score:1000,meta:"s3_json"},{value:"size",score:1000,meta:"s3_json"},{value:"maxlength",score:1000,meta:"s3_json"},{value:"length",score:1000,meta:"s3_json"},{value:"hidden",score:1000,meta:"s3_json"},{value:"text",score:1000,meta:"s3_json"},{value:"textarea",score:1000,meta:"s3_json"},{value:"html",score:1000,meta:"s3_json"},{value:"select",score:1000,meta:"s3_json"},{value:"multiselect",score:1000,meta:"s3_json"},{value:"image",score:1000,meta:"s3_json"},{value:"multiimage",score:1000,meta:"s3_json"},{value:"multiimage2",score:1000,meta:"s3_json"},{value:"file",score:1000,meta:"s3_json"},{value:"multifile",score:1000,meta:"s3_json"},{value:"flash",score:1000,meta:"s3_json"},{value:"multiflash",score:1000,meta:"s3_json"},{value:"media",score:1000,meta:"s3_json"},{value:"media2",score:1000,meta:"s3_json"},{value:"image2",score:1000,meta:"s3_json"},{value:"multimedia",score:1000,meta:"s3_json"},{value:"checkbox",score:1000,meta:"s3_json"},{value:"multicheckbox",score:1000,meta:"s3_json"},{value:"folder",score:1000,meta:"s3_json"},{value:"multifolder",score:1000,meta:"s3_json"}])}})};ed.on('change',function(e){textarea.text(ed.getSession().getValue());textarea.val(ed.getSession().getValue())})});self.find('.s3-clipboard-btn').each(function(){var clipboardBtn=$(this).get(0),successText=$(this).attr('data-clipboard-success-text')||JS_COPIED+": \""+$(this).attr('data-clipboard-text')+"\"",onSuccess=function(){util.msg(successText)};s3.clipboard(clipboardBtn,onSuccess)});self.find('.s3-lazy-img').each(function(){$(this).lazyload({effect:"fadeIn",skip_invisible:false})});self.find('.s3-date-select').each(function(){s3.initS3DateSelect(this)});self.find('#inner_notice_data').s3InnerNotice();if(self.find('.choose_elems_wr-js').length){$('.choose_elems_wr-js').on('click','span',function(){thisparent=$(this).parent('.choose_elems_wr-js');wrap=thisparent.parent();is_select=wrap.find('select').length;action=$(this).data('action');if(!is_select){wrap=thisparent.closest('.multi-checkbox-wrap')}if(action=='choose_all'){if(is_select){select=wrap.find('select');options=select.find('option');options.prop('selected',true);if(select.hasClass('s3-select2')){select.trigger('change')}else{select.trigger('liszt:updated')}}else{checkbox=wrap.find('input[type="checkbox"]');checkbox.prop('checked',true);wrap.find('[data-multi_checkbox_default_change]').removeClass('mc-disabled');wrap.find('input[type="radio"]').attr('disabled',false)}}else{if(is_select){select=wrap.find('select');ulchooseelems=wrap.find('.search-choice');select.val([]);if(select.hasClass('s3-select2')){select.trigger('change')}else{select.trigger('liszt:updated')}ulchooseelems.detach()}else{checkbox=wrap.find('input[type="checkbox"]');checkbox.prop('checked',false);wrap.find('[data-multi_checkbox_default_change]').addClass('mc-disabled');wrap.find('input[type="radio"]').attr('disabled',true)}}})}self.find('.spectrum').each(function(e){var obj=this;var params=$(obj).attr('title');var settings=$.parseJSON(params);settings.showPalette=true;settings.palette=colorPicker.getPalette();settings.hideAfterPaletteSelect=true;settings.togglePaletteOnly=true;settings.togglePaletteMoreText=JS_MORE;settings.togglePaletteLessText=JS_LESS;settings.change=function(color){$('[id="'+obj.id+'_code"]').html(color.toHexString())};$(obj).spectrum(settings);$(obj).attr('title','')});self.find('.s3-group-operations-control').each(function(){var control=$(this),li=$(this).find('li'),actionBtn=control.find('span.action');control.find('.checked-operation').css('width',control.attr('data-width')+'px');li.on('click','span.txt',function(){if(!$(this).attr('onclick')){li.removeClass('selected');$(this).parents('li:first').addClass('selected');var clone=$(this).clone();control.find('.checked-operation').empty().append(clone);if($(this).attr('data-event')){control.find('span.action').addClass('visible')}else{control.find('span.action').removeClass('visible')}}});actionBtn.on('click',function(){var evt=control.find('.checked-operation > span.txt').data('event');try{if(evt){eval(evt)}}catch(err){alert(err.name+"\n"+err.fileName+": Line "+err.lineNumber+":"+err.message)}return false})});if(self.find('[data-multi_checkbox_change]').length){$('[data-multi_checkbox_change]').on('change',function(){$radio_wrap=$(this).next();if($radio_wrap.hasClass('mc-disabled')){$radio_wrap.removeClass('mc-disabled');$radio_wrap.find('input').attr('disabled',false)}else{$radio_wrap.removeClass('mc-active');$radio_wrap.addClass('mc-disabled');$radio_wrap.find('input').attr('disabled',true);$radio_wrap.find('input').prop('checked',false)}})}if(self.find('[data-multi_checkbox_default_change]').length){$('[data-multi_checkbox_default_change]').on('change',function(){$(this).closest('.color-ref-items').find('.mc-active').removeClass('mc-active');$(this).addClass('mc-active')})}self.find('.row-menu-main').each(function(){$(this).rowMenuPlugin()})})};function switchWatermarkSettings(watermarkType){var watermarkPreview=$('span.select-watermark-preview').parent(),watermarkOpacity=$('#watermark_opacity').parent().parent(),watermarkWidth=$('#watermark_width').parent().parent(),watermarkText=$('#watermark_text').parent().parent(),watermarkImage=$('.s3-image-control-wrap').parent(),watermarkIconPosition=$('#watermark_icon_position').parent().parent(),watermarkPosition=$('#watermark_position').parent().parent(),watermarkDirection=$('#watermark_direction').parent().parent();watermarkPreview.show();watermarkOpacity.show();watermarkWidth.show();switch(parseInt(watermarkType)){case 1:watermarkText.show();watermarkPosition.show();watermarkDirection.show();watermarkImage.hide();watermarkIconPosition.hide();break;case 2:watermarkImage.show();watermarkIconPosition.show();watermarkText.hide();watermarkPosition.hide();watermarkDirection.hide();break;default:watermarkPreview.hide();watermarkOpacity.hide();watermarkWidth.hide();watermarkImage.hide();watermarkText.hide();watermarkIconPosition.hide();watermarkPosition.hide();setTimeout(function(){watermarkDirection.hide()},100);break}}})(jQuery);(function($){$.fn.S3DestroyControls=function(){try{const foundWidgets=$(this).find('[id$=\'Widget\']').toArray();if(foundWidgets.length){foundWidgets.forEach((widgetContainer)=>{const widgetId=widgetContainer.id.replace('Widget','');const widget=WidgetsInModal.manager.getWidgetById(widgetId);if(widget){widget.unmount()}})}}catch(e){}return this.each(function(){var self=$(this);self.find('.s3-date-select').each(function destroy(_,el){const $dateSelectEl=$(el);const instanceDateRangePicker=$dateSelectEl.data('daterangepicker')||null;if(!instanceDateRangePicker){return}instanceDateRangePicker.remove()})})};$.fn.rowMenuPlugin=function(){let timeout;const $menu=this;const $li=$menu.find('>li');const moreText=s3.loc('MORE');const resizeObserver=new ResizeObserver(()=>{if(timeout!=='undefined'){clearTimeout(timeout)}timeout=setTimeout(resizeRowMenu,10)});resizeObserver.observe($menu.get(0));function rowMenuInit(){let menuWidth=0;const menuMaxWidth=$menu.outerWidth();$menu.addClass('row-menu-init');$li.each(function(){const $this=$(this);const thisWidth=$this.outerWidth(true);menuWidth+=thisWidth;if((menuWidth+100)>=menuMaxWidth){$this.attr('data-append',1);$this.find('span').addClass('txt');if($menu.find('.row-menu-btn').length<1){$menu.append('<li class="row-menu-btn s3-tabs-nav__li s3-tabs-nav--blue"><span onclick="S3ContextMenuController.openContextMenu(\'.s3-tabs-nav__more-js\', null, event, this);">'+moreText+'<span class="s3-ico-24 i-arrow-down blue"></span></span><div class="context-menu context-menu-v2 s3-tabs-nav__more-js"><ul class="row-menu-container"></ul></div></li>');$menu.find('.row-menu-btn').insertBefore($menu.find('[data-append="1"]').first())};$menu.find('[data-append="1"]').appendTo($menu.find('.row-menu-container'))};return menuWidth});$menu.find('li').removeAttr('data-append');const blueLiCount=$menu.find('.s3-tabs-nav__li.s3-tabs-nav--blue li').length;$menu.find('.s3-tabs-nav__li.s3-tabs-nav--blue span.s3-ico-24.i-arrow-down ').before(' ('+blueLiCount+')')};function resizeRowMenu(){$menu.find('.row-menu-container').insertAfter($menu.find('.row-menu-btn'));$menu.find('.row-menu-container > li').unwrap();$menu.find('.row-menu-btn').remove();rowMenuInit()}rowMenuInit()}})(jQuery);(function($){$.fn.S3CreatePageTypeSwitcher=function(obj){this.find('label').click(function(){var type=$(this).find('input[name="content"]').val();obj.removeClass('page').removeClass('verification').removeClass('link').addClass(type)})}})(jQuery);(function($){$.fn.S3tabs=function(obj,popup){return this.each(function(){var $this=$(this),tabbable;if(obj){if(obj=='next'){tabbable=$this.next()}else if(obj=='prev'){tabbable=$this.prev()}else{tabbable=obj}}else{tabbable=$this.next()};tabbable.addClass('s3-tabbable');if(popup){$this.addClass('s3-popup-tabs');tabbable.addClass('s3-popup-tabbable')};$this.find('a').click(function(e){e.preventDefault();$this.find('a.active').removeClass('active');$(this).addClass('active');tabbable.find('>.active').removeClass('active').end().find($(this).attr('href')).addClass('active')}).eq(0).click()})}})(jQuery);(function($){$.fn.popupTabController=function(){this.each(function(){var $this=$(this),tabs=$this.find('li').not('.title');tabs.find('span').click(function(){var tab=$(this),target=$(tab.data('target')),inputTarget=$(tab.data('input')),inputValue=tab.data('input-value');if(tab.is('.active')){return false};tabs.find('span').each(function(){$(this).removeClass('active');$($(this).data('target')).css('display','none')});tab.addClass('active');target.css('display','block');inputTarget.val(inputValue)}).eq(0).click()})}})(jQuery);(function($){$.fn.toggleBlock=function(){return this.each(function(){var $this=$(this),target=$($this.data('target')),textTarget=$($this.data('text-target')),cookieVar=$this.data('cookie-var'),textShow,textHide;if(!textTarget.size()){textTarget=$this}textShow=textTarget.data('text-show'),textHide=textTarget.data('text-hide');$this.click(function(){if(target.is(':visible')){if(cookieVar){util.createCookie(cookieVar,'hide')}target.hide();textTarget.text(textShow)}else{if(cookieVar){util.eraseCookie(cookieVar)}target.show();textTarget.text(textHide)}})})}})(jQuery);(function($){$.fn.changeFileInput=function(){return this.each(function(){var $this=$(this),fileInput=$this.find('input[type="file"]'),fileInputDOM=fileInput.get(0),multiple=fileInput.attr('multiple'),toggleElements=$this.parents('form:first').find($this.data('toggle-elements')),fileButton=$('<span class="s3-btn green without-margin"></span>'),textSpan=$('<span class="file-text"></span>'),dataClass=$this.data('class'),text={'empty':s3.loc('JS_FILES_NOT_SELECTED'),'count':s3.loc('JS_FILES_TOTAL'),'btn':$this.data('text-btn')?$this.data('text-btn'):s3.loc('JS_BROWSE_FILES')};if(dataClass){fileButton.removeClass('s3-btn').addClass('s3-btn-'+dataClass)}toggleElements.css('display','none');fileButton.text(text.btn).appendTo($this);textSpan.text(text.empty).appendTo($this);fileInput.css({'position':'absolute','visibility':'hidden'});fileInput.change(function(){if(fileInputDOM.files.length){if(fileInputDOM.files.length==1){textSpan.html(fileInputDOM.files[0].name)}else{textSpan.html(text.count+': <strong>'+fileInputDOM.files.length+'</strong>')}fileButton.removeClass('green');toggleElements.css('display','inline-block')}});fileInput.bind(':clear',function(){fileInput.removeAttr('disabled');fileInputDOM.value=null;textSpan.html(text.empty);fileButton.addClass('green');toggleElements.css('display','none')})})}})(jQuery);if($.browser.mozilla&&$.browser.version<=21){$(document).on('click','label.s3-file',function(e){if(e.currentTarget===this&&e.target.nodeName!=='INPUT'){$(this.control).click()}})}(function($){var ColorPicker=function(){var ids={},inAction,charMin=65,visible,tpl='<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit">OK</div></div>',defaults={eventName:'click',onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:'ff0000',livePreview:true,flat:false},fillRGBFields=function(hsb,cal){var rgb=HSBToRGB(hsb);$(cal).data('colorpicker').fields.eq(1).val(rgb.r).end().eq(2).val(rgb.g).end().eq(3).val(rgb.b).end()},fillHSBFields=function(hsb,cal){$(cal).data('colorpicker').fields.eq(4).val(hsb.h).end().eq(5).val(hsb.s).end().eq(6).val(hsb.b).end()},fillHexFields=function(hsb,cal){$(cal).data('colorpicker').fields.eq(0).val(HSBToHex(hsb)).end()},setSelector=function(hsb,cal){$(cal).data('colorpicker').selector.css('backgroundColor','#'+HSBToHex({h:hsb.h,s:100,b:100}));$(cal).data('colorpicker').selectorIndic.css({left:parseInt(150*hsb.s/100,10),top:parseInt(150*(100-hsb.b)/100,10)})},setHue=function(hsb,cal){$(cal).data('colorpicker').hue.css('top',parseInt(150-150*hsb.h/360,10))},setCurrentColor=function(hsb,cal){$(cal).data('colorpicker').currentColor.css('backgroundColor','#'+HSBToHex(hsb))},setNewColor=function(hsb,cal){$(cal).data('colorpicker').newColor.css('backgroundColor','#'+HSBToHex(hsb))},keyDown=function(ev){var pressedKey=ev.charCode||ev.keyCode||-1;if((pressedKey>charMin&&pressedKey<=90)||pressedKey==32){return false}var cal=$(this).parent().parent();if(cal.data('colorpicker').livePreview===true){change.apply(this)}},change=function(ev){var cal=$(this).parent().parent(),col;if(this.parentNode.className.indexOf('_hex')>0){cal.data('colorpicker').color=col=HexToHSB(fixHex(this.value))}else if(this.parentNode.className.indexOf('_hsb')>0){cal.data('colorpicker').color=col=fixHSB({h:parseInt(cal.data('colorpicker').fields.eq(4).val(),10),s:parseInt(cal.data('colorpicker').fields.eq(5).val(),10),b:parseInt(cal.data('colorpicker').fields.eq(6).val(),10)})}else{cal.data('colorpicker').color=col=RGBToHSB(fixRGB({r:parseInt(cal.data('colorpicker').fields.eq(1).val(),10),g:parseInt(cal.data('colorpicker').fields.eq(2).val(),10),b:parseInt(cal.data('colorpicker').fields.eq(3).val(),10)}))}if(ev){fillRGBFields(col,cal.get(0));fillHexFields(col,cal.get(0));fillHSBFields(col,cal.get(0))}setSelector(col,cal.get(0));setHue(col,cal.get(0));setNewColor(col,cal.get(0));cal.data('colorpicker').onChange(cal,[col,HSBToHex(col),HSBToRGB(col)],cal.data('colorpicker').el)},blur=function(ev){var cal=$(this).parent().parent();cal.data('colorpicker').fields.parent().removeClass('colorpicker_focus')},focus=function(){charMin=this.parentNode.className.indexOf('_hex')>0?70:65;$(this).parent().parent().data('colorpicker').fields.parent().removeClass('colorpicker_focus');$(this).parent().addClass('colorpicker_focus')},downIncrement=function(ev){var field=$(this).parent().find('input').focus();var current={el:$(this).parent().addClass('colorpicker_slider'),max:this.parentNode.className.indexOf('_hsb_h')>0?360:(this.parentNode.className.indexOf('_hsb')>0?100:255),y:ev.pageY,field:field,val:parseInt(field.val(),10),preview:$(this).parent().parent().data('colorpicker').livePreview};$(document).bind('mouseup',current,upIncrement);$(document).bind('mousemove',current,moveIncrement)},moveIncrement=function(ev){ev.data.field.val(Math.max(0,Math.min(ev.data.max,parseInt(ev.data.val+ev.pageY-ev.data.y,10))));if(ev.data.preview){change.apply(ev.data.field.get(0),[true])}return false},upIncrement=function(ev){change.apply(ev.data.field.get(0),[true]);ev.data.el.removeClass('colorpicker_slider').find('input').focus();$(document).unbind('mouseup',upIncrement);$(document).unbind('mousemove',moveIncrement);return false},downHue=function(ev){var current={cal:$(this).parent(),y:$(this).offset().top};current.preview=current.cal.data('colorpicker').livePreview;$(document).bind('mouseup',current,upHue);$(document).bind('mousemove',current,moveHue)},moveHue=function(ev){change.apply(ev.data.cal.data('colorpicker').fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,(ev.pageY-ev.data.y))))/150,10)).get(0),[ev.data.preview]);return false},upHue=function(ev){fillRGBFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));fillHexFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));$(document).unbind('mouseup',upHue);$(document).unbind('mousemove',moveHue);return false},downSelector=function(ev){var current={cal:$(this).parent(),pos:$(this).offset()};current.preview=current.cal.data('colorpicker').livePreview;$(document).bind('mouseup',current,upSelector);$(document).bind('mousemove',current,moveSelector)},moveSelector=function(ev){change.apply(ev.data.cal.data('colorpicker').fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,(ev.pageY-ev.data.pos.top))))/150,10)).end().eq(5).val(parseInt(100*(Math.max(0,Math.min(150,(ev.pageX-ev.data.pos.left))))/150,10)).get(0),[ev.data.preview]);return false},upSelector=function(ev){fillRGBFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));fillHexFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));$(document).unbind('mouseup',upSelector);$(document).unbind('mousemove',moveSelector);return false},enterSubmit=function(ev){$(this).addClass('colorpicker_focus')},leaveSubmit=function(ev){$(this).removeClass('colorpicker_focus')},clickSubmit=function(ev){var cal=$(this).parent();var col=cal.data('colorpicker').color;cal.data('colorpicker').origColor=col;setCurrentColor(col,cal.get(0));cal.data('colorpicker').onSubmit(col,HSBToHex(col),HSBToRGB(col),cal.data('colorpicker').el)},show=function(ev){var cal=$('#'+$(this).data('colorpickerId'));cal.data('colorpicker').onBeforeShow.apply(this,[cal.get(0)]);var pos=$(this).offset();var viewPort=getViewport();var top=pos.top+this.offsetHeight;var left=pos.left;if(top+176>viewPort.t+viewPort.h){top-=this.offsetHeight+176}if(left+356>viewPort.l+viewPort.w){left-=356}cal.css({left:left+'px',top:top+'px'});if(cal.data('colorpicker').onShow.apply(this,[cal.get(0)])!=false){cal.show()}$(document).bind('mousedown',{cal:cal},hide);return false},hide=function(ev){if(!isChildOf(ev.data.cal.get(0),ev.target,ev.data.cal.get(0))){if(ev.data.cal.data('colorpicker').onHide.apply(this,[ev.data.cal.get(0)])!=false){ev.data.cal.hide()}$(document).unbind('mousedown',hide)}},isChildOf=function(parentEl,el,container){if(parentEl==el){return true}if(parentEl.contains){return parentEl.contains(el)}if(parentEl.compareDocumentPosition){return!!(parentEl.compareDocumentPosition(el)&16)}var prEl=el.parentNode;while(prEl&&prEl!=container){if(prEl==parentEl)return true;prEl=prEl.parentNode}return false},getViewport=function(){var m=document.compatMode=='CSS1Compat';return{l:window.pageXOffset||(m?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(m?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(m?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(m?document.documentElement.clientHeight:document.body.clientHeight)}},fixHSB=function(hsb){return{h:Math.min(360,Math.max(0,hsb.h)),s:Math.min(100,Math.max(0,hsb.s)),b:Math.min(100,Math.max(0,hsb.b))}},fixRGB=function(rgb){return{r:Math.min(255,Math.max(0,rgb.r)),g:Math.min(255,Math.max(0,rgb.g)),b:Math.min(255,Math.max(0,rgb.b))}},fixHex=function(hex){var len=6-hex.length;if(len>0){var o=[];for(var i=0;i<len;i++){o.push('0')}o.push(hex);hex=o.join('')}return hex},HexToRGB=function(hex){var hex=parseInt(((hex.indexOf('#')>-1)?hex.substring(1):hex),16);return{r:hex>>16,g:(hex&0x00FF00)>>8,b:(hex&0x0000FF)}},HexToHSB=function(hex){return RGBToHSB(HexToRGB(hex))},RGBToHSB=function(rgb){var hsb={h:0,s:0,b:0};var min=Math.min(rgb.r,rgb.g,rgb.b);var max=Math.max(rgb.r,rgb.g,rgb.b);var delta=max-min;hsb.b=max;if(max!=0){}hsb.s=max!=0?255*delta/max:0;if(hsb.s!=0){if(rgb.r==max){hsb.h=(rgb.g-rgb.b)/delta}else if(rgb.g==max){hsb.h=2+(rgb.b-rgb.r)/delta}else{hsb.h=4+(rgb.r-rgb.g)/delta}}else{hsb.h=-1}hsb.h*=60;if(hsb.h<0){hsb.h+=360}hsb.s*=100/255;hsb.b*=100/255;return hsb},HSBToRGB=function(hsb){var rgb={};var h=Math.round(hsb.h);var s=Math.round(hsb.s*255/100);var v=Math.round(hsb.b*255/100);if(s==0){rgb.r=rgb.g=rgb.b=v}else{var t1=v;var t2=(255-s)*v/255;var t3=(t1-t2)*(h%60)/60;if(h==360)h=0;if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3}else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3}else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3}else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3}else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3}else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3}else{rgb.r=0;rgb.g=0;rgb.b=0}}return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)}},RGBToHex=function(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];$.each(hex,function(nr,val){if(val.length==1){hex[nr]='0'+val}});return hex.join('')},HSBToHex=function(hsb){return RGBToHex(HSBToRGB(hsb))},restoreOriginal=function(){var cal=$(this).parent();var col=cal.data('colorpicker').origColor;cal.data('colorpicker').color=col;fillRGBFields(col,cal.get(0));fillHexFields(col,cal.get(0));fillHSBFields(col,cal.get(0));setSelector(col,cal.get(0));setHue(col,cal.get(0));setNewColor(col,cal.get(0))};return{init:function(opt){opt=$.extend({},defaults,opt||{});if(typeof opt.color=='string'){opt.color=HexToHSB(opt.color)}else if(opt.color.r!=undefined&&opt.color.g!=undefined&&opt.color.b!=undefined){opt.color=RGBToHSB(opt.color)}else if(opt.color.h!=undefined&&opt.color.s!=undefined&&opt.color.b!=undefined){opt.color=fixHSB(opt.color)}else{return this}return this.each(function(){if(!$(this).data('colorpickerId')){var options=$.extend({},opt);options.origColor=opt.color;var id='collorpicker_'+parseInt(Math.random()*1000);$(this).data('colorpickerId',id);var cal=$(tpl).attr('id',id);if(options.flat){cal.appendTo(this).show()}else{cal.appendTo($(document.getElementById('divContent')||document.body))}options.fields=cal.find('input').bind('keyup',keyDown).bind('change',change).bind('blur',blur).bind('focus',focus);cal.find('span').bind('mousedown',downIncrement).end().find('>div.colorpicker_current_color').bind('click',restoreOriginal);options.selector=cal.find('div.colorpicker_color').bind('mousedown',downSelector);options.selectorIndic=options.selector.find('div div');options.el=this;options.hue=cal.find('div.colorpicker_hue div');cal.find('div.colorpicker_hue').bind('mousedown',downHue);options.newColor=cal.find('div.colorpicker_new_color');options.currentColor=cal.find('div.colorpicker_current_color');cal.data('colorpicker',options);cal.find('div.colorpicker_submit').bind('mouseenter',enterSubmit).bind('mouseleave',leaveSubmit).bind('click',clickSubmit);fillRGBFields(options.color,cal.get(0));fillHSBFields(options.color,cal.get(0));fillHexFields(options.color,cal.get(0));setHue(options.color,cal.get(0));setSelector(options.color,cal.get(0));setCurrentColor(options.color,cal.get(0));setNewColor(options.color,cal.get(0));if(options.flat){cal.css({position:'relative',display:'block'})}else{$(this).bind(options.eventName,show)}}})},showPicker:function(){return this.each(function(){if($(this).data('colorpickerId')){show.apply(this)}})},hidePicker:function(){return this.each(function(){if($(this).data('colorpickerId')){$('#'+$(this).data('colorpickerId')).hide()}})},setColor:function(col){if(typeof col=='string'){col=HexToHSB(col)}else if(col.r!=undefined&&col.g!=undefined&&col.b!=undefined){col=RGBToHSB(col)}else if(col.h!=undefined&&col.s!=undefined&&col.b!=undefined){col=fixHSB(col)}else{return this}return this.each(function(){if($(this).data('colorpickerId')){var cal=$('#'+$(this).data('colorpickerId'));cal.data('colorpicker').color=col;cal.data('colorpicker').origColor=col;fillRGBFields(col,cal.get(0));fillHSBFields(col,cal.get(0));fillHexFields(col,cal.get(0));setHue(col,cal.get(0));setSelector(col,cal.get(0));setCurrentColor(col,cal.get(0));setNewColor(col,cal.get(0))}})}}}();$.fn.extend({ColorPicker:ColorPicker.init,ColorPickerHide:ColorPicker.hidePicker,ColorPickerShow:ColorPicker.showPicker,ColorPickerSetColor:ColorPicker.setColor})})(jQuery);(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory)}else if(typeof exports==='object'){module.exports=factory(require('jquery'))}else{factory(jQuery)}}(function($){$.minicolors={defaults:{animationSpeed:50,animationEasing:'swing',change:null,changeDelay:0,control:'hue',dataUris:true,defaultValue:'',format:'hex',hide:null,hideSpeed:100,inline:false,keywords:'',letterCase:'lowercase',opacity:false,position:'bottom left',show:null,showSpeed:100,theme:'default'}};$.extend($.fn,{minicolors:function(method,data){switch(method){case'destroy':$(this).each(function(){destroy($(this))});return $(this);case'hide':hide();return $(this);case'opacity':if(data===undefined){return $(this).attr('data-opacity')}else{$(this).each(function(){updateFromInput($(this).attr('data-opacity',data))})}return $(this);case'rgbObject':return rgbObject($(this),method==='rgbaObject');case'rgbString':case'rgbaString':return rgbString($(this),method==='rgbaString');case'settings':if(data===undefined){return $(this).data('minicolors-settings')}else{$(this).each(function(){var settings=$(this).data('minicolors-settings')||{};destroy($(this));$(this).minicolors($.extend(true,settings,data))})}return $(this);case'show':show($(this).eq(0));return $(this);case'value':if(data===undefined){return $(this).val()}else{$(this).each(function(){if(typeof(data)==='object'){if(data.opacity){$(this).attr('data-opacity',keepWithin(data.opacity,0,1))}if(data.color){$(this).val(data.color)}}else{$(this).val(data)}updateFromInput($(this))})}return $(this);default:if(method!=='create')data=method;$(this).each(function(){init($(this),data)});return $(this)}}});function init(input,settings){var minicolors=$('<div class="minicolors" />'),defaults=$.minicolors.defaults,format=input.attr('data-format'),keywords=input.attr('data-keywords'),opacity=input.attr('data-opacity');if(input.data('minicolors-initialized'))return;settings=$.extend(true,{},defaults,settings);minicolors.addClass('minicolors-theme-'+settings.theme).toggleClass('minicolors-with-opacity',settings.opacity).toggleClass('minicolors-no-data-uris',settings.dataUris!==true);if(settings.position!==undefined){$.each(settings.position.split(' '),function(){minicolors.addClass('minicolors-position-'+this)})}if(format==='rgb'){$input_size=opacity?'25':'20'}else{$input_size=keywords?'11':'7'}input.addClass('minicolors-input').data('minicolors-initialized',false).data('minicolors-settings',settings).prop('size',$input_size).wrap(minicolors).after('<div class="minicolors-panel minicolors-slider-'+settings.control+'">'+'<div class="minicolors-slider minicolors-sprite">'+'<div class="minicolors-picker"></div>'+'</div>'+'<div class="minicolors-opacity-slider minicolors-sprite">'+'<div class="minicolors-picker"></div>'+'</div>'+'<div class="minicolors-grid minicolors-sprite">'+'<div class="minicolors-grid-inner"></div>'+'<div class="minicolors-picker"><div></div></div>'+'</div>'+'</div>');if(!settings.inline){input.after('<span class="minicolors-swatch minicolors-sprite"><span class="minicolors-swatch-color"></span></span>');input.next('.minicolors-swatch').on('click',function(event){event.preventDefault();input.focus()})}input.parent().find('.minicolors-panel').on('selectstart',function(){return false}).end();if(settings.inline)input.parent().addClass('minicolors-inline');updateFromInput(input,false);input.data('minicolors-initialized',true)}function destroy(input){var minicolors=input.parent();input.removeData('minicolors-initialized').removeData('minicolors-settings').removeProp('size').removeClass('minicolors-input');minicolors.before(input).remove()}function show(input){var minicolors=input.parent(),panel=minicolors.find('.minicolors-panel'),settings=input.data('minicolors-settings');if(!input.data('minicolors-initialized')||input.prop('disabled')||minicolors.hasClass('minicolors-inline')||minicolors.hasClass('minicolors-focus'))return;hide();minicolors.addClass('minicolors-focus');panel.stop(true,true).fadeIn(settings.showSpeed,function(){if(settings.show)settings.show.call(input.get(0))})}function hide(){$('.minicolors-focus').each(function(){var minicolors=$(this),input=minicolors.find('.minicolors-input'),panel=minicolors.find('.minicolors-panel'),settings=input.data('minicolors-settings');panel.fadeOut(settings.hideSpeed,function(){if(settings.hide)settings.hide.call(input.get(0));minicolors.removeClass('minicolors-focus')})})}function move(target,event,animate){var input=target.parents('.minicolors').find('.minicolors-input'),settings=input.data('minicolors-settings'),picker=target.find('[class$=-picker]'),offsetX=target.offset().left,offsetY=target.offset().top,x=Math.round(event.pageX-offsetX),y=Math.round(event.pageY-offsetY),duration=animate?settings.animationSpeed:0,wx,wy,r,phi;if(event.originalEvent.changedTouches){x=event.originalEvent.changedTouches[0].pageX-offsetX;y=event.originalEvent.changedTouches[0].pageY-offsetY}if(x<0)x=0;if(y<0)y=0;if(x>target.width())x=target.width();if(y>target.height())y=target.height();if(target.parent().is('.minicolors-slider-wheel')&&picker.parent().is('.minicolors-grid')){wx=75-x;wy=75-y;r=Math.sqrt(wx*wx+wy*wy);phi=Math.atan2(wy,wx);if(phi<0)phi+=Math.PI*2;if(r>75){r=75;x=75-(75*Math.cos(phi));y=75-(75*Math.sin(phi))}x=Math.round(x);y=Math.round(y)}if(target.is('.minicolors-grid')){picker.stop(true).animate({top:y+'px',left:x+'px'},duration,settings.animationEasing,function(){updateFromControl(input,target)})}else{picker.stop(true).animate({top:y+'px'},duration,settings.animationEasing,function(){updateFromControl(input,target)})}}function updateFromControl(input,target){function getCoords(picker,container){var left,top;if(!picker.length||!container)return null;left=picker.offset().left;top=picker.offset().top;return{x:left-container.offset().left+(picker.outerWidth()/2),y:top-container.offset().top+(picker.outerHeight()/2)}}var hue,saturation,brightness,x,y,r,phi,hex=input.val(),format=input.attr('data-format'),keywords=input.attr('data-keywords'),opacity=input.attr('data-opacity'),minicolors=input.parent(),settings=input.data('minicolors-settings'),swatch=minicolors.find('.minicolors-swatch'),grid=minicolors.find('.minicolors-grid'),slider=minicolors.find('.minicolors-slider'),opacitySlider=minicolors.find('.minicolors-opacity-slider'),gridPicker=grid.find('[class$=-picker]'),sliderPicker=slider.find('[class$=-picker]'),opacityPicker=opacitySlider.find('[class$=-picker]'),gridPos=getCoords(gridPicker,grid),sliderPos=getCoords(sliderPicker,slider),opacityPos=getCoords(opacityPicker,opacitySlider);if(target.is('.minicolors-grid, .minicolors-slider, .minicolors-opacity-slider')){switch(settings.control){case'wheel':x=(grid.width()/2)-gridPos.x;y=(grid.height()/2)-gridPos.y;r=Math.sqrt(x*x+y*y);phi=Math.atan2(y,x);if(phi<0)phi+=Math.PI*2;if(r>75){r=75;gridPos.x=69-(75*Math.cos(phi));gridPos.y=69-(75*Math.sin(phi))}saturation=keepWithin(r/0.75,0,100);hue=keepWithin(phi*180/Math.PI,0,360);brightness=keepWithin(100-Math.floor(sliderPos.y*(100/slider.height())),0,100);hex=hsb2hex({h:hue,s:saturation,b:brightness});slider.css('backgroundColor',hsb2hex({h:hue,s:saturation,b:100}));break;case'saturation':hue=keepWithin(parseInt(gridPos.x*(360/grid.width()),10),0,360);saturation=keepWithin(100-Math.floor(sliderPos.y*(100/slider.height())),0,100);brightness=keepWithin(100-Math.floor(gridPos.y*(100/grid.height())),0,100);hex=hsb2hex({h:hue,s:saturation,b:brightness});slider.css('backgroundColor',hsb2hex({h:hue,s:100,b:brightness}));minicolors.find('.minicolors-grid-inner').css('opacity',saturation/100);break;case'brightness':hue=keepWithin(parseInt(gridPos.x*(360/grid.width()),10),0,360);saturation=keepWithin(100-Math.floor(gridPos.y*(100/grid.height())),0,100);brightness=keepWithin(100-Math.floor(sliderPos.y*(100/slider.height())),0,100);hex=hsb2hex({h:hue,s:saturation,b:brightness});slider.css('backgroundColor',hsb2hex({h:hue,s:saturation,b:100}));minicolors.find('.minicolors-grid-inner').css('opacity',1-(brightness/100));break;default:hue=keepWithin(360-parseInt(sliderPos.y*(360/slider.height()),10),0,360);saturation=keepWithin(Math.floor(gridPos.x*(100/grid.width())),0,100);brightness=keepWithin(100-Math.floor(gridPos.y*(100/grid.height())),0,100);hex=hsb2hex({h:hue,s:saturation,b:brightness});grid.css('backgroundColor',hsb2hex({h:hue,s:100,b:100}));break}if(settings.opacity){opacity=parseFloat(1-(opacityPos.y/opacitySlider.height())).toFixed(2)}else{opacity=1}if(settings.opacity)input.attr('data-opacity',opacity);if(format==='rgb'){var rgb=hex2rgb(hex),opacity=input.attr('data-opacity')===''?1:keepWithin(parseFloat(input.attr('data-opacity')).toFixed(2),0,1);if(isNaN(opacity)||!settings.opacity)opacity=1;if(input.minicolors('rgbObject').a<=1&&rgb&&settings.opacity){value='rgba('+rgb.r+', '+rgb.g+', '+rgb.b+', '+parseFloat(opacity)+')'}else{value='rgb('+rgb.r+', '+rgb.g+', '+rgb.b+')'}}else{value=convertCase(hex,settings.letterCase)}input.val(value)}swatch.find('span').css({backgroundColor:hex,opacity:opacity});doChange(input,value,opacity)}function updateFromInput(input,preserveInputValue){var hex,hsb,format=input.attr('data-format'),keywords=input.attr('data-keywords'),opacity,x,y,r,phi,minicolors=input.parent(),settings=input.data('minicolors-settings'),swatch=minicolors.find('.minicolors-swatch'),grid=minicolors.find('.minicolors-grid'),slider=minicolors.find('.minicolors-slider'),opacitySlider=minicolors.find('.minicolors-opacity-slider'),gridPicker=grid.find('[class$=-picker]'),sliderPicker=slider.find('[class$=-picker]'),opacityPicker=opacitySlider.find('[class$=-picker]');if(isRgb(input.val())){hex=rgbString2hex(input.val());alpha=keepWithin(parseFloat(getAlpha(input.val())).toFixed(2),0,1);if(alpha){input.attr('data-opacity',alpha)}}else{hex=convertCase(parseHex(input.val(),true),settings.letterCase)}if(!hex){hex=convertCase(parseInput(settings.defaultValue,true),settings.letterCase)}hsb=hex2hsb(hex);keywords=!keywords?[]:$.map(keywords.split(','),function(a){return $.trim(a.toLowerCase())});if(input.val()!==''&&$.inArray(input.val().toLowerCase(),keywords)>-1){value=convertCase(input.val())}else{value=isRgb(input.val())?parseRgb(input.val()):hex}if(!preserveInputValue)input.val(value);if(settings.opacity){opacity=input.attr('data-opacity')===''?1:keepWithin(parseFloat(input.attr('data-opacity')).toFixed(2),0,1);if(isNaN(opacity))opacity=1;input.attr('data-opacity',opacity);swatch.find('span').css('opacity',opacity);y=keepWithin(opacitySlider.height()-(opacitySlider.height()*opacity),0,opacitySlider.height());opacityPicker.css('top',y+'px')}if(input.val().toLowerCase()==='transparent'){swatch.find('span').css('opacity',0)}swatch.find('span').css('backgroundColor',hex);switch(settings.control){case'wheel':r=keepWithin(Math.ceil(hsb.s*0.75),0,grid.height()/2);phi=hsb.h*Math.PI/180;x=keepWithin(75-Math.cos(phi)*r,0,grid.width());y=keepWithin(75-Math.sin(phi)*r,0,grid.height());gridPicker.css({top:y+'px',left:x+'px'});y=150-(hsb.b/(100/grid.height()));if(hex==='')y=0;sliderPicker.css('top',y+'px');slider.css('backgroundColor',hsb2hex({h:hsb.h,s:hsb.s,b:100}));break;case'saturation':x=keepWithin((5*hsb.h)/12,0,150);y=keepWithin(grid.height()-Math.ceil(hsb.b/(100/grid.height())),0,grid.height());gridPicker.css({top:y+'px',left:x+'px'});y=keepWithin(slider.height()-(hsb.s*(slider.height()/100)),0,slider.height());sliderPicker.css('top',y+'px');slider.css('backgroundColor',hsb2hex({h:hsb.h,s:100,b:hsb.b}));minicolors.find('.minicolors-grid-inner').css('opacity',hsb.s/100);break;case'brightness':x=keepWithin((5*hsb.h)/12,0,150);y=keepWithin(grid.height()-Math.ceil(hsb.s/(100/grid.height())),0,grid.height());gridPicker.css({top:y+'px',left:x+'px'});y=keepWithin(slider.height()-(hsb.b*(slider.height()/100)),0,slider.height());sliderPicker.css('top',y+'px');slider.css('backgroundColor',hsb2hex({h:hsb.h,s:hsb.s,b:100}));minicolors.find('.minicolors-grid-inner').css('opacity',1-(hsb.b/100));break;default:x=keepWithin(Math.ceil(hsb.s/(100/grid.width())),0,grid.width());y=keepWithin(grid.height()-Math.ceil(hsb.b/(100/grid.height())),0,grid.height());gridPicker.css({top:y+'px',left:x+'px'});y=keepWithin(slider.height()-(hsb.h/(360/slider.height())),0,slider.height());sliderPicker.css('top',y+'px');grid.css('backgroundColor',hsb2hex({h:hsb.h,s:100,b:100}));break}if(input.data('minicolors-initialized')){doChange(input,value,opacity)}}function doChange(input,value,opacity){var settings=input.data('minicolors-settings'),lastChange=input.data('minicolors-lastChange');if(!lastChange||lastChange.value!==value||lastChange.opacity!==opacity){input.data('minicolors-lastChange',{value:value,opacity:opacity});if(settings.change){if(settings.changeDelay){clearTimeout(input.data('minicolors-changeTimeout'));input.data('minicolors-changeTimeout',setTimeout(function(){settings.change.call(input.get(0),value,opacity)},settings.changeDelay))}else{settings.change.call(input.get(0),value,opacity)}}input.trigger('change').trigger('input')}}function rgbObject(input){var hex=parseHex($(input).val(),true),rgb=hex2rgb(hex),opacity=$(input).attr('data-opacity');if(!rgb)return null;if(opacity!==undefined)$.extend(rgb,{a:parseFloat(opacity)});return rgb}function rgbString(input,alpha){var hex=parseHex($(input).val(),true),rgb=hex2rgb(hex),opacity=$(input).attr('data-opacity');if(!rgb)return null;if(opacity===undefined)opacity=1;if(alpha){return'rgba('+rgb.r+', '+rgb.g+', '+rgb.b+', '+parseFloat(opacity)+')'}else{return'rgb('+rgb.r+', '+rgb.g+', '+rgb.b+')'}}function convertCase(string,letterCase){return letterCase==='uppercase'?string.toUpperCase():string.toLowerCase()}function parseHex(string,expand){string=string.replace(/^#/g,'');if(!string.match(/^[A-F0-9]{3,6}/ig))return'';if(string.length!==3&&string.length!==6)return'';if(string.length===3&&expand){string=string[0]+string[0]+string[1]+string[1]+string[2]+string[2]}return'#'+string}function parseRgb(string,obj){var values=string.replace(/[^\d,.]/g,''),rgba=values.split(','),output;rgba[0]=keepWithin(parseInt(rgba[0],10),0,255);rgba[1]=keepWithin(parseInt(rgba[1],10),0,255);rgba[2]=keepWithin(parseInt(rgba[2],10),0,255);if(rgba[3]){rgba[3]=keepWithin(parseFloat(rgba[3],10),0,1)}if(obj){return{r:rgba[0],g:rgba[1],b:rgba[2],a:rgba[3]?rgba[3]:null}}if(typeof(rgba[3])!=='undefined'&&rgba[3]<=1){return'rgba('+rgba[0]+', '+rgba[1]+', '+rgba[2]+', '+rgba[3]+')'}else{return'rgb('+rgba[0]+', '+rgba[1]+', '+rgba[2]+')'}}function parseInput(string,expand){if(isRgb(string)){return parseRgb(string)}else{return parseHex(string,expand)}}function keepWithin(value,min,max){if(value<min)value=min;if(value>max)value=max;return value}function isRgb(string){rgb=string.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return(rgb&&rgb.length===4)?true:false}function getAlpha(rgba){rgba=rgba.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d{1,2})?|\.\d{1,2})[\s+]?/i);return(rgba&&rgba.length===6)?rgba[4]:'1'}function hsb2rgb(hsb){var rgb={};var h=Math.round(hsb.h);var s=Math.round(hsb.s*255/100);var v=Math.round(hsb.b*255/100);if(s===0){rgb.r=rgb.g=rgb.b=v}else{var t1=v;var t2=(255-s)*v/255;var t3=(t1-t2)*(h%60)/60;if(h===360)h=0;if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3}else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3}else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3}else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3}else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3}else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3}else{rgb.r=0;rgb.g=0;rgb.b=0}}return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)}}function rgbString2hex(rgb){rgb=rgb.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return(rgb&&rgb.length===4)?'#'+('0'+parseInt(rgb[1],10).toString(16)).slice(-2)+('0'+parseInt(rgb[2],10).toString(16)).slice(-2)+('0'+parseInt(rgb[3],10).toString(16)).slice(-2):''}function rgb2hex(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];$.each(hex,function(nr,val){if(val.length===1)hex[nr]='0'+val});return'#'+hex.join('')}function hsb2hex(hsb){return rgb2hex(hsb2rgb(hsb))}function hex2hsb(hex){var hsb=rgb2hsb(hex2rgb(hex));if(hsb.s===0)hsb.h=360;return hsb}function rgb2hsb(rgb){var hsb={h:0,s:0,b:0};var min=Math.min(rgb.r,rgb.g,rgb.b);var max=Math.max(rgb.r,rgb.g,rgb.b);var delta=max-min;hsb.b=max;hsb.s=max!==0?255*delta/max:0;if(hsb.s!==0){if(rgb.r===max){hsb.h=(rgb.g-rgb.b)/delta}else if(rgb.g===max){hsb.h=2+(rgb.b-rgb.r)/delta}else{hsb.h=4+(rgb.r-rgb.g)/delta}}else{hsb.h=-1}hsb.h*=60;if(hsb.h<0){hsb.h+=360}hsb.s*=100/255;hsb.b*=100/255;return hsb}function hex2rgb(hex){hex=parseInt(((hex.indexOf('#')>-1)?hex.substring(1):hex),16);return{r:hex>>16,g:(hex&0x00FF00)>>8,b:(hex&0x0000FF)}}$(document).on('mousedown.minicolors touchstart.minicolors',function(event){if(!$(event.target).parents().add(event.target).hasClass('minicolors')){hide()}}).on('mousedown.minicolors touchstart.minicolors','.minicolors-grid, .minicolors-slider, .minicolors-opacity-slider',function(event){var target=$(this);event.preventDefault();$(document).data('minicolors-target',target);move(target,event,true)}).on('mousemove.minicolors touchmove.minicolors',function(event){var target=$(document).data('minicolors-target');if(target)move(target,event)}).on('mouseup.minicolors touchend.minicolors',function(){$(this).removeData('minicolors-target')}).on('mousedown.minicolors touchstart.minicolors','.minicolors-swatch',function(event){var input=$(this).parent().find('.minicolors-input');event.preventDefault();show(input)}).on('focus.minicolors','.minicolors-input',function(){var input=$(this);if(!input.data('minicolors-initialized'))return;show(input)}).on('blur.minicolors','.minicolors-input',function(){var input=$(this),keywords=input.attr('data-keywords'),settings=input.data('minicolors-settings'),hex,rgba,swatchOpacity;if(!input.data('minicolors-initialized'))return;keywords=!keywords?[]:$.map(keywords.split(','),function(a){return $.trim(a.toLowerCase())});if(input.val()!==''&&$.inArray(input.val().toLowerCase(),keywords)>-1){value=input.val()}else{if(isRgb(input.val())){rgba=parseRgb(input.val(),true)}else{hex=parseHex(input.val(),true);rgba=hex?hex2rgb(hex):null}if(rgba===null){value=settings.defaultValue}else if(settings.format==='rgb'){value=settings.opacity?parseRgb('rgba('+rgba.r+','+rgba.g+','+rgba.b+','+input.attr('data-opacity')+')'):parseRgb('rgb('+rgba.r+','+rgba.g+','+rgba.b+')')}else{value=rgb2hex(rgba)}}swatchOpacity=settings.opacity?input.attr('data-opacity'):1;if(value.toLowerCase()==='transparent')swatchOpacity=0;input.closest('.minicolors').find('.minicolors-swatch > span').css('opacity',swatchOpacity);input.val(value);if(input.val()==='')input.val(parseInput(settings.defaultValue,true));input.val(convertCase(input.val(),settings.letterCase))}).on('keydown.minicolors','.minicolors-input',function(event){var input=$(this);if(!input.data('minicolors-initialized'))return;switch(event.keyCode){case 9:hide();break;case 13:case 27:hide();input.blur();break}}).on('keyup.minicolors','.minicolors-input',function(){var input=$(this);if(!input.data('minicolors-initialized'))return;updateFromInput(input,true)}).on('paste.minicolors','.minicolors-input',function(){var input=$(this);if(!input.data('minicolors-initialized'))return;setTimeout(function(){updateFromInput(input,true)},1)})}));(function($){$.fn.wordCounter=function(options){var settings=$.extend({'template':'<div class="s3-word-counter"><span>'+s3.loc('JS_SYMBOLS_COUNT')+': %symbols%</span><span>'+s3.loc('JS_WORDS_COUNT')+': %words%</span></div>'},options);return this.each(function(){var $this=$(this);if($this.data('word-counter-init')){return}$this.after(settings.template.replace(/%symbols%/,'<span class="s3-word-counter-symbols">0</span>').replace(/%words%/,'<span class="s3-word-counter-words">0</span>'));var count_wrapper=$this.next();var symbols_wrapper=count_wrapper.find('.s3-word-counter-symbols');var words_wrapper=count_wrapper.find('.s3-word-counter-words');$this.keyup(function(){symbols_wrapper.html($.trim($(this).val()).length||0);words_wrapper.html($.trim($(this).val())?$.trim($(this).val()).split(/(?:,+|\s+)(?=[^,\s])/).length:0)}).trigger('keyup');$this.data('word-counter-init',true)})}})(jQuery);(function($,window,undefined){"use strict";function $proxy(n,t){return typeof $.proxy=="function"?$.proxy(n,t):function(i){n.call(t,i)}}function $data(n,t,i){return typeof $.data=="function"?$.data(n,t,i):i?void 0:$(n).hasClass("rs-control")}function $isPlainObject(n){if(typeof $.isPlainObject=="function")return $.isPlainObject(n);var t=JSON.stringify(n);return typeof n=="object"&&n.length===undefined&&t.length>2&&t.substr(0,1)==="{"&&t.substr(t.length-1)==="}"}function isNumber(n){return n=parseFloat(n),typeof n=="number"&&!isNaN(n)}function createElement(n){var t=n.split(".");return $(document.createElement(t[0])).addClass(t[1]||"")}function getdistance(n,t){return Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y))}function setTransform(n,t){return n.css("-webkit-transform","rotate("+t+"deg)"),n.css("-moz-transform","rotate("+t+"deg)"),n.css("-ms-transform","rotate("+t+"deg)"),n.css("-o-transform","rotate("+t+"deg)"),n.css("transform","rotate("+t+"deg)"),n}function RoundSlider(n,t){n.id&&(window[n.id]=this),this.control=$(n),this.options=$.extend({},this.defaults,t),this._raise("beforeCreate")!==!1?(this._init(),this._raise("create")):this._removeData()}function CreateRoundSlider(n,t){for(var i,r,u=0;u<this.length;u++)if(i=this[u],r=$data(i,pluginName),r){if($isPlainObject(n))typeof r.option=="function"?r.option(n):i.id&&window[i.id]&&typeof window[i.id].option=="function"&&window[i.id].option(n);else if(typeof n=="string"&&typeof r[n]=="function"){if((n==="option"||n.indexOf("get")===0)&&t[2]===undefined)return r[n](t[1]);r[n](t[1],t[2])}}else $data(i,pluginName,new RoundSlider(i,n));return this}var pluginName="roundSlider";$.fn[pluginName]=function(n){return CreateRoundSlider.call(this,n,arguments)},RoundSlider.prototype={pluginName:pluginName,version:"1.2",options:{},defaults:{min:0,max:100,step:1,value:null,radius:85,width:18,handleSize:"+0",startAngle:0,endAngle:"+360",animation:!0,showTooltip:!0,editableTooltip:!0,readOnly:!1,disabled:!1,keyboardAction:!0,mouseScrollAction:!1,lineCap:"square",sliderType:"default",circleShape:"full",handleShape:"round",beforeCreate:null,create:null,start:null,drag:null,change:null,stop:null,tooltipFormat:null},_props:function(){return{numberType:["min","max","step","radius","width","startAngle"],booleanType:["animation","showTooltip","editableTooltip","readOnly","disabled","keyboardAction","mouseScrollAction"],stringType:["sliderType","circleShape","handleShape","lineCap"]}},control:null,_init:function(){var t,n;this._isBrowserSupport=this._isBrowserSupported(),this._isKO=!1,this._isAngular=!1,this.control.is("input")&&(this._isInputType=!0,this._hiddenField=this.control,this.control=createElement("div"),this.control.insertAfter(this._hiddenField),this.options.value=this._hiddenField.val()||this.options.value,t=this,this._checkKO()&&setTimeout(function(){t._checkKO()},1),this._checkAngular()),this._bindOnDrag=!1,n=this._dataElement().attr("data-updateon"),typeof n=="string"?n=="drag"&&(this._bindOnDrag=!0):this._isAngular&&(this._bindOnDrag=!0),this._onInit()},_onInit:function(){this._initialize(),this._update(),this._render()},_initialize:function(){this._isBrowserSupport&&(this._isReadOnly=!1,this._checkDataType(),this._refreshCircleShape())},_render:function(){if(this.container=createElement("div.rs-container"),this.innerContainer=createElement("div.rs-inner-container"),this.block=createElement("div.rs-block rs-outer rs-border"),this.container.append(this.innerContainer.append(this.block)),this.control.addClass("rs-control").empty().append(this.container),this._setRadius(),this._isBrowserSupport)this._createLayers(),this._setProperties(),this._setValue(),this._updateTooltipPos(),this._bindControlEvents("_bind"),this._checkIE();else{var n=createElement("div.rs-msg");n.html(typeof this._throwError=="function"?this._throwError():this._throwError),this.control.empty().addClass("rs-error").append(n),this._isInputType&&this.control.append(this._dataElement())}},_update:function(){this._validateSliderType(),this._updateStartEnd(),this._validateStartEnd(),this._handle1=this._handle2=this._handleDefaults(),this._analyzeModelValue(),this._validateModelValue()},_createLayers:function(){var i=this.options.width,t=this._start,n;n=createElement("div.rs-path rs-transition"),this._rangeSlider||this._showRange?(this.block1=n.clone().addClass("rs-range-color").rsRotate(t),this.block2=n.clone().addClass("rs-range-color").css("opacity","0").rsRotate(t),this.block3=n.clone().addClass("rs-path-color").rsRotate(t),this.block4=n.addClass("rs-path-color").css({opacity:"1","z-index":"1"}).rsRotate(t-180),this.block.append(this.block1,this.block2,this.block3,this.block4).addClass("rs-split")):this.block.append(n.addClass("rs-path-color")),this.lastBlock=createElement("span.rs-block").css({padding:i}),this.innerBlock=createElement("div.rs-inner rs-bg-color rs-border"),this.lastBlock.append(this.innerBlock),this.block.append(this.lastBlock),this._appendHandle(),this._appendOverlay(),this._appendHiddenField()},_setProperties:function(){this._updatePre(),this._setHandleShape(),this._addAnimation(),this._appendTooltip(),this.options.showTooltip||this._removeTooltip(),this.options.disabled?this.disable():this.options.readOnly&&this._readOnly(!0),this.options.mouseScrollAction&&this._bindScrollEvents("_bind")},_updatePre:function(){this._prechange=this._predrag=this.options.value},_setValue:function(){if(this._rangeSlider)this._setHandleValue(1),this._setHandleValue(2);else{this._showRange&&this._setHandleValue(1);var n=this.options.sliderType=="default"?this._active||1:parseFloat(this.bar.children().attr("index"));this._setHandleValue(n)}},_appendTooltip:function(){this.container.children(".rs-tooltip").length===0&&(this.tooltip=createElement("span.rs-tooltip rs-tooltip-text"),this.container.append(this.tooltip),this._tooltipEditable(),this._updateTooltip())},_removeTooltip:function(){this.container.children(".rs-tooltip").length!=0&&this.tooltip&&this.tooltip.remove()},_tooltipEditable:function(){if(this.tooltip&&this.options.showTooltip){var n;this.options.editableTooltip?(this.tooltip.addClass("edit"),n="_bind"):(this.tooltip.removeClass("edit"),n="_unbind"),this[n](this.tooltip,"click",this._editTooltip)}},_editTooltip:function(){if(this.tooltip.hasClass("edit")&&!this._isReadOnly){var n=parseFloat(this.tooltip.css("border-left-width"))*2;this.input=createElement("input.rs-input rs-tooltip-text").css({height:this.tooltip.outerHeight()-n,width:this.tooltip.outerWidth()-n}),this.tooltip.html(this.input).removeClass("edit").addClass("hover"),this.input.focus().val(this._getTooltipValue(!0)),this._bind(this.input,"blur",this._focusOut),this._bind(this.input,"change",this._focusOut)}},_focusOut:function(n){n.type=="change"?(this.options.value=this.input.val().replace("-",","),this._analyzeModelValue(),this._validateModelValue(),this._setValue(),this.input.val(this._getTooltipValue(!0))):(this.tooltip.addClass("edit").removeClass("hover"),this._updateTooltip()),this._raiseEvent("change")},_setHandleShape:function(){var n=this.options.handleShape;this._handles().removeClass("rs-handle-dot rs-handle-square"),n=="dot"?this._handles().addClass("rs-handle-dot"):n=="square"?this._handles().addClass("rs-handle-square"):this.options.handleShape=this.defaults.handleShape},_setHandleValue:function(n){this._active=n;var t=this["_handle"+n];this.options.sliderType!="min-range"&&(this.bar=this._activeHandleBar()),this._changeSliderValue(t.value,t.angle)},_setAnimation:function(){this.options.animation?this._addAnimation():this._removeAnimation()},_addAnimation:function(){this.options.animation&&this.control.addClass("rs-animation")},_removeAnimation:function(){this.control.removeClass("rs-animation")},_setRadius:function(){var t=this.options.radius,i=t*2,n=this.options.circleShape,r=i,u=i,f,e;if(this.container.removeClass().addClass("rs-container"),n.indexOf("half")===0){switch(n){case"half-top":case"half-bottom":r=t,u=i;break;case"half-left":case"half-right":r=i,u=t}this.container.addClass(n.replace("half-","")+" half")}else n.indexOf("quarter")===0?(r=u=t,f=n.split("-"),this.container.addClass(f[0]+" "+f[1]+" "+f[2])):this.container.addClass("full "+n);e={height:r,width:u},this.control.css(e),this.container.css(e)},_border:function(n){return n?parseFloat(this._startLine.children().css("border-bottom-width")):parseFloat(this.block.css("border-top-width"))*2},_appendHandle:function(){(this._rangeSlider||!this._showRange)&&this._createHandle(1),(this._rangeSlider||this._showRange)&&this._createHandle(2),this._startLine=this._addSeperator(this._start,"rs-start"),this._endLine=this._addSeperator(this._start+this._end,"rs-end"),this._refreshSeperator()},_addSeperator:function(n,t){var r=createElement("span.rs-seperator rs-border"),u=this.options.width,f=this._border(),i=createElement("span.rs-bar rs-transition "+t).append(r).rsRotate(n);return this.container.append(i),i},_refreshSeperator:function(){var i=this._startLine.add(this._endLine),r=i.children().removeAttr("style"),n=this.options,u=n.width,f=this._border(),t=u+f;n.lineCap=="round"&&n.circleShape!="full"?(i.addClass("rs-rounded"),r.css({width:t,height:t/2+1}),this._startLine.children().css("margin-top",-1).addClass(n.sliderType=="min-range"?"rs-range-color":"rs-path-color"),this._endLine.children().css("margin-top",t/-2).addClass("rs-path-color")):(i.removeClass("rs-rounded"),r.css({width:t,"margin-top":this._border(!0)/-2}).removeClass("rs-range-color rs-path-color"))},_updateSeperator:function(){this._startLine.rsRotate(this._start),this._endLine.rsRotate(this._start+this._end)},_createHandle:function(n){var t=createElement("div.rs-handle rs-move"),u=this.options,f,r;(f=u.handleShape)!="round"&&t.addClass("rs-handle-"+f),t.attr({index:n,tabIndex:"0"});var i=this._dataElement()[0].id,i=i?i+"_":"",e=i+"handle"+(u.sliderType=="range"?"_"+(n==1?"start":"end"):"");return t.attr({role:"slider","aria-label":e}),r=createElement("div.rs-bar rs-transition").css("z-index","7").append(t).rsRotate(this._start),r.addClass(u.sliderType=="range"&&n==2?"rs-second":"rs-first"),this.container.append(r),this._refreshHandle(),this.bar=r,this._active=n,n!=1&&n!=2&&(this["_handle"+n]=this._handleDefaults()),this._bind(t,"focus",this._handleFocus),this._bind(t,"blur",this._handleBlur),t},_refreshHandle:function(){var hSize=this.options.handleSize,h,w,isSquare=!0,s,diff;if(typeof hSize=="string"&&isNumber(hSize))if(hSize.charAt(0)==="+"||hSize.charAt(0)==="-")try{hSize=eval(this.options.width+hSize.charAt(0)+Math.abs(parseFloat(hSize)))}catch(e){console.warn(e)}else hSize.indexOf(",")&&(s=hSize.split(","),isNumber(s[0])&&isNumber(s[1])&&(w=parseFloat(s[0]),h=parseFloat(s[1]),isSquare=!1));isSquare&&(h=w=isNumber(hSize)?parseFloat(hSize):this.options.width),diff=(this.options.width+this._border()-w)/2,this._handles().css({height:h,width:w,margin:-h/2+"px 0 0 "+diff+"px"})},_handleDefaults:function(){return{angle:this._valueToAngle(this.options.min),value:this.options.min}},_handles:function(){return this.container.children("div.rs-bar").find(".rs-handle")},_activeHandleBar:function(n){return n=n!=undefined?n:this._active,$(this.container.children("div.rs-bar")[n-1])},_handleArgs:function(n){n=n!=undefined?n:this._active;var t=this["_handle"+n];return{element:this._activeHandleBar(n).children(),index:n,isActive:n==this._active,value:t?t.value:null,angle:t?t.angle:null}},_dataElement:function(){return this._isInputType?this._hiddenField:this.control},_raiseEvent:function(n){var t=this["_pre"+n];if(t!==this.options.value)return this["_pre"+n]=this.options.value,this._updateTooltip(),(n=="change"||this._bindOnDrag&&n=="drag")&&this._updateHidden(),this._raise(n,{value:this.options.value,preValue:t,handle:this._handleArgs()})},_elementDown:function(n){var i,r,u,t,f;if(!this._isReadOnly)if(i=$(n.target),i.hasClass("rs-handle"))this._handleDown(n);else{var e=this._getXY(n),o=this._getCenterPoint(),s=getdistance(e,o),h=this.block.outerWidth()/2,c=h-(this.options.width+this._border());s>=c&&s<=h&&(n.preventDefault(),r=this.control.find(".rs-handle.rs-focus"),this.control.attr("tabindex","0").focus().removeAttr("tabindex"),i.hasClass("rs-seperator")?(t=i.parent().hasClass("rs-start")?this.options.min:this.options.max,u=this._valueToAngle(t)):(f=this._getAngleValue(e,o),u=f.angle,t=f.value),this._rangeSlider&&(r=this.control.find(".rs-handle.rs-focus"),this._active=r.length==1?parseFloat(r.attr("index")):this._handle2.value-t<t-this._handle1.value?2:1,this.bar=this._activeHandleBar()),this._changeSliderValue(t,u),this._raiseEvent("change"))}},_handleDown:function(n){n.preventDefault();var t=$(n.target);t.focus(),this._removeAnimation(),this._bindMouseEvents("_bind"),this.bar=t.parent(),this._active=parseFloat(t.attr("index")),this._handles().removeClass("rs-move"),this._raise("start",{value:this.options.value,handle:this._handleArgs()})},_handleMove:function(n){n.preventDefault();var u=this._getXY(n),f=this._getCenterPoint(),t=this._getAngleValue(u,f,!0),i,r;i=t.angle,r=t.value,this._changeSliderValue(r,i),this._raiseEvent("drag")},_handleUp:function(){this._handles().addClass("rs-move"),this._bindMouseEvents("_unbind"),this._addAnimation(),this._raiseEvent("change"),this._raise("stop",{value:this.options.value,handle:this._handleArgs()})},_handleFocus:function(n){if(!this._isReadOnly){var t=$(n.target);this._handles().removeClass("rs-focus"),t.addClass("rs-focus"),this.bar=t.parent(),this._active=parseFloat(t.attr("index")),this.options.keyboardAction&&(this._bindKeyboardEvents("_unbind"),this._bindKeyboardEvents("_bind")),this.control.find("div.rs-bar").css("z-index","7"),this.bar.css("z-index","8")}},_handleBlur:function(){this._handles().removeClass("rs-focus"),this.options.keyboardAction&&this._bindKeyboardEvents("_unbind")},_handleKeyDown:function(n){var t,r,i,u;this._isReadOnly||(t=n.keyCode,t==27&&this._handles().blur(),t>=35&&t<=40)&&(t>=37&&t<=40&&this._removeAnimation(),r=this["_handle"+this._active],n.preventDefault(),t==38||t==37?i=this._round(this._limitValue(r.value+this.options.step)):t==39||t==40?i=this._round(this._limitValue(r.value-this._getMinusStep(r.value))):t==36?i=this._getKeyValue("Home"):t==35&&(i=this._getKeyValue("End")),u=this._valueToAngle(i),this._changeSliderValue(i,u),this._raiseEvent("change"))},_handleKeyUp:function(){this._addAnimation()},_getMinusStep:function(n){if(n==this.options.max){var t=(this.options.max-this.options.min)%this.options.step;return t==0?this.options.step:t}return this.options.step},_getKeyValue:function(n){return this._rangeSlider?n=="Home"?this._active==1?this.options.min:this._handle1.value:this._active==1?this._handle2.value:this.options.max:n=="Home"?this.options.min:this.options.max},_elementScroll:function(n){if(!this._isReadOnly){n.preventDefault();var i=n.originalEvent||n,r,t,f,u;(u=i.wheelDelta?i.wheelDelta/60:i.detail?-i.detail/2:0,u!=0)&&(this._updateActiveHandle(n),r=this["_handle"+this._active],t=r.value+(u>0?this.options.step:-this._getMinusStep(r.value)),t=this._limitValue(t),f=this._valueToAngle(t),this._removeAnimation(),this._changeSliderValue(t,f),this._raiseEvent("change"),this._addAnimation())}},_updateActiveHandle:function(n){var t=$(n.target);t.hasClass("rs-handle")&&t.parent().parent()[0]==this.control[0]&&(this.bar=t.parent(),this._active=parseFloat(t.attr("index"))),this.bar.find(".rs-handle").hasClass("rs-focus")||this.bar.find(".rs-handle").focus()},_bindControlEvents:function(n){this[n](this.control,"mousedown",this._elementDown),this[n](this.control,"touchstart",this._elementDown)},_bindScrollEvents:function(n){this[n](this.control,"mousewheel",this._elementScroll),this[n](this.control,"DOMMouseScroll",this._elementScroll)},_bindMouseEvents:function(n){this[n]($(document),"mousemove",this._handleMove),this[n]($(document),"mouseup",this._handleUp),this[n]($(document),"mouseleave",this._handleUp),this[n]($(document),"touchmove",this._handleMove),this[n]($(document),"touchend",this._handleUp),this[n]($(document),"touchcancel",this._handleUp)},_bindKeyboardEvents:function(n){this[n]($(document),"keydown",this._handleKeyDown),this[n]($(document),"keyup",this._handleKeyUp)},_changeSliderValue:function(n,t){var u=this._oriAngle(t),i=this._limitAngle(t);if(this._rangeSlider||this._showRange){if(this._active==1&&u<=this._oriAngle(this._handle2.angle)||this._active==2&&u>=this._oriAngle(this._handle1.angle)||this._invertRange){this["_handle"+this._active]={angle:t,value:n},this.options.value=this._rangeSlider?this._handle1.value+","+this._handle2.value:n,this.bar.rsRotate(i),this._updateARIA(n);var r=this._oriAngle(this._handle2.angle)-this._oriAngle(this._handle1.angle),f="1",e="0";r<=180&&!(r<0&&r>-180)&&(f="0",e="1"),this.block2.css("opacity",f),this.block3.css("opacity",e),(this._active==1?this.block4:this.block2).rsRotate(i-180),(this._active==1?this.block1:this.block3).rsRotate(i)}}else this["_handle"+this._active]={angle:t,value:n},this.options.value=n,this.bar.rsRotate(i),this._updateARIA(n)},_updateARIA:function(n){var i=this.options.min,r=this.options.max,t;this.bar.children().attr({"aria-valuenow":n}),this.options.sliderType=="range"?(t=this._handles(),t.eq(0).attr({"aria-valuemin":i}),t.eq(1).attr({"aria-valuemax":r}),this._active==1?t.eq(1).attr({"aria-valuemin":n}):t.eq(0).attr({"aria-valuemax":n})):this.bar.children().attr({"aria-valuemin":i,"aria-valuemax":r})},_checkKO:function(){var f=this._dataElement().data("bind"),t,i,r,n,u;if(typeof f=="string"&&typeof ko=="object"){if(t=ko.dataFor(this._dataElement()[0]),typeof t=="undefined")return!0;for(i=f.split(","),n=0;n<i.length;n++)if(u=i[n].split(":"),$.trim(u[0])=="value"){r=$.trim(u[1]);break}r&&(this._isKO=!0,ko.computed(function(){this.option("value",t[r]())},this))}},_checkAngular:function(){if(typeof angular=="object"&&typeof angular.element=="function"&&(this._ngName=this._dataElement().attr("ng-model"),typeof this._ngName=="string")){this._isAngular=!0;var n=this;this._scope().$watch(this._ngName,function(t){n.option("value",t)})}},_scope:function(){return angular.element(this._dataElement()).scope()},_getXY:function(n){return n.type.indexOf("mouse")==-1&&(n=(n.originalEvent||n).changedTouches[0]),{x:n.pageX,y:n.pageY}},_getCenterPoint:function(){var n=this.block.offset();return{x:n.left+this.block.outerWidth()/2,y:n.top+this.block.outerHeight()/2}},_getAngleValue:function(n,t,i){var u=Math.atan2(n.y-t.y,t.x-n.x),r=-u/(Math.PI/180);return r<this._start&&(r+=360),r=this._checkAngle(r,i),this._processStepByAngle(r)},_checkAngle:function(n,t){var r=this._oriAngle(n),i;if(r>this._end){if(!t)return this["_handle"+this._active].angle;i=this._oriAngle(this["_handle"+this._active].angle),n=this._start+(i<=this._end-i?0:this._end)}return n},_processStepByAngle:function(n){var t=this._angleToValue(n);return this._processStepByValue(t)},_processStepByValue:function(n){var r=this.options.step,e,t,u,f,i,o;return e=(n-this.options.min)%r,t=n-e,u=this._limitValue(t+r),f=this._limitValue(t-r),i=n>=t?n-t<u-n?t:u:t-n>n-f?t:f,i=this._round(i),o=this._valueToAngle(i),{value:i,angle:o}},_round:function(n){var t=this.options.step.toString().split(".");return t[1]?parseFloat(n.toFixed(t[1].length)):Math.round(n)},_oriAngle:function(n){var t=n-this._start;return t<0&&(t+=360),t},_limitAngle:function(n){return n>360+this._start&&(n-=360),n<this._start&&(n+=360),n},_limitValue:function(n){return n<this.options.min&&(n=this.options.min),n>this.options.max&&(n=this.options.max),n},_angleToValue:function(n){var t=this.options;return this._oriAngle(n)/this._end*(t.max-t.min)+t.min},_valueToAngle:function(n){var t=this.options;return(n-t.min)/(t.max-t.min)*this._end+this._start},_appendHiddenField:function(){this._hiddenField=this._hiddenField||createElement("input"),this._hiddenField.attr({type:"hidden",name:this._dataElement()[0].id||""}),this.control.append(this._hiddenField),this._updateHidden()},_updateHidden:function(){var n=this.options.value;this._hiddenField.val(n),(this._isKO||this._isAngular)&&this._hiddenField.trigger("change"),this._isAngular&&(this._scope()[this._ngName]=n)},_updateTooltip:function(){this.tooltip&&!this.tooltip.hasClass("hover")&&this.tooltip.html(this._getTooltipValue()),this._updateTooltipPos()},_updateTooltipPos:function(){this.tooltip&&this.tooltip.css(this._getTooltipPos())},_getTooltipPos:function(){var n=this.options.circleShape,t;if(n=="full"||n=="pie"||n.indexOf("custom")===0)return{"margin-top":-this.tooltip.outerHeight()/2,"margin-left":-this.tooltip.outerWidth()/2};if(n.indexOf("half")!=-1){switch(n){case"half-top":case"half-bottom":t={"margin-left":-this.tooltip.outerWidth()/2};break;case"half-left":case"half-right":t={"margin-top":-this.tooltip.outerHeight()/2}}return t}return{}},_getTooltipValue:function(n){if(this._rangeSlider){var t=this.options.value.split(",");return n?t[0]+" - "+t[1]:this._tooltipValue(t[0],1)+" - "+this._tooltipValue(t[1],2)}return n?this.options.value:this._tooltipValue(this.options.value)},_tooltipValue:function(n,t){var i=this._raise("tooltipFormat",{value:n,handle:this._handleArgs(t)});return i!=null&&typeof i!="boolean"?i:n},_validateStartAngle:function(){var n=this.options.startAngle;return n=(isNumber(n)?parseFloat(n):0)%360,n<0&&(n+=360),this.options.startAngle=n,n},_validateEndAngle:function(){var end=this.options.endAngle;if(typeof end=="string"&&isNumber(end)&&(end.charAt(0)==="+"||end.charAt(0)==="-"))try{end=eval(this.options.startAngle+end.charAt(0)+Math.abs(parseFloat(end)))}catch(e){console.warn(e)}return end=(isNumber(end)?parseFloat(end):360)%360,end<=this.options.startAngle&&(end+=360),end},_refreshCircleShape:function(){var n=this.options.circleShape,i=["half-top","half-bottom","half-left","half-right","quarter-top-left","quarter-top-right","quarter-bottom-right","quarter-bottom-left","pie","custom-half","custom-quarter"],t;i.indexOf(n)==-1&&(t=["h1","h2","h3","h4","q1","q2","q3","q4","3/4","ch","cq"].indexOf(n),n=t!=-1?i[t]:n=="half"?"half-top":n=="quarter"?"quarter-top-left":"full"),this.options.circleShape=n},_appendOverlay:function(){var n=this.options.circleShape;n=="pie"?this._checkOverlay(".rs-overlay",270):(n=="custom-half"||n=="custom-quarter")&&(this._checkOverlay(".rs-overlay1",180),n=="custom-quarter"&&this._checkOverlay(".rs-overlay2",this._end))},_checkOverlay:function(n,t){var i=this.container.children(n);i.length==0&&(i=createElement("div"+n+" rs-transition rs-bg-color"),this.container.append(i)),i.rsRotate(this._start+t)},_checkDataType:function(){var i=this.options,r,n,t,u=this._props();for(r in u.numberType)n=u.numberType[r],t=i[n],i[n]=isNumber(t)?parseFloat(t):this.defaults[n];for(r in u.booleanType)n=u.booleanType[r],t=i[n],i[n]=t=="false"?!1:!!t;for(r in u.stringType)n=u.stringType[r],t=i[n],i[n]=(""+t).toLowerCase()},_validateSliderType:function(){var n=this.options.sliderType.toLowerCase();this._rangeSlider=this._showRange=!1,n=="range"?this._rangeSlider=this._showRange=!0:n.indexOf("min")!=-1?(this._showRange=!0,n="min-range"):n="default",this.options.sliderType=n},_updateStartEnd:function(){var n=this.options.circleShape;n!="full"&&(n.indexOf("quarter")!=-1?this.options.endAngle="+90":n.indexOf("half")!=-1?this.options.endAngle="+180":n=="pie"&&(this.options.endAngle="+270"),n=="quarter-top-left"||n=="half-top"?this.options.startAngle=0:n=="quarter-top-right"||n=="half-right"?this.options.startAngle=90:n=="quarter-bottom-right"||n=="half-bottom"?this.options.startAngle=180:(n=="quarter-bottom-left"||n=="half-left")&&(this.options.startAngle=270))},_validateStartEnd:function(){this._start=this._validateStartAngle(),this._end=this._validateEndAngle();var n=this._start<this._end?0:360;this._end+=n-this._start},_analyzeModelValue:function(){var n=this.options.value,t=this.options.min,f=this.options.max,u,r,i;n instanceof Array&&(n=n.toString()),i=typeof n=="string"?n.split(","):[n],this._rangeSlider?r=typeof n=="string"?i.length>=2?(isNumber(i[0])?i[0]:t)+","+(isNumber(i[1])?i[1]:f):isNumber(i[0])?t+","+i[0]:t+","+t:isNumber(n)?t+","+n:t+","+t:typeof n=="string"?(u=i.pop(),r=isNumber(u)?parseFloat(u):t):r=isNumber(n)?parseFloat(n):t,this.options.value=r},_validateModelValue:function(){var r=this.options.value,i;if(this._rangeSlider){var u=r.split(","),n=parseFloat(u[0]),t=parseFloat(u[1]);n=this._limitValue(n),t=this._limitValue(t),this._invertRange||n>t&&(t=n),this._handle1=this._processStepByValue(n),this._handle2=this._processStepByValue(t),this.options.value=this._handle1.value+","+this._handle2.value}else i=this._showRange?2:this._active||1,this["_handle"+i]=this._processStepByValue(this._limitValue(r)),this._showRange&&(this._handle1=this._handleDefaults()),this.options.value=this["_handle"+i].value},_isBrowserSupported:function(){for(var t=["borderRadius","WebkitBorderRadius","MozBorderRadius","OBorderRadius","msBorderRadius","KhtmlBorderRadius"],n=0;n<t.length;n++)if(document.body.style[t[n]]!==undefined)return!0},_throwError:function(){return"This browser doesn't support the border-radious property."},_checkIE:function(){var n=window.navigator.userAgent;(n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0)&&this.control.css({"-ms-touch-action":"none","touch-action":"none"})},_raise:function(n,t){var u=this.options,i=u[n],r=!0;return t=t||{value:u.value},t.options=u,i&&(t.type=n,typeof i=="string"&&(i=window[i]),$.isFunction(i)&&(r=i.call(this,t),r=r===!1?!1:r)),this.control.trigger($.Event?$.Event(n,t):n),r},_bind:function(n,t,i){$(n).bind(t,$proxy(i,this))},_unbind:function(n,t,i){$.proxy?$(n).unbind(t,$.proxy(i,this)):$(n).unbind(t)},_getInstance:function(){return $data(this._dataElement()[0],pluginName)},_removeData:function(){var n=this._dataElement()[0];$.removeData&&$.removeData(n,pluginName),n.id&&delete window[n.id]},_destroyControl:function(){this._isInputType&&this._dataElement().insertAfter(this.control).attr("type","text"),this.control.empty().removeClass("rs-control").height("").width(""),this._removeAnimation(),this._bindControlEvents("_unbind")},_updateWidth:function(){this.lastBlock.css("padding",this.options.width),this._refreshHandle()},_readOnly:function(n){this._isReadOnly=n,this.container.removeClass("rs-readonly"),n&&this.container.addClass("rs-readonly")},_get:function(n){return this.options[n]},_set:function(n,t){var i=this._props();if($.inArray(n,i.numberType)!=-1){if(!isNumber(t))return;t=parseFloat(t)}else $.inArray(n,i.booleanType)!=-1?t=t=="false"?!1:!!t:$.inArray(n,i.stringType)!=-1&&(t=t.toLowerCase());if(this.options[n]!=t){this.options[n]=t;switch(n){case"startAngle":case"endAngle":this._validateStartEnd(),this._updateSeperator(),this._appendOverlay();case"min":case"max":case"step":case"value":this._analyzeModelValue(),this._validateModelValue(),this._setValue(),this._updatePre(),this._updateHidden(),this._updateTooltip();break;case"radius":this._setRadius(),this._updateTooltipPos();break;case"width":this._removeAnimation(),this._updateWidth(),this._updateTooltipPos(),this._addAnimation(),this._refreshSeperator();break;case"handleSize":this._refreshHandle();break;case"handleShape":this._setHandleShape();break;case"animation":this._setAnimation();break;case"showTooltip":this.options.showTooltip?this._appendTooltip():this._removeTooltip();break;case"editableTooltip":this._tooltipEditable(),this._updateTooltipPos();break;case"disabled":this.options.disabled?this.disable():this.enable();break;case"readOnly":this.options.readOnly?this._readOnly(!0):!this.options.disabled&&this._readOnly(!1);break;case"mouseScrollAction":this._bindScrollEvents(this.options.mouseScrollAction?"_bind":"_unbind");break;case"lineCap":this._refreshSeperator();break;case"circleShape":this._refreshCircleShape(),this.options.circleShape=="full"&&(this.options.startAngle=0,this.options.endAngle="+360");case"sliderType":this._destroyControl(),this._onInit()}return this}},option:function(n,t){if(this._getInstance()&&this._isBrowserSupport){if($isPlainObject(n)){(n.min!==undefined||n.max!==undefined)&&(n.min!==undefined&&(this.options.min=n.min,delete n.min),n.max!==undefined&&(this.options.max=n.max,delete n.max),n.value==undefined&&this._set("value",this.options.value));for(var i in n)this._set(i,n[i])}else if(n&&typeof n=="string"){if(t===undefined)return this._get(n);this._set(n,t)}return this}},getValue:function(n){if(this.options.sliderType=="range"&&isNumber(n)){var t=parseFloat(n);if(t==1||t==2)return this["_handle"+t].value}return this._get("value")},setValue:function(n,t){if(isNumber(n)){if(isNumber(t))if(this.options.sliderType=="range"){var i=parseFloat(t),r=parseFloat(n);i==1?n=r+","+this._handle2.value:i==2&&(n=this._handle1.value+","+r)}else this.options.sliderType=="default"&&(this._active=t);this._set("value",n)}},disable:function(){this.options.disabled=!0,this.container.addClass("rs-disabled"),this._readOnly(!0)},enable:function(){this.options.disabled=!1,this.container.removeClass("rs-disabled"),this.options.readOnly||this._readOnly(!1)},destroy:function(){this._getInstance()&&(this._destroyControl(),this._removeData(),this._isInputType&&this.control.remove())}},$.fn.rsRotate=function(n){return setTransform(this,n)},typeof $.fn.outerHeight=="undefined"&&($.fn.outerHeight=function(){return this[0].offsetHeight},$.fn.outerWidth=function(){return this[0].offsetWidth}),typeof $.fn.hasClass=="undefined"&&($.fn.hasClass=function(n){return this[0].className.split(" ").indexOf(n)!==-1}),typeof $.fn.offset=="undefined"&&($.fn.offset=function(){return{left:this[0].offsetLeft,top:this[0].offsetTop}}),$.fn[pluginName].prototype=RoundSlider.prototype})(jQuery,window);(function(e){var t=function(n){return e.type(n)!=="object"?t({files:[].slice.call(arguments)}):(n=e.extend({},{files:[],async:!0,cache:!0,once:!0},n),n.async?t.async(n):t.sync(n))};e.extend(t,{cache:{},clear:function(e){e?delete t.cache[e]:t.cache={}},async:function(n){return function(n){var r=e.Deferred(),i=n.files,s=i.length,o=0;return e.each(i,function(e,i){t.load(i,n).done(function(){o++,r.notify(i,o,s),o===s&&r.resolve()})}),r.promise()}(n)},sync:function(n){return function(n){function u(e){t.load(e,n).done(function(){o++,r.notify(e,o,s),o<s?u(i[o]):r.resolve()})}var r=e.Deferred(),i=n.files,s=i.length,o=0;return u(i[o]),r.promise()}(n)},load:function(e,n){var r=e.split("."),i=r[r.length-1];if(t[i])return n.once?(t.cache[i]||(t.cache[i]={}),t.cache[i][e]||(t.cache[i][e]=t[i](e,n)),t.cache[i][e]):t[i](e,n);throw new Error("extension "+i+" is not supported")},js:function(t,n){return e.ajax({dataType:"script",cache:n.cache,url:t})},css:function(t,n){var r=e.Deferred(),i;return n.cache||(t+="?_="+e.now()),e("<link>",{rel:"stylesheet",href:t}).appendTo(document.head),i=new Image,i.onerror=function(){r.resolve()},i.src=t,r.promise()}}),e.require=t})(jQuery);!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],b):b("undefined"!=typeof exports?require("jquery"):a.jQuery)}(this,function(a){"use strict";function h(b){if(c.webkit&&!b)return{height:0,width:0};if(!c.data.outer){var d={border:"none","box-sizing":"content-box",height:"200px",margin:"0",padding:"0",width:"200px"};c.data.inner=a("<div>").css(a.extend({},d)),c.data.outer=a("<div>").css(a.extend({left:"-1000px",overflow:"scroll",position:"absolute",top:"-1000px"},d)).append(c.data.inner).appendTo("body")}return c.data.outer.scrollLeft(1e3).scrollTop(1e3),{height:Math.ceil(c.data.outer.offset().top-c.data.inner.offset().top||0),width:Math.ceil(c.data.outer.offset().left-c.data.inner.offset().left||0)}}function i(){var a=h(!0);return!(a.height||a.width)}function j(a){var b=a.originalEvent;return(!b.axis||b.axis!==b.HORIZONTAL_AXIS)&&!b.wheelDeltaX}var b=!1,c={data:{index:0,name:"scrollbar"},firefox:/firefox/i.test(navigator.userAgent),macosx:/mac/i.test(navigator.platform),msedge:/edge\/\d+/i.test(navigator.userAgent),msie:/(msie|trident)/i.test(navigator.userAgent),mobile:/android|webos|iphone|ipad|ipod|blackberry/i.test(navigator.userAgent),overlay:null,scroll:null,scrolls:[],webkit:/webkit/i.test(navigator.userAgent)&&!/edge\/\d+/i.test(navigator.userAgent)};c.scrolls.add=function(a){this.remove(a).push(a)},c.scrolls.remove=function(b){for(;a.inArray(b,this)>=0;)this.splice(a.inArray(b,this),1);return this};var d={autoScrollSize:!0,autoUpdate:!0,debug:!1,disableBodyScroll:!1,duration:200,ignoreMobile:!1,ignoreOverlay:!1,isRtl:!1,scrollStep:30,showArrows:!1,stepScrolling:!0,scrollx:null,scrolly:null,onDestroy:null,onFallback:null,onInit:null,onScroll:null,onUpdate:null},e=function(b){c.scroll||(c.overlay=i(),c.scroll=h(),g(),a(window).resize(function(){var a=!1;if(c.scroll&&(c.scroll.height||c.scroll.width)){var b=h();b.height===c.scroll.height&&b.width===c.scroll.width||(c.scroll=b,a=!0)}g(a)})),this.container=b,this.namespace=".scrollbar_"+c.data.index++,this.options=a.extend({},d,window.jQueryScrollbarOptions||{}),this.scrollTo=null,this.scrollx={},this.scrolly={},b.data(c.data.name,this),c.scrolls.add(this)};e.prototype={destroy:function(){if(this.wrapper){this.container.removeData(c.data.name),c.scrolls.remove(this);var b=this.container.scrollLeft(),d=this.container.scrollTop();this.container.insertBefore(this.wrapper).css({height:"",margin:"","max-height":""}).removeClass("scroll-content scroll-scrollx_visible scroll-scrolly_visible").off(this.namespace).scrollLeft(b).scrollTop(d),this.scrollx.scroll.removeClass("scroll-scrollx_visible").find("div").addBack().off(this.namespace),this.scrolly.scroll.removeClass("scroll-scrolly_visible").find("div").addBack().off(this.namespace),this.wrapper.remove(),a(document).add("body").off(this.namespace),a.isFunction(this.options.onDestroy)&&this.options.onDestroy.apply(this,[this.container])}},init:function(b){var d=this,e=this.container,f=this.containerWrapper||e,g=this.namespace,h=a.extend(this.options,b||{}),i={x:this.scrollx,y:this.scrolly},k=this.wrapper,l={},m={scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop()};if(c.mobile&&h.ignoreMobile||c.overlay&&h.ignoreOverlay||c.macosx&&!c.webkit)return a.isFunction(h.onFallback)&&h.onFallback.apply(this,[e]),!1;if(k)l={height:"auto","margin-bottom":c.scroll.height*-1+"px","max-height":""},l[h.isRtl?"margin-left":"margin-right"]=c.scroll.width*-1+"px",f.css(l);else{if(this.wrapper=k=a("<div>").addClass("scroll-wrapper").addClass(e.attr("class")).css("position","absolute"===e.css("position")?"absolute":"relative").insertBefore(e).append(e),h.isRtl&&k.addClass("scroll--rtl"),e.is("textarea")&&(this.containerWrapper=f=a("<div>").insertBefore(e).append(e),k.addClass("scroll-textarea")),l={height:"auto","margin-bottom":c.scroll.height*-1+"px","max-height":""},l[h.isRtl?"margin-left":"margin-right"]=c.scroll.width*-1+"px",f.addClass("scroll-content").css(l),e.on("scroll"+g,function(b){var f=e.scrollLeft(),g=e.scrollTop();if(h.isRtl)switch(!0){case c.firefox:f=Math.abs(f);case c.msedge||c.msie:f=e[0].scrollWidth-e[0].clientWidth-f}a.isFunction(h.onScroll)&&h.onScroll.call(d,{maxScroll:i.y.maxScrollOffset,scroll:g,size:i.y.size,visible:i.y.visible},{maxScroll:i.x.maxScrollOffset,scroll:f,size:i.x.size,visible:i.x.visible}),i.x.isVisible&&i.x.scroll.bar.css("left",f*i.x.kx+"px"),i.y.isVisible&&i.y.scroll.bar.css("top",g*i.y.kx+"px")}),k.on("scroll"+g,function(){k.scrollTop(0).scrollLeft(0)}),h.disableBodyScroll){var n=function(a){j(a)?i.y.isVisible&&i.y.mousewheel(a):i.x.isVisible&&i.x.mousewheel(a)};k.on("MozMousePixelScroll"+g,n),k.on("mousewheel"+g,n),c.mobile&&k.on("touchstart"+g,function(b){var c=b.originalEvent.touches&&b.originalEvent.touches[0]||b,d={pageX:c.pageX,pageY:c.pageY},f={left:e.scrollLeft(),top:e.scrollTop()};a(document).on("touchmove"+g,function(a){var b=a.originalEvent.targetTouches&&a.originalEvent.targetTouches[0]||a;e.scrollLeft(f.left+d.pageX-b.pageX),e.scrollTop(f.top+d.pageY-b.pageY),a.preventDefault()}),a(document).on("touchend"+g,function(){a(document).off(g)})})}a.isFunction(h.onInit)&&h.onInit.apply(this,[e])}a.each(i,function(b,f){var k=null,l=1,m="x"===b?"scrollLeft":"scrollTop",n=h.scrollStep,o=function(){var a=e[m]();e[m](a+n),1==l&&a+n>=p&&(a=e[m]()),l==-1&&a+n<=p&&(a=e[m]()),e[m]()==a&&k&&k()},p=0;f.scroll||(f.scroll=d._getScroll(h["scroll"+b]).addClass("scroll-"+b),h.showArrows&&f.scroll.addClass("scroll-element_arrows_visible"),f.mousewheel=function(a){if(!f.isVisible||"x"===b&&j(a))return!0;if("y"===b&&!j(a))return i.x.mousewheel(a),!0;var c=a.originalEvent.wheelDelta*-1||a.originalEvent.detail,g=f.size-f.visible-f.offset;return c||("x"===b&&a.originalEvent.deltaX?c=40*a.originalEvent.deltaX:"y"===b&&a.originalEvent.deltaY&&(c=40*a.originalEvent.deltaY)),(c>0&&p<g||c<0&&p>0)&&(p+=c,p<0&&(p=0),p>g&&(p=g),d.scrollTo=d.scrollTo||{},d.scrollTo[m]=p,setTimeout(function(){d.scrollTo&&(e.stop().animate(d.scrollTo,240,"linear",function(){p=e[m]()}),d.scrollTo=null)},1)),a.preventDefault(),!1},f.scroll.on("MozMousePixelScroll"+g,f.mousewheel).on("mousewheel"+g,f.mousewheel).on("mouseenter"+g,function(){p=e[m]()}),f.scroll.find(".scroll-arrow, .scroll-element_track").on("mousedown"+g,function(g){if(1!=g.which)return!0;l=1;var i={eventOffset:g["x"===b?"pageX":"pageY"],maxScrollValue:f.size-f.visible-f.offset,scrollbarOffset:f.scroll.bar.offset()["x"===b?"left":"top"],scrollbarSize:f.scroll.bar["x"===b?"outerWidth":"outerHeight"]()},j=0,q=0;if(a(this).hasClass("scroll-arrow")){if(l=a(this).hasClass("scroll-arrow_more")?1:-1,n=h.scrollStep*l,p=l>0?i.maxScrollValue:0,h.isRtl)switch(!0){case c.firefox:p=l>0?0:i.maxScrollValue*-1;break;case c.msie||c.msedge:}}else l=i.eventOffset>i.scrollbarOffset+i.scrollbarSize?1:i.eventOffset<i.scrollbarOffset?-1:0,"x"===b&&h.isRtl&&(c.msie||c.msedge)&&(l*=-1),n=Math.round(.75*f.visible)*l,p=i.eventOffset-i.scrollbarOffset-(h.stepScrolling?1==l?i.scrollbarSize:0:Math.round(i.scrollbarSize/2)),p=e[m]()+p/f.kx;return d.scrollTo=d.scrollTo||{},d.scrollTo[m]=h.stepScrolling?e[m]()+n:p,h.stepScrolling&&(k=function(){p=e[m](),clearInterval(q),clearTimeout(j),j=0,q=0},j=setTimeout(function(){q=setInterval(o,40)},h.duration+100)),setTimeout(function(){d.scrollTo&&(e.animate(d.scrollTo,h.duration),d.scrollTo=null)},1),d._handleMouseDown(k,g)}),f.scroll.bar.on("mousedown"+g,function(i){if(1!=i.which)return!0;var j=i["x"===b?"pageX":"pageY"],k=e[m]();return f.scroll.addClass("scroll-draggable"),a(document).on("mousemove"+g,function(a){var d=parseInt((a["x"===b?"pageX":"pageY"]-j)/f.kx,10);"x"===b&&h.isRtl&&(c.msie||c.msedge)&&(d*=-1),e[m](k+d)}),d._handleMouseDown(function(){f.scroll.removeClass("scroll-draggable"),p=e[m]()},i)}))}),a.each(i,function(a,b){var c="scroll-scroll"+a+"_visible",d="x"==a?i.y:i.x;b.scroll.removeClass(c),d.scroll.removeClass(c),f.removeClass(c)}),a.each(i,function(b,c){a.extend(c,"x"==b?{offset:parseInt(e.css("left"),10)||0,size:e.prop("scrollWidth"),visible:k.width()}:{offset:parseInt(e.css("top"),10)||0,size:e.prop("scrollHeight"),visible:k.height()})}),this._updateScroll("x",this.scrollx),this._updateScroll("y",this.scrolly),a.isFunction(h.onUpdate)&&h.onUpdate.apply(this,[e]),a.each(i,function(a,b){var c="x"===a?"left":"top",d="x"===a?"outerWidth":"outerHeight",f="x"===a?"width":"height",g=parseInt(e.css(c),10)||0,i=b.size,j=b.visible+g,k=b.scroll.size[d]()+(parseInt(b.scroll.size.css(c),10)||0);h.autoScrollSize&&(b.scrollbarSize=parseInt(k*j/i,10),b.scroll.bar.css(f,b.scrollbarSize+"px")),b.scrollbarSize=b.scroll.bar[d](),b.kx=(k-b.scrollbarSize)/(i-j)||1,b.maxScrollOffset=i-j}),e.scrollLeft(m.scrollLeft).scrollTop(m.scrollTop).trigger("scroll")},_getScroll:function(b){var c={advanced:['<div class="scroll-element">','<div class="scroll-element_corner"></div>','<div class="scroll-arrow scroll-arrow_less"></div>','<div class="scroll-arrow scroll-arrow_more"></div>','<div class="scroll-element_outer">','<div class="scroll-element_size"></div>','<div class="scroll-element_inner-wrapper">','<div class="scroll-element_inner scroll-element_track">','<div class="scroll-element_inner-bottom"></div>',"</div>","</div>",'<div class="scroll-bar">','<div class="scroll-bar_body">','<div class="scroll-bar_body-inner"></div>',"</div>",'<div class="scroll-bar_bottom"></div>','<div class="scroll-bar_center"></div>',"</div>","</div>","</div>"].join(""),simple:['<div class="scroll-element">','<div class="scroll-element_outer">','<div class="scroll-element_size"></div>','<div class="scroll-element_track"></div>','<div class="scroll-bar"></div>',"</div>","</div>"].join("")};return c[b]&&(b=c[b]),b||(b=c.simple),b="string"==typeof b?a(b).appendTo(this.wrapper):a(b),a.extend(b,{bar:b.find(".scroll-bar"),size:b.find(".scroll-element_size"),track:b.find(".scroll-element_track")}),b},_handleMouseDown:function(b,c){var d=this.namespace;return a(document).on("blur"+d,function(){a(document).add("body").off(d),b&&b()}),a(document).on("dragstart"+d,function(a){return a.preventDefault(),!1}),a(document).on("mouseup"+d,function(){a(document).add("body").off(d),b&&b()}),a("body").on("selectstart"+d,function(a){return a.preventDefault(),!1}),c&&c.preventDefault(),!1},_updateScroll:function(b,d){var e=this.container,f=this.containerWrapper||e,g="scroll-scroll"+b+"_visible",h="x"===b?this.scrolly:this.scrollx,i=parseInt(this.container.css("x"===b?"left":"top"),10)||0,j=this.wrapper,k=d.size,l=d.visible+i;d.isVisible=k-l>1,d.isVisible?(d.scroll.addClass(g),h.scroll.addClass(g),f.addClass(g)):(d.scroll.removeClass(g),h.scroll.removeClass(g),f.removeClass(g)),"y"===b&&(e.is("textarea")||k<l?f.css({height:l+c.scroll.height+"px","max-height":"none"}):f.css({"max-height":l+c.scroll.height+"px"})),d.size==e.prop("scrollWidth")&&h.size==e.prop("scrollHeight")&&d.visible==j.width()&&h.visible==j.height()&&d.offset==(parseInt(e.css("left"),10)||0)&&h.offset==(parseInt(e.css("top"),10)||0)||(a.extend(this.scrollx,{offset:parseInt(e.css("left"),10)||0,size:e.prop("scrollWidth"),visible:j.width()}),a.extend(this.scrolly,{offset:parseInt(e.css("top"),10)||0,size:this.container.prop("scrollHeight"),visible:j.height()}),this._updateScroll("x"===b?"y":"x",h))}};var f=e;a.fn.scrollbar=function(b,d){return"string"!=typeof b&&(d=b,b="init"),"undefined"==typeof d&&(d=[]),a.isArray(d)||(d=[d]),this.not("body, .scroll-wrapper").each(function(){var e=a(this),g=e.data(c.data.name);(g||"init"===b)&&(g||(g=new f(e)),g[b]&&g[b].apply(g,d))}),this},a.fn.scrollbar.options=d;var g=function(){var a=0,d=0;return function(e){var f,h,i,j,k,l,m;for(f=0;f<c.scrolls.length;f++)j=c.scrolls[f],h=j.container,i=j.options,k=j.wrapper,l=j.scrollx,m=j.scrolly,(e||i.autoUpdate&&k&&k.is(":visible")&&(h.prop("scrollWidth")!=l.size||h.prop("scrollHeight")!=m.size||k.width()!=l.visible||k.height()!=m.visible))&&(j.init(),i.debug&&(window.console&&console.log({scrollHeight:h.prop("scrollHeight")+":"+j.scrolly.size,scrollWidth:h.prop("scrollWidth")+":"+j.scrollx.size,visibleHeight:k.height()+":"+j.scrolly.visible,visibleWidth:k.width()+":"+j.scrollx.visible},!0),d++));b&&d>10?(window.console&&console.log("Scroll updates exceed 10"),g=function(){}):(clearTimeout(a),a=setTimeout(g,300))}}();window.angular&&!function(a){a.module("jQueryScrollbar",[]).provider("jQueryScrollbar",function(){var b=d;return{setOptions:function(c){a.extend(b,c)},$get:function(){return{options:a.copy(b)}}}}).directive("jqueryScrollbar",["jQueryScrollbar","$parse",function(a,b){return{restrict:"AC",link:function(c,d,e){var f=b(e.jqueryScrollbar),g=f(c);d.scrollbar(g||a.options).on("$destroy",function(){d.scrollbar("destroy")})}}}])}(window.angular)});!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.moment=b()}(this,function(){"use strict";function a(){return od.apply(null,arguments)}function b(a){od=a}function c(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function d(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function e(a){var b;for(b in a)return!1;return!0}function f(a){return"number"==typeof a||"[object Number]"===Object.prototype.toString.call(a)}function g(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function h(a,b){var c,d=[];for(c=0;c<a.length;++c)d.push(b(a[c],c));return d}function i(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function j(a,b){for(var c in b)i(b,c)&&(a[c]=b[c]);return i(b,"toString")&&(a.toString=b.toString),i(b,"valueOf")&&(a.valueOf=b.valueOf),a}function k(a,b,c,d){return rb(a,b,c,d,!0).utc()}function l(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}}function m(a){return null==a._pf&&(a._pf=l()),a._pf}function n(a){if(null==a._isValid){var b=m(a),c=qd.call(b.parsedDateParts,function(a){return null!=a}),d=!isNaN(a._d.getTime())&&b.overflow<0&&!b.empty&&!b.invalidMonth&&!b.invalidWeekday&&!b.nullInput&&!b.invalidFormat&&!b.userInvalidated&&(!b.meridiem||b.meridiem&&c);if(a._strict&&(d=d&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour),null!=Object.isFrozen&&Object.isFrozen(a))return d;a._isValid=d}return a._isValid}function o(a){var b=k(NaN);return null!=a?j(m(b),a):m(b).userInvalidated=!0,b}function p(a){return void 0===a}function q(a,b){var c,d,e;if(p(b._isAMomentObject)||(a._isAMomentObject=b._isAMomentObject),p(b._i)||(a._i=b._i),p(b._f)||(a._f=b._f),p(b._l)||(a._l=b._l),p(b._strict)||(a._strict=b._strict),p(b._tzm)||(a._tzm=b._tzm),p(b._isUTC)||(a._isUTC=b._isUTC),p(b._offset)||(a._offset=b._offset),p(b._pf)||(a._pf=m(b)),p(b._locale)||(a._locale=b._locale),rd.length>0)for(c in rd)d=rd[c],e=b[d],p(e)||(a[d]=e);return a}function r(b){q(this,b),this._d=new Date(null!=b._d?b._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),sd===!1&&(sd=!0,a.updateOffset(this),sd=!1)}function s(a){return a instanceof r||null!=a&&null!=a._isAMomentObject}function t(a){return a<0?Math.ceil(a)||0:Math.floor(a)}function u(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=t(b)),c}function v(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;d<e;d++)(c&&a[d]!==b[d]||!c&&u(a[d])!==u(b[d]))&&g++;return g+f}function w(b){a.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+b)}function x(b,c){var d=!0;return j(function(){if(null!=a.deprecationHandler&&a.deprecationHandler(null,b),d){for(var e,f=[],g=0;g<arguments.length;g++){if(e="","object"==typeof arguments[g]){e+="\n["+g+"] ";for(var h in arguments[0])e+=h+": "+arguments[0][h]+", ";e=e.slice(0,-2)}else e=arguments[g];f.push(e)}w(b+"\nArguments: "+Array.prototype.slice.call(f).join("")+"\n"+(new Error).stack),d=!1}return c.apply(this,arguments)},c)}function y(b,c){null!=a.deprecationHandler&&a.deprecationHandler(b,c),td[b]||(w(c),td[b]=!0)}function z(a){return a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function A(a){var b,c;for(c in a)b=a[c],z(b)?this[c]=b:this["_"+c]=b;this._config=a,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function B(a,b){var c,e=j({},a);for(c in b)i(b,c)&&(d(a[c])&&d(b[c])?(e[c]={},j(e[c],a[c]),j(e[c],b[c])):null!=b[c]?e[c]=b[c]:delete e[c]);for(c in a)i(a,c)&&!i(b,c)&&d(a[c])&&(e[c]=j({},e[c]));return e}function C(a){null!=a&&this.set(a)}function D(a,b,c){var d=this._calendar[a]||this._calendar.sameElse;return z(d)?d.call(b,c):d}function E(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];return b||!c?b:(this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a])}function F(){return this._invalidDate}function G(a){return this._ordinal.replace("%d",a)}function H(a,b,c,d){var e=this._relativeTime[c];return z(e)?e(a,b,c,d):e.replace(/%d/i,a)}function I(a,b){var c=this._relativeTime[a>0?"future":"past"];return z(c)?c(b):c.replace(/%s/i,b)}function J(a,b){var c=a.toLowerCase();Dd[c]=Dd[c+"s"]=Dd[b]=a}function K(a){return"string"==typeof a?Dd[a]||Dd[a.toLowerCase()]:void 0}function L(a){var b,c,d={};for(c in a)i(a,c)&&(b=K(c),b&&(d[b]=a[c]));return d}function M(a,b){Ed[a]=b}function N(a){var b=[];for(var c in a)b.push({unit:c,priority:Ed[c]});return b.sort(function(a,b){return a.priority-b.priority}),b}function O(b,c){return function(d){return null!=d?(Q(this,b,d),a.updateOffset(this,c),this):P(this,b)}}function P(a,b){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+b]():NaN}function Q(a,b,c){a.isValid()&&a._d["set"+(a._isUTC?"UTC":"")+b](c)}function R(a){return a=K(a),z(this[a])?this[a]():this}function S(a,b){if("object"==typeof a){a=L(a);for(var c=N(a),d=0;d<c.length;d++)this[c[d].unit](a[c[d].unit])}else if(a=K(a),z(this[a]))return this[a](b);return this}function T(a,b,c){var d=""+Math.abs(a),e=b-d.length,f=a>=0;return(f?c?"+":"":"-")+Math.pow(10,Math.max(0,e)).toString().substr(1)+d}function U(a,b,c,d){var e=d;"string"==typeof d&&(e=function(){return this[d]()}),a&&(Id[a]=e),b&&(Id[b[0]]=function(){return T(e.apply(this,arguments),b[1],b[2])}),c&&(Id[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function V(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function W(a){var b,c,d=a.match(Fd);for(b=0,c=d.length;b<c;b++)Id[d[b]]?d[b]=Id[d[b]]:d[b]=V(d[b]);return function(b){var e,f="";for(e=0;e<c;e++)f+=d[e]instanceof Function?d[e].call(b,a):d[e];return f}}function X(a,b){return a.isValid()?(b=Y(b,a.localeData()),Hd[b]=Hd[b]||W(b),Hd[b](a)):a.localeData().invalidDate()}function Y(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Gd.lastIndex=0;d>=0&&Gd.test(a);)a=a.replace(Gd,c),Gd.lastIndex=0,d-=1;return a}function Z(a,b,c){$d[a]=z(b)?b:function(a,d){return a&&c?c:b}}function $(a,b){return i($d,a)?$d[a](b._strict,b._locale):new RegExp(_(a))}function _(a){return aa(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}))}function aa(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ba(a,b){var c,d=b;for("string"==typeof a&&(a=[a]),f(b)&&(d=function(a,c){c[b]=u(a)}),c=0;c<a.length;c++)_d[a[c]]=d}function ca(a,b){ba(a,function(a,c,d,e){d._w=d._w||{},b(a,d._w,d,e)})}function da(a,b,c){null!=b&&i(_d,a)&&_d[a](b,c._a,c,a)}function ea(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function fa(a,b){return a?c(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||ke).test(b)?"format":"standalone"][a.month()]:this._months}function ga(a,b){return a?c(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[ke.test(b)?"format":"standalone"][a.month()]:this._monthsShort}function ha(a,b,c){var d,e,f,g=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],d=0;d<12;++d)f=k([2e3,d]),this._shortMonthsParse[d]=this.monthsShort(f,"").toLocaleLowerCase(),this._longMonthsParse[d]=this.months(f,"").toLocaleLowerCase();return c?"MMM"===b?(e=je.call(this._shortMonthsParse,g),e!==-1?e:null):(e=je.call(this._longMonthsParse,g),e!==-1?e:null):"MMM"===b?(e=je.call(this._shortMonthsParse,g),e!==-1?e:(e=je.call(this._longMonthsParse,g),e!==-1?e:null)):(e=je.call(this._longMonthsParse,g),e!==-1?e:(e=je.call(this._shortMonthsParse,g),e!==-1?e:null))}function ia(a,b,c){var d,e,f;if(this._monthsParseExact)return ha.call(this,a,b,c);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),d=0;d<12;d++){if(e=k([2e3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(f="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(f.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a))return d;if(c&&"MMM"===b&&this._shortMonthsParse[d].test(a))return d;if(!c&&this._monthsParse[d].test(a))return d}}function ja(a,b){var c;if(!a.isValid())return a;if("string"==typeof b)if(/^\d+$/.test(b))b=u(b);else if(b=a.localeData().monthsParse(b),!f(b))return a;return c=Math.min(a.date(),ea(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a}function ka(b){return null!=b?(ja(this,b),a.updateOffset(this,!0),this):P(this,"Month")}function la(){return ea(this.year(),this.month())}function ma(a){return this._monthsParseExact?(i(this,"_monthsRegex")||oa.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex):(i(this,"_monthsShortRegex")||(this._monthsShortRegex=ne),this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex)}function na(a){return this._monthsParseExact?(i(this,"_monthsRegex")||oa.call(this),a?this._monthsStrictRegex:this._monthsRegex):(i(this,"_monthsRegex")||(this._monthsRegex=oe),this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex)}function oa(){function a(a,b){return b.length-a.length}var b,c,d=[],e=[],f=[];for(b=0;b<12;b++)c=k([2e3,b]),d.push(this.monthsShort(c,"")),e.push(this.months(c,"")),f.push(this.months(c,"")),f.push(this.monthsShort(c,""));for(d.sort(a),e.sort(a),f.sort(a),b=0;b<12;b++)d[b]=aa(d[b]),e[b]=aa(e[b]);for(b=0;b<24;b++)f[b]=aa(f[b]);this._monthsRegex=new RegExp("^("+f.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+e.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+d.join("|")+")","i")}function pa(a){return qa(a)?366:365}function qa(a){return a%4===0&&a%100!==0||a%400===0}function ra(){return qa(this.year())}function sa(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return a<100&&a>=0&&isFinite(h.getFullYear())&&h.setFullYear(a),h}function ta(a){var b=new Date(Date.UTC.apply(null,arguments));return a<100&&a>=0&&isFinite(b.getUTCFullYear())&&b.setUTCFullYear(a),b}function ua(a,b,c){var d=7+b-c,e=(7+ta(a,0,d).getUTCDay()-b)%7;return-e+d-1}function va(a,b,c,d,e){var f,g,h=(7+c-d)%7,i=ua(a,d,e),j=1+7*(b-1)+h+i;return j<=0?(f=a-1,g=pa(f)+j):j>pa(a)?(f=a+1,g=j-pa(a)):(f=a,g=j),{year:f,dayOfYear:g}}function wa(a,b,c){var d,e,f=ua(a.year(),b,c),g=Math.floor((a.dayOfYear()-f-1)/7)+1;return g<1?(e=a.year()-1,d=g+xa(e,b,c)):g>xa(a.year(),b,c)?(d=g-xa(a.year(),b,c),e=a.year()+1):(e=a.year(),d=g),{week:d,year:e}}function xa(a,b,c){var d=ua(a,b,c),e=ua(a+1,b,c);return(pa(a)-d+e)/7}function ya(a){return wa(a,this._week.dow,this._week.doy).week}function za(){return this._week.dow}function Aa(){return this._week.doy}function Ba(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")}function Ca(a){var b=wa(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")}function Da(a,b){return"string"!=typeof a?a:isNaN(a)?(a=b.weekdaysParse(a),"number"==typeof a?a:null):parseInt(a,10)}function Ea(a,b){return"string"==typeof a?b.weekdaysParse(a)%7||7:isNaN(a)?null:a}function Fa(a,b){return a?c(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(b)?"format":"standalone"][a.day()]:this._weekdays}function Ga(a){return a?this._weekdaysShort[a.day()]:this._weekdaysShort}function Ha(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin}function Ia(a,b,c){var d,e,f,g=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],d=0;d<7;++d)f=k([2e3,1]).day(d),this._minWeekdaysParse[d]=this.weekdaysMin(f,"").toLocaleLowerCase(),this._shortWeekdaysParse[d]=this.weekdaysShort(f,"").toLocaleLowerCase(),this._weekdaysParse[d]=this.weekdays(f,"").toLocaleLowerCase();return c?"dddd"===b?(e=je.call(this._weekdaysParse,g),e!==-1?e:null):"ddd"===b?(e=je.call(this._shortWeekdaysParse,g),e!==-1?e:null):(e=je.call(this._minWeekdaysParse,g),e!==-1?e:null):"dddd"===b?(e=je.call(this._weekdaysParse,g),e!==-1?e:(e=je.call(this._shortWeekdaysParse,g),e!==-1?e:(e=je.call(this._minWeekdaysParse,g),e!==-1?e:null))):"ddd"===b?(e=je.call(this._shortWeekdaysParse,g),e!==-1?e:(e=je.call(this._weekdaysParse,g),e!==-1?e:(e=je.call(this._minWeekdaysParse,g),e!==-1?e:null))):(e=je.call(this._minWeekdaysParse,g),e!==-1?e:(e=je.call(this._weekdaysParse,g),e!==-1?e:(e=je.call(this._shortWeekdaysParse,g),e!==-1?e:null)))}function Ja(a,b,c){var d,e,f;if(this._weekdaysParseExact)return Ia.call(this,a,b,c);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),d=0;d<7;d++){if(e=k([2e3,1]).day(d),c&&!this._fullWeekdaysParse[d]&&(this._fullWeekdaysParse[d]=new RegExp("^"+this.weekdays(e,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[d]=new RegExp("^"+this.weekdaysShort(e,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[d]=new RegExp("^"+this.weekdaysMin(e,"").replace(".",".?")+"$","i")),this._weekdaysParse[d]||(f="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+"|^"+this.weekdaysMin(e,""),this._weekdaysParse[d]=new RegExp(f.replace(".",""),"i")),c&&"dddd"===b&&this._fullWeekdaysParse[d].test(a))return d;if(c&&"ddd"===b&&this._shortWeekdaysParse[d].test(a))return d;if(c&&"dd"===b&&this._minWeekdaysParse[d].test(a))return d;if(!c&&this._weekdaysParse[d].test(a))return d}}function Ka(a){if(!this.isValid())return null!=a?this:NaN;var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=Da(a,this.localeData()),this.add(a-b,"d")):b}function La(a){if(!this.isValid())return null!=a?this:NaN;var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")}function Ma(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var b=Ea(a,this.localeData());return this.day(this.day()%7?b:b-7)}return this.day()||7}function Na(a){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||Qa.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex):(i(this,"_weekdaysRegex")||(this._weekdaysRegex=ue),this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex)}function Oa(a){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||Qa.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(i(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=ve),this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Pa(a){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||Qa.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(i(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=we),this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Qa(){function a(a,b){return b.length-a.length}var b,c,d,e,f,g=[],h=[],i=[],j=[];for(b=0;b<7;b++)c=k([2e3,1]).day(b),d=this.weekdaysMin(c,""),e=this.weekdaysShort(c,""),f=this.weekdays(c,""),g.push(d),h.push(e),i.push(f),j.push(d),j.push(e),j.push(f);for(g.sort(a),h.sort(a),i.sort(a),j.sort(a),b=0;b<7;b++)h[b]=aa(h[b]),i[b]=aa(i[b]),j[b]=aa(j[b]);this._weekdaysRegex=new RegExp("^("+j.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+g.join("|")+")","i")}function Ra(){return this.hours()%12||12}function Sa(){return this.hours()||24}function Ta(a,b){U(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Ua(a,b){return b._meridiemParse}function Va(a){return"p"===(a+"").toLowerCase().charAt(0)}function Wa(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"}function Xa(a){return a?a.toLowerCase().replace("_","-"):a}function Ya(a){for(var b,c,d,e,f=0;f<a.length;){for(e=Xa(a[f]).split("-"),b=e.length,c=Xa(a[f+1]),c=c?c.split("-"):null;b>0;){if(d=Za(e.slice(0,b).join("-")))return d;if(c&&c.length>=b&&v(e,c,!0)>=b-1)break;b--}f++}return null}function Za(a){var b=null;if(!Be[a]&&"undefined"!=typeof module&&module&&module.exports)try{b=xe._abbr,require("./locale/"+a),$a(b)}catch(a){}return Be[a]}function $a(a,b){var c;return a&&(c=p(b)?bb(a):_a(a,b),c&&(xe=c)),xe._abbr}function _a(a,b){if(null!==b){var c=Ae;if(b.abbr=a,null!=Be[a])y("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),c=Be[a]._config;else if(null!=b.parentLocale){if(null==Be[b.parentLocale])return Ce[b.parentLocale]||(Ce[b.parentLocale]=[]),Ce[b.parentLocale].push({name:a,config:b}),null;c=Be[b.parentLocale]._config}return Be[a]=new C(B(c,b)),Ce[a]&&Ce[a].forEach(function(a){_a(a.name,a.config)}),$a(a),Be[a]}return delete Be[a],null}function ab(a,b){if(null!=b){var c,d=Ae;null!=Be[a]&&(d=Be[a]._config),b=B(d,b),c=new C(b),c.parentLocale=Be[a],Be[a]=c,$a(a)}else null!=Be[a]&&(null!=Be[a].parentLocale?Be[a]=Be[a].parentLocale:null!=Be[a]&&delete Be[a]);return Be[a]}function bb(a){var b;if(a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr),!a)return xe;if(!c(a)){if(b=Za(a))return b;a=[a]}return Ya(a)}function cb(){return wd(Be)}function db(a){var b,c=a._a;return c&&m(a).overflow===-2&&(b=c[be]<0||c[be]>11?be:c[ce]<1||c[ce]>ea(c[ae],c[be])?ce:c[de]<0||c[de]>24||24===c[de]&&(0!==c[ee]||0!==c[fe]||0!==c[ge])?de:c[ee]<0||c[ee]>59?ee:c[fe]<0||c[fe]>59?fe:c[ge]<0||c[ge]>999?ge:-1,m(a)._overflowDayOfYear&&(b<ae||b>ce)&&(b=ce),m(a)._overflowWeeks&&b===-1&&(b=he),m(a)._overflowWeekday&&b===-1&&(b=ie),m(a).overflow=b),a}function eb(a){var b,c,d,e,f,g,h=a._i,i=De.exec(h)||Ee.exec(h);if(i){for(m(a).iso=!0,b=0,c=Ge.length;b<c;b++)if(Ge[b][1].exec(i[1])){e=Ge[b][0],d=Ge[b][2]!==!1;break}if(null==e)return void(a._isValid=!1);if(i[3]){for(b=0,c=He.length;b<c;b++)if(He[b][1].exec(i[3])){f=(i[2]||" ")+He[b][0];break}if(null==f)return void(a._isValid=!1)}if(!d&&null!=f)return void(a._isValid=!1);if(i[4]){if(!Fe.exec(i[4]))return void(a._isValid=!1);g="Z"}a._f=e+(f||"")+(g||""),kb(a)}else a._isValid=!1}function fb(b){var c=Ie.exec(b._i);return null!==c?void(b._d=new Date(+c[1])):(eb(b),void(b._isValid===!1&&(delete b._isValid,a.createFromInputFallback(b))))}function gb(a,b,c){return null!=a?a:null!=b?b:c}function hb(b){var c=new Date(a.now());return b._useUTC?[c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()]:[c.getFullYear(),c.getMonth(),c.getDate()]}function ib(a){var b,c,d,e,f=[];if(!a._d){for(d=hb(a),a._w&&null==a._a[ce]&&null==a._a[be]&&jb(a),a._dayOfYear&&(e=gb(a._a[ae],d[ae]),a._dayOfYear>pa(e)&&(m(a)._overflowDayOfYear=!0),c=ta(e,0,a._dayOfYear),a._a[be]=c.getUTCMonth(),a._a[ce]=c.getUTCDate()),b=0;b<3&&null==a._a[b];++b)a._a[b]=f[b]=d[b];for(;b<7;b++)a._a[b]=f[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[de]&&0===a._a[ee]&&0===a._a[fe]&&0===a._a[ge]&&(a._nextDay=!0,a._a[de]=0),a._d=(a._useUTC?ta:sa).apply(null,f),null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),a._nextDay&&(a._a[de]=24)}}function jb(a){var b,c,d,e,f,g,h,i;if(b=a._w,null!=b.GG||null!=b.W||null!=b.E)f=1,g=4,c=gb(b.GG,a._a[ae],wa(sb(),1,4).year),d=gb(b.W,1),e=gb(b.E,1),(e<1||e>7)&&(i=!0);else{f=a._locale._week.dow,g=a._locale._week.doy;var j=wa(sb(),f,g);c=gb(b.gg,a._a[ae],j.year),d=gb(b.w,j.week),null!=b.d?(e=b.d,(e<0||e>6)&&(i=!0)):null!=b.e?(e=b.e+f,(b.e<0||b.e>6)&&(i=!0)):e=f}d<1||d>xa(c,f,g)?m(a)._overflowWeeks=!0:null!=i?m(a)._overflowWeekday=!0:(h=va(c,d,e,f,g),a._a[ae]=h.year,a._dayOfYear=h.dayOfYear)}function kb(b){if(b._f===a.ISO_8601)return void eb(b);b._a=[],m(b).empty=!0;var c,d,e,f,g,h=""+b._i,i=h.length,j=0;for(e=Y(b._f,b._locale).match(Fd)||[],c=0;c<e.length;c++)f=e[c],d=(h.match($(f,b))||[])[0],d&&(g=h.substr(0,h.indexOf(d)),g.length>0&&m(b).unusedInput.push(g),h=h.slice(h.indexOf(d)+d.length),j+=d.length),Id[f]?(d?m(b).empty=!1:m(b).unusedTokens.push(f),da(f,d,b)):b._strict&&!d&&m(b).unusedTokens.push(f);m(b).charsLeftOver=i-j,h.length>0&&m(b).unusedInput.push(h),b._a[de]<=12&&m(b).bigHour===!0&&b._a[de]>0&&(m(b).bigHour=void 0),m(b).parsedDateParts=b._a.slice(0),m(b).meridiem=b._meridiem,b._a[de]=lb(b._locale,b._a[de],b._meridiem),ib(b),db(b)}function lb(a,b,c){var d;return null==c?b:null!=a.meridiemHour?a.meridiemHour(b,c):null!=a.isPM?(d=a.isPM(c),d&&b<12&&(b+=12),d||12!==b||(b=0),b):b}function mb(a){var b,c,d,e,f;if(0===a._f.length)return m(a).invalidFormat=!0,void(a._d=new Date(NaN));for(e=0;e<a._f.length;e++)f=0,b=q({},a),null!=a._useUTC&&(b._useUTC=a._useUTC),b._f=a._f[e],kb(b),n(b)&&(f+=m(b).charsLeftOver,f+=10*m(b).unusedTokens.length,m(b).score=f,(null==d||f<d)&&(d=f,c=b));j(a,c||b)}function nb(a){if(!a._d){var b=L(a._i);a._a=h([b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],function(a){return a&&parseInt(a,10)}),ib(a)}}function ob(a){var b=new r(db(pb(a)));return b._nextDay&&(b.add(1,"d"),b._nextDay=void 0),b}function pb(a){var b=a._i,d=a._f;return a._locale=a._locale||bb(a._l),null===b||void 0===d&&""===b?o({nullInput:!0}):("string"==typeof b&&(a._i=b=a._locale.preparse(b)),s(b)?new r(db(b)):(g(b)?a._d=b:c(d)?mb(a):d?kb(a):qb(a),n(a)||(a._d=null),a))}function qb(b){var d=b._i;void 0===d?b._d=new Date(a.now()):g(d)?b._d=new Date(d.valueOf()):"string"==typeof d?fb(b):c(d)?(b._a=h(d.slice(0),function(a){return parseInt(a,10)}),ib(b)):"object"==typeof d?nb(b):f(d)?b._d=new Date(d):a.createFromInputFallback(b)}function rb(a,b,f,g,h){var i={};return f!==!0&&f!==!1||(g=f,f=void 0),(d(a)&&e(a)||c(a)&&0===a.length)&&(a=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=h,i._l=f,i._i=a,i._f=b,i._strict=g,ob(i)}function sb(a,b,c,d){return rb(a,b,c,d,!1)}function tb(a,b){var d,e;if(1===b.length&&c(b[0])&&(b=b[0]),!b.length)return sb();for(d=b[0],e=1;e<b.length;++e)b[e].isValid()&&!b[e][a](d)||(d=b[e]);return d}function ub(){var a=[].slice.call(arguments,0);return tb("isBefore",a)}function vb(){var a=[].slice.call(arguments,0);return tb("isAfter",a)}function wb(a){var b=L(a),c=b.year||0,d=b.quarter||0,e=b.month||0,f=b.week||0,g=b.day||0,h=b.hour||0,i=b.minute||0,j=b.second||0,k=b.millisecond||0;this._milliseconds=+k+1e3*j+6e4*i+1e3*h*60*60,this._days=+g+7*f,this._months=+e+3*d+12*c,this._data={},this._locale=bb(),this._bubble()}function xb(a){return a instanceof wb}function yb(a){return a<0?Math.round(-1*a)*-1:Math.round(a)}function zb(a,b){U(a,0,0,function(){var a=this.utcOffset(),c="+";return a<0&&(a=-a,c="-"),c+T(~~(a/60),2)+b+T(~~a%60,2)})}function Ab(a,b){var c=(b||"").match(a);if(null===c)return null;var d=c[c.length-1]||[],e=(d+"").match(Me)||["-",0,0],f=+(60*e[1])+u(e[2]);return 0===f?0:"+"===e[0]?f:-f}function Bb(b,c){var d,e;return c._isUTC?(d=c.clone(),e=(s(b)||g(b)?b.valueOf():sb(b).valueOf())-d.valueOf(),d._d.setTime(d._d.valueOf()+e),a.updateOffset(d,!1),d):sb(b).local()}function Cb(a){return 15*-Math.round(a._d.getTimezoneOffset()/15)}function Db(b,c){var d,e=this._offset||0;if(!this.isValid())return null!=b?this:NaN;if(null!=b){if("string"==typeof b){if(b=Ab(Xd,b),null===b)return this}else Math.abs(b)<16&&(b=60*b);return!this._isUTC&&c&&(d=Cb(this)),this._offset=b,this._isUTC=!0,null!=d&&this.add(d,"m"),e!==b&&(!c||this._changeInProgress?Tb(this,Ob(b-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?e:Cb(this)}function Eb(a,b){return null!=a?("string"!=typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()}function Fb(a){return this.utcOffset(0,a)}function Gb(a){return this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(Cb(this),"m")),this}function Hb(){if(null!=this._tzm)this.utcOffset(this._tzm);else if("string"==typeof this._i){var a=Ab(Wd,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this}function Ib(a){return!!this.isValid()&&(a=a?sb(a).utcOffset():0,(this.utcOffset()-a)%60===0)}function Jb(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Kb(){if(!p(this._isDSTShifted))return this._isDSTShifted;var a={};if(q(a,this),a=pb(a),a._a){var b=a._isUTC?k(a._a):sb(a._a);this._isDSTShifted=this.isValid()&&v(a._a,b.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Lb(){return!!this.isValid()&&!this._isUTC}function Mb(){return!!this.isValid()&&this._isUTC}function Nb(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Ob(a,b){var c,d,e,g=a,h=null;return xb(a)?g={ms:a._milliseconds,d:a._days,M:a._months}:f(a)?(g={},b?g[b]=a:g.milliseconds=a):(h=Ne.exec(a))?(c="-"===h[1]?-1:1,g={y:0,d:u(h[ce])*c,h:u(h[de])*c,m:u(h[ee])*c,s:u(h[fe])*c,ms:u(yb(1e3*h[ge]))*c}):(h=Oe.exec(a))?(c="-"===h[1]?-1:1,g={y:Pb(h[2],c),M:Pb(h[3],c),w:Pb(h[4],c),d:Pb(h[5],c),h:Pb(h[6],c),m:Pb(h[7],c),s:Pb(h[8],c)}):null==g?g={}:"object"==typeof g&&("from"in g||"to"in g)&&(e=Rb(sb(g.from),sb(g.to)),g={},g.ms=e.milliseconds,g.M=e.months),d=new wb(g),xb(a)&&i(a,"_locale")&&(d._locale=a._locale),d}function Pb(a,b){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*b}function Qb(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b)&&--c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function Rb(a,b){var c;return a.isValid()&&b.isValid()?(b=Bb(b,a),a.isBefore(b)?c=Qb(a,b):(c=Qb(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c):{milliseconds:0,months:0}}function Sb(a,b){return function(c,d){var e,f;return null===d||isNaN(+d)||(y(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),f=c,c=d,d=f),c="string"==typeof c?+c:c,e=Ob(c,d),Tb(this,e,a),this}}function Tb(b,c,d,e){var f=c._milliseconds,g=yb(c._days),h=yb(c._months);b.isValid()&&(e=null==e||e,f&&b._d.setTime(b._d.valueOf()+f*d),g&&Q(b,"Date",P(b,"Date")+g*d),h&&ja(b,P(b,"Month")+h*d),e&&a.updateOffset(b,g||h))}function Ub(a,b){var c=a.diff(b,"days",!0);return c<-6?"sameElse":c<-1?"lastWeek":c<0?"lastDay":c<1?"sameDay":c<2?"nextDay":c<7?"nextWeek":"sameElse"}function Vb(b,c){var d=b||sb(),e=Bb(d,this).startOf("day"),f=a.calendarFormat(this,e)||"sameElse",g=c&&(z(c[f])?c[f].call(this,d):c[f]);return this.format(g||this.localeData().calendar(f,this,sb(d)))}function Wb(){return new r(this)}function Xb(a,b){var c=s(a)?a:sb(a);return!(!this.isValid()||!c.isValid())&&(b=K(p(b)?"millisecond":b),"millisecond"===b?this.valueOf()>c.valueOf():c.valueOf()<this.clone().startOf(b).valueOf())}function Yb(a,b){var c=s(a)?a:sb(a);return!(!this.isValid()||!c.isValid())&&(b=K(p(b)?"millisecond":b),"millisecond"===b?this.valueOf()<c.valueOf():this.clone().endOf(b).valueOf()<c.valueOf())}function Zb(a,b,c,d){return d=d||"()",("("===d[0]?this.isAfter(a,c):!this.isBefore(a,c))&&(")"===d[1]?this.isBefore(b,c):!this.isAfter(b,c))}function $b(a,b){var c,d=s(a)?a:sb(a);return!(!this.isValid()||!d.isValid())&&(b=K(b||"millisecond"),"millisecond"===b?this.valueOf()===d.valueOf():(c=d.valueOf(),this.clone().startOf(b).valueOf()<=c&&c<=this.clone().endOf(b).valueOf()))}function _b(a,b){return this.isSame(a,b)||this.isAfter(a,b)}function ac(a,b){return this.isSame(a,b)||this.isBefore(a,b)}function bc(a,b,c){var d,e,f,g;return this.isValid()?(d=Bb(a,this),d.isValid()?(e=6e4*(d.utcOffset()-this.utcOffset()),b=K(b),"year"===b||"month"===b||"quarter"===b?(g=cc(this,d),"quarter"===b?g/=3:"year"===b&&(g/=12)):(f=this-d,g="second"===b?f/1e3:"minute"===b?f/6e4:"hour"===b?f/36e5:"day"===b?(f-e)/864e5:"week"===b?(f-e)/6048e5:f),c?g:t(g)):NaN):NaN}function cc(a,b){var c,d,e=12*(b.year()-a.year())+(b.month()-a.month()),f=a.clone().add(e,"months");return b-f<0?(c=a.clone().add(e-1,"months"),d=(b-f)/(f-c)):(c=a.clone().add(e+1,"months"),d=(b-f)/(c-f)),-(e+d)||0}function dc(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ec(){var a=this.clone().utc();return 0<a.year()&&a.year()<=9999?z(Date.prototype.toISOString)?this.toDate().toISOString():X(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):X(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function fc(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",b="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",b="Z");var c="["+a+'("]',d=0<this.year()&&this.year()<=9999?"YYYY":"YYYYYY",e="-MM-DD[T]HH:mm:ss.SSS",f=b+'[")]';return this.format(c+d+e+f)}function gc(b){b||(b=this.isUtc()?a.defaultFormatUtc:a.defaultFormat);var c=X(this,b);return this.localeData().postformat(c)}function hc(a,b){return this.isValid()&&(s(a)&&a.isValid()||sb(a).isValid())?Ob({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function ic(a){return this.from(sb(),a)}function jc(a,b){return this.isValid()&&(s(a)&&a.isValid()||sb(a).isValid())?Ob({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function kc(a){return this.to(sb(),a)}function lc(a){var b;return void 0===a?this._locale._abbr:(b=bb(a),null!=b&&(this._locale=b),this)}function mc(){return this._locale}function nc(a){switch(a=K(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a&&this.weekday(0),"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this}function oc(a){return a=K(a),void 0===a||"millisecond"===a?this:("date"===a&&(a="day"),this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms"))}function pc(){return this._d.valueOf()-6e4*(this._offset||0)}function qc(){return Math.floor(this.valueOf()/1e3)}function rc(){return new Date(this.valueOf())}function sc(){var a=this;return[a.year(),a.month(),a.date(),a.hour(),a.minute(),a.second(),a.millisecond()]}function tc(){var a=this;return{years:a.year(),months:a.month(),date:a.date(),hours:a.hours(),minutes:a.minutes(),seconds:a.seconds(),milliseconds:a.milliseconds()}}function uc(){return this.isValid()?this.toISOString():null}function vc(){return n(this)}function wc(){return j({},m(this))}function xc(){return m(this).overflow}function yc(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function zc(a,b){U(0,[a,a.length],0,b)}function Ac(a){return Ec.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Bc(a){return Ec.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)}function Cc(){return xa(this.year(),1,4)}function Dc(){var a=this.localeData()._week;return xa(this.year(),a.dow,a.doy)}function Ec(a,b,c,d,e){var f;return null==a?wa(this,d,e).year:(f=xa(a,d,e),b>f&&(b=f),Fc.call(this,a,b,c,d,e))}function Fc(a,b,c,d,e){var f=va(a,b,c,d,e),g=ta(f.year,0,f.dayOfYear);return this.year(g.getUTCFullYear()),this.month(g.getUTCMonth()),this.date(g.getUTCDate()),this}function Gc(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)}function Hc(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==a?b:this.add(a-b,"d")}function Ic(a,b){b[ge]=u(1e3*("0."+a))}function Jc(){return this._isUTC?"UTC":""}function Kc(){return this._isUTC?"Coordinated Universal Time":""}function Lc(a){return sb(1e3*a)}function Mc(){return sb.apply(null,arguments).parseZone()}function Nc(a){return a}function Oc(a,b,c,d){var e=bb(),f=k().set(d,b);return e[c](f,a)}function Pc(a,b,c){if(f(a)&&(b=a,a=void 0),a=a||"",null!=b)return Oc(a,b,c,"month");var d,e=[];for(d=0;d<12;d++)e[d]=Oc(a,d,c,"month");return e}function Qc(a,b,c,d){"boolean"==typeof a?(f(b)&&(c=b,b=void 0),b=b||""):(b=a,c=b,a=!1,f(b)&&(c=b,b=void 0),b=b||"");var e=bb(),g=a?e._week.dow:0;if(null!=c)return Oc(b,(c+g)%7,d,"day");var h,i=[];for(h=0;h<7;h++)i[h]=Oc(b,(h+g)%7,d,"day");return i}function Rc(a,b){return Pc(a,b,"months")}function Sc(a,b){return Pc(a,b,"monthsShort")}function Tc(a,b,c){return Qc(a,b,c,"weekdays")}function Uc(a,b,c){return Qc(a,b,c,"weekdaysShort")}function Vc(a,b,c){return Qc(a,b,c,"weekdaysMin")}function Wc(){var a=this._data;return this._milliseconds=Ze(this._milliseconds),this._days=Ze(this._days),this._months=Ze(this._months),a.milliseconds=Ze(a.milliseconds),a.seconds=Ze(a.seconds),a.minutes=Ze(a.minutes),a.hours=Ze(a.hours),a.months=Ze(a.months),a.years=Ze(a.years),this}function Xc(a,b,c,d){var e=Ob(b,c);return a._milliseconds+=d*e._milliseconds,a._days+=d*e._days,a._months+=d*e._months,a._bubble()}function Yc(a,b){return Xc(this,a,b,1)}function Zc(a,b){return Xc(this,a,b,-1)}function $c(a){return a<0?Math.floor(a):Math.ceil(a)}function _c(){var a,b,c,d,e,f=this._milliseconds,g=this._days,h=this._months,i=this._data;return f>=0&&g>=0&&h>=0||f<=0&&g<=0&&h<=0||(f+=864e5*$c(bd(h)+g),g=0,h=0),i.milliseconds=f%1e3,a=t(f/1e3),i.seconds=a%60,b=t(a/60),i.minutes=b%60,c=t(b/60),i.hours=c%24,g+=t(c/24),e=t(ad(g)),h+=e,g-=$c(bd(e)),d=t(h/12),h%=12,i.days=g,i.months=h,i.years=d,this}function ad(a){return 4800*a/146097}function bd(a){return 146097*a/4800}function cd(a){var b,c,d=this._milliseconds;if(a=K(a),"month"===a||"year"===a)return b=this._days+d/864e5,c=this._months+ad(b),"month"===a?c:c/12;switch(b=this._days+Math.round(bd(this._months)),a){case"week":return b/7+d/6048e5;case"day":return b+d/864e5;case"hour":return 24*b+d/36e5;case"minute":return 1440*b+d/6e4;case"second":return 86400*b+d/1e3;case"millisecond":return Math.floor(864e5*b)+d;default:throw new Error("Unknown unit "+a)}}function dd(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*u(this._months/12)}function ed(a){return function(){return this.as(a)}}function fd(a){return a=K(a),this[a+"s"]()}function gd(a){return function(){return this._data[a]}}function hd(){return t(this.days()/7)}function id(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function jd(a,b,c){var d=Ob(a).abs(),e=of(d.as("s")),f=of(d.as("m")),g=of(d.as("h")),h=of(d.as("d")),i=of(d.as("M")),j=of(d.as("y")),k=e<pf.s&&["s",e]||f<=1&&["m"]||f<pf.m&&["mm",f]||g<=1&&["h"]||g<pf.h&&["hh",g]||h<=1&&["d"]||h<pf.d&&["dd",h]||i<=1&&["M"]||i<pf.M&&["MM",i]||j<=1&&["y"]||["yy",j];return k[2]=b,k[3]=+a>0,k[4]=c,id.apply(null,k)}function kd(a){return void 0===a?of:"function"==typeof a&&(of=a,!0)}function ld(a,b){return void 0!==pf[a]&&(void 0===b?pf[a]:(pf[a]=b,!0))}function md(a){var b=this.localeData(),c=jd(this,!a,b);return a&&(c=b.pastFuture(+this,c)),b.postformat(c)}function nd(){var a,b,c,d=qf(this._milliseconds)/1e3,e=qf(this._days),f=qf(this._months);a=t(d/60),b=t(a/60),d%=60,a%=60,c=t(f/12),f%=12;var g=c,h=f,i=e,j=b,k=a,l=d,m=this.asSeconds();return m?(m<0?"-":"")+"P"+(g?g+"Y":"")+(h?h+"M":"")+(i?i+"D":"")+(j||k||l?"T":"")+(j?j+"H":"")+(k?k+"M":"")+(l?l+"S":""):"P0D"}var od,pd;pd=Array.prototype.some?Array.prototype.some:function(a){for(var b=Object(this),c=b.length>>>0,d=0;d<c;d++)if(d in b&&a.call(this,b[d],d,b))return!0;return!1};var qd=pd,rd=a.momentProperties=[],sd=!1,td={};a.suppressDeprecationWarnings=!1,a.deprecationHandler=null;var ud;ud=Object.keys?Object.keys:function(a){var b,c=[];for(b in a)i(a,b)&&c.push(b);return c};var vd,wd=ud,xd={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},yd={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},zd="Invalid date",Ad="%d",Bd=/\d{1,2}/,Cd={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Dd={},Ed={},Fd=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Gd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Hd={},Id={},Jd=/\d/,Kd=/\d\d/,Ld=/\d{3}/,Md=/\d{4}/,Nd=/[+-]?\d{6}/,Od=/\d\d?/,Pd=/\d\d\d\d?/,Qd=/\d\d\d\d\d\d?/,Rd=/\d{1,3}/,Sd=/\d{1,4}/,Td=/[+-]?\d{1,6}/,Ud=/\d+/,Vd=/[+-]?\d+/,Wd=/Z|[+-]\d\d:?\d\d/gi,Xd=/Z|[+-]\d\d(?::?\d\d)?/gi,Yd=/[+-]?\d+(\.\d{1,3})?/,Zd=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,$d={},_d={},ae=0,be=1,ce=2,de=3,ee=4,fe=5,ge=6,he=7,ie=8;vd=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var b;for(b=0;b<this.length;++b)if(this[b]===a)return b;return-1};var je=vd;U("M",["MM",2],"Mo",function(){return this.month()+1}),U("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)}),U("MMMM",0,0,function(a){return this.localeData().months(this,a)}),J("month","M"),M("month",8),Z("M",Od),Z("MM",Od,Kd),Z("MMM",function(a,b){return b.monthsShortRegex(a)}),Z("MMMM",function(a,b){return b.monthsRegex(a)}),ba(["M","MM"],function(a,b){b[be]=u(a)-1}),ba(["MMM","MMMM"],function(a,b,c,d){var e=c._locale.monthsParse(a,d,c._strict);null!=e?b[be]=e:m(c).invalidMonth=a});var ke=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,le="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),me="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),ne=Zd,oe=Zd;U("Y",0,0,function(){var a=this.year();return a<=9999?""+a:"+"+a}),U(0,["YY",2],0,function(){return this.year()%100}),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),J("year","y"),M("year",1),Z("Y",Vd),Z("YY",Od,Kd),Z("YYYY",Sd,Md),Z("YYYYY",Td,Nd),Z("YYYYYY",Td,Nd),ba(["YYYYY","YYYYYY"],ae),ba("YYYY",function(b,c){c[ae]=2===b.length?a.parseTwoDigitYear(b):u(b)}),ba("YY",function(b,c){c[ae]=a.parseTwoDigitYear(b)}),ba("Y",function(a,b){b[ae]=parseInt(a,10)}),a.parseTwoDigitYear=function(a){return u(a)+(u(a)>68?1900:2e3)};var pe=O("FullYear",!0);U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),J("week","w"),J("isoWeek","W"),M("week",5),M("isoWeek",5),Z("w",Od),Z("ww",Od,Kd),Z("W",Od),Z("WW",Od,Kd),ca(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=u(a)});var qe={dow:0,doy:6};U("d",0,"do","day"),U("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)}),U("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)}),U("dddd",0,0,function(a){return this.localeData().weekdays(this,a)}),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),J("day","d"),J("weekday","e"),J("isoWeekday","E"),M("day",11),M("weekday",11),M("isoWeekday",11),Z("d",Od),Z("e",Od),Z("E",Od),Z("dd",function(a,b){return b.weekdaysMinRegex(a)}),Z("ddd",function(a,b){return b.weekdaysShortRegex(a)}),Z("dddd",function(a,b){return b.weekdaysRegex(a)}),ca(["dd","ddd","dddd"],function(a,b,c,d){var e=c._locale.weekdaysParse(a,d,c._strict);null!=e?b.d=e:m(c).invalidWeekday=a}),ca(["d","e","E"],function(a,b,c,d){b[d]=u(a)});var re="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),se="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),te="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),ue=Zd,ve=Zd,we=Zd;U("H",["HH",2],0,"hour"),U("h",["hh",2],0,Ra),U("k",["kk",2],0,Sa),U("hmm",0,0,function(){return""+Ra.apply(this)+T(this.minutes(),2)}),U("hmmss",0,0,function(){return""+Ra.apply(this)+T(this.minutes(),2)+T(this.seconds(),2)}),U("Hmm",0,0,function(){return""+this.hours()+T(this.minutes(),2)}),U("Hmmss",0,0,function(){return""+this.hours()+T(this.minutes(),2)+T(this.seconds(),2)}),Ta("a",!0),Ta("A",!1),J("hour","h"),M("hour",13),Z("a",Ua),Z("A",Ua),Z("H",Od),Z("h",Od),Z("HH",Od,Kd),Z("hh",Od,Kd),Z("hmm",Pd),Z("hmmss",Qd),Z("Hmm",Pd),Z("Hmmss",Qd),ba(["H","HH"],de),ba(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a),c._meridiem=a}),ba(["h","hh"],function(a,b,c){b[de]=u(a),m(c).bigHour=!0}),ba("hmm",function(a,b,c){var d=a.length-2;b[de]=u(a.substr(0,d)),b[ee]=u(a.substr(d)),m(c).bigHour=!0}),ba("hmmss",function(a,b,c){var d=a.length-4,e=a.length-2;b[de]=u(a.substr(0,d)),b[ee]=u(a.substr(d,2)),b[fe]=u(a.substr(e)),m(c).bigHour=!0}),ba("Hmm",function(a,b,c){var d=a.length-2;b[de]=u(a.substr(0,d)),b[ee]=u(a.substr(d))}),ba("Hmmss",function(a,b,c){var d=a.length-4,e=a.length-2;b[de]=u(a.substr(0,d)),b[ee]=u(a.substr(d,2)),b[fe]=u(a.substr(e))});var xe,ye=/[ap]\.?m?\.?/i,ze=O("Hours",!0),Ae={calendar:xd,longDateFormat:yd,invalidDate:zd,ordinal:Ad,ordinalParse:Bd,relativeTime:Cd,months:le,monthsShort:me,week:qe,weekdays:re,weekdaysMin:te,weekdaysShort:se,meridiemParse:ye},Be={},Ce={},De=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ee=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Fe=/Z|[+-]\d\d(?::?\d\d)?/,Ge=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],He=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Ie=/^\/?Date\((\-?\d+)/i;a.createFromInputFallback=x("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))}),a.ISO_8601=function(){};var Je=x("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=sb.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:o()}),Ke=x("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=sb.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:a:o()}),Le=function(){return Date.now?Date.now():+new Date};zb("Z",":"),zb("ZZ",""),Z("Z",Xd),Z("ZZ",Xd),ba(["Z","ZZ"],function(a,b,c){c._useUTC=!0,c._tzm=Ab(Xd,a)});var Me=/([\+\-]|\d\d)/gi;a.updateOffset=function(){};var Ne=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Oe=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Ob.fn=wb.prototype;var Pe=Sb(1,"add"),Qe=Sb(-1,"subtract");a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",a.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Re=x("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});U(0,["gg",2],0,function(){return this.weekYear()%100}),U(0,["GG",2],0,function(){return this.isoWeekYear()%100}),zc("gggg","weekYear"),zc("ggggg","weekYear"),zc("GGGG","isoWeekYear"),zc("GGGGG","isoWeekYear"),J("weekYear","gg"),J("isoWeekYear","GG"),M("weekYear",1),M("isoWeekYear",1),Z("G",Vd),Z("g",Vd),Z("GG",Od,Kd),Z("gg",Od,Kd),Z("GGGG",Sd,Md),Z("gggg",Sd,Md),Z("GGGGG",Td,Nd),Z("ggggg",Td,Nd),ca(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=u(a)}),ca(["gg","GG"],function(b,c,d,e){c[e]=a.parseTwoDigitYear(b)}),U("Q",0,"Qo","quarter"),J("quarter","Q"),M("quarter",7),Z("Q",Jd),ba("Q",function(a,b){b[be]=3*(u(a)-1)}),U("D",["DD",2],"Do","date"),J("date","D"),M("date",9),Z("D",Od),Z("DD",Od,Kd),Z("Do",function(a,b){return a?b._ordinalParse:b._ordinalParseLenient}),ba(["D","DD"],ce),ba("Do",function(a,b){b[ce]=u(a.match(Od)[0],10)});var Se=O("Date",!0);U("DDD",["DDDD",3],"DDDo","dayOfYear"),J("dayOfYear","DDD"),M("dayOfYear",4),Z("DDD",Rd),Z("DDDD",Ld),ba(["DDD","DDDD"],function(a,b,c){c._dayOfYear=u(a)}),U("m",["mm",2],0,"minute"),J("minute","m"),M("minute",14),Z("m",Od),Z("mm",Od,Kd),ba(["m","mm"],ee);var Te=O("Minutes",!1);U("s",["ss",2],0,"second"),J("second","s"),M("second",15),Z("s",Od),Z("ss",Od,Kd),ba(["s","ss"],fe);var Ue=O("Seconds",!1);U("S",0,0,function(){return~~(this.millisecond()/100)}),U(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,function(){return 10*this.millisecond()}),U(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),U(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),U(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),U(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),U(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),J("millisecond","ms"),M("millisecond",16),Z("S",Rd,Jd),Z("SS",Rd,Kd),Z("SSS",Rd,Ld);var Ve;for(Ve="SSSS";Ve.length<=9;Ve+="S")Z(Ve,Ud);for(Ve="S";Ve.length<=9;Ve+="S")ba(Ve,Ic);var We=O("Milliseconds",!1);U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var Xe=r.prototype;Xe.add=Pe,Xe.calendar=Vb,Xe.clone=Wb,Xe.diff=bc,Xe.endOf=oc,Xe.format=gc,Xe.from=hc,Xe.fromNow=ic,Xe.to=jc,Xe.toNow=kc,Xe.get=R,Xe.invalidAt=xc,Xe.isAfter=Xb,Xe.isBefore=Yb,Xe.isBetween=Zb,Xe.isSame=$b,Xe.isSameOrAfter=_b,Xe.isSameOrBefore=ac,Xe.isValid=vc,Xe.lang=Re,Xe.locale=lc,Xe.localeData=mc,Xe.max=Ke,Xe.min=Je,Xe.parsingFlags=wc,Xe.set=S,Xe.startOf=nc,Xe.subtract=Qe,Xe.toArray=sc,Xe.toObject=tc,Xe.toDate=rc,Xe.toISOString=ec,Xe.inspect=fc,Xe.toJSON=uc,Xe.toString=dc,Xe.unix=qc,Xe.valueOf=pc,Xe.creationData=yc,Xe.year=pe,Xe.isLeapYear=ra,Xe.weekYear=Ac,Xe.isoWeekYear=Bc,Xe.quarter=Xe.quarters=Gc,Xe.month=ka,Xe.daysInMonth=la,Xe.week=Xe.weeks=Ba,Xe.isoWeek=Xe.isoWeeks=Ca,Xe.weeksInYear=Dc,Xe.isoWeeksInYear=Cc,Xe.date=Se,Xe.day=Xe.days=Ka,Xe.weekday=La,Xe.isoWeekday=Ma,Xe.dayOfYear=Hc,Xe.hour=Xe.hours=ze,Xe.minute=Xe.minutes=Te,Xe.second=Xe.seconds=Ue,Xe.millisecond=Xe.milliseconds=We,Xe.utcOffset=Db,Xe.utc=Fb,Xe.local=Gb,Xe.parseZone=Hb,Xe.hasAlignedHourOffset=Ib,Xe.isDST=Jb,Xe.isLocal=Lb,Xe.isUtcOffset=Mb,Xe.isUtc=Nb,Xe.isUTC=Nb,Xe.zoneAbbr=Jc,Xe.zoneName=Kc,Xe.dates=x("dates accessor is deprecated. Use date instead.",Se),Xe.months=x("months accessor is deprecated. Use month instead",ka),Xe.years=x("years accessor is deprecated. Use year instead",pe),Xe.zone=x("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Eb),Xe.isDSTShifted=x("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Kb);var Ye=C.prototype;Ye.calendar=D,Ye.longDateFormat=E,Ye.invalidDate=F,Ye.ordinal=G,Ye.preparse=Nc,Ye.postformat=Nc,Ye.relativeTime=H,Ye.pastFuture=I,Ye.set=A,Ye.months=fa,Ye.monthsShort=ga,Ye.monthsParse=ia,Ye.monthsRegex=na,Ye.monthsShortRegex=ma,Ye.week=ya,Ye.firstDayOfYear=Aa,Ye.firstDayOfWeek=za,Ye.weekdays=Fa,Ye.weekdaysMin=Ha,Ye.weekdaysShort=Ga,Ye.weekdaysParse=Ja,Ye.weekdaysRegex=Na,Ye.weekdaysShortRegex=Oa,Ye.weekdaysMinRegex=Pa,Ye.isPM=Va,Ye.meridiem=Wa,$a("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10,c=1===u(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),a.lang=x("moment.lang is deprecated. Use moment.locale instead.",$a),a.langData=x("moment.langData is deprecated. Use moment.localeData instead.",bb);var Ze=Math.abs,$e=ed("ms"),_e=ed("s"),af=ed("m"),bf=ed("h"),cf=ed("d"),df=ed("w"),ef=ed("M"),ff=ed("y"),gf=gd("milliseconds"),hf=gd("seconds"),jf=gd("minutes"),kf=gd("hours"),lf=gd("days"),mf=gd("months"),nf=gd("years"),of=Math.round,pf={s:45,m:45,h:22,d:26,M:11},qf=Math.abs,rf=wb.prototype;return rf.abs=Wc,rf.add=Yc,rf.subtract=Zc,rf.as=cd,rf.asMilliseconds=$e,rf.asSeconds=_e,rf.asMinutes=af,rf.asHours=bf,rf.asDays=cf,rf.asWeeks=df,rf.asMonths=ef,rf.asYears=ff,rf.valueOf=dd,rf._bubble=_c,rf.get=fd,rf.milliseconds=gf,rf.seconds=hf,rf.minutes=jf,rf.hours=kf,rf.days=lf,rf.weeks=hd,rf.months=mf,rf.years=nf,rf.humanize=md,rf.toISOString=nd,rf.toString=nd,rf.toJSON=nd,rf.locale=lc,rf.localeData=mc,rf.toIsoString=x("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",nd),rf.lang=Re,U("X",0,0,"unix"),U("x",0,0,"valueOf"),Z("x",Vd),Z("X",Yd),ba("X",function(a,b,c){c._d=new Date(1e3*parseFloat(a,10))}),ba("x",function(a,b,c){c._d=new Date(u(a))}),a.version="2.17.1",b(sb),a.fn=Xe,a.min=ub,a.max=vb,a.now=Le,a.utc=k,a.unix=Lc,a.months=Rc,a.isDate=g,a.locale=$a,a.invalid=o,a.duration=Ob,a.isMoment=s,a.weekdays=Tc,a.parseZone=Mc,a.localeData=bb,a.isDuration=xb,a.monthsShort=Sc,a.weekdaysMin=Vc,a.defineLocale=_a,a.updateLocale=ab,a.locales=cb,a.weekdaysShort=Uc,a.normalizeUnits=K,a.relativeTimeRounding=kd,a.relativeTimeThreshold=ld,a.calendarFormat=Ub,a.prototype=Xe,a});(function(root,factory){if(typeof define==='function'&&define.amd){define(['moment','jquery'],function(moment,jquery){return(root.daterangepicker=factory(moment,jquery))})}else if(typeof module==='object'&&module.exports){var jQuery=(typeof window!='undefined')?window.jQuery:undefined;if(!jQuery){jQuery=require('jquery');if(!jQuery.fn)jQuery.fn={}}module.exports=factory(require('moment'),jQuery)}else{root.daterangepicker=factory(root.moment,root.jQuery)}}(this,function(moment,$){var DateRangePicker=function(element,options,cb){this.parentEl='body';this.element=$(element);this.startDate=moment().startOf('day');this.endDate=moment().endOf('day');this.minDate=false;this.maxDate=false;this.dateLimit=false;this.autoApply=false;this.singleDatePicker=false;this.showDropdowns=false;this.showWeekNumbers=false;this.showISOWeekNumbers=false;this.showCustomRangeLabel=true;this.timePicker=false;this.timePicker24Hour=false;this.timePickerIncrement=1;this.timePickerSeconds=false;this.linkedCalendars=true;this.autoUpdateInput=true;this.alwaysShowCalendars=false;this.ranges={};this.opens='right';if(this.element.hasClass('pull-right'))this.opens='left';this.drops='down';if(this.element.hasClass('dropup'))this.drops='up';this.buttonClasses='btn btn-sm';this.applyClass='btn-success';this.cancelClass='btn-default';this.locale={direction:'ltr',format:moment.localeData().longDateFormat('L'),separator:' - ',applyLabel:'Apply',cancelLabel:'Cancel',weekLabel:'W',customRangeLabel:'Custom Range',daysOfWeek:moment.weekdaysMin(),monthNames:moment.monthsShort(),firstDay:moment.localeData().firstDayOfWeek()};this.callback=function(){};this.isShowing=false;this.leftCalendar={};this.rightCalendar={};if(typeof options!=='object'||options===null)options={};options=$.extend(this.element.data(),options);if(typeof options.template!=='string'&&!(options.template instanceof $))options.template='<div class="daterangepicker dropdown-menu">'+'<div class="ranges">'+'</div>'+'<div class="calendar left">'+'<div class="daterangepicker_input">'+'<input class="input-mini form-control" type="text" name="daterangepicker_start" value="" />'+'<div class="calendar-time">'+'<span>'+s3.loc('JS_TIME')+'</span>'+'<div></div>'+'</div>'+'</div>'+'<div class="calendar-table"></div>'+'</div>'+'<div class="calendar right">'+'<div class="daterangepicker_input">'+'<input class="input-mini form-control" type="text" name="daterangepicker_end" value="" />'+'<i class="fa fa-calendar glyphicon glyphicon-calendar"></i>'+'<div class="calendar-time">'+'<div></div>'+'<i class="fa fa-clock-o glyphicon glyphicon-time"></i>'+'</div>'+'</div>'+'<div class="calendar-table"></div>'+'</div>'+'<div class="range_inputs">'+'<button class="applyBtn s3-btn green without-margin" disabled="disabled" type="button"></button> '+'<button class="cancelBtn s3-btn" type="button"></button>'+'</div>'+'</div>';this.parentEl=(options.parentEl&&$(options.parentEl).length)?$(options.parentEl):$(this.parentEl);this.container=$(options.template).appendTo(this.parentEl);if(typeof options.locale==='object'){if(typeof options.locale.direction==='string')this.locale.direction=options.locale.direction;if(typeof options.locale.format==='string')this.locale.format=options.locale.format;if(typeof options.locale.separator==='string')this.locale.separator=options.locale.separator;if(typeof options.locale.daysOfWeek==='object')this.locale.daysOfWeek=options.locale.daysOfWeek.slice();if(typeof options.locale.monthNames==='object')this.locale.monthNames=options.locale.monthNames.slice();if(typeof options.locale.firstDay==='number')this.locale.firstDay=options.locale.firstDay;if(typeof options.locale.applyLabel==='string')this.locale.applyLabel=options.locale.applyLabel;if(typeof options.locale.cancelLabel==='string')this.locale.cancelLabel=options.locale.cancelLabel;if(typeof options.locale.weekLabel==='string')this.locale.weekLabel=options.locale.weekLabel;if(typeof options.locale.customRangeLabel==='string'){var elem=document.createElement('textarea');elem.innerHTML=options.locale.customRangeLabel;var rangeHtml=elem.value;this.locale.customRangeLabel=rangeHtml}}this.container.addClass(this.locale.direction);if(typeof options.startDate==='string')this.startDate=moment(options.startDate,this.locale.format);if(typeof options.endDate==='string')this.endDate=moment(options.endDate,this.locale.format);if(typeof options.minDate==='string')this.minDate=moment(options.minDate,this.locale.format);if(typeof options.maxDate==='string')this.maxDate=moment(options.maxDate,this.locale.format);if(typeof options.startDate==='object')this.startDate=moment(options.startDate);if(typeof options.endDate==='object')this.endDate=moment(options.endDate);if(typeof options.minDate==='object')this.minDate=moment(options.minDate);if(typeof options.maxDate==='object')this.maxDate=moment(options.maxDate);if(this.minDate&&this.startDate.isBefore(this.minDate))this.startDate=this.minDate.clone();if(this.maxDate&&this.endDate.isAfter(this.maxDate))this.endDate=this.maxDate.clone();if(typeof options.applyClass==='string')this.applyClass=options.applyClass;if(typeof options.cancelClass==='string')this.cancelClass=options.cancelClass;if(typeof options.dateLimit==='object')this.dateLimit=options.dateLimit;if(typeof options.opens==='string')this.opens=options.opens;if(typeof options.drops==='string')this.drops=options.drops;if(typeof options.showWeekNumbers==='boolean')this.showWeekNumbers=options.showWeekNumbers;if(typeof options.showISOWeekNumbers==='boolean')this.showISOWeekNumbers=options.showISOWeekNumbers;if(typeof options.buttonClasses==='string')this.buttonClasses=options.buttonClasses;if(typeof options.buttonClasses==='object')this.buttonClasses=options.buttonClasses.join(' ');if(typeof options.showDropdowns==='boolean')this.showDropdowns=options.showDropdowns;if(typeof options.showCustomRangeLabel==='boolean')this.showCustomRangeLabel=options.showCustomRangeLabel;if(typeof options.singleDatePicker==='boolean'){this.singleDatePicker=options.singleDatePicker;if(this.singleDatePicker)this.endDate=this.startDate.clone()}if(typeof options.timePicker==='boolean')this.timePicker=options.timePicker;if(typeof options.timePickerSeconds==='boolean')this.timePickerSeconds=options.timePickerSeconds;if(typeof options.timePickerIncrement==='number')this.timePickerIncrement=options.timePickerIncrement;if(typeof options.timePicker24Hour==='boolean')this.timePicker24Hour=options.timePicker24Hour;if(typeof options.autoApply==='boolean')this.autoApply=options.autoApply;if(typeof options.autoUpdateInput==='boolean')this.autoUpdateInput=options.autoUpdateInput;if(typeof options.linkedCalendars==='boolean')this.linkedCalendars=options.linkedCalendars;if(typeof options.isInvalidDate==='function')this.isInvalidDate=options.isInvalidDate;if(typeof options.isCustomDate==='function')this.isCustomDate=options.isCustomDate;if(typeof options.alwaysShowCalendars==='boolean')this.alwaysShowCalendars=options.alwaysShowCalendars;if(this.locale.firstDay!=0){var iterator=this.locale.firstDay;while(iterator>0){this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift());iterator--}}var start,end,range;if(typeof options.startDate==='undefined'&&typeof options.endDate==='undefined'){if($(this.element).is('input[type=text]')){var val=$(this.element).val(),split=val.split(this.locale.separator);start=end=null;if(split.length==2){start=moment(split[0],this.locale.format);end=moment(split[1],this.locale.format)}else if(this.singleDatePicker&&val!==""){start=moment(val,this.locale.format);end=moment(val,this.locale.format)}if(start!==null&&end!==null){this.setStartDate(start);this.setEndDate(end)}}}if(typeof options.ranges==='object'){for(range in options.ranges){if(typeof options.ranges[range][0]==='string')start=moment(options.ranges[range][0],this.locale.format);else start=moment(options.ranges[range][0]);if(typeof options.ranges[range][1]==='string')end=moment(options.ranges[range][1],this.locale.format);else end=moment(options.ranges[range][1]);if(this.minDate&&start.isBefore(this.minDate))start=this.minDate.clone();var maxDate=this.maxDate;if(this.dateLimit&&maxDate&&start.clone().add(this.dateLimit).isAfter(maxDate))maxDate=start.clone().add(this.dateLimit);if(maxDate&&end.isAfter(maxDate))end=maxDate.clone();if((this.minDate&&end.isBefore(this.minDate,this.timepicker?'minute':'day'))||(maxDate&&start.isAfter(maxDate,this.timepicker?'minute':'day')))continue;var elem=document.createElement('textarea');elem.innerHTML=range;var rangeHtml=elem.value;this.ranges[rangeHtml]=[start,end]}var list='<ul>';for(range in this.ranges){list+='<li data-range-key="'+range+'">'+range+'</li>'}if(this.showCustomRangeLabel){list+='<li data-range-key="'+this.locale.customRangeLabel+'">'+this.locale.customRangeLabel+'</li>'}list+='</ul>';this.container.find('.ranges').prepend(list)}if(typeof cb==='function'){this.callback=cb}if(!this.timePicker){this.startDate=this.startDate.startOf('day');this.endDate=this.endDate.endOf('day');this.container.find('.calendar-time').hide()}if(this.timePicker&&this.autoApply)this.autoApply=false;if(this.autoApply&&typeof options.ranges!=='object'){this.container.find('.ranges').hide()}else if(this.autoApply){this.container.find('.applyBtn, .cancelBtn').addClass('hide')}if(this.singleDatePicker){this.container.addClass('single');this.container.find('.calendar.left').addClass('single');this.container.find('.calendar.left').show();this.container.find('.calendar.right').hide();this.container.find('.daterangepicker_input input, .daterangepicker_input > i').hide();if(this.timePicker){this.container.find('.ranges ul').hide()}else{this.container.find('.ranges').hide()}}if((typeof options.ranges==='undefined'&&!this.singleDatePicker)||this.alwaysShowCalendars){this.container.addClass('show-calendar')}this.container.addClass('opens'+this.opens);if(typeof options.ranges!=='undefined'&&this.opens=='right'){this.container.find('.ranges').prependTo(this.container.find('.calendar.left').parent())}this.container.find('.applyBtn, .cancelBtn').addClass(this.buttonClasses);if(this.applyClass.length)this.container.find('.applyBtn').addClass(this.applyClass);if(this.cancelClass.length)this.container.find('.cancelBtn').addClass(this.cancelClass);this.container.find('.applyBtn').html(this.locale.applyLabel);this.container.find('.cancelBtn').html(this.locale.cancelLabel);this.container.find('.calendar').on('click.daterangepicker','.prev',$.proxy(this.clickPrev,this)).on('click.daterangepicker','.next',$.proxy(this.clickNext,this)).on('mousedown.daterangepicker','td.available',$.proxy(this.clickDate,this)).on('mouseenter.daterangepicker','td.available',$.proxy(this.hoverDate,this)).on('mouseleave.daterangepicker','td.available',$.proxy(this.updateFormInputs,this)).on('change.daterangepicker','select.yearselect',$.proxy(this.monthOrYearChanged,this)).on('change.daterangepicker','select.monthselect',$.proxy(this.monthOrYearChanged,this)).on('change.daterangepicker','select.hourselect,select.minuteselect,select.secondselect,select.ampmselect',$.proxy(this.timeChanged,this)).on('click.daterangepicker','.daterangepicker_input input',$.proxy(this.showCalendars,this)).on('focus.daterangepicker','.daterangepicker_input input',$.proxy(this.formInputsFocused,this)).on('blur.daterangepicker','.daterangepicker_input input',$.proxy(this.formInputsBlurred,this)).on('change.daterangepicker','.daterangepicker_input input',$.proxy(this.formInputsChanged,this));this.container.find('.range_inputs').on('click.daterangepicker','button.applyBtn',$.proxy(this.clickApply,this)).on('click.daterangepicker','button.cancelBtn',$.proxy(this.clickCancel,this));this.container.find('.ranges').on('click.daterangepicker','li',$.proxy(this.clickRange,this)).on('mouseenter.daterangepicker','li',$.proxy(this.hoverRange,this)).on('mouseleave.daterangepicker','li',$.proxy(this.updateFormInputs,this));if(this.element.is('input')||this.element.is('button')){this.element.on({'click.daterangepicker':$.proxy(this.show,this),'focus.daterangepicker':$.proxy(this.show,this),'keyup.daterangepicker':$.proxy(this.elementChanged,this),'keydown.daterangepicker':$.proxy(this.keydown,this)})}else{this.element.on('click.daterangepicker',$.proxy(this.toggle,this))}if(this.element.is('input')&&!this.singleDatePicker&&this.autoUpdateInput){this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format));this.element.trigger('change')}else if(this.element.is('input')&&this.autoUpdateInput){this.element.val(this.startDate.format(this.locale.format));this.element.trigger('change')}};DateRangePicker.prototype={constructor:DateRangePicker,setStartDate:function(startDate){if(typeof startDate==='string')this.startDate=moment(startDate,this.locale.format);if(typeof startDate==='object')this.startDate=moment(startDate);if(!this.timePicker)this.startDate=this.startDate.startOf('day');if(this.timePicker&&this.timePickerIncrement)this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);if(this.minDate&&this.startDate.isBefore(this.minDate)){this.startDate=this.minDate.clone();if(this.timePicker&&this.timePickerIncrement)this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement)}if(this.maxDate&&this.startDate.isAfter(this.maxDate)){this.startDate=this.maxDate.clone();if(this.timePicker&&this.timePickerIncrement)this.startDate.minute(Math.floor(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement)}if(!this.isShowing)this.updateElement();this.updateMonthsInView()},setEndDate:function(endDate){if(typeof endDate==='string')this.endDate=moment(endDate,this.locale.format);if(typeof endDate==='object')this.endDate=moment(endDate);if(!this.timePicker)this.endDate=this.endDate.endOf('day');if(this.timePicker&&this.timePickerIncrement)this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);if(this.endDate.isBefore(this.startDate))this.endDate=this.startDate.clone();if(this.maxDate&&this.endDate.isAfter(this.maxDate))this.endDate=this.maxDate.clone();if(this.dateLimit&&this.startDate.clone().add(this.dateLimit).isBefore(this.endDate))this.endDate=this.startDate.clone().add(this.dateLimit);this.previousRightTime=this.endDate.clone();if(!this.isShowing)this.updateElement();this.updateMonthsInView()},isInvalidDate:function(){return false},isCustomDate:function(){return false},updateView:function(){if(this.timePicker){this.renderTimePicker('left');this.renderTimePicker('right');if(!this.endDate){this.container.find('.right .calendar-time select').attr('disabled','disabled').addClass('disabled')}else{this.container.find('.right .calendar-time select').removeAttr('disabled').removeClass('disabled')}}if(this.endDate){this.container.find('input[name="daterangepicker_end"]').removeClass('active');this.container.find('input[name="daterangepicker_start"]').addClass('active')}else{this.container.find('input[name="daterangepicker_end"]').addClass('active');this.container.find('input[name="daterangepicker_start"]').removeClass('active')}this.updateMonthsInView();this.updateCalendars();this.updateFormInputs()},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format('YYYY-MM')==this.leftCalendar.month.format('YYYY-MM')||this.startDate.format('YYYY-MM')==this.rightCalendar.month.format('YYYY-MM'))&&(this.endDate.format('YYYY-MM')==this.leftCalendar.month.format('YYYY-MM')||this.endDate.format('YYYY-MM')==this.rightCalendar.month.format('YYYY-MM'))){return}this.leftCalendar.month=this.startDate.clone().date(2);if(!this.linkedCalendars&&(this.endDate.month()!=this.startDate.month()||this.endDate.year()!=this.startDate.year())){this.rightCalendar.month=this.endDate.clone().date(2)}else{this.rightCalendar.month=this.startDate.clone().date(2).add(1,'month')}}else{if(this.leftCalendar.month.format('YYYY-MM')!=this.startDate.format('YYYY-MM')&&this.rightCalendar.month.format('YYYY-MM')!=this.startDate.format('YYYY-MM')){this.leftCalendar.month=this.startDate.clone().date(2);this.rightCalendar.month=this.startDate.clone().date(2).add(1,'month')}}if(this.maxDate&&this.linkedCalendars&&!this.singleDatePicker&&this.rightCalendar.month>this.maxDate){this.rightCalendar.month=this.maxDate.clone().date(2);this.leftCalendar.month=this.maxDate.clone().date(2).subtract(1,'month')}},updateCalendars:function(){if(this.timePicker){var hour,minute,second;if(this.endDate){hour=parseInt(this.container.find('.left .hourselect').val(),10);minute=parseInt(this.container.find('.left .minuteselect').val(),10);second=this.timePickerSeconds?parseInt(this.container.find('.left .secondselect').val(),10):0;if(!this.timePicker24Hour){var ampm=this.container.find('.left .ampmselect').val();if(ampm==='PM'&&hour<12)hour+=12;if(ampm==='AM'&&hour===12)hour=0}}else{hour=parseInt(this.container.find('.right .hourselect').val(),10);minute=parseInt(this.container.find('.right .minuteselect').val(),10);second=this.timePickerSeconds?parseInt(this.container.find('.right .secondselect').val(),10):0;if(!this.timePicker24Hour){var ampm=this.container.find('.right .ampmselect').val();if(ampm==='PM'&&hour<12)hour+=12;if(ampm==='AM'&&hour===12)hour=0}}this.leftCalendar.month.hour(hour).minute(minute).second(second);this.rightCalendar.month.hour(hour).minute(minute).second(second)}this.renderCalendar('left');this.renderCalendar('right');this.container.find('.ranges li').removeClass('active');if(this.endDate==null)return;this.calculateChosenLabel()},renderCalendar:function(side){var calendar=side=='left'?this.leftCalendar:this.rightCalendar;var month=calendar.month.month();var year=calendar.month.year();var hour=calendar.month.hour();var minute=calendar.month.minute();var second=calendar.month.second();var daysInMonth=moment([year,month]).daysInMonth();var firstDay=moment([year,month,1]);var lastDay=moment([year,month,daysInMonth]);var lastMonth=moment(firstDay).subtract(1,'month').month();var lastYear=moment(firstDay).subtract(1,'month').year();var daysInLastMonth=moment([lastYear,lastMonth]).daysInMonth();var dayOfWeek=firstDay.day();var calendar=[];calendar.firstDay=firstDay;calendar.lastDay=lastDay;for(var i=0;i<6;i++){calendar[i]=[]}var startDay=daysInLastMonth-dayOfWeek+this.locale.firstDay+1;if(startDay>daysInLastMonth)startDay-=7;if(dayOfWeek==this.locale.firstDay)startDay=daysInLastMonth-6;var curDate=moment([lastYear,lastMonth,startDay,12,minute,second]);var col,row;for(var i=0,col=0,row=0;i<42;i++,col++,curDate=moment(curDate).add(24,'hour')){if(i>0&&col%7===0){col=0;row++}calendar[row][col]=curDate.clone().hour(hour).minute(minute).second(second);curDate.hour(12);if(this.minDate&&calendar[row][col].format('YYYY-MM-DD')==this.minDate.format('YYYY-MM-DD')&&calendar[row][col].isBefore(this.minDate)&&side=='left'){calendar[row][col]=this.minDate.clone()}if(this.maxDate&&calendar[row][col].format('YYYY-MM-DD')==this.maxDate.format('YYYY-MM-DD')&&calendar[row][col].isAfter(this.maxDate)&&side=='right'){calendar[row][col]=this.maxDate.clone()}}if(side=='left'){this.leftCalendar.calendar=calendar}else{this.rightCalendar.calendar=calendar}var minDate=side=='left'?this.minDate:this.startDate;var maxDate=this.maxDate;var selected=side=='left'?this.startDate:this.endDate;var arrow=this.locale.direction=='ltr'?{left:'chevron-left',right:'chevron-right'}:{left:'chevron-right',right:'chevron-left'};var html='<table class="table-condensed">';html+='<thead>';html+='<tr>';if(this.showWeekNumbers||this.showISOWeekNumbers)html+='<th></th>';if((!minDate||minDate.isBefore(calendar.firstDay))&&(!this.linkedCalendars||side=='left')){html+='<th class="prev available"><i class="fa fa-'+arrow.left+' glyphicon glyphicon-'+arrow.left+'"></i></th>'}else{html+='<th></th>'}var dateHtml=this.locale.monthNames[calendar[1][1].month()]+calendar[1][1].format(" YYYY");if(this.showDropdowns){var currentMonth=calendar[1][1].month();var currentYear=calendar[1][1].year();var maxYear=(maxDate&&maxDate.year())||(currentYear+5);var minYear=(minDate&&minDate.year())||(currentYear-50);var inMinYear=currentYear==minYear;var inMaxYear=currentYear==maxYear;var monthHtml='<select class="monthselect">';for(var m=0;m<12;m++){if((!inMinYear||m>=minDate.month())&&(!inMaxYear||m<=maxDate.month())){monthHtml+="<option value='"+m+"'"+(m===currentMonth?" selected='selected'":"")+">"+this.locale.monthNames[m]+"</option>"}else{monthHtml+="<option value='"+m+"'"+(m===currentMonth?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[m]+"</option>"}}monthHtml+="</select>";var yearHtml='<select class="yearselect">';for(var y=minYear;y<=maxYear;y++){yearHtml+='<option value="'+y+'"'+(y===currentYear?' selected="selected"':'')+'>'+y+'</option>'}yearHtml+='</select>';dateHtml=monthHtml+yearHtml}html+='<th colspan="5" class="month">'+dateHtml+'</th>';if((!maxDate||maxDate.isAfter(calendar.lastDay))&&(!this.linkedCalendars||side=='right'||this.singleDatePicker)){html+='<th class="next available"><i class="fa fa-'+arrow.right+' glyphicon glyphicon-'+arrow.right+'"></i></th>'}else{html+='<th></th>'}html+='</tr>';html+='<tr>';if(this.showWeekNumbers||this.showISOWeekNumbers)html+='<th class="week">'+this.locale.weekLabel+'</th>';$.each(this.locale.daysOfWeek,function(index,dayOfWeek){html+='<th>'+dayOfWeek+'</th>'});html+='</tr>';html+='</thead>';html+='<tbody>';if(this.endDate==null&&this.dateLimit){var maxLimit=this.startDate.clone().add(this.dateLimit).endOf('day');if(!maxDate||maxLimit.isBefore(maxDate)){maxDate=maxLimit}}for(var row=0;row<6;row++){html+='<tr>';if(this.showWeekNumbers)html+='<td class="week">'+calendar[row][0].week()+'</td>';else if(this.showISOWeekNumbers)html+='<td class="week">'+calendar[row][0].isoWeek()+'</td>';for(var col=0;col<7;col++){var classes=[];if(calendar[row][col].isSame(new Date(),"day"))classes.push('today');if(calendar[row][col].isoWeekday()>5)classes.push('weekend');if(calendar[row][col].month()!=calendar[1][1].month())classes.push('off');if(this.minDate&&calendar[row][col].isBefore(this.minDate,'day'))classes.push('off','disabled');if(maxDate&&calendar[row][col].isAfter(maxDate,'day'))classes.push('off','disabled');if(this.isInvalidDate(calendar[row][col]))classes.push('off','disabled');if(calendar[row][col].format('YYYY-MM-DD')==this.startDate.format('YYYY-MM-DD'))classes.push('active','start-date');if(this.endDate!=null&&calendar[row][col].format('YYYY-MM-DD')==this.endDate.format('YYYY-MM-DD'))classes.push('active','end-date');if(this.endDate!=null&&calendar[row][col]>this.startDate&&calendar[row][col]<this.endDate)classes.push('in-range');var isCustom=this.isCustomDate(calendar[row][col]);if(isCustom!==false){if(typeof isCustom==='string')classes.push(isCustom);else Array.prototype.push.apply(classes,isCustom)}var cname='',disabled=false;for(var i=0;i<classes.length;i++){cname+=classes[i]+' ';if(classes[i]=='disabled')disabled=true}if(!disabled)cname+='available';html+='<td class="'+cname.replace(/^\s+|\s+$/g,'')+'" data-title="'+'r'+row+'c'+col+'">'+calendar[row][col].date()+'</td>'}html+='</tr>'}html+='</tbody>';html+='</table>';this.container.find('.calendar.'+side+' .calendar-table').html(html)},renderTimePicker:function(side){if(side=='right'&&!this.endDate)return;var html,selected,minDate,maxDate=this.maxDate;if(this.dateLimit&&(!this.maxDate||this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)))maxDate=this.startDate.clone().add(this.dateLimit);if(side=='left'){selected=this.startDate.clone();minDate=this.minDate}else if(side=='right'){selected=this.endDate.clone();minDate=this.startDate;var timeSelector=this.container.find('.calendar.right .calendar-time div');if(timeSelector.html()!=''){selected.hour(timeSelector.find('.hourselect option:selected').val()||selected.hour());selected.minute(timeSelector.find('.minuteselect option:selected').val()||selected.minute());selected.second(timeSelector.find('.secondselect option:selected').val()||selected.second());if(!this.timePicker24Hour){var ampm=timeSelector.find('.ampmselect option:selected').val();if(ampm==='PM'&&selected.hour()<12)selected.hour(selected.hour()+12);if(ampm==='AM'&&selected.hour()===12)selected.hour(0)}}if(selected.isBefore(this.startDate))selected=this.startDate.clone();if(maxDate&&selected.isAfter(maxDate))selected=maxDate.clone()}html='<select class="hourselect">';var start=this.timePicker24Hour?0:1;var end=this.timePicker24Hour?23:12;for(var i=start;i<=end;i++){var display_hour=i<10?'0'+i:i;var i_in_24=i;if(!this.timePicker24Hour){i_in_24=selected.hour()>=12?(i==12?12:i+12):(i==12?0:i);display_hour=i_in_24<10?'0'+i_in_24:i_in_24}var time=selected.clone().hour(i_in_24);var disabled=false;if(minDate&&time.minute(59).isBefore(minDate))disabled=true;if(maxDate&&time.minute(0).isAfter(maxDate))disabled=true;if(i_in_24==selected.hour()&&!disabled){html+='<option value="'+i+'" selected="selected">'+display_hour+'</option>'}else if(disabled){html+='<option value="'+i+'" disabled="disabled" class="disabled">'+display_hour+'</option>'}else{html+='<option value="'+i+'">'+display_hour+'</option>'}}html+='</select> ';html+=': <select class="minuteselect">';for(var i=0;i<60;i+=this.timePickerIncrement){var padded=i<10?'0'+i:i;var time=selected.clone().minute(i);var disabled=false;if(minDate&&time.second(59).isBefore(minDate))disabled=true;if(maxDate&&time.second(0).isAfter(maxDate))disabled=true;if(selected.minute()==i&&!disabled){html+='<option value="'+i+'" selected="selected">'+padded+'</option>'}else if(disabled){html+='<option value="'+i+'" disabled="disabled" class="disabled">'+padded+'</option>'}else{html+='<option value="'+i+'">'+padded+'</option>'}}html+='</select> ';if(this.timePickerSeconds){html+=': <select class="secondselect">';for(var i=0;i<60;i++){var padded=i<10?'0'+i:i;var time=selected.clone().second(i);var disabled=false;if(minDate&&time.isBefore(minDate))disabled=true;if(maxDate&&time.isAfter(maxDate))disabled=true;if(selected.second()==i&&!disabled){html+='<option value="'+i+'" selected="selected">'+padded+'</option>'}else if(disabled){html+='<option value="'+i+'" disabled="disabled" class="disabled">'+padded+'</option>'}else{html+='<option value="'+i+'">'+padded+'</option>'}}html+='</select> '}if(!this.timePicker24Hour){html+='<select class="ampmselect">';var am_html='';var pm_html='';if(minDate&&selected.clone().hour(12).minute(0).second(0).isBefore(minDate))am_html=' disabled="disabled" class="disabled"';if(maxDate&&selected.clone().hour(0).minute(0).second(0).isAfter(maxDate))pm_html=' disabled="disabled" class="disabled"';if(selected.hour()>=12){html+='<option value="AM"'+am_html+'>AM</option><option value="PM" selected="selected"'+pm_html+'>PM</option>'}else{html+='<option value="AM" selected="selected"'+am_html+'>AM</option><option value="PM"'+pm_html+'>PM</option>'}html+='</select>'}this.container.find('.calendar.'+side+' .calendar-time div').html(html)},updateFormInputs:function(){if(this.container.find('input[name=daterangepicker_start]').is(":focus")||this.container.find('input[name=daterangepicker_end]').is(":focus"))return;this.container.find('input[name=daterangepicker_start]').val(this.startDate.format(this.locale.format));if(this.endDate)this.container.find('input[name=daterangepicker_end]').val(this.endDate.format(this.locale.format));if(this.singleDatePicker||(this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate)))){this.container.find('button.applyBtn').removeAttr('disabled')}else{this.container.find('button.applyBtn').attr('disabled','disabled')}},move:function(){var parentOffset={top:0,left:0},containerTop;var parentRightEdge=$(window).width();if(!this.parentEl.is('body')){parentOffset={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()};parentRightEdge=this.parentEl[0].clientWidth+this.parentEl.offset().left}if(this.drops=='up')containerTop=this.element.offset().top-this.container.outerHeight()-parentOffset.top;else containerTop=this.element.offset().top+this.element.outerHeight()-parentOffset.top;this.container[this.drops=='up'?'addClass':'removeClass']('dropup');if(this.opens=='left'){this.container.css({top:containerTop,right:parentRightEdge-this.element.offset().left-this.element.outerWidth(),left:'auto'});if(this.container.offset().left<0){this.container.css({right:'auto',left:9})}}else if(this.opens=='center'){this.container.css({top:containerTop,left:this.element.offset().left-parentOffset.left+this.element.outerWidth()/2-this.container.outerWidth()/2,right:'auto'});if(this.container.offset().left<0){this.container.css({right:'auto',left:9})}}else{this.container.css({top:containerTop,left:this.element.offset().left-parentOffset.left,right:'auto'});if(this.container.offset().left+this.container.outerWidth()>$(window).width()){this.container.css({left:'auto',right:0})}}},show:function(e){if(this.isShowing)return;if(this.startDate.isValid()==false){this.startDate=moment()}if(this.endDate.isValid()==false){this.endDate=moment()}this._outsideClickProxy=$.proxy(function(e){this.outsideClick(e)},this);$(document).on('mousedown.daterangepicker',this._outsideClickProxy).on('touchend.daterangepicker',this._outsideClickProxy).on('click.daterangepicker','[data-toggle=dropdown]',this._outsideClickProxy).on('focusin.daterangepicker',this._outsideClickProxy);$(window).on('resize.daterangepicker',$.proxy(function(e){this.move(e)},this));this.oldStartDate=this.startDate.clone();this.oldEndDate=this.endDate.clone();this.previousRightTime=this.endDate.clone();this.updateView();this.container.show();this.move();this.element.trigger('show.daterangepicker',this);this.isShowing=true},hide:function(e){if(!this.isShowing)return;if(!this.endDate){this.startDate=this.oldStartDate.clone();this.endDate=this.oldEndDate.clone()}if(!this.startDate.isSame(this.oldStartDate)||!this.endDate.isSame(this.oldEndDate))this.callback(this.startDate,this.endDate,this.chosenLabel);this.updateElement();$(document).off('.daterangepicker');$(window).off('.daterangepicker');this.container.hide();this.element.trigger('hide.daterangepicker',this);this.isShowing=false},toggle:function(e){if(this.isShowing){this.hide()}else{this.show()}},outsideClick:function(e){var target=$(e.target);if(e.type=="focusin"||target.closest(this.element).length||target.closest(this.container).length||target.closest('.calendar-table').length)return;this.hide();this.element.trigger('outsideClick.daterangepicker',this)},showCalendars:function(){this.container.addClass('show-calendar');this.move();this.element.trigger('showCalendar.daterangepicker',this)},hideCalendars:function(){this.container.removeClass('show-calendar');this.element.trigger('hideCalendar.daterangepicker',this)},hoverRange:function(e){if(this.container.find('input[name=daterangepicker_start]').is(":focus")||this.container.find('input[name=daterangepicker_end]').is(":focus"))return;var label=e.target.getAttribute('data-range-key');if(label==this.locale.customRangeLabel){this.updateView()}else{var dates=this.ranges[label];this.container.find('input[name=daterangepicker_start]').val(dates[0].format(this.locale.format));this.container.find('input[name=daterangepicker_end]').val(dates[1].format(this.locale.format))}},clickRange:function(e){var label=e.target.getAttribute('data-range-key');this.chosenLabel=label;if(label==this.locale.customRangeLabel){this.showCalendars()}else{var dates=this.ranges[label];this.startDate=dates[0];this.endDate=dates[1];if(!this.timePicker){this.startDate.startOf('day');this.endDate.endOf('day')}if(!this.alwaysShowCalendars)this.hideCalendars();this.clickApply()}},clickPrev:function(e){var cal=$(e.target).parents('.calendar');if(cal.hasClass('left')){this.leftCalendar.month.subtract(1,'month');if(this.linkedCalendars)this.rightCalendar.month.subtract(1,'month')}else{this.rightCalendar.month.subtract(1,'month')}this.updateCalendars()},clickNext:function(e){var cal=$(e.target).parents('.calendar');if(cal.hasClass('left')){this.leftCalendar.month.add(1,'month')}else{this.rightCalendar.month.add(1,'month');if(this.linkedCalendars)this.leftCalendar.month.add(1,'month')}this.updateCalendars()},hoverDate:function(e){if(!$(e.target).hasClass('available'))return;var title=$(e.target).attr('data-title');var row=title.substr(1,1);var col=title.substr(3,1);var cal=$(e.target).parents('.calendar');var date=cal.hasClass('left')?this.leftCalendar.calendar[row][col]:this.rightCalendar.calendar[row][col];if(this.endDate&&!this.container.find('input[name=daterangepicker_start]').is(":focus")){this.container.find('input[name=daterangepicker_start]').val(date.format(this.locale.format))}else if(!this.endDate&&!this.container.find('input[name=daterangepicker_end]').is(":focus")){this.container.find('input[name=daterangepicker_end]').val(date.format(this.locale.format))}var leftCalendar=this.leftCalendar;var rightCalendar=this.rightCalendar;var startDate=this.startDate;if(!this.endDate){this.container.find('.calendar tbody td').each(function(index,el){if($(el).hasClass('week'))return;var title=$(el).attr('data-title');var row=title.substr(1,1);var col=title.substr(3,1);var cal=$(el).parents('.calendar');var dt=cal.hasClass('left')?leftCalendar.calendar[row][col]:rightCalendar.calendar[row][col];if((dt.isAfter(startDate)&&dt.isBefore(date))||dt.isSame(date,'day')){$(el).addClass('in-range')}else{$(el).removeClass('in-range')}})}},clickDate:function(e){if(!$(e.target).hasClass('available'))return;var title=$(e.target).attr('data-title');var row=title.substr(1,1);var col=title.substr(3,1);var cal=$(e.target).parents('.calendar');var date=cal.hasClass('left')?this.leftCalendar.calendar[row][col]:this.rightCalendar.calendar[row][col];if(this.endDate||date.isBefore(this.startDate,'day')){if(this.timePicker){var hour=parseInt(this.container.find('.left .hourselect').val(),10);if(!this.timePicker24Hour){var ampm=this.container.find('.left .ampmselect').val();if(ampm==='PM'&&hour<12)hour+=12;if(ampm==='AM'&&hour===12)hour=0}var minute=parseInt(this.container.find('.left .minuteselect').val(),10);var second=this.timePickerSeconds?parseInt(this.container.find('.left .secondselect').val(),10):0;date=date.clone().hour(hour).minute(minute).second(second)}this.endDate=null;this.setStartDate(date.clone())}else if(!this.endDate&&date.isBefore(this.startDate)){this.setEndDate(this.startDate.clone())}else{if(this.timePicker){var hour=parseInt(this.container.find('.right .hourselect').val(),10);if(!this.timePicker24Hour){var ampm=this.container.find('.right .ampmselect').val();if(ampm==='PM'&&hour<12)hour+=12;if(ampm==='AM'&&hour===12)hour=0}var minute=parseInt(this.container.find('.right .minuteselect').val(),10);var second=this.timePickerSeconds?parseInt(this.container.find('.right .secondselect').val(),10):0;date=date.clone().hour(hour).minute(minute).second(second)}this.setEndDate(date.clone());if(this.autoApply){this.calculateChosenLabel();this.clickApply()}}if(this.singleDatePicker){this.setEndDate(this.startDate);if(!this.timePicker)this.clickApply()}this.updateView();e.stopPropagation()},calculateChosenLabel:function(){var customRange=true;var i=0;for(var range in this.ranges){if(this.timePicker){if(this.startDate.isSame(this.ranges[range][0])&&this.endDate.isSame(this.ranges[range][1])){customRange=false;this.chosenLabel=this.container.find('.ranges li:eq('+i+')').addClass('active').html();break}}else{if(this.startDate.format('YYYY-MM-DD')==this.ranges[range][0].format('YYYY-MM-DD')&&this.endDate.format('YYYY-MM-DD')==this.ranges[range][1].format('YYYY-MM-DD')){customRange=false;this.chosenLabel=this.container.find('.ranges li:eq('+i+')').addClass('active').html();break}}i++}if(customRange){if(this.showCustomRangeLabel){this.chosenLabel=this.container.find('.ranges li:last').addClass('active').html()}else{this.chosenLabel=null}this.showCalendars()}},clickApply:function(e){this.hide();this.element.trigger('apply.daterangepicker',this)},clickCancel:function(e){this.startDate=this.oldStartDate;this.endDate=this.oldEndDate;this.hide();this.element.trigger('cancel.daterangepicker',this)},monthOrYearChanged:function(e){var isLeft=$(e.target).closest('.calendar').hasClass('left'),leftOrRight=isLeft?'left':'right',cal=this.container.find('.calendar.'+leftOrRight);var month=parseInt(cal.find('.monthselect').val(),10);var year=cal.find('.yearselect').val();if(!isLeft){if(year<this.startDate.year()||(year==this.startDate.year()&&month<this.startDate.month())){month=this.startDate.month();year=this.startDate.year()}}if(this.minDate){if(year<this.minDate.year()||(year==this.minDate.year()&&month<this.minDate.month())){month=this.minDate.month();year=this.minDate.year()}}if(this.maxDate){if(year>this.maxDate.year()||(year==this.maxDate.year()&&month>this.maxDate.month())){month=this.maxDate.month();year=this.maxDate.year()}}if(isLeft){this.leftCalendar.month.month(month).year(year);if(this.linkedCalendars)this.rightCalendar.month=this.leftCalendar.month.clone().add(1,'month')}else{this.rightCalendar.month.month(month).year(year);if(this.linkedCalendars)this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,'month')}this.updateCalendars()},timeChanged:function(e){var cal=$(e.target).closest('.calendar'),isLeft=cal.hasClass('left');var hour=parseInt(cal.find('.hourselect').val(),10);var minute=parseInt(cal.find('.minuteselect').val(),10);var second=this.timePickerSeconds?parseInt(cal.find('.secondselect').val(),10):0;if(!this.timePicker24Hour){var ampm=cal.find('.ampmselect').val();if(ampm==='PM'&&hour<12)hour+=12;if(ampm==='AM'&&hour===12)hour=0}if(isLeft){var start=this.startDate.clone();start.hour(hour);start.minute(minute);start.second(second);this.setStartDate(start);if(this.singleDatePicker){this.endDate=this.startDate.clone()}else if(this.endDate&&this.endDate.format('YYYY-MM-DD')==start.format('YYYY-MM-DD')&&this.endDate.isBefore(start)){this.setEndDate(start.clone())}}else if(this.endDate){var end=this.endDate.clone();end.hour(hour);end.minute(minute);end.second(second);this.setEndDate(end)}this.updateCalendars();this.updateFormInputs();this.renderTimePicker('left');this.renderTimePicker('right')},formInputsChanged:function(e){var isRight=$(e.target).closest('.calendar').hasClass('right');var start=moment(this.container.find('input[name="daterangepicker_start"]').val(),this.locale.format);var end=moment(this.container.find('input[name="daterangepicker_end"]').val(),this.locale.format);if(start.isValid()&&end.isValid()){if(isRight&&end.isBefore(start))start=end.clone();this.setStartDate(start);this.setEndDate(end);if(isRight){this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format))}else{this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format))}}else{return false}this.updateView()},formInputsFocused:function(e){this.container.find('input[name="daterangepicker_start"], input[name="daterangepicker_end"]').removeClass('active');$(e.target).addClass('active');var isRight=$(e.target).closest('.calendar').hasClass('right');if(isRight){this.endDate=null;this.setStartDate(this.startDate.clone());this.updateView()}},formInputsBlurred:function(e){if(!this.endDate){var val=this.container.find('input[name="daterangepicker_end"]').val();var end=moment(val,this.locale.format);if(end.isValid()){this.setEndDate(end);this.updateView()}}},elementChanged:function(){if(!this.element.is('input'))return;if(!this.element.val().length)return;if(this.element.val().length<this.locale.format.length)return;var dateString=this.element.val().split(this.locale.separator),start=null,end=null;if(dateString.length===2){start=moment(dateString[0],this.locale.format);end=moment(dateString[1],this.locale.format)}if(this.singleDatePicker||start===null||end===null){start=moment(this.element.val(),this.locale.format);end=start}if(!start.isValid()||!end.isValid())return;this.setStartDate(start);this.setEndDate(end);this.updateView()},keydown:function(e){if((e.keyCode===9)||(e.keyCode===13)){this.hide()}},updateElement:function(){if(this.element.is('input')&&!this.singleDatePicker&&this.autoUpdateInput){this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format));this.element.trigger('change')}else if(this.element.is('input')&&this.autoUpdateInput){this.element.val(this.startDate.format(this.locale.format));this.element.trigger('change')}},remove:function(){this.container.remove();this.element.off('.daterangepicker');this.element.removeData()}};$.fn.daterangepicker=function(options,callback){this.each(function(){var el=$(this);if(el.data('daterangepicker'))el.data('daterangepicker').remove();el.data('daterangepicker',new DateRangePicker(el,options,callback))});return this};return DateRangePicker}));(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(require('jquery')):typeof define==='function'&&define.amd?define('jquery.suggestions.js',['jquery'],factory):(factory(global.$))}(this,(function($){'use strict';$='default'in $?$['default']:$;var KEYS={ENTER:13,ESC:27,TAB:9,SPACE:32,UP:38,DOWN:40};var EVENT_NS='.suggestions';var DATA_ATTR_KEY='suggestions';var WORD_DELIMITERS='\\s"\'~\\*\\.,:\\|\\[\\]\\(\\)\\{\\}<>№';var WORD_SPLITTER=new RegExp('['+WORD_DELIMITERS+']+','g');var WORD_PARTS_DELIMITERS='\\-\\+\\/\\\\\\?!@#$%^&';var WORD_PARTS_SPLITTER=new RegExp('['+WORD_PARTS_DELIMITERS+']+','g');var utils=(function(){var uniqueId=0;return{escapeRegExChars:function(value){return value.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},escapeHtml:function(str){var map={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#x27;','/':'&#x2F;'};if(str){$.each(map,function(ch,html){str=str.replace(new RegExp(ch,'g'),html)})}return str},getDefaultType:function(){return($.support.cors?'POST':'GET')},getDefaultContentType:function(){return($.support.cors?'application/json':'application/x-www-form-urlencoded')},fixURLProtocol:function(url){return $.support.cors?url:url.replace(/^https?:/,location.protocol)},addUrlParams:function(url,params){return url+(/\?/.test(url)?'&':'?')+$.param(params)},serialize:function(data){if($.support.cors){return JSON.stringify(data,function(key,value){return value===null?undefined:value})}else{return $.param(data,true)}},compact:function(array){return $.grep(array,function(el){return!!el})},delay:function(handler,delay){return setTimeout(handler,delay||0)},uniqueId:function(prefix){return(prefix||'')+ ++uniqueId},slice:function(obj,start){return Array.prototype.slice.call(obj,start)},indexBy:function(data,field,indexField){var result={};$.each(data,function(i,obj){var key=obj[field],val={};if(indexField){val[indexField]=i}result[key]=$.extend(true,val,obj)});return result},areSame:function self(a,b){var same=true;if(typeof a!=typeof b){return false}if(typeof a=='object'&&a!=null&&b!=null){$.each(a,function(i,value){return same=self(value,b[i])});return same}return a===b},arrayMinus:function(array1,array2){return array2?$.grep(array1,function(el,i){return $.inArray(el,array2)===-1}):array1},arrayMinusWithPartialMatching:function(array1,array2){return array2?$.grep(array1,function(el,i){return!array2.some(function(el2){return el2.indexOf(el)===0})}):array1},arraysIntersection:function(array1,array2){var result=[];if(!$.isArray(array1)||!$.isArray(array2)){return result}$.each(array1,function(index,item){if($.inArray(item,array2)>=0){result.push(item)}});return result},getWords:function(str,stopwords){str=str.replace(/(\d+)([а-яА-ЯёЁ]{2,})/g,'$1 $2').replace(/([а-яА-ЯёЁ]+)(\d+)/g,'$1 $2');var words=this.compact(str.split(WORD_SPLITTER)),lastWord=words.pop(),goodWords=this.arrayMinus(words,stopwords);goodWords.push(lastWord);return goodWords},normalize:function(str,stopwords){var that=this;return that.getWords(str,stopwords).join(' ')},stringEncloses:function(str1,str2){return str1.length>str2.length&&str1.indexOf(str2)!==-1},fieldsNotEmpty:function(obj,fields){if(!$.isPlainObject(obj)){return false}var result=true;$.each(fields,function(i,field){return result=!!(obj[field])});return result},getDeepValue:function self(obj,name){var path=name.split('.'),step=path.shift();return obj&&(path.length?self(obj[step],path.join('.')):obj[step])},reWordExtractor:function(){return new RegExp('([^'+WORD_DELIMITERS+']*)(['+WORD_DELIMITERS+']*)','g')},formatToken:function(token){return token&&token.toLowerCase().replace(/[ёЁ]/g,'е')},withSubTokens:function(tokens){var result=[];$.each(tokens,function(i,token){var subtokens=token.split(WORD_PARTS_SPLITTER);result.push(token);if(subtokens.length>1){result=result.concat(utils.compact(subtokens))}});return result},objectKeys:function(obj){if(Object.keys){return Object.keys(obj)}var keys=[];$.each(obj,function(name){keys.push(name)});return keys}}}());var matchers=function(){function sameParentChecker(preprocessFn){return function(suggestions){if(suggestions.length===0){return false}if(suggestions.length===1){return true}var parentValue=preprocessFn(suggestions[0].value),aliens=$.grep(suggestions,function(suggestion){return preprocessFn(suggestion.value).indexOf(parentValue)===0},true);return aliens.length===0}}var haveSameParent=sameParentChecker(function(val){return val});var haveSameParentAddress=sameParentChecker(function(val){return val.replace(/, (?:д|вл|двлд|к) .+$/,'')});return{matchByNormalizedQuery:function(query,suggestions){var queryLowerCase=query.toLowerCase(),stopwords=this&&this.stopwords,normalizedQuery=utils.normalize(queryLowerCase,stopwords),matches=[];$.each(suggestions,function(i,suggestion){var suggestedValue=suggestion.value.toLowerCase();if(utils.stringEncloses(queryLowerCase,suggestedValue)){return false}if(suggestedValue.indexOf(normalizedQuery)>0){return false}if(normalizedQuery===utils.normalize(suggestedValue,stopwords)){matches.push(i)}});return matches.length===1?matches[0]:-1},matchByWords:function(query,suggestions){var stopwords=this&&this.stopwords,queryLowerCase=query.toLowerCase(),queryTokens,matches=[];if(haveSameParent(suggestions)){queryTokens=utils.withSubTokens(utils.getWords(queryLowerCase,stopwords));$.each(suggestions,function(i,suggestion){var suggestedValue=suggestion.value.toLowerCase();if(utils.stringEncloses(queryLowerCase,suggestedValue)){return false}var suggestionWords=utils.withSubTokens(utils.getWords(suggestedValue,stopwords));if(utils.arrayMinus(queryTokens,suggestionWords).length===0){matches.push(i)}})}return matches.length===1?matches[0]:-1},matchByWordsAddress:function(query,suggestions){var stopwords=this&&this.stopwords,queryLowerCase=query.toLowerCase(),queryTokens,index=-1;if(haveSameParentAddress(suggestions)){queryTokens=utils.withSubTokens(utils.getWords(queryLowerCase,stopwords));$.each(suggestions,function(i,suggestion){var suggestedValue=suggestion.value.toLowerCase();if(utils.stringEncloses(queryLowerCase,suggestedValue)){return false}var suggestionWords=utils.withSubTokens(utils.getWords(suggestedValue,stopwords));if(utils.arrayMinus(queryTokens,suggestionWords).length===0){index=i;return false}})}return index},matchByFields:function(query,suggestions){var stopwords=this&&this.stopwords,fieldsStopwords=this&&this.fieldsStopwords,tokens=utils.withSubTokens(utils.getWords(query.toLowerCase(),stopwords)),suggestionWords=[];if(suggestions.length===1){if(fieldsStopwords){$.each(fieldsStopwords,function(field,stopwords){var fieldValue=utils.getDeepValue(suggestions[0],field),fieldWords=fieldValue&&utils.withSubTokens(utils.getWords(fieldValue.toLowerCase(),stopwords));if(fieldWords&&fieldWords.length){suggestionWords=suggestionWords.concat(fieldWords)}})}if(utils.arrayMinusWithPartialMatching(tokens,suggestionWords).length===0){return 0}}return-1}}}();var DEFAULT_OPTIONS={autoSelectFirst:false,serviceUrl:'https://suggestions.dadata.ru/suggestions/api/4_1/rs',onSearchStart:$.noop,onSearchComplete:$.noop,onSearchError:$.noop,onSuggestionsFetch:null,onSelect:null,onSelectNothing:null,onInvalidateSelection:null,minChars:1,deferRequestBy:100,params:{},paramName:'query',timeout:3000,formatResult:null,formatSelected:null,noCache:false,containerClass:'suggestions-suggestions',tabDisabled:false,triggerSelectOnSpace:false,triggerSelectOnEnter:true,triggerSelectOnBlur:true,preventBadQueries:false,hint:'Выберите вариант или продолжите ввод',type:null,requestMode:'suggest',count:5,$helpers:null,headers:null,scrollOnFocus:true,mobileWidth:980,initializeInterval:100};var ADDRESS_STOPWORDS=['ао','аобл','дом','респ','а/я','аал','автодорога','аллея','арбан','аул','б-р','берег','бугор','вал','вл','волость','въезд','высел','г','городок','гск','д','двлд','днп','дор','дп','ж/д_будка','ж/д_казарм','ж/д_оп','ж/д_платф','ж/д_пост','ж/д_рзд','ж/д_ст','жилзона','жилрайон','жт','заезд','заимка','зона','к','казарма','канал','кв','кв-л','км','кольцо','комн','кордон','коса','кп','край','линия','лпх','м','массив','местность','мкр','мост','н/п','наб','нп','обл','округ','остров','оф','п','п/о','п/р','п/ст','парк','пгт','пер','переезд','пл','пл-ка','платф','погост','полустанок','починок','пр-кт','проезд','промзона','просек','просека','проселок','проток','протока','проулок','р-н','рзд','россия','рп','ряды','с','с/а','с/мо','с/о','с/п','с/с','сад','сквер','сл','снт','спуск','ст','ст-ца','стр','тер','тракт','туп','у','ул','уч-к','ф/х','ферма','х','ш','бульвар','владение','выселки','гаражно-строительный','город','деревня','домовладение','дорога','квартал','километр','комната','корпус','литер','леспромхоз','местечко','микрорайон','набережная','область','переулок','платформа','площадка','площадь','поселение','поселок','проспект','разъезд','район','республика','село','сельсовет','слобода','сооружение','станица','станция','строение','территория','тупик','улица','улус','участок','хутор','шоссе'];var ADDRESS_COMPONENTS=[{id:'kladr_id',fields:['kladr_id'],forBounds:false,forLocations:true},{id:'postal_code',fields:['postal_code'],forBounds:false,forLocations:true},{id:'country',fields:['country'],forBounds:false,forLocations:true},{id:'region_fias_id',fields:['region_fias_id'],forBounds:false,forLocations:true},{id:'region',fields:['region','region_type','region_type_full','region_with_type'],forBounds:true,forLocations:true,kladrFormat:{digits:2,zeros:11},fiasType:'region_fias_id'},{id:'area_fias_id',fields:['area_fias_id'],forBounds:false,forLocations:true},{id:'area',fields:['area','area_type','area_type_full','area_with_type'],forBounds:true,forLocations:true,kladrFormat:{digits:5,zeros:8},fiasType:'area_fias_id'},{id:'city_fias_id',fields:['city_fias_id'],forBounds:false,forLocations:true},{id:'city',fields:['city','city_type','city_type_full','city_with_type'],forBounds:true,forLocations:true,kladrFormat:{digits:8,zeros:5},fiasType:'city_fias_id'},{id:'city_district_fias_id',fields:['city_district_fias_id'],forBounds:false,forLocations:true},{id:'city_district',fields:['city_district','city_district_type','city_district_type_full','city_district_with_type'],forBounds:true,forLocations:true,kladrFormat:{digits:11,zeros:2},fiasType:'city_district_fias_id'},{id:'settlement_fias_id',fields:['settlement_fias_id'],forBounds:false,forLocations:true},{id:'settlement',fields:['settlement','settlement_type','settlement_type_full','settlement_with_type'],forBounds:true,forLocations:true,kladrFormat:{digits:11,zeros:2},fiasType:'settlement_fias_id'},{id:'street_fias_id',fields:['street_fias_id'],forBounds:false,forLocations:true},{id:'street',fields:['street','street_type','street_type_full','street_with_type'],forBounds:true,forLocations:true,kladrFormat:{digits:15,zeros:2},fiasType:'street_fias_id'},{id:'house',fields:['house','house_type','house_type_full','block','block_type'],forBounds:true,forLocations:false,kladrFormat:{digits:19}}];var rHasMatch=/<strong>/;var innPartsLengths={'LEGAL':[2,2,5,1],'INDIVIDUAL':[2,2,6,2]};function valueStartsWith(suggestion,field){var fieldValue=suggestion.data&&suggestion.data[field];return fieldValue&&new RegExp('^'+utils.escapeRegExChars(fieldValue)+'(['+WORD_DELIMITERS+']|$)','i').test(suggestion.value)}function chooseFormattedField(formattedMain,formattedAlt){return rHasMatch.test(formattedAlt)&&!rHasMatch.test(formattedMain)?formattedAlt:formattedMain}function formattedField(main,alt,currentValue,suggestion,options){var that=this,formattedMain=that.highlightMatches(main,currentValue,suggestion,options),formattedAlt=that.highlightMatches(alt,currentValue,suggestion,options);return chooseFormattedField(formattedMain,formattedAlt)}var types={};types['NAME']={urlSuffix:'fio',matchers:[matchers.matchByNormalizedQuery,matchers.matchByWords],fieldNames:{surname:'фамилия',name:'имя',patronymic:'отчество'},alwaysContinueSelecting:true,isDataComplete:function(suggestion){var that=this,params=that.options.params,data=suggestion.data,fields;if($.isFunction(params)){params=params.call(that.element,suggestion.value)}if(params&&params.parts){fields=$.map(params.parts,function(part){return part.toLowerCase()})}else{fields=['surname','name'];if(valueStartsWith(suggestion,'surname')){fields.push('patronymic')}}return utils.fieldsNotEmpty(data,fields)},composeValue:function(data){return utils.compact([data.surname,data.name,data.patronymic]).join(' ')}};types['ADDRESS']={urlSuffix:'address',matchers:[$.proxy(matchers.matchByNormalizedQuery,{stopwords:ADDRESS_STOPWORDS}),$.proxy(matchers.matchByWordsAddress,{stopwords:ADDRESS_STOPWORDS})],dataComponents:ADDRESS_COMPONENTS,dataComponentsById:utils.indexBy(ADDRESS_COMPONENTS,'id','index'),unformattableTokens:ADDRESS_STOPWORDS,enrichmentEnabled:true,geoEnabled:true,isDataComplete:function(suggestion){var fields=[this.bounds.to||'flat'],data=suggestion.data;return!$.isPlainObject(data)||utils.fieldsNotEmpty(data,fields)},composeValue:function(data,optionalComponents){return utils.compact([data.region_with_type||utils.compact([data.region,data.region_type]).join(' '),data.area_with_type||utils.compact([data.area_type,data.area]).join(' '),data.city_with_type||utils.compact([data.city_type,data.city]).join(' '),data.city_district_with_type||utils.compact([data.city_district_type,data.city_district]).join(' '),data.settlement_with_type||utils.compact([data.settlement_type,data.settlement]).join(' '),data.street_with_type||utils.compact([data.street_type,data.street]).join(' '),utils.compact([data.house_type,data.house,data.block_type,data.block]).join(' '),utils.compact([data.flat_type,data.flat]).join(' '),data.postal_box&&('а/я '+data.postal_box)]).join(', ')},formatResult:function(){var componentsUnderCityDistrict=[],_underCityDistrict=false;$.each(ADDRESS_COMPONENTS,function(){if(_underCityDistrict)componentsUnderCityDistrict.push(this.id);if(this.id==='city_district')_underCityDistrict=true});return function(value,currentValue,suggestion,options){var that=this,district=suggestion.data&&suggestion.data.city_district_with_type;value=that.highlightMatches(value,currentValue,suggestion,options);value=that.wrapFormattedValue(value,suggestion);if(district&&(!that.bounds.own.length||that.bounds.own.indexOf('street')>=0)&&!$.isEmptyObject(that.copyDataComponents(suggestion.data,componentsUnderCityDistrict))){value+='<div class="'+that.classes.subtext+'">'+that.highlightMatches(district,currentValue,suggestion)+'</div>'}return value}}()};types['PARTY']={urlSuffix:'party',matchers:[$.proxy(matchers.matchByFields,{fieldsStopwords:{'value':null,'data.address.value':ADDRESS_STOPWORDS,'data.inn':null,'data.ogrn':null}})],dataComponents:ADDRESS_COMPONENTS,geoEnabled:true,formatResult:function(value,currentValue,suggestion,options){var that=this,formattedInn=that.type.formatResultInn.call(that,suggestion,currentValue),formatterOGRN=that.highlightMatches(utils.getDeepValue(suggestion.data,'ogrn'),currentValue,suggestion),formattedInnOGRN=chooseFormattedField(formattedInn,formatterOGRN),formattedFIO=that.highlightMatches(utils.getDeepValue(suggestion.data,'management.name'),currentValue,suggestion),address=utils.getDeepValue(suggestion.data,'address.value')||'';if(that.isMobile){(options||(options={})).maxLength=50}value=formattedField.call(that,value,utils.getDeepValue(suggestion.data,'name.latin'),currentValue,suggestion,options);value=that.wrapFormattedValue(value,suggestion);if(address){address=address.replace(/^(\d{6}?\s+|Россия,\s+)/i,'');if(that.isMobile){address=address.replace(new RegExp('^([^'+WORD_DELIMITERS+']+['+WORD_DELIMITERS+']+[^'+WORD_DELIMITERS+']+).*'),'$1')}else{address=that.highlightMatches(address,currentValue,suggestion,{unformattableTokens:ADDRESS_STOPWORDS})}}if(formattedInnOGRN||address||formattedFIO){value+='<div class="'+that.classes.subtext+'">'+'<span class="'+that.classes.subtext_inline+'">'+(formattedInnOGRN||'')+'</span>'+(chooseFormattedField(address,formattedFIO)||'')+'</div>'}return value},formatResultInn:function(suggestion,currentValue){var that=this,inn=suggestion.data&&suggestion.data.inn,innPartsLength=innPartsLengths[suggestion.data&&suggestion.data.type],innParts,formattedInn,rDigit=/\d/;if(inn){formattedInn=that.highlightMatches(inn,currentValue,suggestion);if(innPartsLength){formattedInn=formattedInn.split('');innParts=$.map(innPartsLength,function(partLength){var formattedPart='',ch;while(partLength&&(ch=formattedInn.shift())){formattedPart+=ch;if(rDigit.test(ch))partLength--}return formattedPart});formattedInn=innParts.join('<span class="'+that.classes.subtext_delimiter+'"></span>')+formattedInn.join('')}return formattedInn}}};types['EMAIL']={urlSuffix:'email',matchers:[matchers.matchByNormalizedQuery],isQueryRequestable:function(query){return this.options.suggest_local||query.indexOf('@')>=0}};types['BANK']={urlSuffix:'bank',matchers:[$.proxy(matchers.matchByFields,{fieldsStopwords:{'value':null,'data.bic':null,'data.swift':null}})],formatResult:function(value,currentValue,suggestion,options){var that=this,formattedBIC=that.highlightMatches(utils.getDeepValue(suggestion.data,'bic'),currentValue,suggestion),address=utils.getDeepValue(suggestion.data,'address.value')||'';value=that.highlightMatches(value,currentValue,suggestion,options);value=that.wrapFormattedValue(value,suggestion);if(address){address=address.replace(/^\d{6}( РОССИЯ)?, /i,'');if(that.isMobile){address=address.replace(new RegExp('^([^'+WORD_DELIMITERS+']+['+WORD_DELIMITERS+']+[^'+WORD_DELIMITERS+']+).*'),'$1')}else{address=that.highlightMatches(address,currentValue,suggestion,{unformattableTokens:ADDRESS_STOPWORDS})}}if(formattedBIC||address){value+='<div class="'+that.classes.subtext+'">'+'<span class="'+that.classes.subtext_inline+'">'+formattedBIC+'</span>'+address+'</div>'}return value},formatSelected:function(suggestion){return utils.getDeepValue(suggestion,'data.name.payment')}};$.extend(DEFAULT_OPTIONS,{suggest_local:true});var notificator={chains:{},'on':function(name,method){this.get(name).push(method);return this},'get':function(name){var chains=this.chains;return chains[name]||(chains[name]=[])}};var serviceMethods={'suggest':{defaultParams:{type:utils.getDefaultType(),dataType:'json',contentType:utils.getDefaultContentType()},addTypeInUrl:true},'detectAddressByIp':{defaultParams:{type:'GET',dataType:'json'},addTypeInUrl:false},'status':{defaultParams:{type:'GET',dataType:'json'},addTypeInUrl:true},'findById':{defaultParams:{type:utils.getDefaultType(),dataType:'json',contentType:utils.getDefaultContentType()},addTypeInUrl:true}};var requestModes={'suggest':{method:'suggest',userSelect:true,updateValue:true,enrichmentEnabled:true},'findById':{method:'findById',userSelect:false,updateValue:false,enrichmentEnabled:false}};function Suggestions(el,options){var that=this;that.element=el;that.el=$(el);that.suggestions=[];that.badQueries=[];that.selectedIndex=-1;that.currentValue=that.element.value;that.intervalId=0;that.cachedResponse={};that.enrichmentCache={};that.currentRequest=null;that.inputPhase=$.Deferred();that.fetchPhase=$.Deferred();that.enrichPhase=$.Deferred();that.onChangeTimeout=null;that.triggering={};that.$wrapper=null;that.options=$.extend({},DEFAULT_OPTIONS,options);that.classes={hint:'suggestions-hint',mobile:'suggestions-mobile',nowrap:'suggestions-nowrap',selected:'suggestions-selected',suggestion:'suggestions-suggestion',subtext:'suggestions-subtext',subtext_inline:'suggestions-subtext suggestions-subtext_inline',subtext_delimiter:'suggestions-subtext-delimiter',subtext_label:'suggestions-subtext suggestions-subtext_label',removeConstraint:'suggestions-remove',value:'suggestions-value'};that.disabled=false;that.selection=null;that.$viewport=$(window);that.$body=$(document.body);that.type=null;that.status={};that.setupElement();that.initializer=$.Deferred();if(that.el.is(':visible')){that.initializer.resolve()}else{that.deferInitialization()}that.initializer.done($.proxy(that.initialize,that))}Suggestions.prototype={initialize:function(){var that=this;that.uniqueId=utils.uniqueId('i');that.createWrapper();that.notify('initialize');that.bindWindowEvents();that.setOptions();that.fixPosition()},deferInitialization:function(){var that=this,events='mouseover focus keydown',timer,callback=function(){that.initializer.resolve();that.enable()};that.initializer.always(function(){that.el.off(events,callback);clearInterval(timer)});that.disabled=true;that.el.on(events,callback);timer=setInterval(function(){if(that.el.is(':visible')){callback()}},that.options.initializeInterval)},isInitialized:function(){return this.initializer.state()==='resolved'},dispose:function(){var that=this;that.initializer.reject();that.notify('dispose');that.el.removeData(DATA_ATTR_KEY).removeClass('suggestions-input');that.unbindWindowEvents();that.removeWrapper();that.el.trigger('suggestions-dispose')},notify:function(chainName){var that=this,args=utils.slice(arguments,1);return $.map(notificator.get(chainName),function(method){return method.apply(that,args)})},createWrapper:function(){var that=this;that.$wrapper=$('<div class="suggestions-wrapper"/>');that.el.after(that.$wrapper);that.$wrapper.on('mousedown'+EVENT_NS,$.proxy(that.onMousedown,that))},removeWrapper:function(){var that=this;if(that.$wrapper){that.$wrapper.remove()}$(that.options.$helpers).off(EVENT_NS)},onMousedown:function(e){var that=this;e.preventDefault();that.cancelBlur=true;utils.delay(function(){delete that.cancelBlur});if($(e.target).closest(".ui-menu-item").length==0){utils.delay(function(){$(document).one("mousedown",function(e){var $elements=that.el.add(that.$wrapper).add(that.options.$helpers);if(that.options.floating){$elements=$elements.add(that.$container)}$elements=$elements.filter(function(){return this===e.target||$.contains(this,e.target)});if(!$elements.length){that.hide()}})})}},bindWindowEvents:function(){var that=this,handler=$.proxy(that.fixPosition,that);that.$viewport.on('resize'+EVENT_NS+that.uniqueId,handler).on('scroll'+EVENT_NS+that.uniqueId,handler)},unbindWindowEvents:function(){this.$viewport.off('resize'+EVENT_NS+this.uniqueId).off('scroll'+EVENT_NS+this.uniqueId)},scrollToTop:function(){var that=this,scrollTarget=that.options.scrollOnFocus;if(scrollTarget===true){scrollTarget=that.el}if(scrollTarget instanceof $&&scrollTarget.length>0){$('body,html').animate({scrollTop:scrollTarget.offset().top},'fast')}},setOptions:function(suppliedOptions){var that=this;$.extend(that.options,suppliedOptions);$.each({'type':types,'requestMode':requestModes},function(option,available){that[option]=available[that.options[option]];if(!that[option]){that.disable();throw'`'+option+'` option is incorrect! Must be one of: '+$.map(available,function(value,name){return'"'+name+'"'}).join(', ')}});$(that.options.$helpers).off(EVENT_NS).on('mousedown'+EVENT_NS,$.proxy(that.onMousedown,that));if(that.isInitialized()){that.notify('setOptions')}},fixPosition:function(e){var that=this,elLayout={},wrapperOffset,origin;that.isMobile=that.$viewport.width()<=that.options.mobileWidth;if(!that.isInitialized()||(e&&e.type=='scroll'&&!(that.options.floating||that.isMobile)))return;that.$container.appendTo(that.options.floating?that.$body:that.$wrapper);that.notify('resetPosition');that.el.css('paddingLeft','');that.el.css('paddingRight','');elLayout.paddingLeft=parseFloat(that.el.css('paddingLeft'));elLayout.paddingRight=parseFloat(that.el.css('paddingRight'));$.extend(elLayout,that.el.offset());elLayout.borderTop=that.el.css('border-top-style')=='none'?0:parseFloat(that.el.css('border-top-width'));elLayout.borderLeft=that.el.css('border-left-style')=='none'?0:parseFloat(that.el.css('border-left-width'));elLayout.innerHeight=that.el.innerHeight();elLayout.innerWidth=that.el.innerWidth();elLayout.outerHeight=that.el.outerHeight();elLayout.componentsLeft=0;elLayout.componentsRight=0;wrapperOffset=that.$wrapper.offset();origin={top:elLayout.top-wrapperOffset.top,left:elLayout.left-wrapperOffset.left};that.notify('fixPosition',origin,elLayout);if(elLayout.componentsLeft>elLayout.paddingLeft){that.el.css('paddingLeft',elLayout.componentsLeft+'px')}if(elLayout.componentsRight>elLayout.paddingRight){that.el.css('paddingRight',elLayout.componentsRight+'px')}},clearCache:function(){this.cachedResponse={};this.enrichmentCache={};this.badQueries=[]},clear:function(){var that=this;if(that.isInitialized()){that.clearCache();that.currentValue='';that.selection=null;that.hide();that.suggestions=[];that.el.val('');that.el.trigger('suggestions-clear');that.notify('clear')}},disable:function(){var that=this;that.disabled=true;that.abortRequest();if(that.visible){that.hide()}},enable:function(){this.disabled=false},isUnavailable:function(){return this.disabled},update:function(){var that=this,query=that.el.val();if(that.isInitialized()){that.currentValue=query;if(that.isQueryRequestable(query)){that.updateSuggestions(query)}else{that.hide()}}},setSuggestion:function(suggestion){var that=this,data,value;if($.isPlainObject(suggestion)&&$.isPlainObject(suggestion.data)){suggestion=$.extend(true,{},suggestion);if(that.bounds.own.length){that.checkValueBounds(suggestion);data=that.copyDataComponents(suggestion.data,that.bounds.all);if(suggestion.data.kladr_id){data.kladr_id=that.getBoundedKladrId(suggestion.data.kladr_id,that.bounds.all)}suggestion.data=data}that.selection=suggestion;that.suggestions=[suggestion];value=that.getSuggestionValue(suggestion)||'';that.currentValue=value;that.el.val(value);that.abortRequest();that.el.trigger('suggestions-set')}},fixData:function(){var that=this,fullQuery=that.extendedCurrentValue(),currentValue=that.el.val(),resolver=$.Deferred();resolver.done(function(suggestion){that.selectSuggestion(suggestion,0,currentValue,{hasBeenEnriched:true});that.el.trigger('suggestions-fixdata',suggestion)}).fail(function(){that.selection=null;that.currentValue='';that.el.val(that.currentValue);that.el.trigger('suggestions-fixdata')});if(that.isQueryRequestable(fullQuery)){that.currentValue=fullQuery;that.getSuggestions(fullQuery,{count:1,from_bound:null,to_bound:null}).done(function(suggestions){var suggestion=suggestions[0];if(suggestion){resolver.resolve(suggestion)}else{resolver.reject()}}).fail(function(){resolver.reject()})}else{resolver.reject()}},extendedCurrentValue:function(){var that=this,parentInstance=that.getParentInstance(),parentValue=parentInstance&&parentInstance.extendedCurrentValue(),currentValue=$.trim(that.el.val());return utils.compact([parentValue,currentValue]).join(' ')},getAjaxParams:function(method,custom){var that=this,token=$.trim(that.options.token),partner=$.trim(that.options.partner),serviceUrl=that.options.serviceUrl,serviceMethod=serviceMethods[method],params=$.extend({timeout:that.options.timeout},serviceMethod.defaultParams),headers={};if(!/\/$/.test(serviceUrl)){}if(serviceMethod.addTypeInUrl){}serviceUrl=utils.fixURLProtocol(serviceUrl);if($.support.cors){if(token){headers['Authorization']='Token '+token}if(partner){headers['X-Partner']=partner}headers['X-Version']=Suggestions.version;if(!params.headers){params.headers={}}$.extend(params.headers,that.options.headers,headers)}else{if(token){headers['token']=token}if(partner){headers['partner']=partner}headers['version']=Suggestions.version}params.url=serviceUrl;return $.extend(params,custom)},isQueryRequestable:function(query){var that=this,result;result=query.length>=that.options.minChars;if(result&&that.type.isQueryRequestable){result=that.type.isQueryRequestable.call(that,query)}return result},constructRequestParams:function(query,customParams){var that=this,options=that.options,params=$.isFunction(options.params)?options.params.call(that.element,query):$.extend({},options.params);if(that.type.constructRequestParams){$.extend(params,that.type.constructRequestParams.call(that))}$.each(that.notify('requestParams'),function(i,hookParams){$.extend(params,hookParams)});params[options.paramName]=query;if($.isNumeric(options.count)&&options.count>0){params.count=options.count}return $.extend(params,customParams)},updateSuggestions:function(query){var that=this;that.fetchPhase=that.getSuggestions(query).done(function(suggestions){that.assignSuggestions(suggestions,query)})},getSuggestions:function(query,customParams,requestOptions){var response,that=this,options=that.options,noCallbacks=requestOptions&&requestOptions.noCallbacks,useEnrichmentCache=requestOptions&&requestOptions.useEnrichmentCache,params=that.constructRequestParams(query,customParams),cacheKey=$.param(params||{}),resolver=$.Deferred();response=that.cachedResponse[cacheKey];if(response&&$.isArray(response.suggestions)){resolver.resolve(response.suggestions)}else{if(that.isBadQuery(query)){resolver.reject()}else{if(!noCallbacks&&options.onSearchStart.call(that.element,params)===false){resolver.reject()}else{that.doGetSuggestions(params).done(function(response){response=response.result;if(that.processResponse(response)&&query==that.currentValue){if(!options.noCache){if(useEnrichmentCache){that.enrichmentCache[query]=response.suggestions[0]}else{that.enrichResponse(response,query);that.cachedResponse[cacheKey]=response;if(options.preventBadQueries&&response.suggestions.length===0){that.badQueries.push(query)}}}resolver.resolve(response.suggestions)}else{resolver.reject()}if(!noCallbacks){options.onSearchComplete.call(that.element,query,response.suggestions)}}).fail(function(jqXHR,textStatus,errorThrown){resolver.reject();if(!noCallbacks&&textStatus!=='abort'){options.onSearchError.call(that.element,query,jqXHR,textStatus,errorThrown)}})}}}return resolver},doGetSuggestions:function(params){var that=this,request=$.ajax(that.getAjaxParams(that.requestMode.method,{data:utils.serialize(params)}));that.abortRequest();that.currentRequest=request;that.notify('request');request.always(function(){that.currentRequest=null;that.notify('request')});return request},isBadQuery:function(q){if(!this.options.preventBadQueries){return false}var result=false;$.each(this.badQueries,function(i,query){return!(result=q.indexOf(query)===0)});return result},abortRequest:function(){var that=this;if(that.currentRequest){that.currentRequest.abort()}},processResponse:function(response){var that=this,suggestions;if(!response||!$.isArray(response.suggestions)){return false}that.verifySuggestionsFormat(response.suggestions);that.setUnrestrictedValues(response.suggestions);if($.isFunction(that.options.onSuggestionsFetch)){suggestions=that.options.onSuggestionsFetch.call(that.element,response.suggestions);if($.isArray(suggestions)){response.suggestions=suggestions}}return true},verifySuggestionsFormat:function(suggestions){if(typeof suggestions[0]==='string'){$.each(suggestions,function(i,value){suggestions[i]={value:value,data:null}})}},getSuggestionValue:function(suggestion,selectionOptions){var that=this,formatSelected=that.options.formatSelected||that.type.formatSelected,hasSameValues=selectionOptions&&selectionOptions.hasSameValues,hasBeenEnriched=selectionOptions&&selectionOptions.hasBeenEnriched,formattedValue;if($.isFunction(formatSelected)){formattedValue=formatSelected.call(that,suggestion)}if(typeof formattedValue!=='string'||formattedValue.length==0){formattedValue=suggestion.value;if(that.type.composeValue){if(hasBeenEnriched){if(that.options.restrict_value){formattedValue=that.type.composeValue(that.getUnrestrictedData(suggestion.data))}else{if(that.bounds.own.indexOf('street')>=0){formattedValue=that.type.composeValue(that.copyDataComponents(suggestion.data,that.bounds.own))}}}else{if(hasSameValues){if(that.options.restrict_value){formattedValue=that.type.composeValue(that.getUnrestrictedData(suggestion.data))}else{if(that.bounds.own.indexOf('street')>=0){formattedValue=that.type.composeValue(that.copyDataComponents(suggestion.data,that.bounds.own))}else{formattedValue=suggestion.unrestricted_value}}}}}}return formattedValue},hasSameValues:function(suggestion){var hasSame=false;$.each(this.suggestions,function(i,anotherSuggestion){if(anotherSuggestion.value===suggestion.value&&anotherSuggestion!==suggestion){hasSame=true;return false}});return hasSame},assignSuggestions:function(suggestions,query){var that=this;that.suggestions=suggestions;that.notify('assignSuggestions',query)},shouldRestrictValues:function(){var that=this;return that.options.restrict_value&&that.constraints&&Object.keys(that.constraints).length==1},setUnrestrictedValues:function(suggestions){var that=this,shouldRestrict=that.shouldRestrictValues(),label=that.getFirstConstraintLabel();$.each(suggestions,function(i,suggestion){if(!suggestion.unrestricted_value){suggestion.unrestricted_value=shouldRestrict?label+', '+suggestion.value:suggestion.value}})},areSuggestionsSame:function(a,b){return a&&b&&a.value===b.value&&utils.areSame(a.data,b.data)}};var methods={setupElement:function(){this.el.attr('autocomplete','off').addClass('suggestions-input g-form-control-text').css('box-sizing','border-box')},bindElementEvents:function(){var that=this;that.el.on('keydown'+EVENT_NS,$.proxy(that.onElementKeyDown,that));that.el.on(['keyup'+EVENT_NS,'cut'+EVENT_NS,'paste'+EVENT_NS,'input'+EVENT_NS].join(' '),$.proxy(that.onElementKeyUp,that));that.el.on('blur'+EVENT_NS,$.proxy(that.onElementBlur,that));that.el.on('focus'+EVENT_NS,$.proxy(that.onElementFocus,that))},unbindElementEvents:function(){this.el.off(EVENT_NS)},onElementBlur:function(){var that=this;if(that.cancelBlur){that.cancelBlur=false;return}if(that.options.triggerSelectOnBlur){if(!that.isUnavailable()){that.selectCurrentValue({noSpace:true}).always(function(){that.hide()})}}else{that.hide()}if(that.fetchPhase.abort){that.fetchPhase.abort()}},onElementFocus:function(){var that=this;if(!that.cancelFocus){utils.delay($.proxy(that.completeOnFocus,that))}that.cancelFocus=false},onElementKeyDown:function(e){var that=this;if(that.isUnavailable()){return}if(!that.visible){switch(e.which){case KEYS.DOWN:that.suggest();break;case KEYS.ENTER:if(that.options.triggerSelectOnEnter){that.triggerOnSelectNothing()}break}return}switch(e.which){case KEYS.ESC:that.el.val(that.currentValue);that.hide();that.abortRequest();break;case KEYS.TAB:if(that.options.tabDisabled===false){return}break;case KEYS.ENTER:if(that.options.triggerSelectOnEnter){that.selectCurrentValue()}break;case KEYS.SPACE:if(that.options.triggerSelectOnSpace&&that.isCursorAtEnd()){e.preventDefault();that.selectCurrentValue({continueSelecting:true,dontEnrich:true}).fail(function(){that.currentValue+=' ';that.el.val(that.currentValue);that.proceedChangedValue()})}return;case KEYS.UP:that.moveUp();break;case KEYS.DOWN:that.moveDown();break;default:return}e.stopImmediatePropagation();e.preventDefault()},onElementKeyUp:function(e){var that=this;if(that.isUnavailable()){return}switch(e.which){case KEYS.UP:case KEYS.DOWN:case KEYS.ENTER:return}clearTimeout(that.onChangeTimeout);that.inputPhase.reject();if(that.currentValue!==that.el.val()){that.proceedChangedValue()}},proceedChangedValue:function(){var that=this;that.abortRequest();that.inputPhase=$.Deferred().done($.proxy(that.onValueChange,that));if(that.options.deferRequestBy>0){that.onChangeTimeout=utils.delay(function(){that.inputPhase.resolve()},that.options.deferRequestBy)}else{that.inputPhase.resolve()}},onValueChange:function(){var that=this,currentSelection;if(that.selection){currentSelection=that.selection;that.selection=null;that.trigger('InvalidateSelection',currentSelection)}that.selectedIndex=-1;that.update();that.notify('valueChange')},completeOnFocus:function(){var that=this;if(that.isUnavailable()){return}if(that.isElementFocused()){that.fixPosition();that.update();if(that.isMobile){that.setCursorAtEnd();that.scrollToTop()}}},isElementFocused:function(){return document.activeElement===this.element},isCursorAtEnd:function(){var that=this,valLength=that.el.val().length,selectionStart,range;try{selectionStart=that.element.selectionStart;if(typeof selectionStart==='number'){return selectionStart===valLength}}catch(ex){}if(document.selection){range=document.selection.createRange();range.moveStart('character',-valLength);return valLength===range.text.length}return true},setCursorAtEnd:function(){var element=this.element;try{element.selectionEnd=element.selectionStart=element.value.length;element.scrollLeft=element.scrollWidth}catch(ex){element.value=element.value}}};$.extend(Suggestions.prototype,methods);notificator.on('initialize',methods.bindElementEvents).on('dispose',methods.unbindElementEvents);var statusRequests={};function resetTokens(){$.each(statusRequests,function(){this.abort()});statusRequests={}}resetTokens();var methods$1={checkStatus:function(){var that=this,token=$.trim(that.options.token),requestKey=that.options.type+token,request=statusRequests[requestKey];if(!request){request=statusRequests[requestKey]=$.ajax(that.getAjaxParams('status'))}request.done(function(status){if(status.search){$.extend(that.status,status)}else{triggerError('Service Unavailable')}}).fail(function(){triggerError(request.statusText)});function triggerError(errorThrown){if($.isFunction(that.options.onSearchError)){that.options.onSearchError.call(that.element,null,request,'error',errorThrown)}}}};Suggestions.resetTokens=resetTokens;$.extend(Suggestions.prototype,methods$1);notificator.on('setOptions',methods$1.checkStatus);var locationRequest;var defaultGeoLocation=true;function resetLocation(){locationRequest=null;DEFAULT_OPTIONS.geoLocation=defaultGeoLocation}var methods$2={checkLocation:function(){var that=this,providedLocation=that.options.geoLocation;if(!that.type.geoEnabled||!providedLocation){return}that.geoLocation=$.Deferred();if($.isPlainObject(providedLocation)||$.isArray(providedLocation)){that.geoLocation.resolve(providedLocation)}else{if(!locationRequest){locationRequest=$.ajax(that.getAjaxParams('detectAddressByIp'))}locationRequest.done(function(resp){var locationData=resp&&resp.location&&resp.location.data;if(locationData&&locationData.kladr_id){that.geoLocation.resolve(locationData)}else{that.geoLocation.reject()}}).fail(function(){that.geoLocation.reject()})}},getGeoLocation:function(){return this.geoLocation},constructParams:function(){var that=this,params={};if(that.geoLocation&&$.isFunction(that.geoLocation.promise)&&that.geoLocation.state()=='resolved'){that.geoLocation.done(function(locationData){params['locations_boost']=$.makeArray(locationData)})}return params}};if(utils.getDefaultType()!='GET'){$.extend(DEFAULT_OPTIONS,{geoLocation:defaultGeoLocation});$.extend(Suggestions,{resetLocation:resetLocation});$.extend(Suggestions.prototype,{getGeoLocation:methods$2.getGeoLocation});notificator.on('setOptions',methods$2.checkLocation).on('requestParams',methods$2.constructParams)}var methods$3={enrichSuggestion:function(suggestion,selectionOptions){var that=this,resolver=$.Deferred();if(!that.status.enrich||!that.type.enrichmentEnabled||!that.requestMode.enrichmentEnabled||selectionOptions&&selectionOptions.dontEnrich){return resolver.resolve(suggestion)}if(suggestion.data&&suggestion.data.qc!=null){return resolver.resolve(suggestion)}that.disableDropdown();that.currentValue=suggestion.unrestricted_value;that.enrichPhase=that.getSuggestions(suggestion.unrestricted_value,{count:1,locations:null,locations_boost:null,from_bound:null,to_bound:null},{noCallbacks:true,useEnrichmentCache:true}).always(function(){that.enableDropdown()}).done(function(suggestions){var enrichedSuggestion=suggestions&&suggestions[0];resolver.resolve(enrichedSuggestion||suggestion,!!enrichedSuggestion)}).fail(function(){resolver.resolve(suggestion)});return resolver},enrichResponse:function(response,query){var that=this,enrichedSuggestion=that.enrichmentCache[query];if(enrichedSuggestion){$.each(response.suggestions,function(i,suggestion){if(suggestion.value===query){response.suggestions[i]=enrichedSuggestion;return false}})}}};$.extend(Suggestions.prototype,methods$3);function highlightMatches(chunks){return $.map(chunks,function(chunk){var text=utils.escapeHtml(chunk.text);if(text&&chunk.matched){text='<strong>'+text+'</strong>'}return text}).join('')}function nowrapLinkedParts(formattedStr,nowrapClass){var delimitedParts=formattedStr.split(', ');if(delimitedParts.length===1){return formattedStr}return $.map(delimitedParts,function(part){return'<span class="'+nowrapClass+'">'+part+'</span>'}).join(', ')}function hasAnotherSuggestion(suggestions,suggestion){var result=false;$.each(suggestions,function(i,s){result=s.value==suggestion.value&&s!=suggestion;if(result){return false}});return result}var optionsUsed={width:'auto',floating:false};var methods$4={createContainer:function(){var that=this,suggestionSelector='.'+that.classes.suggestion,options=that.options,$container=$('<div/>').addClass(options.containerClass).css({position:'absolute',display:'none'});that.$container=$container;$container.on('click'+EVENT_NS,suggestionSelector,$.proxy(that.onSuggestionClick,that))},removeContainer:function(){var that=this;if(that.options.floating){that.$container.remove()}},setContainerOptions:function(){var that=this,mousedownEvent='mousedown'+EVENT_NS;that.$container.off(mousedownEvent);if(that.options.floating){that.$container.on(mousedownEvent,$.proxy(that.onMousedown,that))}},onSuggestionClick:function(e){var that=this,$el=$(e.target),index;if(!that.dropdownDisabled){that.cancelFocus=true;that.el.focus();while($el.length&&!(index=$el.attr('data-index'))){$el=$el.closest('.'+that.classes.suggestion)}if(index&&!isNaN(index)){that.select(+index)}}},setDropdownPosition:function(origin,elLayout){var that=this,scrollLeft=that.$viewport.scrollLeft(),style;if(that.isMobile){style=that.options.floating?{left:scrollLeft+'px',top:elLayout.top+elLayout.outerHeight+'px'}:{left:origin.left-elLayout.left+scrollLeft+'px',top:origin.top+elLayout.outerHeight+'px'};style.width=that.$viewport.width()+'px'}else{style=that.options.floating?{left:elLayout.left+'px',top:elLayout.top+elLayout.borderTop+elLayout.innerHeight+'px'}:{left:origin.left+'px',top:origin.top+elLayout.borderTop+elLayout.innerHeight+'px'};utils.delay(function(){var width=that.options.width;if(width==='auto'){width=that.el.outerWidth()}that.$container.outerWidth(width)})}that.$container.toggleClass(that.classes.mobile,that.isMobile).css(style);that.containerItemsPadding=elLayout.left+elLayout.borderLeft+elLayout.paddingLeft-scrollLeft},setItemsPositions:function(){var that=this,$items=that.getSuggestionsItems();$items.css('paddingLeft',that.isMobile?that.containerItemsPadding+'px':'')},getSuggestionsItems:function(){return this.$container.children('.'+this.classes.suggestion)},toggleDropdownEnabling:function(enable){this.dropdownDisabled=!enable;this.$container.attr('disabled',!enable)},disableDropdown:function(){this.toggleDropdownEnabling(false)},enableDropdown:function(){this.toggleDropdownEnabling(true)},hasSuggestionsToChoose:function(){var that=this;return that.suggestions.length>1||(that.suggestions.length===1&&(!that.selection||$.trim(that.suggestions[0].value)!==$.trim(that.selection.value)))},suggest:function(){var that=this,options=that.options,formatResult,html;if(!that.requestMode.userSelect){return}if(!that.hasSuggestionsToChoose()){that.hide();return}formatResult=options.formatResult||that.type.formatResult||that.formatResult;html=[];if(!that.isMobile&&options.hint&&that.suggestions.length){html.push('<div class="'+that.classes.hint+'">'+options.hint+'</div>')}that.selectedIndex=-1;$.each(that.suggestions,function(i,suggestion){var labels=that.makeSuggestionLabel(that.suggestions,suggestion);if(suggestion==that.selection){that.selectedIndex=i}html.push('<div class="'+that.classes.suggestion+'" data-index="'+i+'">');html.push(formatResult.call(that,suggestion.value,that.currentValue,suggestion,{unformattableTokens:that.type.unformattableTokens}));if(labels){html.push('<span class="'+that.classes.subtext_label+'">'+utils.escapeHtml(labels)+'</span>')}html.push('</div>')});that.$container.html(html.join(''));if(options.autoSelectFirst&&that.selectedIndex===-1){that.selectedIndex=0}if(that.selectedIndex!==-1){that.getSuggestionsItems().eq(that.selectedIndex).addClass(that.classes.selected)}if($.isFunction(options.beforeRender)){options.beforeRender.call(that.element,that.$container)}that.$container.show();that.visible=true;that.fixPosition();that.setItemsPositions()},wrapFormattedValue:function(value,suggestion){var that=this,status=utils.getDeepValue(suggestion.data,'state.status');return'<span class="'+that.classes.value+'"'+(status?' data-suggestion-status="'+status+'"':'')+'>'+value+'</span>'},formatResult:function(value,currentValue,suggestion,options){var that=this;value=that.highlightMatches(value,currentValue,suggestion,options);return that.wrapFormattedValue(value,suggestion)},highlightMatches:function(value,currentValue,suggestion,options){var that=this,chunks=[],unformattableTokens=options&&options.unformattableTokens,maxLength=options&&options.maxLength,tokens,tokenMatchers,preferredTokens,rWords=utils.reWordExtractor(),match,word,i,chunk,formattedStr;if(!value)return'';tokens=utils.compact(utils.formatToken(currentValue).split(WORD_SPLITTER));preferredTokens=utils.arrayMinus(tokens,unformattableTokens);tokens=utils.withSubTokens(preferredTokens.concat(utils.arrayMinus(tokens,preferredTokens)));tokenMatchers=$.map(tokens,function(token){return new RegExp('^((.*)(['+WORD_PARTS_DELIMITERS+']+))?'+'('+utils.escapeRegExChars(token)+')'+'([^'+WORD_PARTS_DELIMITERS+']*['+WORD_PARTS_DELIMITERS+']*)','i')});while((match=rWords.exec(value))&&match[0]){word=match[1];chunks.push({text:word,hasUpperCase:word.toLowerCase()!==word,formatted:utils.formatToken(word),matchable:true});if(match[2]){chunks.push({text:match[2]})}}for(i=0;i<chunks.length;i++){chunk=chunks[i];if(chunk.matchable&&!chunk.matched&&($.inArray(chunk.formatted,unformattableTokens)===-1||chunk.hasUpperCase)){$.each(tokenMatchers,function(j,matcher){var tokenMatch=matcher.exec(chunk.formatted),length,nextIndex=i+1;if(tokenMatch){tokenMatch={before:tokenMatch[1]||'',beforeText:tokenMatch[2]||'',beforeDelimiter:tokenMatch[3]||'',text:tokenMatch[4]||'',after:tokenMatch[5]||''};if(tokenMatch.before){chunks.splice(i,0,{text:chunk.text.substr(0,tokenMatch.beforeText.length),formatted:tokenMatch.beforeText,matchable:true},{text:tokenMatch.beforeDelimiter});nextIndex+=2;length=tokenMatch.before.length;chunk.text=chunk.text.substr(length);chunk.formatted=chunk.formatted.substr(length);i--}length=tokenMatch.text.length+tokenMatch.after.length;if(chunk.formatted.length>length){chunks.splice(nextIndex,0,{text:chunk.text.substr(length),formatted:chunk.formatted.substr(length),matchable:true});chunk.text=chunk.text.substr(0,length);chunk.formatted=chunk.formatted.substr(0,length)}if(tokenMatch.after){length=tokenMatch.text.length;chunks.splice(nextIndex,0,{text:chunk.text.substr(length),formatted:chunk.formatted.substr(length)});chunk.text=chunk.text.substr(0,length);chunk.formatted=chunk.formatted.substr(0,length)}chunk.matched=true;return false}})}}if(maxLength){for(i=0;i<chunks.length&&maxLength>=0;i++){chunk=chunks[i];maxLength-=chunk.text.length;if(maxLength<0){chunk.text=chunk.text.substr(0,chunk.text.length+maxLength)+'...'}}chunks.length=i}formattedStr=highlightMatches(chunks);return nowrapLinkedParts(formattedStr,that.classes.nowrap)},makeSuggestionLabel:function(suggestions,suggestion){var that=this,fieldNames=that.type.fieldNames,nameData={},rWords=utils.reWordExtractor(),match,word,labels=[];if(fieldNames&&hasAnotherSuggestion(suggestions,suggestion)&&suggestion.data){$.each(fieldNames,function(field){var value=suggestion.data[field];if(value){nameData[field]=utils.formatToken(value)}});if(!$.isEmptyObject(nameData)){while((match=rWords.exec(utils.formatToken(suggestion.value)))&&(word=match[1])){$.each(nameData,function(i,value){if(value==word){labels.push(fieldNames[i]);delete nameData[i];return false}})}if(labels.length){return labels.join(', ')}}}},hide:function(){var that=this;that.visible=false;that.selectedIndex=-1;that.$container.hide().empty()},activate:function(index){var that=this,$activeItem,selected=that.classes.selected,$children;if(!that.dropdownDisabled){$children=that.getSuggestionsItems();$children.removeClass(selected);that.selectedIndex=index;if(that.selectedIndex!==-1&&$children.length>that.selectedIndex){$activeItem=$children.eq(that.selectedIndex);$activeItem.addClass(selected);return $activeItem}}return null},deactivate:function(restoreValue){var that=this;if(!that.dropdownDisabled){that.selectedIndex=-1;that.getSuggestionsItems().removeClass(that.classes.selected);if(restoreValue){that.el.val(that.currentValue)}}},moveUp:function(){var that=this;if(that.dropdownDisabled){return}if(that.selectedIndex===-1){if(that.suggestions.length){that.adjustScroll(that.suggestions.length-1)}return}if(that.selectedIndex===0){that.deactivate(true);return}that.adjustScroll(that.selectedIndex-1)},moveDown:function(){var that=this;if(that.dropdownDisabled){return}if(that.selectedIndex===(that.suggestions.length-1)){that.deactivate(true);return}that.adjustScroll(that.selectedIndex+1)},adjustScroll:function(index){var that=this,$activeItem=that.activate(index),itemTop,itemBottom,scrollTop=that.$container.scrollTop(),containerHeight;if(!$activeItem||!$activeItem.length){return}itemTop=$activeItem.position().top;if(itemTop<0){that.$container.scrollTop(scrollTop+itemTop)}else{itemBottom=itemTop+$activeItem.outerHeight();containerHeight=that.$container.innerHeight();if(itemBottom>containerHeight){that.$container.scrollTop(scrollTop-containerHeight+itemBottom)}}that.el.val(that.suggestions[index].value)}};$.extend(DEFAULT_OPTIONS,optionsUsed);$.extend(Suggestions.prototype,methods$4);notificator.on('initialize',methods$4.createContainer).on('dispose',methods$4.removeContainer).on('setOptions',methods$4.setContainerOptions).on('fixPosition',methods$4.setDropdownPosition).on('fixPosition',methods$4.setItemsPositions).on('assignSuggestions',methods$4.suggest);var QUEUE_NAME='addon';var BEFORE_SHOW_ADDON=50;var BEFORE_RESTORE_PADDING=1000;var optionsUsed$1={addon:null};var ADDON_TYPES={'NONE':'none','SPINNER':'spinner','CLEAR':'clear'};var Addon=function(owner){var that=this,$el=$('<span class="suggestions-addon"/>');that.owner=owner;that.$el=$el;that.type=ADDON_TYPES.NONE;that.visible=false;that.initialPadding=null;$el.on('click',$.proxy(that,'onClick'))};Addon.prototype={checkType:function(){var that=this,type=that.owner.options.addon,isTypeCorrect=false;$.each(ADDON_TYPES,function(key,value){isTypeCorrect=value==type;if(isTypeCorrect){return false}});if(!isTypeCorrect){type=that.owner.isMobile?ADDON_TYPES.CLEAR:ADDON_TYPES.SPINNER}if(type!=that.type){that.type=type;that.$el.attr('data-addon-type',type);that.toggle(true)}},toggle:function(immediate){var that=this,visible;switch(that.type){case ADDON_TYPES.CLEAR:visible=!!that.owner.currentValue;break;case ADDON_TYPES.SPINNER:visible=!!that.owner.currentRequest;break;default:visible=false}if(visible!=that.visible){that.visible=visible;if(visible){that.show(immediate)}else{that.hide(immediate)}}},show:function(immediate){var that=this,style={'opacity':1};if(immediate){that.$el.show().css(style);that.showBackground(true)}else{that.$el.stop(true,true).delay(BEFORE_SHOW_ADDON).queue(function(){that.$el.show();that.showBackground();that.$el.dequeue()}).animate(style,'fast')}},hide:function(immediate){var that=this,style={'opacity':0};if(immediate){that.$el.hide().css(style)}that.$el.stop(true).animate(style,{duration:'fast',complete:function(){that.$el.hide();that.hideBackground()}})},fixPosition:function(origin,elLayout){var that=this,addonSize=elLayout.innerHeight;that.checkType();that.$el.css({left:origin.left+elLayout.borderLeft+elLayout.innerWidth-addonSize+'px',top:origin.top+elLayout.borderTop+'px',height:addonSize,width:addonSize});that.initialPadding=elLayout.paddingRight;that.width=addonSize;if(that.visible){elLayout.componentsRight+=addonSize}},showBackground:function(immediate){var that=this,$el=that.owner.el,style={'paddingRight':that.width};if(that.width>that.initialPadding){that.stopBackground();if(immediate){$el.css(style)}else{$el.animate(style,{duration:'fast',queue:QUEUE_NAME}).dequeue(QUEUE_NAME)}}},hideBackground:function(immediate){var that=this,$el=that.owner.el,style={'paddingRight':that.initialPadding};if(that.width>that.initialPadding){that.stopBackground(true);if(immediate){$el.css(style)}else{$el.delay(BEFORE_RESTORE_PADDING,QUEUE_NAME).animate(style,{duration:'fast',queue:QUEUE_NAME}).dequeue(QUEUE_NAME)}}},stopBackground:function(gotoEnd){this.owner.el.stop(QUEUE_NAME,true,gotoEnd)},onClick:function(e){var that=this;if(that.type==ADDON_TYPES.CLEAR){that.owner.clear()}}};var methods$5={createAddon:function(){var that=this,addon=new Addon(that);that.$wrapper.append(addon.$el);that.addon=addon},fixAddonPosition:function(origin,elLayout){this.addon.fixPosition(origin,elLayout)},checkAddonType:function(){this.addon.checkType()},checkAddonVisibility:function(){this.addon.toggle()},stopBackground:function(){this.addon.stopBackground()}};$.extend(DEFAULT_OPTIONS,optionsUsed$1);notificator.on('initialize',methods$5.createAddon).on('setOptions',methods$5.checkAddonType).on('fixPosition',methods$5.fixAddonPosition).on('clear',methods$5.checkAddonVisibility).on('valueChange',methods$5.checkAddonVisibility).on('request',methods$5.checkAddonVisibility).on('resetPosition',methods$5.stopBackground);var optionsUsed$2={constraints:null,restrict_value:false};var fiasParamNames=['region_fias_id','area_fias_id','city_fias_id','city_district_fias_id','settlement_fias_id','street_fias_id'];function belongsToArea(suggestion,instance){var parentSuggestion=instance.selection,result=parentSuggestion&&parentSuggestion.data&&instance.bounds;if(result){$.each(instance.bounds.all,function(i,bound){return(result=parentSuggestion.data[bound]===suggestion.data[bound])})}return result}var ConstraintLocation=function(data,instance){var that=this,fieldNames,fiasFieldNames,fiasFields={};that.instance=instance;that.fields={};that.specificity=-1;if($.isPlainObject(data)&&instance.type.dataComponents){$.each(instance.type.dataComponents,function(i,component){var fieldName=component.id;if(component.forLocations&&data[fieldName]){that.fields[fieldName]=data[fieldName];that.specificity=i}})}fieldNames=utils.objectKeys(that.fields);fiasFieldNames=utils.arraysIntersection(fieldNames,fiasParamNames);if(fiasFieldNames.length){$.each(fiasFieldNames,function(index,fieldName){fiasFields[fieldName]=that.fields[fieldName]});that.fields=fiasFields;that.specificity=that.getFiasSpecificity(fiasFieldNames)}else if(that.fields.kladr_id){that.fields={kladr_id:that.fields.kladr_id};that.specificity=that.getKladrSpecificity(that.fields.kladr_id)}};$.extend(ConstraintLocation.prototype,{getLabel:function(){return this.instance.type.composeValue(this.fields)},getFields:function(){return this.fields},isValid:function(){return!$.isEmptyObject(this.fields)},getKladrSpecificity:function(kladr_id){var specificity=-1,significantLength;this.significantKladr=kladr_id.replace(/^(\d{2})(\d*?)(0+)$/g,'$1$2');significantLength=this.significantKladr.length;$.each(this.instance.type.dataComponents,function(i,component){if(component.kladrFormat&&significantLength===component.kladrFormat.digits){specificity=i}});return specificity},getFiasSpecificity:function(fiasFieldNames){var specificity=-1;$.each(this.instance.type.dataComponents,function(i,component){if(component.fiasType&&($.inArray(component.fiasType,fiasFieldNames)>-1)&&specificity<i){specificity=i}});return specificity},containsData:function(data){var result=true;if(this.fields.kladr_id){return!!data.kladr_id&&data.kladr_id.indexOf(this.significantKladr)===0}else{$.each(this.fields,function(fieldName,value){return result=!!data[fieldName]&&data[fieldName].toLowerCase()===value.toLowerCase()});return result}}});Suggestions.ConstraintLocation=ConstraintLocation;var Constraint=function(data,instance){this.id=utils.uniqueId('c');this.deletable=!!data.deletable;this.instance=instance;this.locations=$.map($.makeArray(data&&(data.locations||data.restrictions)),function(data){return new ConstraintLocation(data,instance)});this.locations=$.grep(this.locations,function(location){return location.isValid()});this.label=data.label;if(this.label==null&&instance.type.composeValue){this.label=$.map(this.locations,function(location){return location.getLabel()}).join(', ')}if(this.label&&this.isValid()){this.$el=$(document.createElement('li')).append($(document.createElement('span')).text(this.label)).attr('data-constraint-id',this.id);if(this.deletable){this.$el.append($(document.createElement('span')).addClass(instance.classes.removeConstraint))}}};$.extend(Constraint.prototype,{isValid:function(){return this.locations.length>0},getFields:function(){return $.map(this.locations,function(location){return location.getFields()})}});var methods$6={createConstraints:function(){var that=this;that.constraints={};that.$constraints=$('<ul class="suggestions-constraints"/>');that.$wrapper.append(that.$constraints);that.$constraints.on('click','.'+that.classes.removeConstraint,$.proxy(that.onConstraintRemoveClick,that))},setConstraintsPosition:function(origin,elLayout){var that=this;that.$constraints.css({left:origin.left+elLayout.borderLeft+elLayout.paddingLeft+'px',top:origin.top+elLayout.borderTop+Math.round((elLayout.innerHeight-that.$constraints.height())/2)+'px'});elLayout.componentsLeft+=that.$constraints.outerWidth(true)+elLayout.paddingLeft},onConstraintRemoveClick:function(e){var that=this,$item=$(e.target).closest('li'),id=$item.attr('data-constraint-id');delete that.constraints[id];that.update();$item.fadeOut('fast',function(){that.removeConstraint(id)})},setupConstraints:function(){var that=this,constraints=that.options.constraints,$parent;if(!constraints){that.unbindFromParent();return}if(constraints instanceof $||typeof constraints==='string'||typeof constraints.nodeType==='number'){$parent=$(constraints);if(!$parent.is(that.constraints)){that.unbindFromParent();if(!$parent.is(that.el)){that.constraints=$parent;that.bindToParent()}}}else{that._constraintsUpdating=true;$.each(that.constraints,$.proxy(that.removeConstraint,that));$.each($.makeArray(constraints),function(i,constraint){that.addConstraint(constraint)});that._constraintsUpdating=false;that.fixPosition()}},filteredLocation:function(data){var locationComponents=[],location={};$.each(this.type.dataComponents,function(){if(this.forLocations)locationComponents.push(this.id)});if($.isPlainObject(data)){$.each(data,function(key,value){if(value&&locationComponents.indexOf(key)>=0){location[key]=value}})}if(!$.isEmptyObject(location)){return location.kladr_id?{kladr_id:location.kladr_id}:location}},addConstraint:function(constraint){var that=this;constraint=new Constraint(constraint,that);if(constraint.isValid()){that.constraints[constraint.id]=constraint;if(constraint.$el){that.$constraints.append(constraint.$el);if(!that._constraintsUpdating){that.fixPosition()}}}},removeConstraint:function(id){var that=this;delete that.constraints[id];that.$constraints.children('[data-constraint-id="'+id+'"]').remove();if(!that._constraintsUpdating){that.fixPosition()}},constructConstraintsParams:function(){var that=this,locations=[],constraints=that.constraints,parentInstance,parentData,params={};while(constraints instanceof $&&(parentInstance=constraints.suggestions())&&!(parentData=utils.getDeepValue(parentInstance,'selection.data'))){constraints=parentInstance.constraints}if(constraints instanceof $){parentData=(new ConstraintLocation(parentData,parentInstance)).getFields();if(parentData){params.locations=[parentData];params.restrict_value=true}}else{if(constraints){$.each(constraints,function(id,constraint){locations=locations.concat(constraint.getFields())});if(locations.length){params.locations=locations;params.restrict_value=that.options.restrict_value}}}return params},getFirstConstraintLabel:function(){var that=this,constraints_id=$.isPlainObject(that.constraints)&&Object.keys(that.constraints)[0];return constraints_id?that.constraints[constraints_id].label:''},bindToParent:function(){var that=this;that.constraints.on(['suggestions-select.'+that.uniqueId,'suggestions-invalidateselection.'+that.uniqueId,'suggestions-clear.'+that.uniqueId].join(' '),$.proxy(that.onParentSelectionChanged,that)).on('suggestions-dispose.'+that.uniqueId,$.proxy(that.onParentDispose,that))},unbindFromParent:function(){var that=this,$parent=that.constraints;if($parent instanceof $){$parent.off('.'+that.uniqueId)}},onParentSelectionChanged:function(e,suggestion,valueChanged){if(e.type!=='suggestions-select'||valueChanged){this.clear()}},onParentDispose:function(e){this.unbindFromParent()},getParentInstance:function(){return this.constraints instanceof $&&this.constraints.suggestions()},shareWithParent:function(suggestion){var that=this.getParentInstance();if(!that||that.type!==this.type||belongsToArea(suggestion,that)){return}that.shareWithParent(suggestion);that.setSuggestion(suggestion)},getUnrestrictedData:function(data){var that=this,restrictedKeys=[],unrestrictedData={},maxSpecificity=-1;$.each(that.constraints,function(id,constraint){$.each(constraint.locations,function(i,location){if(location.containsData(data)&&location.specificity>maxSpecificity){maxSpecificity=location.specificity}})});if(maxSpecificity>=0){if(data.region_kladr_id&&data.region_kladr_id===data.city_kladr_id){restrictedKeys.push.apply(restrictedKeys,that.type.dataComponentsById['city'].fields)}$.each(that.type.dataComponents.slice(0,maxSpecificity+1),function(i,component){restrictedKeys.push.apply(restrictedKeys,component.fields)});$.each(data,function(key,value){if(restrictedKeys.indexOf(key)===-1){unrestrictedData[key]=value}})}else{unrestrictedData=data}return unrestrictedData}};$.extend(DEFAULT_OPTIONS,optionsUsed$2);$.extend(Suggestions.prototype,methods$6);if(utils.getDefaultType()!='GET'){notificator.on('initialize',methods$6.createConstraints).on('setOptions',methods$6.setupConstraints).on('fixPosition',methods$6.setConstraintsPosition).on('requestParams',methods$6.constructConstraintsParams).on('dispose',methods$6.unbindFromParent)}var methods$7={proceedQuery:function(query){var that=this;if(query.length>=that.options.minChars){that.updateSuggestions(query)}else{that.hide()}},selectCurrentValue:function(selectionOptions){var that=this,result=$.Deferred();that.inputPhase.resolve();that.fetchPhase.done(function(){var index;if(that.selection&&!that.visible){result.reject()}else{index=that.findSuggestionIndex();that.select(index,selectionOptions);if(index===-1){result.reject()}else{result.resolve(index)}}}).fail(function(){result.reject()});return result},selectFoundSuggestion:function(){var that=this;if(!that.requestMode.userSelect){that.select(0)}},findSuggestionIndex:function(){var that=this,index=that.selectedIndex,value;if(index===-1){value=$.trim(that.el.val());if(value){$.each(that.type.matchers,function(i,matcher){index=matcher(value,that.suggestions);return index===-1})}}return index},select:function(index,selectionOptions){var that=this,suggestion=that.suggestions[index],continueSelecting=selectionOptions&&selectionOptions.continueSelecting,currentValue=that.currentValue,hasSameValues;if(that.triggering['Select'])return;if(!suggestion){if(!continueSelecting&&!that.selection){that.triggerOnSelectNothing()}that.onSelectComplete(continueSelecting);return}hasSameValues=that.hasSameValues(suggestion);that.enrichSuggestion(suggestion,selectionOptions).done(function(enrichedSuggestion,hasBeenEnriched){that.selectSuggestion(enrichedSuggestion,index,currentValue,$.extend({hasBeenEnriched:hasBeenEnriched,hasSameValues:hasSameValues},selectionOptions))})},selectSuggestion:function(suggestion,index,lastValue,selectionOptions){var that=this,continueSelecting=selectionOptions.continueSelecting,assumeDataComplete=!that.type.isDataComplete||that.type.isDataComplete.call(that,suggestion),currentSelection=that.selection;if(that.triggering['Select'])return;if(that.type.alwaysContinueSelecting){continueSelecting=true}if(assumeDataComplete){continueSelecting=false}if(selectionOptions.hasBeenEnriched&&that.suggestions[index]){that.suggestions[index].data=suggestion.data}if(that.requestMode.updateValue){that.checkValueBounds(suggestion);that.currentValue=that.getSuggestionValue(suggestion,selectionOptions);if(that.currentValue&&!selectionOptions.noSpace&&!assumeDataComplete){that.currentValue+=' '}that.el.val(that.currentValue)}if(that.currentValue){that.selection=suggestion;if(!that.areSuggestionsSame(suggestion,currentSelection)){that.trigger('Select',suggestion,that.currentValue!=lastValue)}if(that.requestMode.userSelect){that.onSelectComplete(continueSelecting)}}else{that.selection=null;that.triggerOnSelectNothing()}that.shareWithParent(suggestion)},onSelectComplete:function(continueSelecting){var that=this;if(continueSelecting){that.selectedIndex=-1;that.updateSuggestions(that.currentValue)}else{that.hide()}},triggerOnSelectNothing:function(){var that=this;if(!that.triggering['SelectNothing']){that.trigger('SelectNothing',that.currentValue)}},trigger:function(event){var that=this,args=utils.slice(arguments,1),callback=that.options['on'+event];that.triggering[event]=true;if($.isFunction(callback)){callback.apply(that.element,args)}that.el.trigger.call(that.el,'suggestions-'+event.toLowerCase(),args);that.triggering[event]=false}};$.extend(Suggestions.prototype,methods$7);notificator.on('assignSuggestions',methods$7.selectFoundSuggestion);var optionsUsed$3={bounds:null};var methods$8={setupBounds:function(){this.bounds={from:null,to:null}},setBoundsOptions:function(){var that=this,boundsAvailable=[],newBounds=$.trim(that.options.bounds).split('-'),boundFrom=newBounds[0],boundTo=newBounds[newBounds.length-1],boundsOwn=[],boundIsOwn,boundsAll=[],indexTo;if(that.type.dataComponents){$.each(that.type.dataComponents,function(){if(this.forBounds){boundsAvailable.push(this.id)}})}if($.inArray(boundFrom,boundsAvailable)===-1){boundFrom=null}indexTo=$.inArray(boundTo,boundsAvailable);if(indexTo===-1||indexTo===boundsAvailable.length-1){boundTo=null}if(boundFrom||boundTo){boundIsOwn=!boundFrom;$.each(boundsAvailable,function(i,bound){if(bound==boundFrom){boundIsOwn=true}boundsAll.push(bound);if(boundIsOwn){boundsOwn.push(bound)}if(bound==boundTo){return false}})}that.bounds.from=boundFrom;that.bounds.to=boundTo;that.bounds.all=boundsAll;that.bounds.own=boundsOwn},constructBoundsParams:function(){var that=this,params={};if(that.bounds.from){params['from_bound']={value:that.bounds.from}}if(that.bounds.to){params['to_bound']={value:that.bounds.to}}return params},checkValueBounds:function(suggestion){var that=this,valueData;if(that.bounds.own.length&&that.type.composeValue){valueData=that.copyDataComponents(suggestion.data,that.bounds.own);suggestion.value=that.type.composeValue(valueData,['city_district'])}},copyDataComponents:function(data,components){var result={},dataComponentsById=this.type.dataComponentsById;if(dataComponentsById){$.each(components,function(i,component){$.each(dataComponentsById[component].fields,function(i,field){if(data[field]!=null){result[field]=data[field]}})})}return result},getBoundedKladrId:function(kladr_id,boundsRange){var boundTo=boundsRange[boundsRange.length-1],kladrFormat;$.each(this.type.dataComponents,function(i,component){if(component.id===boundTo){kladrFormat=component.kladrFormat;return false}});return kladr_id.substr(0,kladrFormat.digits)+(new Array((kladrFormat.zeros||0)+1).join('0'))}};$.extend(DEFAULT_OPTIONS,optionsUsed$3);$.extend(Suggestions.prototype,methods$8);notificator.on('initialize',methods$8.setupBounds).on('setOptions',methods$8.setBoundsOptions).on('requestParams',methods$8.constructBoundsParams);Suggestions.defaultOptions=DEFAULT_OPTIONS;Suggestions.version='17.2.1';$.Suggestions=Suggestions;$.fn.suggestions=function(options,args){if(arguments.length===0){return this.first().data(DATA_ATTR_KEY)}return this.each(function(){var inputElement=$(this),instance=inputElement.data(DATA_ATTR_KEY);if(typeof options==='string'){if(instance&&typeof instance[options]==='function'){instance[options](args)}}else{if(instance&&instance.dispose){instance.dispose()}instance=new Suggestions(this,options);inputElement.data(DATA_ATTR_KEY,instance)}})}})));(function($){$.fn.s3InnerNotice=function(options){return this.each(function(){var $this=$(this);var url=$this.data("url");$.ajax({url:url,type:'post',success:function(data){if(data!=0){$this.parents('._dashboard__inner_notice').addClass('_card--attention');$this.parents('._dashboard__inner_notice').find('._card__num').text(data)}},error:function(){s3.alert(JS_ERROR+' code: 2')}})})}})(jQuery);var jQuery_S3;(function($){jQuery_S3={editObject:function(obj,container,url,callback){S3Ajax.openAjaxForm(url,function(r){S3PopUp.closeLastPopup();if(obj){var parent=$(obj).parents('.box:first');$(r.html).insertAfter(parent);parent.empty().remove()}else{$(r.html).appendTo($(container))}});if(callback&&typeof(callback)=='function'){callback()}},deleteObject:function(){var obj,url,parent,msg,rpc;if(arguments.length==1){var o=arguments[0];obj=o.hasOwnProperty('obj')?o.obj:null;url=o.hasOwnProperty('url')?o.url:null;parent=o.hasOwnProperty('parent')?o.parent:null;msg=o.hasOwnProperty('msg')?o.msg:'';rpc=o.hasOwnProperty('rpc')?o.rpc:null;payload=o.hasOwnProperty('payload')?o.payload:null}else{obj=arguments[0];url=arguments[1];parent=arguments[2];msg=arguments[3];rpc=arguments[4]}S3PopUp.open('confirm',msg||s3.loc('JS_CONFIRM_DELETE'),function(){var error=false;if(rpc&&rpc.method){var p=new JsonRpcProxy(url,[rpc.method]);rpc.onError=function(response){error=true};p.call(rpc.method,rpc)}else if(payload){var res=S3Ajax.ajaxRequest(url,'post',payload);error=res.error||!(res.done||res.result)}else{var res=S3Ajax.ajaxRequest(url,'get');error=res.error||!(res.done||res.result)}if(!error){if(typeof parent!='string')parent='.box:first';$(obj).parents(parent).empty().remove()}else{S3PopUp.open('alert','<b>'+s3.loc('JS_ERROR')+' #'+response.error.code+'</b><br/><br/>'+response.error.message)}})},updateObject:function(obj,container,url,callback){var self=this,parent=$(obj).parents('.box:first'),r=S3Ajax.ajaxRequest(url,'post');$(r.html).insertAfter(parent);parent.empty().remove();if(callback&&typeof(callback)=='function'){callback()}},checkAllCheckboxes:function(obj,target,parent){var obj=$(obj),target=obj.parents(parent+':first').find(target);if(target.find('.s3-cb input:checked').size()==target.find('.s3-cb input').size()){target.find('.s3-cb').removeClass('half-active').removeClass('active').find('input').removeAttr('checked').prop('checked',false)}else{target.find('.s3-cb').removeClass('half-active').addClass('active').find('input').attr('checked','checked').prop('checked',true)}},deleteCronTask:function(obj,object_id,file_id){var cron_list_wrap=$(obj).closest('.cron-list-wrap'),cron_count=cron_list_wrap.find('.cron-count');s3.deleteObject(obj,'TR','/-/cms/v1/cron-queue/?act=delete&'+S3_ACCESS+'&object_id='+object_id+'&file_id='+file_id,function(){if(cron_count.text()==1){cron_list_wrap.empty().after('<br/><br />').remove()}else{cron_count.text(parseInt(cron_count.text())-1)}})},replaceNode:function(container,html){var newContainer=$(html);$(container).replaceWith(newContainer);newContainer.S3ChangeControls();fadeController.init(newContainer.get(0));OrderController.localStorageInit()},refreshSitemap:function(url){s3.confirm(s3.loc('JS_REGENERATE_SITEMAP'),function(){if(util.touchUrl(url)){util.msg(s3.loc('JS_REGENERATE_SITEMAP_JOB_CREATED'))}else{s3.alertHTML((msgError?msgError:s3.loc('JS_ERROR')))}popupController.closeLastPopup();s3.reloadVisibleContent()})}}})(jQuery);let MultiCheckboxControlController={};(function(_$){MultiCheckboxControlController={DATA_ATTR_ID:'data-multicheckbox_id',DATA_CONTROL_NAME:'data-control_name',ITEMS_PER_PAGE:12,HEADER_CLASSNAME:'.multi-checkbox-control__header',CONTROL_CLASSNAME:'.multi-checkbox-control',markupSettings:{},countPages:0,currentNumPage:0,notMod:{},options:{},currentKindId:0,currentName:'',currentControlName:'',currentControl:null,currentControlList:null,counterSelectedItemsNode:null,popupTitle:'',selectedItems:0,init:function(name,options,markup,notMod){this.options[name]=options;this.notMod[name]=+notMod;if(markup&&!_.isEqual(this.markupSettings,markup)){this.markupSettings=markup}},openPopup:function(ctx,name,title){let popup=new PopupWindow("ajaxPopupWindow_"+popupController.popups.length);popup.drag=true;popup.modal=true;popup.center=true;this.currentName=name;this.currentControlName=name.split('.')[0];this.currentKindId=+name.split('.')[1];this.currentControl=ctx.closest(".multi-checkbox-control");this.currentControlList=this.currentControl.querySelector(".multi-checkbox-control__list");this.countPages=Math.ceil(this.options[name].length/this.ITEMS_PER_PAGE);this.popupTitle=title;this.currentNumPage=0;this._recalculationSelectedItems();popupController.showPopup(popup);const content=this._contentFactory(this.currentNumPage);popup.obj.innerHTML=this._popupFactory(title,content);this.counterSelectedItemsNode=document.querySelector(".addition-fields__badge--white");return popup},_recalculationSelectedItems:function(){this.selectedItems=0;this.options[this.currentName].forEach((option)=>{if(option.selected)this.selectedItems++})},_contentFactory:function(numPage){return`<div class="addition-fields__header"><div class="addition-fields__selector-wrapper"><div class="addition-fields__selector"onclick="S3ContextMenuController.openContextMenu('.addition-fields__selector-menu', null, event, this, '.addition-fields__selector-wrapper');"><label class="s3-label-static-cb"><input type="checkbox"${this.selectedItems?'checked="checked"':''}${this.selectedItems?`onclick='MultiCheckboxControlController.clearSelected();'`:`onclick='MultiCheckboxControlController.selectAllPage();'`}><span class="ico"></span></label><div class="addition-fields__selector--title">${s3.loc('JS_SELECTED')}:</div><div class="addition-fields__badge addition-fields__badge--white">${this.selectedItems}</div><div class="addition-fields__arrow"></div></div><div class="addition-fields__selector-menu"><div class="addition-fields__selector-menu--item"onclick="MultiCheckboxControlController.selectAllPage();">${s3.loc('JS_ALL_IN_PAGE')}</div><div class="addition-fields__selector-menu--item"onclick="MultiCheckboxControlController.selectAllFolder();">${s3.loc('JS_ALL_IN_FOLDER')}</div></div></div><div class="addition-fields__amount"><div class="addition-fields__amount--title">${s3.loc('JS_AMOUNT_ELEMENTS')}:</div><div class="addition-fields__badge addition-fields__badge--gray">${this.options[this.currentName].length}</div></div></div>${this._popupItemsFactory(this.paginate(numPage))}${this._paginateFactory(numPage)}`},paginate:function(numPage){const start=this.ITEMS_PER_PAGE*numPage;const end=start+this.ITEMS_PER_PAGE;return this.options[this.currentName].slice(start,end)},changePage:function(numPage){this.currentNumPage=numPage;const content=this._contentFactory(numPage);popupController.getLastPopup().obj.innerHTML=this._popupFactory(this.popupTitle,content);this.counterSelectedItemsNode=document.querySelector(".addition-fields__badge--white")},clearSelected:function(){this.options[this.currentName].forEach((item)=>{this.deleteItem(this.currentName,item.id)});this._recalculationSelectedItems();const content=this._contentFactory(this.currentNumPage);popupController.getLastPopup().obj.innerHTML=this._popupFactory(this.popupTitle,content);this.counterSelectedItemsNode=document.querySelector(".addition-fields__badge--white")},selectAllPage:function(){const items=this.paginate(this.currentNumPage);const ids=[];items.forEach((item)=>{if(item.selected)return;item.selected=true;ids.push(item.id)});this._recalculationSelectedItems();this._addItems(ids);const content=this._contentFactory(this.currentNumPage);popupController.getLastPopup().obj.innerHTML=this._popupFactory(this.popupTitle,content);this.counterSelectedItemsNode=document.querySelector(".addition-fields__badge--white")},selectAllFolder:function(){const ids=[];this.options[this.currentName].forEach((item)=>{if(item.selected)return;item.selected=true;ids.push(item.id)});this._recalculationSelectedItems();this._addItems(ids);const content=this._contentFactory(this.currentNumPage);popupController.getLastPopup().obj.innerHTML=this._popupFactory(this.popupTitle,content);this.counterSelectedItemsNode=document.querySelector(".addition-fields__badge--white")},_paginateFactory:function(numPage){if(this.countPages<=1)return"";const items=(countPages)=>{const items=[];for(let i=0;i<countPages;i++){items.push(`<span class="mg-pagelist__item ${i === numPage ? `active` : ''}"${numPage!==i?`onclick="MultiCheckboxControlController.changePage(${i});"`:''}>${i+1}</span>`)}return items};return`<div class="mg-pagelist"><span class="mg-pagelist__item ${numPage === 0 ? 'disabled' : ''}"${numPage>=1?`onclick="MultiCheckboxControlController.changePage(0);"`:''}><span class="s3-ico-24 i-arrow-left-dual"></span></span><span class="mg-pagelist__item ${numPage === 0 ? 'disabled' : ''}"${numPage>=1?`onclick="MultiCheckboxControlController.changePage(${numPage - 1})"`:''}><span class="s3-ico-24 i-arrow-left"></span></span><span class="mg-pagelist__group">${items(this.countPages).join('')}</span><span class="mg-pagelist__item ${numPage + 1 === this.countPages ? 'disabled' : ''}"${numPage+1!==this.countPages?`onclick="MultiCheckboxControlController.changePage(${numPage + 1});"`:''}><span class="s3-ico-24 i-arrow-right"></span></span><span class="mg-pagelist__item ${numPage + 1 === this.countPages ? 'disabled' : ''}"${numPage+1!==this.countPages?`onclick="MultiCheckboxControlController.changePage(${this.countPages - 1});"`:''}><span class="s3-ico-24 i-arrow-right-dual"></span></span></div>`},_popupItemsFactory:function(options){const items=options.map((option)=>(this._popupItemFactory(option))).join('');return`<div class='addition-fields__list'>${items}</div>`},selectItems:function(ctx,id){if(ctx.checked){this._addItems([id]);this._findOption(this.currentName,id).selected=true;this.selectedItems++}else{this.deleteItem(this.currentName,id);this.selectedItems--}const checkbox=this.counterSelectedItemsNode.closest('.addition-fields__selector').getElementsByTagName('input')[0];this.counterSelectedItemsNode.innerHTML=this.selectedItems;if(this.selectedItems===0){checkbox.checked=false}else if(this.selectedItems>0&&!checkbox.checked){checkbox.checked=true}},_addItems:function(ids){const options=this._findOptions(this.currentName,ids);const items=[];options.forEach((option)=>{items.push(this._itemFactory(option))});this.currentControlList.insertAdjacentHTML("beforeEnd",items.join(''));_$(this.currentControlList).S3ChangeControls();this._toggleHeaders();this._selectDefaultValueReference(this.currentName)},_itemFactory:function(option){return`<div class="multi-checkbox-control__item ${option.index >= 0 ? `color-ref-control__item` : ''}"data-multicheckbox_id="${option.id}-kind_id${this.currentKindId}"><input type="checkbox"checked ${option.index>=0?`name="${this.currentControlName}[value][${option.index}]"`:`name="${this.currentControlName}[value][]"`}value="${option.id}"><div class="multi-checkbox-control__item-name color-ref-control__item-name">${option.code?`<div class="color-ref-control__image"style="background:${option.code};"></div>`:''}${option.urlImage?`<div class="color-ref-control__image"style="background: url(${option.urlImage}) 0 0 no-repeat;"></div>`:''}${option.name}</div>${this.markupSettings.enabled&&this.notMod[this.currentName]?`<div class="multi-checkbox-control__item-markup"><input type="text"name="${this.markupSettings.key}[${option.id}][delta]"value=""oninput="MultiCheckboxControlController.validateMarkupValue(event);"/><select name="${this.markupSettings.key}[${option.id}][type]"><option value="currency">${s3.loc('JS_CURRENCY')}</option><option value="percent">%</option></select></div>`:''}<div class="multi-checkbox-control__item-actions">${this.notMod[this.currentName]?`<label class="s3-cb switcher"><input id="s3_switcher"type="checkbox"${option.isDefault?`checked="checked"`:''}name="${this.currentControlName}[data][default]"value="${option.id}"onclick="MultiCheckboxControlController.toggleDefaultValueReference(this, '.multi-checkbox-control__list');"></label>`:''}<span class="multi-checkbox-control__remove"onclick="MultiCheckboxControlController.deleteItem('${this.currentName}', ${option.id});"></span></div></div>`},_popupItemFactory:function(option){return`<label class='addition-fields__item s3-label-static-cb'><input type='checkbox'onclick="MultiCheckboxControlController.selectItems(this, ${option.id});"${option.selected?"checked":''}><span class='ico'></span>${option.name}</label>`},_popupFactory:function(title,content){return`<div class='bluepopup-wrapper with-tabs'><table ${popupController.getLastPopup().expanded?`style="width: 100%;"class="bluepopup-table-expdanded"`:''}><tbody><tr><td class='draggable_title'><span class='title'>${title}</span></td><td class='controls'width='1'align='right'><span class='s3-ico winexpand-thin'onclick='popupController.toggleLastPopup(this);'></span><span class='s3-ico winclose-thin'onclick='popupController.closeLastPopup();'></span></td></tr><tr><td colspan='2'class='content'><div class='addition-fields'>${content}<span class="s3-btn-v2 grey"onclick="popupController.closeLastPopup();">${s3.loc('JS_CLOSE')}</span></div></td></tr></tbody></table></div>`},toggleDefaultValueReference:function(ctx,selector){if(!ctx.checked&&ctx.dataset.notClick!=="1"){setTimeout(()=>{ctx.click()},0);return false}else if(ctx.dataset.notClick!=="1"){const toggleCallbackFn=(el)=>{if(!el.checked||el===ctx)return;const controlName=ctx.closest(this.CONTROL_CLASSNAME).getAttribute(this.DATA_CONTROL_NAME);this._findOption(controlName,+ctx.value).isDefault=true;this._findOption(controlName,+el.value).isDefault=false;el.dataset.notClick="1";el.click();ctx.click()};ctx.closest(selector).querySelectorAll('#s3_switcher').forEach(toggleCallbackFn)}if(ctx.dataset.notClick==="1")ctx.dataset.notClick=""},_findOptions:function(name,ids){return this.options[name].filter((item)=>{if(ids.includes(item.id))return item})},_findOption:function(name,id){return this.options[name].find((item)=>{if(item.id===id)return item})},_toggleHeaders:function(){const headers=document.querySelectorAll(this.HEADER_CLASSNAME);headers.forEach((header)=>{const listItems=header.nextElementSibling;if(!listItems.childElementCount){header.style.display='none'}if(listItems.childElementCount&&header.style.display==='none'){header.style.display='flex'}})},_selectDefaultValueReference:function(name){if(this._checkSelectDefaultValueReference(name))return;const controls=Array.prototype.slice.call(document.querySelectorAll(this.CONTROL_CLASSNAME));const control=controls.find((_control)=>_control.getAttribute(this.DATA_CONTROL_NAME)===name);const switcher=control.querySelectorAll('input[id=s3_switcher]')[0];if(switcher){this._findOption(name,+switcher.value).isDefault=true;switcher.click()}},_checkSelectDefaultValueReference:function(name){return this.options[name].find((option)=>{return!!option.isDefault})},validateMarkupValue:function(event){const reg=new RegExp(/^-?(\d+)?(\.(\d)?(\d)?)?$/);if(!reg.test(event.target.value)){let value=event.target.value.split('');let dotIndex=0;value=value.map((character,index)=>{if(character===',')character='.';if(index===0&&(+character||character==='-'))return character;if(index===1&&(+character||+character===0))return character;if(character==='.'&&dotIndex===0){dotIndex=index;return character}if(+character||+character===0)return character});event.target.value=dotIndex?value.join('').slice(0,dotIndex+3):value.join('')}},deleteItem:function(name,id){const kindId=name.split('.')[1];const selectedItems=document.querySelectorAll(`.multi-checkbox-control__item`);selectedItems.forEach((item)=>{if(item.getAttribute(this.DATA_ATTR_ID)===`${id.toString()}-kind_id${kindId}`)item.remove()});const option=this._findOption(name,id);option.selected=null;option.isDefault=false;this._toggleHeaders();this._selectDefaultValueReference(name)}}})(jQuery);var S3Ajax;(function($){S3Ajax={hash_separator:'#',target:false,ajax_link_class:'s3-ajax-link',ajax_form_class:'s3-ajax-form',loader:false,init:function(target){var self=this,hash;self.target=$(target);self.addAjaxLoader();self.addHashSeparator($('body'));$(document).on('submit','form.'+self.ajax_form_class,function(e){e.preventDefault();self.sendFormData($(e.currentTarget))})},reloadContent:function(){var self=this;self.reloadContentByHash(window.location.hash.replace('&63;','?'))},addHashSeparator:function(data){var self=this;data.find('.'+self.ajax_link_class).each(function(){var link=$(this);link.attr('href',self.hash_separator+link.attr('href'))})},parseHash:function(url){var lnk=url.split(this.hash_separator);return lnk[1]},reloadContentByHash:function(hash){var self=this;if(/\/my\/s3\/[a-zA-Z0-9\_\/\.\?\=\&\%]*/.test(hash)){$.ajax({url:self.parseHash(hash),type:'POST',async:false,beforeSend:function(){self.loader.show()},success:function(data){var firstChar=data.charAt(0);data=data.substring(1,data.length);self.target.empty().html(data);self.addHashSeparator(self.target)},error:function(){alert("ERROR!")},complete:function(){self.loader.hide()}})}},sendFormData:function(form,callback){var self=this,$this=form,data;data=$this.serializeObject();$.ajax({url:$this.attr('action'),type:$this.attr('method'),async:false,data:data,beforeSend:function(){self.loader.show()},dataType:"json",success:function(data){if(data.error){S3PopUp.open('alert',data.error)}else if(data.done&&data.status=='1'){S3PopUp.open('alert','DONE')}else if(data.done&&data.html){S3PopUp.open('modal',data.html)};if(callback&&typeof(callback)=='function'){callback(data)}},error:function(){S3PopUp.open('alert','S3Ajax send form ERROR!')},complete:function(){self.loader.hide()}})},ajaxRequest:function(url,type,data,datatype){var self=this,res=false;$.ajax({url:url,type:type,async:false,data:(typeof(data)=='object')?data:{},dataType:(datatype)?datatype:'json',beforeSend:function(){self.loader.show()},success:function(data){res=data},error:function(){S3PopUp.open('alert','S3Ajax request ERROR!')},complete:function(){self.loader.hide()}});return res},openAjaxPopup:function(){var link,type,title,payload,method='GET',contentType='application/x-www-form-urlencoded; charset=UTF-8',dataType='html',self=this,initialArgs=arguments,onClose,onOpen,isReloaded;if(typeof arguments[0]=="object"){var o=arguments[0];link=o.hasOwnProperty("link")?o.link:null;type=o.hasOwnProperty("type")?o.type:null;title=o.hasOwnProperty("title")?o.title:null;onClose=o.hasOwnProperty("onClose")?o.onClose:null;onOpen=o.hasOwnProperty("onOpen")?o.onOpen:null;isReloaded=o.hasOwnProperty("isReloaded")?o.isReloaded:false;if(o.hasOwnProperty("jsonrpc")){payload=typeof o.jsonrpc=="string"?o.jsonrpc:JSON.stringify(o.jsonrpc);contentType='application/json';dataType='json';method='POST'}else if(o.hasOwnProperty("payload")){payload=o.payload;dataType='json';if(payload){method='POST'}else{method='GET'}}}else{link=arguments[0];type=arguments.length>1?arguments[1]:null}$.ajax({url:link,type:method,async:false,beforeSend:function(){self.loader.show()},data:payload,contentType:contentType,success:function(data,status,xhr){var popup,html,onReload;if(payload&&data.error!=undefined){S3PopUp.open('alert','<pre style="white-space:normal">'+data.error.message+'</pre>');return}if(data.result){html=payload?data.result:data}else{html=data}popup=S3PopUp.open(type,{body:html,title:title},null,onClose,onOpen);onReload=function(){if(payload||isReloaded){popup.onClose=null;S3PopUp.closeLastPopup();S3Ajax.openAjaxPopup.apply(self,initialArgs);util.msg(window.JS_RELOADED||'Reloaded')}else{S3PopUp.insertContent(self.ajaxRequest($(this).attr('reload-url'),'get',false,'html'))}};S3PopUp.setReloadFunction(popup,onReload);popup.find('.s3-popup-reload').attr('reload-url',xhr.getResponseHeader('Content-Location')).click(onReload)},error:function(){S3PopUp.open('alert','S3Ajax send form ERROR!')},complete:function(){self.loader.hide()}})},openAjaxPanel:function(){var link,type,title,jsonRpcRequest,method='GET',contentType='application/x-www-form-urlencoded; charset=UTF-8',dataType='html',self=this,initialArgs=arguments,onClose,onOpen,insert;if(typeof arguments[0]=="object"){var o=arguments[0];link=o.hasOwnProperty("link")?o.link:null;type=o.hasOwnProperty("type")?o.type:null;title=o.hasOwnProperty("title")?o.title:null;onClose=o.hasOwnProperty("onClose")?o.onClose:null;onOpen=o.hasOwnProperty("onOpen")?o.onOpen:null;insert=o.hasOwnProperty("insert")?o.insert:null;if(o.hasOwnProperty("jsonrpc")){jsonRpcRequest=typeof o.jsonrpc=="string"?o.jsonrpc:JSON.stringify(o.jsonrpc);contentType='application/json';dataType='json';method='POST'}}else{link=arguments[0];type=arguments.length>1?arguments[1]:null}$.ajax({url:link,type:method,async:false,beforeSend:function(){self.loader.show()},data:jsonRpcRequest,contentType:contentType,success:function(data,status,xhr){var panel,html,onReload;if(jsonRpcRequest&&data.error!=undefined){S3PopUp.open('alert','<pre style="white-space:normal">'+data.error.message+'</pre>');return}html=jsonRpcRequest?data.result:data;panel=S3LpPanel.open(type,{body:html,title:title},null,onClose,onOpen);panel.attr('data-params',jsonRpcRequest)},error:function(){S3PopUp.open('alert','S3Ajax send form ERROR!')},complete:function(){self.loader.hide()}})},openAjaxForm:function(link,onSubmit){var self=this;$.ajax({url:link,async:false,beforeSend:function(){self.loader.show()},success:function(data,status,xhr){var popup;popup=S3PopUp.open('modal',data);popup.find('form').off('submit').submit(function(e){e.preventDefault();self.sendFormData($(this),function(r){onSubmit(r)})}).end().find('.s3-popup-reload').attr('reload-url',xhr.getResponseHeader('Content-Location')).click(function(){S3PopUp.insertContent(self.ajaxRequest($(this).attr('reload-url'),'get',false,'html'))})},error:function(){S3PopUp.open('alert','S3Ajax send form ERROR!')},complete:function(){self.loader.hide()}})},addAjaxLoader:function(){var self=this;$('<div class="s3-ajax-loader"></div>').appendTo('body');self.loader=$('.s3-ajax-loader')}}})(jQuery);var S3PopUp;(function($){S3PopUp={DEFAULT_ZINDEX:9999,ZINDEX_STEP:2,EV_COLLAPSE:'s3::popup::collapse',EV_EXPAND:'s3::popup::expand',cap:false,popup_history:[],addDraggable:function(popup){var handle;if(popup.hasClass('alert')||popup.hasClass('confirm')){handle=false}else{handle=popup.find('.popup-header')}return popup.draggable({handle:handle,drag:function(e,ui){if(ui.position.top<=0){ui.position.top=0}}})},open:function(type,data,onConfirm,onClose,onOpen){var self=this,popup;self.addModalCap();if(type==undefined&&!type){type='popup'}switch(type){case"dynamic":self.cap.show();popup=$(data.body).appendTo('body');break;case"modal":self.cap.show();popup=$(self.getPopup()).appendTo('body');break;case"alert":self.cap.show();popup=$(self.getAlert()).appendTo('body');popup.css({maxWidth:'800px'});break;case"popup":popup=$(self.getPopup()).appendTo('body');break;case"confirm":popup=$(self.getConfirm()).appendTo('body');popup.find('.s3-popup-confirm').click(function(){self.closeLastPopup();if(onConfirm&&typeof(onConfirm)=='function'){onConfirm(popup)}});break}popup.s3PopupType=type;if(self.popup_history.length>0){var lastPopup,lastOldPopup,zIndex;lastPopup=self.getLastPopup();zIndex=Number(lastPopup.css('z-index'))||self.DEFAULT_ZINDEX;if(window.popupController!==undefined){if(lastOldPopup=window.popupController.getLastPopup()){zIndex=Math.max(zIndex,Number($(lastOldPopup.obj).css('z-index'))||0)}}zIndex+=self.ZINDEX_STEP;popup.css('z-index',zIndex)}self.popup_history.push(popup);if(type!='alert'){self.addDraggable(popup)}self.setTitle(data.title);if(typeof onClose=='function'){$.extend(popup,{onClose:onClose})}popup.find('.close').click(function(){self.closeLastPopup()});popup.find('.expand').click(function(){self.expandPopup(popup)});if(type=='alert'||type=='confirm'){data={body:data}}var callback=function(){self.alignByCenter(popup,type);if(typeof onOpen=='function'){onOpen(popup)}};if(type!="dynamic"){self.insertContent(data.body,callback)}else{callback();popup.S3ChangeControls()}self.adjustModalCap();return popup},closeLastPopup:function(){var $popup,lastOldPopup,zIndex,zIndexOld;$popup=this.getLastPopup();zIndex=$popup?Number($popup.css('z-index'))||0:0;if($popup&&$($popup).find('.nvd3-svg').length){$(document).find(".nvtooltip.xy-tooltip:last").remove()}if(window.popupController!==undefined){if(lastOldPopup=window.popupController.getLastPopup()){zIndexOld=Number($(lastOldPopup.obj).css('z-index'))||0}}if(zIndexOld&&zIndex<zIndexOld){popupController.closeLastPopup();return}if(!$popup){return}this.popup_history.pop();if(typeof $popup.onClose=='function'){$popup.onClose($popup)}$popup.empty().remove();if(this.popup_history.length>0){}else if(this.popup_history.length==0){this.cap.hide()}this.adjustModalCap()},getLastPopup:function(){var i=this.popup_history.length;while(--i>=0){if(this.popup_history[i].length!=0){return this.popup_history[i]}this.popup_history.splice(i,1)}return false},setReloadFunction:function(popup,f){popup.s3ReloadFunc=f},reloadLastPopup:function(){var p=S3PopUp.getLastPopup();if(!p||typeof p.s3ReloadFunc!='function')return;p.s3ReloadFunc()},insertContent:function(data,callback){var self=this,last=self.popup_history[self.popup_history.length-1];last.find('.content').html(data);if(callback&&typeof(callback)=='function'){callback()}},setTitle:function(title){if(title==undefined){return}var self=this,last=self.popup_history[self.popup_history.length-1];last.find('.popup-title').html(title)},appendContent:function(data){var self=this,last=self.popup_history[self.popup_history.length-1];last.find('.content').html(last.html()+data)},addModalCap:function(){var self=this,$cap=$('.s3-popup-cap');if($cap.size()==0){self.cap=$('<div class="s3-popup-cap"></div>').css('opacity','0.5').appendTo('body')}},adjustModalCap:function(){var popup,zIndex,cap;popup=this.getLastPopup();cap=$('.s3-popup-cap');if(popup===false||cap.size()==0){return}zIndex=popup.css('z-index');if(zIndex){cap.css('z-index',zIndex-1)}},alignByCenter:function(popup){var width=popup.data('width');if(!width){width='auto'}else{width+='px'}popup.css({'width':width,'min-height':'auto'});popup.position({my:"center",at:"center",of:"body"});var popup_height=popup.height();if(parseInt(popup_height)>parseInt($(window).height())){popup.css({'top':$(document).scrollTop()+20})}else{popup.css({'top':$(document).scrollTop()+parseInt($(window).height())/2-parseInt(popup_height)/2})}},verticalAlignByTop:function(popup){popup.css({'top':$(document).scrollTop()+20})},expandPopup:function(popup){var self=this,evt,$popup_body=popup.find('.popup-body'),popup_body_height=$popup_body.height();if(popup.hasClass('expanded')){popup.css({'width':'auto',});self.alignByCenter(popup);popup.removeClass('expanded');evt=self.EV_COLLAPSE}else{if(!popup.data('width')){popup.data('width',popup.width()+50)}popup.addClass('expanded').css({'left':0,'top':($(window).height()/2-popup.height()/2>0?$(window).height()/2-popup.height()/2:0),'right':0,'margin-left':0,'margin-top':0,'width':'100%','min-height':popup_body_height});evt=self.EV_EXPAND}window.util.customEvent.trigger(evt)},getPopup:function(){return $('#s3-popup-code').html()},getAlert:function(){return $('#s3-popup-alert-code').html()},getConfirm:function(){return $('#s3-popup-confirm-code').html()}}})(jQuery);var S3PageController;(function($){S3PageController={page_id:undefined,page_context_menu:'.s3-page-context',context_timeout:undefined,selectPageViewType:function(tpl_id,tpl_name,page_type,lp_preset_id=''){var default_page_type="page",link_page_type="link",tpl_btn=$('#template_id_btn'),tpl_field=$('#template_id');tpl_btn.text(tpl_name);tpl_field.val(tpl_id);if(!page_type){tpl_btn.removeClass('link');$('#page_content').val(default_page_type);$('#url_link').removeAttr('required');pageController.hideElements('#editUrlParams','#editVerificationParamsCode','#editVerificationParamsAddress');pageController.showElements('#editPageParams','#seo_tabs','#page_address','#page_seo_tab','#page_access_tab')}else if(page_type&&page_type=="link"){tpl_btn.addClass('link');$('#page_content').val(link_page_type);$('#url_link').attr('required','required');pageController.hideElements('#editVerificationParamsCode','#editVerificationParamsAddress','#page_address','#page_seo_tab','#page_seo','#page_access','#page_access_tab');pageController.showElements('#editUrlParams');$('#page_seo_tab, #page_access_tab').removeClass('tab-active')}if(!lp_preset_id){lp_preset_id=''}$('#lp_preset_id').val(lp_preset_id);if(!this.selectPageViewType.silentMode&&S3ContextMenuController.lastContextmenu){S3ContextMenuController.closeContextMenu()}},switchPageSettingTab:function(btn,parent){if(!btn||!parent){return false}var tab_body=$(btn.attr('data-tab-body'));if(!tab_body){return false}var btn_neighbor,btn_neighbor_body;if(tab_body.is(':visible')){btn.removeClass('tab-active');tab_body.addClass('hidden');util.createCookie('PageSettingTab','hidden',24)}else{btn.addClass('tab-active');tab_body.removeClass('hidden').S3ChangeControls();util.eraseCookie('PageSettingTab');parent.find('[data-tab-body]').not(btn).each(function(){btn_neighbor=$(this);btn_neighbor_body=$(btn_neighbor.attr('data-tab-body'));btn_neighbor.removeClass('tab-active');btn_neighbor_body.addClass('hidden')})}}}})(jQuery);var S3ContextMenuController;(function($){S3ContextMenuController={lastContextmenu:[],lastContextmenuSelector:[],lastContextbutton:[],contextmenuTimeout:undefined,onclose:undefined,openContextMenu:function(target,callback,event,obj,parent,no_close_last,level,onclose,not_close_selector,no_close){if(event&&!$(event.target).is($(obj))&&!$(event.target).parent().is($(obj))){return}var self=this,window_width=parseInt($(window).width()),target=(parent)?$(event.target).parents(parent+':first').find(target):target,offset=$(target).parent().offset();if(onclose&&typeof onclose==='function'){self.onclose=onclose}if($(target).is(':visible')){return false}else{if(self.lastContextmenu.length){var last_context_id='#'+self.lastContextmenu[self.lastContextmenu.length-1].attr('id');if(!no_close_last){self.closeContextMenu()}else if(level){self.closeContextMenu(level)}if(last_context_id==target){self.lastContextmenu=[];return false}}if(obj){self.lastContextbutton.push($(obj).addClass('context-button-active').data('contextmenu-level',level))}self.lastContextmenuSelector.push(target);$(target).data('contextmenu-level',level);var _t=$(target).show(1,function(){if($(target).data('width')){$(target).css('min-width',$(target).data('width'))}if(($(target).width()+offset.left)>window_width){$(target).css({'left':window_width-$(target).width()-offset.left-5})}$('body').click(function(e){if(no_close||$(e.target).is('.no-close')||$(e.target).parents('.no-close:first').size()||not_close_selector&&$(e.target).closest(not_close_selector).size()){return}self.closeContextMenu();self.lastContextmenu=[]});if(callback&&typeof(callback)=='function'){callback(self.lastContextmenu[self.lastContextmenu.length-1])}}).mousemove(function(){});self.lastContextmenu.push(_t.data('contextmenu-level',level))}},closeContextMenu:function(level){var self=this;var closed=false;$('body').off('click');$.each(self.lastContextmenuSelector,function(key,item){var $item=$(item);if(!level||$item.data('contextmenu-level')>=level){$item.off('mousemove').css('display','none');closed=true}});$.each(self.lastContextbutton,function(key,item){if(!level||item.data('contextmenu-level')>=level){$(item).removeClass('context-button-active')}});if(self.contextmenuTimeout){clearTimeout(self.contextmenuTimeout)}if(self.onclose&&closed){self.onclose();self.onclose=undefined}},resetTimeout:function(){var self=this;if(self.contextmenuTimeout){clearTimeout(self.contextmenuTimeout)}self.contextmenuTimeout=setTimeout(function(){self.closeContextMenu()},10000)}}})(jQuery);var imageBuyStatusUpdateTimeout;var ImageController;(function($){ImageController={checked:false,folder_id:false,image_count:false,container:false,image_selector_name:null,image_selector_control_id:0,image_selector_gallery_type_extra_get:'',isValidExtension:function(n){return/(?:jpg|png|jpeg|gif|tiff|tif|xbm|bmp|webp)$/i.test(n)},checkExtension:function(n){if(n&&!this.isValidExtension(n)){s3.alertHTML(s3.loc('JS_TYPE_NOT_ALLOWED'));return false}return true},_getContainer:function(idPrefix){return util.getObject(idPrefix+'container')},_getSearchForm:function(idPrefix){return util.getObject(idPrefix+'search_form')},_getSearchFormQuery:function(idPrefix){var f=this._getSearchForm(idPrefix);if(!(f&&f.elements.submitted.value))return'';var q='';$.each(f.elements,function(k,v){if(/^s\[/.test(v.name)){q+='&'+encodeURIComponent(v.name)+'='+encodeURIComponent(v.value)}});return q},groupMoveToCategory:function(idPrefix,folders_global){var self=this,url='/-/cms/v1/image/?act=move&'+S3_ACCESS+self._getSearchFormQuery(idPrefix)+'&folders_global='+folders_global,current_folder=self.folder_id;openAjaxForm(url+'&mode=choose&popup=1',function(r){s3.cronJobs(self._getContainer(idPrefix),'LI','image',url+'&mode=set&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupCopyToCategory:function(idPrefix,folders_global){var self=this,url='/-/cms/v1/image/?act=move&'+S3_ACCESS+self._getSearchFormQuery(idPrefix)+'&folders_global='+folders_global,current_folder=self.folder_id;openAjaxForm(url+'&mode=choose&popup=1',function(r){s3.cronJobs(self._getContainer(idPrefix),'LI','image',url+'&mode=append&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupResetCategory:function(idPrefix,folders_global){var self=this,url='/-/cms/v1/image/?act=move&'+S3_ACCESS+self._getSearchFormQuery(idPrefix)+'&folders_global='+folders_global,current_folder=self.folder_id;openAjaxForm(url+'&mode=choose&popup=1',function(r){s3.cronJobs(self._getContainer(idPrefix),'LI','image',url+'&mode=reset&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupAddWatermark:function(idPrefix,folders_global){var self=this,url='/-/cms/v1/image/?act=watermark&'+S3_ACCESS+self._getSearchFormQuery(idPrefix)+'&folders_global='+folders_global+'&mode=queue',current_folder=self.folder_id;s3.cronJobs(self._getContainer(idPrefix),'LI','image',url,null,'input',{checked:true},false,current_folder);self.folder_id=false},groupDelete:function(idPrefix,global,real){var self=this,url='/-/cms/v1/image/?act=delete&'+S3_ACCESS+self._getSearchFormQuery(idPrefix)+'&global='+global+(real?'&real='+real:''),current_folder=self.folder_id;s3.cronJobs(self._getContainer(idPrefix),'LI','image',url,null,'input',{checked:true},true,current_folder);self.folder_id=false},groupRestore:function(idPrefix,global){var self=this,url='/-/cms/v1/image/?act=restore&'+S3_ACCESS+self._getSearchFormQuery(idPrefix)+'&global='+global,current_folder=self.folder_id;s3.cronJobs(self._getContainer(idPrefix),'LI','image',url,null,'input',{checked:true},false,current_folder);self.folder_id=false},groupRestoreToCategory:function(idPrefix){var self=this,url='/-/cms/v1/image/?act=move&'+S3_ACCESS+self._getSearchFormQuery(idPrefix),current_folder=self.folder_id;openAjaxForm(url+'&mode=choose&popup=1',function(r){s3.cronJobs(self._getContainer(idPrefix),'LI','image',url+'&mode=restore&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},restore:function(image_id){if(image_id){var url='/-/cms/v1/image/?act=restore&'+S3_ACCESS+'&object_id='+image_id;nobject=util.makeGetRequest(url,'');if(nobject&&!nobject.error){treeController.reloadTree('.tree-wrapper');util.msg(s3.loc('JS_IMAGE_RESTORE_MESSAGE'));s3.reloadContent()}}},findLost:function(message){s3.confirm(message,function(){popupController.closeLastPopup();openAjaxForm('/-/cms/v1/image/?act=find_lost&'+S3_ACCESS,function(r){},function(r){s3.reloadVisibleContent()})})},deleteUnused:function(url,cmd){openAjaxForm(url+'&cmd='+cmd,function(r){},function(r){if(cmd!='show'){s3.reloadVisibleContent()}})},deleteCache:function(){url='/-/x-api/v1/protected/?method=image/clearCache&'+access,$.ajax({url:url,type:'POST',contentType:"application/json; charset=utf-8",success:function(data){if(data.result==true){s3.alert(s3.loc('IMAGE_DELETE_CACHE_ALL_DELETE'))}else{s3.alert(s3.loc('IMAGE_DELETE_CACHE_ALL_WRONG'))}},error:function(){console.log('Error')}})},search:function(form,depositphotos){var text=form.elements['s[text]'].value.trim();var url='/-/cms/v1/image/?type_id=3&'+S3_ACCESS;var is_popup=form.elements['popup'].value.trim()==1;var search_params=form.elements['s[search_params]'].value.trim();if(depositphotos){url+='&tab_id=depositphotos&p=0';var regex_replacer=new RegExp(' ','g');if(text!=""){text=text.replace(regex_replacer,'+');url+='&search_query='+text}if(search_params!=""){var search_params=$.parseJSON(search_params);if(search_params['dp_search_query']){text=search_params['dp_search_query'].replace(regex_replacer,'+');url+='&search_query='+text}delete search_params['dp_search_query'];if(!$.isEmptyObject(search_params)){for(param_key in search_params){search_params[param_key]=search_params[param_key].replace(regex_replacer,'+')}url+="&"+$.param(search_params)}}util.eraseCookie('last_page_for_type_image');util.createCookie('dp_search_url-ver_'+VER_ID,url);if(is_popup){url+='&selector=1&popup=1';s3.loadPopupContent(url)}else{s3.loadContent(url)}}else{if(text){search(form,'/-/cms/v1/image/?'+S3_ACCESS)}}return false},searchByParam:function(form,search_params,depositphotos){var self=this,form_container=form.get(0);form_container.elements['s[search_params]'].value=search_params;if(popupController.getLastPopup()){popupController.closeLastPopup()}self.search(form_container,depositphotos)},searchRestore:function(popup){var url='/-/cms/v1/image/?type_id=3&'+S3_ACCESS,search_hash=util.readCookie('dp_search_url-ver_'+VER_ID);if(!search_hash){return false}url+=decodeURIComponent(search_hash);if(popup){url+='&selector=1&popup=1';s3.loadPopupContent(url)}else{s3.loadContent(url)}},clearSearchParams:function(search_label,form){var form_container=form.get(0);form_container.elements['s[search_params]'].value='';search_label.remove();form.submit()},updateSearchParams:function(obj){var form=obj.parents('form'),search_params,obj_name=obj.attr('name'),obj_val=obj.val();if(!form||!obj){return false}var params_control=form.find('[name="s[search_params]"]');if(params_control){if(params_control.val()==''){search_params={}}else{search_params=$.parseJSON(params_control.val())}if(obj_name&&obj_val!=''){search_params[obj_name]=obj_val}else{delete search_params[obj_name]}if($.isEmptyObject(search_params)){search_params=''}else{search_params=JSON.stringify(search_params)}params_control.val(search_params)}},addWatermark:function(){openAjaxForm('/-/cms/v1/image/?act=watermark&mode=popup&'+S3_ACCESS+'&popup=1');var wn=popupController.getLastPopup();wn.onAfterReload=ImageController.watermarkControls;ImageController.watermarkControls(wn)},watermarkAction:function(form){queueFormData(form);ImageController.watermarkControls()},watermarkControls:function(win){var win=win||popupController.getLastPopup();var chs=$(win.obj).find('[name="folder_id[]"]');chs.change(function(){if($(this).val()=="0"){chs.filter('[value!=0]').attr('checked',chs.filter('[value=0]').is(":checked")).parent().S3changeCheckboxAndRadio()}else{chs.filter('[value=0]').attr('checked',false).parent().S3changeCheckboxAndRadio()}})},updateSelector:function(container){var self=this,n_images=$(container).find('li.image:not([data-exists])').length;$('.image-selector').show(0);if(n_images>self.image_count){$('.image-selector .selector-image-count').each(function(){this.innerHTML=Number(this.innerHTML.trim())+1})}$('.image-selector .selector-visible-number').each(function(){this.innerHTML=$(container).find('li.image').length})},getImageCount:function(container){var self=this;self.image_count=$(container).find('li.image:not([data-exists])').length},toggleTabImages:function(name,popup,callback,params,multiselect){var url='/-/cms/v1/image/?type_id=3&'+S3_ACCESS;if(typeof name!=='string'){return}url+='&tab_id='+name;if(params){var toggle_params=$.parseJSON(params);if(!$.isEmptyObject(toggle_params)){url+="&"+$.param(toggle_params)}}if(multiselect){url+='&multiselect=1'}if(popup){url+='&selector=1&popup=1';s3.loadPopupContent(url)}else{s3.loadContent(url,callback)}},disableWatermarkDirection:function(select){var value=$(select).val(),typeWatermark=$('#watermark_on').val();wdirection=$(select).parents('div:first').next();if(typeWatermark==1){if(value=='diag3'||value=='ns'||value=='we'||value=='diag'||value=='diag2'){$(wdirection).hide()}else{$(wdirection).show()}}},editImageFromPreview:function(image_selector){var image_container=$(image_selector);if(image_container.get(0)){popupController.closeLastPopup();image_container.find('span.objectEdit').trigger('click')}},buyImage:function(source_id,outer_image_id,preview_url){if(!source_id||!preview_url||!outer_image_id){console.log('Error occurred while buying image');return false}var url='/-/cms/v1/payment/?'+access+'&service_group=image_order_depositphotos'+'&order_params=image_id='+outer_image_id+'&order_data[image]='+JSON.stringify({'source_id':source_id,'outer_image_id':outer_image_id,'preview_url':preview_url,'status':'new'});s3.openModalPopup(url)},toggleImageFavorite:function(elem,source_id,outer_image_id,preview_url){var self=this,order_data=[];order_data['image']=JSON.stringify({'source_id':source_id,'outer_image_id':outer_image_id,'preview_url':preview_url,'status':'favorite'});self.updateImageSource(order_data,false,function(){elem.toggleClass('active')})},updateImageSource:function(order_data,return_to_all,callback){if(order_data&&order_data.image){var image_data=$.parseJSON(order_data.image),url='/-/x-api/v1/protected/?method=image/updateImageSource&'+access,popup=false;if(popupController.getLastPopup()){popup=true}Preloader.show({mini:true});$.ajax({url:url,type:'POST',data:{'source_id':image_data.source_id,'outer_image_id':image_data.outer_image_id,'status':image_data.status,'preview_url':image_data.preview_url},success:function(){if(return_to_all){ImageController.toggleTabImages('depositphotos',popup)}if(typeof callback=="function"){callback()}Preloader.hide()},error:function(){console.log('Error')}})}},getImageByFilename:function(ver_id,filename,callback){var self=this;var url='/-/x-api/v1/protected/?method=image/getImageIdByFilename&'+access;$.ajax({url:url,type:'POST',data:{'ver_id':ver_id,'filename':filename,},success:function(data){if(callback&&typeof callback==='function'){callback(data)}},error:function(){console.log('Error')}})},downloadImageSource:function(outer_image_id,popup,data,site_id,service_group){var self=this;if(data===''){self.getImageBuyStatus(outer_image_id,site_id,service_group)}else{if(outer_image_id){var url='/-/x-api/v1/protected/?method=image/downloadImageSource&'+access;Preloader.show({mini:true});$.ajax({url:url,type:'POST',data:{'image_id':outer_image_id,'data':data},success:function(data){Preloader.hide();if(!data.result){s3.alert(JS_IMAGE_DOWNLOAD_ERROR)}else{ImageController.toggleTabImages('depositphotos',popup,function(){util.msg(JS_IMAGE_DOWNLOADED)})}},error:function(){console.log('Error')}})}}},checkImageBuyStatus:function(outer_image_id,source_id){if(outer_image_id&&source_id){var url='/-/x-api/v1/protected/?method=image/checkImageSource&'+access;Preloader.show({mini:true});$.ajax({url:url,type:'POST',data:{'image_id':outer_image_id,'source_id':source_id},success:function(response){if(response.result=="downloaded"){s3.reloadVisibleContent()}else{s3.alert(JS_IMAGE_DOWNLOAD_IN_PROGRESS)}Preloader.hide()},error:function(){console.log('Error');Preloader.hide()}})}},getImageBuyStatus:function(outer_image_id,site_id,service_group){if(outer_image_id&&site_id&&service_group){var self=this,url='/-/x-api/v1/protected/?method=image/getImageSource&'+access,popup=false;if(popupController.getLastPopup()){popup=true}Preloader.show({mini:true});$.ajax({url:url,type:'POST',data:{'site_id':site_id,'service_group':service_group,'image_id':outer_image_id},success:function(response){if(response.result){var data=JSON.stringify(response.result.data);self.downloadImageSource(outer_image_id,popup,data,site_id,service_group)}},error:function(){console.log('Error');Preloader.hide()}})}},imagesStatusAutoUpdate:function(image_ids){var url='/-/x-api/v1/protected/?method=image/checkImagesBuyStatus&'+access,popup=false;clearTimeout(imageBuyStatusUpdateTimeout);imageBuyStatusUpdateTimeout=setTimeout(function(){checkStatusUpdate(image_ids)},5000);function checkStatusUpdate(image_ids){if(image_ids){if(popupController.getLastPopup()){popup=true}$.post(url,{image_ids:image_ids,source_id:1}).done(function(data){if(data.result){setTimeout(function(){s3.reloadVisibleContent()},2000)}else{imageBuyStatusUpdateTimeout=setTimeout(function(){checkStatusUpdate(image_ids)},30000)}})}}},groupAction:function(elem){var self=this,select=elem.parent().find('select'),action=select.find('option:selected').data('action'),menu=elem.next();menu.find('tr.'+action).click()},addImagesToSelector:function(idPrefix,gallery){var self=this,images=s3.getBatchOpInfo(self._getContainer(idPrefix),'LI','image','',null,'input',{checked:true});if(!images.ids.length){return s3.alert(s3.loc('JS_NO_OBJECTS_CHOSEN_ERROR'))}if(gallery){var galleryNum=s3.getInt(gallery);switch(galleryNum){case 1:var a=document.getElementById(self.image_selector_name);var gallery_id=$(a).data('gallery-id');if(a){var res=util.makePostRequest('/-/cms/v1/gallery/?act=add_images&'+access+'&group=1&object_id='+gallery_id,'&ids='+images.ids);$(a).append(res.text);util.msg(s3.loc('JS_ADDED_TO_LIST'));s3.reloadVisibleContent()}break;case 2:var a=document.getElementById(self.image_selector_name);var gallery_id=$(a).data('gallery-id');var album_id=$(a).data('album-id')||$(a).data('folder-id');var res=util.makePostRequest('/-/cms/v1/gallery2/?act=add_images&'+access+'&group=1&object_id='+gallery_id+'&album_id='+album_id,'&ids='+images.ids);$(a).append(res.text);util.msg(s3.loc('JS_ADDED_TO_LIST'));s3.reloadVisibleContent();$(a).S3ChangeControls();break}}else{var p=popupController.getPreviousPopup();if(p&&p.obj){var a=util.getElementByIdAndTagName(p.obj,'UL','control-multi-image'+self.image_selector_name);if(a){var res=util.makePostRequest('/-/cms/v1/image/?act=multi_control&'+access+'&group=1&control_id='+self.image_selector_control_id,'&ids='+images.ids+'&control_name='+self.image_selector_name);$(a).append(res.text);util.msg(s3.loc('JS_ADDED_TO_LIST'));s3.reloadVisibleContent()}}}},setPerPage:function(per_page,prevPopupReload){if(Number.isInteger(parseInt(per_page))){var url='/-/cms/v1/image/?act=settings&'+S3_ACCESS;util.makePostRequest(url,'images_per_page='+parseInt(per_page)+'&save_per_page=1');if(popupController.getLastModalPopup()){var popup=popupController.getLastModalPopup();s3.reloadVisibleContent(util.urlParamReplace(popup.url,'p',0));if(prevPopupReload&&popupController.getPreviousPopup()){popupController.reloadPreviousPopup()}}else{s3.reloadVisibleContent(util.urlParamReplace(s3.lastContentUrl,'p',0))}}},}})(jQuery);var treeController;(function($){treeController={contextMenu:'.s3-tree-context',node:false,tree:false,orderButtons:false,dynaTree:false,current_folder_id:false,nodeIdPostfix:'',showFolderId:false,loadMode:'',tree_prefix:false,is_search:false,searchResults:false,divScroll:'folder_scroll_div',tree_changes:[],type:'',selectedFolders:'',folderCount:0,urlStructureSave:'/-/cms/v1/folder/?act=storage&'+S3_ACCESS,exportFolders:0,refs:false,is_collect:false,folder_id:0,cookie:{'image':'last_folder_for_type_image','lp_block_layout':'last_folder_for_type_lp_block_layout','shop2':'last_folder_for_type_shop2','file':'last_folder_for_type_file','article2_lenta':'last_folder_for_type_article2_lenta','users':'last_folder_for_type_users','mosaic':'last_folder_for_type_mosaic','gallery2':'last_folder_for_type_gallery2','text':'last_folder_for_type_text','textplain':'last_folder_for_type_textplain','article_category':'last_folder_for_type_article_category','shop':'last_folder_for_type_shop',},urls:{'image':'/-/cms/v1/image/','lp_block_layout':'/-/cms/v1/lp/block/layout/?act=index','shop2':'/-/cms/v1/shop2/?act=view','file':'/-/cms/v1/file/','article2_lenta':'/-/cms/v1/article2/','users':'/-/cms/v1/user/','media':'/-/cms/v1/media/','mosaic':'/-/cms/v1/mosaic/','gallery2':'/-/cms/v1/gallery2/','text':'/-/cms/v1/text/','textplain':'/-/cms/v1/text-plain/','article_category':'/-/cms/v1/article-category/?act=view','shop2_marketplace_mapping':'/-/cms/v1/shop2/marketplace/','shop':'/-/cms/v1/shop/?act=view',},acl:{'image':'image.folder','shop2':'shop2_product.manage_category','file':'files.manage','textplain':'html.manage','text':'text.manage','article_category':'articles.manage','article2_lenta':'articles2.manage','flash':'flash.manage','media':'media.manage','users':'users.folder','mosaic':'mosaic.manage','external_classifiers':'shop2_product.manage_yml_category','lp_block_layout':'lp_block_layout.manage','gallery2':'gallery2.manage',},getUrl:function(node,params){let base_url=this.urls[node.data.type];return base_url+(base_url.indexOf('?')===-1?'?':'&')+params},init:function(object,form){var self=this,tree_id=object.data('tree-id'),target=$(object),folderCount=object.data('folders-count');self.folderCount=folderCount;self.orderButtons=$('.s3-tree-order-buttons');self.searchResults=$('.search-results');self.tree=target;self.tree_changes=[];self.type=object.data('type');self.tree_id=tree_id;self.menu_modified=object.data('menu-modified');var foldersControls=target.parents('.s3-tree-wr:first').find('.folders-controls');foldersControls.removeAttr('style');$(window).scroll(function(){if($(object).get(0)){foldersControls.removeAttr('style');if($(this).scrollTop()>target.offset().top&&$(this).scrollTop()<target.offset().top+target.parents('td.tree-wrapper').height()-100){foldersControls.css({top:$(this).scrollTop()-target.offset().top+90,})}else{foldersControls.removeAttr('style')}}});if(ACLController.access.indexOf(self.acl[self.type])===-1&&self.type!='shop'){var treeWrapper=$(target).parents('.s3-tree-wr:first'),controls=treeWrapper.find('nobr'),addButton=controls.find('>span.add-folder'),deleteButton=controls.find('label.delete-tree');if(addButton.get(0)){addButton.addClass('deny');addButton.removeAttr('title');addButton.attr('onclick','ACLController.accessError(event, this)');addButton.attr('data-access',self.acl[self.type]);addButton.on('mouseout',function(){addButton.removeClass('on');$('.custom-tooltip-styling.access').empty().remove()})}if(deleteButton.get(0)){deleteButton.addClass('deny');deleteButton.removeAttr('title');deleteButton.attr('onclick','ACLController.accessError(event, this)');deleteButton.attr('data-access',self.acl[self.type]);deleteButton.on('mouseout',function(){deleteButton.removeClass('on');$('.custom-tooltip-styling.access').empty().remove()})}}target.dynatree({debugLevel:0,persist:false,cookieId:'dynatree-'+tree_id,minExpandLevel:2,generateIds:true,onLazyRead:function(node){node.appendAjax({url:'/-/cms/v1/folder/?act=branch&'+S3_ACCESS,data:{folder_id:node.data.key,_left:node.data._left,_right:node.data._right,_level:node.data._level,tree_id:tree_id,mode:node.data.mode,type:node.data.type,type_id:node.data.type_id,object_id:node.data.object_id,tree_prefix:node.data.tree_prefix,selectedFolders:self.selectedFolders,global_folder:node.data.global_folder,tab_id:node.data.tab_id,orderby:node.data.orderby,showFolderId:(node.data.showFolderId)?1:0,},async:false,type:'post',})},onActivate:function(node){},onCustomRender:function(node){if(ACLController.access.indexOf(self.acl[node.data.type])===-1&&self.type!='shop'){node.data.noedit=true}var html='';if(node.data._level==0){html=html+'<span class="dynatree-title">'+node.data.folder_name+'</span>';html=html+'<span class="dynatree-items s3-badge">'+node.data.items+'</span>'}else{html+='<span class="wrapper">';if(!node.data.noedit&&!self.refs&&node.data.key>0&&self.loadMode!='select'){html=html+'<span class="dynatree-context"></span>'}if(node.data.tree_prefix){if(self.loadMode!='select'){html+='<span class="checkbox"><label class="s3-rb" onclick="folderController.click('+node.data.key+', this);"><input class="folder-input" type="radio" value="'+node.data.key+'" data-name="'+node.data.folder_name+'" name="folder_id"></label></span>'}else{html+='<span class="checkbox"><label class="s3-cb" onclick="folderController.click('+node.data.key+', this);"><input class="folder-input" type="checkbox" value="'+node.data.key+'" data-name="'+node.data.folder_name+'" name="folder_id"></label></span>'}}html+='<span class="active-wrapper">';html=html+'<span class="dynatree-title folder-name" id="folder'+node.data.key+'">'+node.data.folder_name+'</span>';if(!node.data.noedit&&!self.refs&&node.data.key>0&&self.loadMode=='select'){html=html+'<span class="dynatree-context"></span>'}if(node.data.href){html+='<a target="_blank" href="'+node.data.href+'" class="s3-ico i-link-svg"></a>'}if(parseInt(node.data.items)>0){html=html+'<span class="dynatree-items s3-badge">'+node.data.items+'</span>'}html+='</span>';html+='</span>';if(node.data.key>0){html=html+'<span class="dynatree-folder-id s3-clipboard-btn no-icon" data-clipboard-text="'+node.data.key+'">'+node.data.key+'</span>'}if(node.data.tree_prefix&&node.childList&&node.data.type_id!=78){html=html+'<span id="folder-branch-'+node.data.folder_id+'" class="choose-branch" data-selected="false"><a href="#" onclick="event.preventDefault(); folderController.selectBranch(this, '+node.data.folder_id+');">'+s3.loc('JS_CHOOSE_BRANCH')+'</a></span>'}}return html},onRender:function(node,nodeSpan){var j_node=$(nodeSpan);if(self.loadMode=='browse'&&self.selectedFolders==null&&node.data.key==0){node.data.selected=1}if(node.data.selected&&node.data.key==0){folderController.allSelected=true}if(self.selectedFolders&&self.selectedFolders.split(',').indexOf(node.data.key)!=-1){node.data.selected=1}if(parseInt(node.data.system)==1&&node.data._level>0){j_node.addClass('filter');j_node.find('span.dynatree-icon:first').addClass('s3-tooltip small').attr('title',s3.loc('JS_CATEGORY_FILTER'))}if(parseInt(node.data.system)==2&&node.data._level>0){j_node.addClass('link');j_node.find('span.dynatree-icon:first').addClass('s3-tooltip small').attr('title',s3.loc('JS_CATEGORY_LINK'))}if(self.exportFolders){j_node.addClass('export')}if(node.data.hidden==1){j_node.addClass('hidden')}if(node.data.hidden==2){j_node.addClass('linked')}if(node.data.active&&node.data.tree_prefix==0){self.current_folder_id=node.data.key;j_node.addClass('active');if(!node.data.preventAutoExpand){node.expand(true)}}if(node.data.parentActive){j_node.addClass('active-parent');if(!node.data.preventAutoExpand){node.expand(true)}}if(node.data.key>0){j_node.find('.dynatree-context').bind('click',function(e){e.preventDefault();self.openContextMenu(node)});if(!node.data.noedit&&!self.refs){j_node.find('.dynatree-title').bind('contextmenu',function(e){e.preventDefault();self.openContextMenu(node)})}}if(node.data.locked>0){j_node.addClass('pageLocked')}if(node.data.selected>0){j_node.addClass('active');j_node.find('.s3-cb, .s3-rb').addClass('active');j_node.find('.s3-cb input, .s3-rb input').attr('checked','checked')}j_node.find('span.checkbox label').bind('click',function(e){e.preventDefault();node.data.selected=(node.data.selected)?0:1;if(node.data.key==0){folderController.selectAllFolders(node);return false}if(self.is_search){var label=$('.search-results').find('li.folder-'+node.data.key+' label:first');if(label.hasClass('active')){label.removeClass('active');label.find('input').removeAttr('checked')}else{label.addClass('active');label.find('input').attr('checked','checked')}}});j_node.find('.dynatree-title').bind('click',function(e){if(node.data.tree_prefix>0){switch(self.loadMode){case'browse':if(node.data.key==0){folderController.click(0)}else{folderController.click(node.data.key,$(this))}break;case'select2':if(node.data.key==0){folderController.click(0)}else{folderController.click(node.data.key,$(this))}break;case'select':if(node.data.key==0){folderController.selectAllFolders(node);return false}$(this).parents('li:first').find('label:first').click();break}return}var url=self.getUrl(node,S3_ACCESS);if(node.data.object_id>0){var id=node.data.object_id;url=self.getUrl(node,'object_id='+id+'&'+S3_ACCESS)}if(node.data.type=='image'&&ImageController.image_selector_name){url+='&multiselect=1'+ImageController.image_selector_gallery_type_extra_get}if(node.data.cropper_width&&node.data.cropper_height){url+='&cropper_width='+node.data.cropper_width+'&cropper_height='+node.data.cropper_height}if(node.data.type=='article2_lenta'||node.data.type=='article2'){url+='&act=view'}if(node.data.type=='users'&&util.readCookie('users_select')){url+='&select=1'}if(node.data.type=='file'&&util.readCookie('selected_files')){url+='&'+decodeURIComponent(util.readCookie('selected_files'))}if(node.data.type=='inner_notice'&&!node.data.notice_client_view){url+='&act=index_admin'}else if(node.data.type=='inner_notice'&&node.data.notice_client_view){url+='&act=index&server_id='+node.data.server_id+'&lang_id='+node.data.lang_id+'&id_client'+node.data.id_client}if(node.data.type=='gallery2'){url+='&act=view'}if(node.data.type=='shop2_marketplace_mapping'){url+='&act=mapping'+'&integration_id='+node.data.integration_id+'&type_mapping='+node.data.type_mapping+'&matched='+node.data.matched+(node.data['search']?'&search='+node.data.search:'')}e.preventDefault();if(self.current_folder_id==node.data.key&&(node.data.type_id!=39&&node.data.type_id!=3&&node.data.type_id!=2&&node.data.type_id!=8)){if(node.hasChildren()){var expanded=node.isExpanded();node.expand(!expanded)}return}if(parseInt(node.data.system)>1&&node.data._level){return}util.eraseCookie(self.cookie[node.data.type]);if(node.data.key!=0){self.current_folder_id=node.data.key;url=url+'&folder_id='+node.data.key;if(node.data.orderby){url=url+'&orderby='+node.data.orderby}if(node.data.ordertype){url=url+'&ordertype='+node.data.ordertype}}else{util.eraseCookie(self.cookie[node.data.type])}if(node.data.tab_id){url=url+'&tab_id='+node.data.tab_id}if(node.data.usersSelected){var usersSelected=node.data.usersSelected.split(',');for(var u=0;u<usersSelected.length;u++){url+='&selected[]='+usersSelected[u]}}util.createCookie(self.cookie[node.data.type],node.data.key);if(!popupController.getLastModalPopup()){if(!url){url=s3.lastContentUrl}s3.loadContent(url,function(){$('html, body').scrollTop(0)})}else{popupController.reloadLastPopup(url?util.urlParamReplace(url,'popup',1):false);var p=popupController.getLastPopup();$('html, body').scrollTop($(p.obj).offset().top)}});node.data.preventAutoExpand=true;j_node.S3ChangeControls()},onCreate:function(node){},classNames:$.ui.dynatree.prototype.options.classNames,dnd:{onDragStart:function(node){if(node.data.noedit||node.data.folder_id===0){return false}else{return true}},onDragStop:function(node){},autoExpandMS:200,preventVoidMoves:true,onDragEnter:function(node,sourceNode){if(node.data._level==0||node.data.folder_id===0){return false}else{return true}},onDragOver:function(node,sourceNode,hitMode){if(node.isDescendantOf(sourceNode)){return false}},onDrop:function(node,sourceNode,hitMode,ui,draggable){if(node.data._level==0||node.data.folder_id===0){return false}if(self.loadMode){self.orderButtons=$(popupController.getLastPopup().obj).find('div.s3-tree-order-buttons')}sourceNode.move(node,hitMode);sourceNode.data.addClass=sourceNode.data.addClass.replace('added','');sourceNode.data.addClass=sourceNode.data.addClass+' added';sourceNode.render();setTimeout(function(){sourceNode.data.addClass=sourceNode.data.addClass.replace('added','');sourceNode.render()},3000);self.tree_changes.push({source_id:sourceNode.data.key,source_tree_id:sourceNode.data.tree_id,target_id:node.data.key,target_tree_id:node.data.tree_id,mode:hitMode,});var last_menu_modified=self.getTreeModified(self.tree_id,self.menu_modified,node.data.key);if(self.orderButtons){if(!self.orderButtons.is(':visible')){if(last_menu_modified===self.menu_modified){self.saveStructureFirstAlert()}}$(sourceNode.span).parents('.s3-tree-wrapper-in:first').addClass('saveTree')}},onDragLeave:function(node,sourceNode){},},});if(self.loadMode&&self.loadMode!='browse'&&target.length){if(target.dynatree('getRoot').countChildren()<=1){$(target).hide()}}$(target).addClass(self.loadMode);if($('.tree-wrapper .search-results.load-data-'+tree_id).length&&localStorage.getItem('folder_search_data_'+tree_id)){$('.tree-wrapper .search-results.load-data-'+tree_id).html(localStorage.getItem('folder_search_data_'+tree_id));if($('.folders-search input[name="s[text]"]').val()){$('.folders-search .reset').css('opacity','1')}}$('.folders-search input[name="s[text]"]').keyup(function(){if(!$(this).val().trim()){$('.folders-search .reset').css('opacity','0')}})},add:function(parent_id,object_id,type_id,global_folder,mode,hidden){var self=this,parent_id=parseInt(parent_id,10),object_id=parseInt(object_id,10)||0,type_id=parseInt(type_id,10),global_folder=parseInt(global_folder,10),mode=mode||'browse',hidden=hidden||0,nodeIdPostfix=nodeIdPostfix||'',showFolderId=showFolderId||0,tree_prefix=(self.tree_prefix)?1:0,url='/-/cms/v1/folder/?act=edit',tree=$('.tree-wrapper');url=url+'&'+S3_ACCESS+'&dynatree=1&folder_parent='+parent_id+'&folder_id=0&object_id='+object_id+'&type_id='+type_id+'&mode='+mode+'&hidden='+hidden+'&global_folder='+global_folder+'&tree_prefix='+tree_prefix+'&nodeIdPostfix='+nodeIdPostfix+'&showFolderId='+showFolderId;if(self.exportFolders){url+='&noedit=1'}if(self.exportFolders||self.loadMode){tree=$('.folders-tree')}openAjaxForm(url,function(result){popupController.closeLastPopup();tree.find('.folder-'+parent_id).each(function(ind,el){self.node=$.ui.dynatree.getNode(el);if(self.node){self.node.addChild(JSON.parse(result.text));self.node.expand(true)}});self.tree.show();if(self.exportFolders){self.reloadTree()}$('.s3-tree-wr').find('div.properties label:last').css('display','inline-block')},function(){if(self.type=='gallery2'){s3.reloadVisibleContent()}})},edit:function(folder_id,object_id,type_id,global_folder,mode,hidden,selected,nodeIdPostfix,showFolderId,shop2){var self=this,folder_id=parseInt(folder_id,10),object_id=parseInt(object_id,10)||0,type_id=parseInt(type_id,10),global_folder=parseInt(global_folder,10),mode=mode||'browse',hidden=hidden||0,selected=selected||0,nodeIdPostfix=nodeIdPostfix||'',showFolderId=showFolderId||0,tree_prefix=(self.tree_prefix)?1:0,url='/-/cms/v1/folder/?act=edit';if(!type_id||!folder_id){s3.alert('Error!')}url=url+'&'+S3_ACCESS+'&dynatree=1&folder_parent=0&folder_id='+folder_id+'&object_id='+object_id+'&type_id='+type_id+'&mode='+mode+'&hidden='+hidden+'&global_folder='+global_folder+'&tree_prefix='+tree_prefix+'&selected='+selected+'&nodeIdPostfix='+nodeIdPostfix+'&showFolderId='+showFolderId;if(!self.node){self.node=$.ui.dynatree.getNode($('.folder-'+folder_id))}if(self.loadMode){self.node=$.ui.dynatree.getNode($('.s3-tree-wrapper-in.popup .folder-'+folder_id))}openAjaxForm(url,function(result){popupController.closeLastPopup();self.node.data=JSON.parse(result.text);self.node.render();if(self.is_search){var folder_name=self.node.data.folder_name,hidden=parseInt(self.node.data.hidden),spanName=self.searchResults.find('li.folder-'+folder_id+' span.folder-name');spanName.text(folder_name);if(!hidden){spanName.removeClass('hidden')}else{spanName.addClass('hidden')}}if(parseInt(self.node.data.system)){var folder_ids_input=util.getObject('folder_ids'+nodeIdPostfix);if(folder_ids_input){var ids=folder_ids_input.value.split(',');if(ids.indexOf(self.node.data.key)!=-1){ids.splice(ids.indexOf(self.node.data.key),1);folder_ids_input.value=ids.join(',')}}}},function(){if(shop2||self.type=='gallery2'){s3.reloadVisibleContent()}},function(result){self.node.data=JSON.parse(result.text);self.node.render();if(self.is_search){var folder_name=self.node.data.folder_name,hidden=parseInt(self.node.data.hidden),spanName=self.searchResults.find('li.folder-'+folder_id+' span.folder-name');spanName.text(folder_name);if(!hidden){spanName.removeClass('hidden')}else{spanName.addClass('hidden')}}if(parseInt(self.node.data.system)){var folder_ids_input=util.getObject('folder_ids'+nodeIdPostfix);if(folder_ids_input){var ids=folder_ids_input.value.split(',');if(ids.indexOf(self.node.data.key)!=-1){ids.splice(ids.indexOf(self.node.data.key),1);folder_ids_input.value=ids.join(',')}}}})},copy:function(folder_id,object_id,type_id,global_folder,mode,copymode,parent_id,nodeIdPostfix,showFolderId){var self=this,folder_id=parseInt(folder_id,10),parent_id=parseInt(parent_id,10),object_id=parseInt(object_id,10)||0,type_id=parseInt(type_id,10),global_folder=parseInt(global_folder,10),mode=mode||'browse',copymode=copymode||'copy',nodeIdPostfix=nodeIdPostfix||'',showFolderId=showFolderId||'',url='/-/cms/v1/folder/?act=copy',node_child=undefined,children_list=undefined,response;if(!type_id||!folder_id){s3.alert('Error!')}url=url+'&'+S3_ACCESS+'&dynatree=1&folder_parent='+parent_id+'&folder_id='+folder_id+'&object_id='+object_id+'&type_id='+type_id+'&mode='+mode+'&copymode='+copymode+'&global_folder='+global_folder+'&nodeIdPostfix='+nodeIdPostfix+'&showFolderId='+showFolderId;if(!self.node){self.node=$.ui.dynatree.getNode($('.folder-'+folder_id))}if(self.loadMode){self.node=$.ui.dynatree.getNode($('.s3-tree-wrapper-in.popup .folder-'+folder_id))}$.ajax({url:url,dataType:'json',success:function(data){if(data.error){s3.alert(data.msg)}else{var alert_message,message_prefix;if(self.node.data.type_id==39||self.node.data.type_id==32){if(self.node.data.system==2){alert_message=(copymode=='copyfull'?s3.loc('JS_FOLDER_BRANCH_COPY_DONE'):s3.loc('JS_FOLDER_LINK_COPY_DONE')),message_prefix=(copymode=='copyfull'?s3.loc('JS_FOLDER_BRANCH_COPY_DONE'):s3.loc('JS_FOLDER_LINK_COPY_DONE'))+self.node.data.type_id}else{alert_message=(copymode=='copyfull'?s3.loc('JS_FOLDER_BRANCH_COPY_DONE'):s3.loc('JS_FOLDER_COPY_DONE')),message_prefix=(copymode=='copyfull'?s3.loc('JS_FOLDER_BRANCH_COPY_DONE'):s3.loc('JS_FOLDER_COPY_DONE'))+self.node.data.type_id}}else{alert_message=(copymode=='copyfull'?s3.loc('JS_FOLDER_BRANCH_COPY_DONE_NOT_HIDDEN'):s3.loc('JS_FOLDER_COPY_DONE_NOT_HIDDEN')),message_prefix=(copymode=='copyfull'?s3.loc('JS_FOLDER_BRANCH_COPY_DONE_NOT_HIDDEN'):s3.loc('JS_FOLDER_COPY_DONE_NOT_HIDDEN'))+self.node.data.type_id}alert_message=alert_message.replace('%FOLDER_NAME%',self.node.data.folder_name);self.reloadTree(true);s3.alertHTML(alert_message,false,message_prefix)}},error:function(){var popup=new PopupWindow('ajaxPopupWindow_'+popupController.popups.length);popup.drag=true;popup.modal=true;popup.center=true;popup.created=true;var obj=document.createElement('DIV');obj.id=popup.elementId;obj.style.position='absolute';obj.style.display='none';obj.innerHTML=data.responseText;document.body.appendChild(obj);popupController.showPopup(popup)},})},del:function(folder_id,type_id,global_folder,tree_id,all){var self=this,tree_id=parseInt(tree_id,10),folder_id=parseInt(folder_id,10),type_id=parseInt(type_id,10),global_folder=parseInt(global_folder,10),remove_all=parseInt(all,10)||0,remove=(remove_all)?0:1,url='',confirmDelete=s3.loc('JS_CONFIRM_DELETE'),prev;if(remove_all){url='/-/cms/v1/folder/?act=delete_all&'+S3_ACCESS+'&dynatree=1&folder_id='+folder_id+'&type_id='+type_id+'&tree_id='+tree_id+'&global_folder='+global_folder}else{url='/-/cms/v1/folder/?act=delete&'+S3_ACCESS+'&dynatree=1&folder_id='+folder_id+'&type_id='+type_id+'&tree_id='+tree_id+'&global_folder='+global_folder}var dyna_folders=$('.folder-'+folder_id);if(self.loadMode){dyna_folders=$('.s3-tree-wrapper-in.popup .folder-'+folder_id)}if(!self.node){self.node=$.ui.dynatree.getNode(dyna_folders)}if(remove){if(parseInt(self.node.data.locked)>0&&(!isStaffUser||global_folder)){s3.alert(s3.loc('JS_FOLDER_LOCKED'));return}}else{if(remove_all){var lock=self.tree.find('.dynatree-node.pageLocked').length;if(lock&&(!isStaffUser||global_folder)){s3.alert(s3.loc('JS_FOLDER_TREE_HAS_LOCKED_ITEM'));return}}}if(remove_all){confirmDelete=s3.loc('JS_CONFIRM_DELETE_ALL_CATEGORIES')}s3.confirm(confirmDelete,function(){popupController.closeLastPopup();$.ajax({url:url,success:function(data){if(remove){dyna_folders.each(function(ind,el){self.node=$.ui.dynatree.getNode(el);prev=self.node.getPrevSibling();if(!prev){prev=self.node.getParent()}self.node.remove();prev.render();self.searchResults.find('li.folder-'+folder_id).remove();self.removeSelectedFolder(self.node.data.key)})}else{if(remove_all){self.reloadTree();self.searchResults.empty();self.removeAllSelectedFolders()}else{alert('delete error')}}if(self.loadMode){if(self.loadMode!='browse'&&self.tree.dynatree('getRoot').countChildren()<=1){self.tree.hide()}if((self.loadMode=='browse'&&self.tree.dynatree('getRoot').countChildren()<=2)||(self.loadMode=='select'&&self.tree.dynatree('getRoot').countChildren()<=1)){$('.s3-tree-wr').find('div.properties label:last').hide()}}else{if(self.tree.dynatree('getRoot').countChildren()<=2){$('.s3-tree-wr').find('div.properties label:last').hide()}}if(self.type=='gallery2'){s3.reloadVisibleContent()}},error:function(req){var error_text='delete request error';var deny=req.getResponseHeader('X-Reason');if(deny=='acl-deny'){error_text=req.text=ACLController.getToolTipContent(req.getResponseHeader('X-Acl').split(';')[0])}s3.alert(error_text)},})})},toggleHide:function(folder_id,hide){var self=this,folder_id=parseInt(folder_id,10),hide=parseInt(hide,10),url='/-/cms/v1/folder/?act=visibility';url=url+'&'+S3_ACCESS+'&folder_id='+folder_id+'&hide='+hide;if(!self.node){self.node=$.ui.dynatree.getNode($('.folder-'+folder_id))}$.ajax({url:url,success:function(data){self.node.data.hidden=hide;self.node.render()},error:function(){s3.alert('hide request error')},})},contextEdit:function(contextMenu,add){var self=this,contextMenu=$(contextMenu).parents('.context-menu:first'),mode=contextMenu.data('mode')||'browse',hidden=contextMenu.data('hidden')||0,type_id=contextMenu.data('type_id')||0,object_id=contextMenu.data('object_id')||0,folder_id=contextMenu.data('folder_id')||-1,selected=contextMenu.data('selected')||0,nodeIdPostfix=contextMenu.data('nodeIdPostfix')||'',showFolderId=contextMenu.data('showFolderId')||0,global_folder=contextMenu.data('global_folder')||0,locked=contextMenu.data('locked')||0;if(add==true){self.add(folder_id,object_id,type_id,global_folder,mode,hidden,selected,nodeIdPostfix,showFolderId)}else{if(locked>0&&!isStaffUser){s3.alert(s3.loc('JS_FOLDER_LOCKED'));return}self.edit(folder_id,object_id,type_id,global_folder,mode,hidden,selected,nodeIdPostfix,showFolderId)}},contextCopy:function(contextMenu,full){var self=this,contextMenu=$(contextMenu).parents('.context-menu:first'),mode=contextMenu.data('mode')||'browse',type_id=contextMenu.data('type_id')||0,object_id=contextMenu.data('object_id')||0,folder_id=contextMenu.data('folder_id')||0,parent_id=contextMenu.data('parent_id')||0,copymode=(full)?'copyfull':'copy',nodeIdPostfix=contextMenu.data('nodeIdPostfix')||'',showFolderId=contextMenu.data('showFolderId')||0,global_folder=contextMenu.data('global_folder')||0;self.copy(folder_id,object_id,type_id,global_folder,mode,copymode,parent_id,nodeIdPostfix,showFolderId)},contextDelete:function(contextMenu,tree_id){var self=this,contextMenu=$(contextMenu).parents('.context-menu:first'),type_id=contextMenu.data('type_id')||0,folder_id=contextMenu.data('folder_id')||-1,global_folder=contextMenu.data('global_folder')||0;self.del(folder_id,type_id,global_folder,tree_id)},contextHide:function(contextMenu,hide){if(!$(contextMenu).hasClass('active')){$(contextMenu).parent().find('label').removeClass('active');$(contextMenu).addClass('active')}else{return}var self=this,contextMenu=$(contextMenu).parents('.context-menu:first'),folder_id=contextMenu.data('folder_id')||-1;self.toggleHide(folder_id,hide)},openControlsContextMenu:function(obj){var self=this,target=$(obj),targetOffset=target.position(),cntMenu=$(target).parents('.s3-tree-wr:first').find('.s3-tree-folders-context');S3ContextMenuController.openContextMenu(cntMenu,function(contextMenu){$(contextMenu).css({'top':targetOffset.top+65,'left':targetOffset.left-187,})})},openContextMenu:function(node){var self=this,target=$(node.span),targetOffset=target.find('.dynatree-context').position(),cntMenu=$(target).parents('.s3-tree-wr:first').find(self.contextMenu);self.node=node;S3ContextMenuController.openContextMenu(cntMenu,function(contextMenu){var hideToggleElem=$(contextMenu).find('.toggle-hide');var lockToggleElem=$(contextMenu).find('.toggle-lock');hideToggleElem.find('label').removeClass('active');lockToggleElem.find('label').removeClass('active');if(node.data.hidden==1){hideToggleElem.find('label.hide').addClass('active')}else{if(node.data.hidden==2){hideToggleElem.find('label.linked').addClass('active')}else{hideToggleElem.find('label.show').addClass('active')}}if($(target).hasClass('pageLocked')){lockToggleElem.find('label:first').addClass('active')}else{lockToggleElem.find('label:last').addClass('active')}if(node.data.href!=''){$(contextMenu).find('li.node-link').removeAttr('style');$(contextMenu).find('li.node-link a').attr('href',node.data.href)}$(contextMenu).css({'top':target.offset().top-target.closest('.s3-tree-wr').offset().top+23,'left':target.offset().left-target.closest('.s3-tree-wr').offset().left+45,}).data('locked',node.data.locked).data('nodeIdPostfix',node.data.nodeIdPostfix).data('showFolderId',node.data.showFolderId).data('object_id',node.data.object_id).data('mode',self.loadMode).data('selected',node.data.selected).data('hidden',node.data.hidden).data('folder_id',node.data.key).data('parent_id',node.getParent().data.key).data('global_folder',node.data.global_folder).data('type_id',node.data.type_id).find('.name.folder-id').attr('data-clipboard-text',node.data.key);$(contextMenu).find('.name.folder-id-text').text('id '+node.data.key);if(node.data.system==2){$('.s3-radio-tabs.medium .hide').before($(contextMenu).find('.s3-radio-tabs.medium .linked').hide())}else{if($(contextMenu).find('.s3-radio-tabs.medium .linked').is(':hidden')){$('.s3-radio-tabs.medium .hide').after($(contextMenu).find('.s3-radio-tabs.medium .linked').show())}}var clipboardBtn=$(contextMenu).find('.name.folder-id'),successText=JS_COPIED+': "'+$(contextMenu).find('.name.folder-id-text').text()+'"',onSuccess=function(){util.msg(successText)};s3.clipboard(clipboardBtn.get(0),onSuccess)},null,target)},recountTree:function(){var self=this,request='',nodes=self.tree.find('.dynatree-node'),node,node_level;nodes.each(function(){node=$.ui.dynatree.getNode($(this));if(node.data.key>=0){node_level=node.getLevel()-1;if(node.data.key==0){request+=('\nroot='+node_level)}else{if(node_level!=0){request+=('\n'+node.data.key+'='+node_level)}}}});return request},saveTreeOrder:function(folder_global,tree_id,menu_modified,type_id,object_id){var self=this;var response=util.makePostRequest(self.urlStructureSave,'&tree_id='+tree_id+'&global='+folder_global+'&object_id='+object_id+'&type_id='+type_id+'&tree_changes='+JSON.stringify(self.tree_changes)+'&menu_modified='+menu_modified);if(response.error){s3.alert(s3.loc('JS_ERROR_WHILE_SAVING_CHANGES'))}else{s3.alert(s3.loc('JS_CHANGES_SAVED'));self.reloadTree()}},reloadTree:function(copy){var self=this,tree=$('.tree-wrapper'),tree_prefix=self.tree_prefix||0,popup=self.loadMode,node,type,type_id,orderby,curr_folder_id,url,object_id,exportFolders,showFolderId,nodeIdPostfix;var p=popupController.getLastPopup();if(popup){tree=$('.folders-tree')}else{if(p&&$(p.obj).find('.tree-wrapper').get(0)){tree=$(p.obj).find('.tree-wrapper')}else{p=popupController.getPreviousPopup();if(p&&$(p.obj).find('.tree-wrapper').get(0)){tree=$(p.obj).find('.tree-wrapper')}}}if(!tree.size()){return false}if(tree.find('.dynatree-node.active').size()>0){node=$.ui.dynatree.getNode(tree.find('.dynatree-node.active').eq(0));if(node&&node.data){curr_folder_id=node.data.key}}else{node=$.ui.dynatree.getNode(tree.find('.dynatree-node').eq(0))}if(!node||!node.data){return false}type=node.data.type;type_id=node.data.type_id;orderby=node.data.orderby;object_id=node.data.object_id||0;exportFolders=node.data.export||0;showFolderId=node.data.showFolderId||0;nodeIdPostfix=node.data.nodeIdPostfix;url='/-/cms/v1/folder/?'+S3_ACCESS+'&type_id='+type_id+'&type='+type+'&curr_folder_id='+curr_folder_id+'&mode=dynatree&orderby='+orderby+'&object_id='+object_id+'&showFolderId='+showFolderId+'&nodeIdPostfix='+nodeIdPostfix;if(popup&&tree_prefix){url+='&tree_prefix='+tree_prefix+'&popup='+popup+'&selected='+self.selectedFolders+'&export='+exportFolders}tree.load(url,function(){self.init(tree.find('.s3-tree:first'));tree.S3ChangeControls()})},closeFoldersBlock:function(elem){var self=this,tree=$(elem).parents('.tree-wrapper'),folders=tree.find('.s3-tree-wrapper'),foldersWidth=parseInt(folders.width());elem.next().removeClass('disable');if(elem.hasClass('disable')){return false}if(foldersWidth>0){folders.animate({width:0,},600,function(){util.createCookie('foldersWidth_'+self.type,0);elem.addClass('disable')})}},openFoldersBlock:function(elem){var self=this,tree=$(elem).parents('.tree-wrapper'),folders=tree.find('.s3-tree-wrapper'),foldersWidth=parseInt(folders.width()),childWidth=parseInt(folders.find('.s3-tree-wrapper-in:first').outerWidth()),flag=false;elem.prev().removeClass('disable');if(childWidth<=268){childWidth=268;flag=true}if($(elem).hasClass('disable')){return false}if(foldersWidth==0){folders.animate({width:268},600,function(){elem.prev().removeClass('disable');util.createCookie('foldersWidth_'+self.type,268);if(flag){elem.addClass('disable')}})}else{folders.animate({width:childWidth},600,function(){elem.addClass('disable');util.createCookie('foldersWidth_'+self.type,childWidth)})}},toggleLock:function(){var self=this,node=self.node,folder_id,url,r;folder_id=node.data.key;url='/-/cms/v1/folder/?act=toggle_lock&'+access+'&folder_id='+folder_id+'&type_id='+node.data.type_id;r=util.makeGetRequest(url);if(r&&!r.error){$(node.span).toggleClass('pageLocked');node.data.locked=(node.data.locked)?0:1}},removeSelectedFolder:function(folder_id){var previousPopup=popupController.getPreviousPopup();var folder_ids_span=null;var objectEditFolderList_span=null;if(previousPopup){var a=previousPopup.obj;folder_ids_span=util.getElementByIdAndTagName(a,'INPUT','folder_ids'+this.nodeIdPostfix);objectEditFolderList_span=util.getElementByIdAndTagName(a,'UL','objectEditFolderList'+this.nodeIdPostfix)}if(!folder_ids_span||!objectEditFolderList_span){folder_ids_span=util.getObject('folder_ids'+this.nodeIdPostfix);objectEditFolderList_span=document.getElementById('objectEditFolderList'+this.nodeIdPostfix)}if(folder_ids_span&&objectEditFolderList_span){var li=$(objectEditFolderList_span).find('li.folder-'+folder_id);if(li.get(0)){li.find('span.remove').click()}else{var ids=folder_ids_span.value.split(',');if(ids.indexOf(folder_id)!=-1){ids.splice(ids.indexOf(folder_id),1);folder_ids_span.value=ids.join(',')}}}},removeAllSelectedFolders:function(){var previousPopup=popupController.getPreviousPopup();var folder_ids_span=null;var objectEditFolderList_span=null;if(previousPopup){var a=previousPopup.obj;folder_ids_span=util.getElementByIdAndTagName(a,'INPUT','folder_ids'+this.nodeIdPostfix);objectEditFolderList_span=util.getElementByIdAndTagName(a,'UL','objectEditFolderList'+this.nodeIdPostfix)}if(!folder_ids_span||!objectEditFolderList_span){folder_ids_span=util.getObject('folder_ids'+this.nodeIdPostfix);objectEditFolderList_span=document.getElementById('objectEditFolderList'+this.nodeIdPostfix)}if(folder_ids_span&&objectEditFolderList_span){folder_ids_span.value='';objectEditFolderList_span.innerHTML=''}},load:function(mode,type_id,object_id,obj,onClick,nodeIdPostfix,showFolderId,overrideSettings,reload,disabled_ids,exportFolders,afterRender){var self=this;const container=$('#objectEditFolderList'+nodeIdPostfix);const countOfSelectedItems=container.find('>li').length;const limit=container.data('limit');if(!!limit&&countOfSelectedItems>=limit){s3.alert(s3.loc(container.data('limit-msg')));return}Preloader.show({mini:true});folderController.controllers.unshift({onClick:onClick,nodeIdPostfix:nodeIdPostfix||'',showFolderId:showFolderId||0,mode:mode,objectId:object_id,type_id:type_id,parent_id:0,overrideSettings:overrideSettings||null,container:container,limit:limit||false,limit_msg:container.data('limit-msg'),});folderController.last_id=0;self.nodeIdPostfix=nodeIdPostfix||'';self.showFolderId=showFolderId||0;self.loadMode=mode||'';self.tree_prefix=1;if(nodeIdPostfix&&nodeIdPostfix.indexOf('refs')!=-1){self.refs=true}if(nodeIdPostfix&&(nodeIdPostfix.indexOf('_parent')!=-1||nodeIdPostfix.indexOf('_child')!=-1)){self.is_collect=true}self.exportFolders=(exportFolders)?1:0;if(popupController.getLastPopup()){var a=popupController.getLastPopup().obj;var inp=util.getElementByIdAndTagName(a,'INPUT','folder_ids'+nodeIdPostfix)}else{var inp=util.getObject('folder_ids'+nodeIdPostfix)}var selected=(mode=='select'||mode=='radio')?inp.value:util.readCookie('last_folder_for_type_'+nodeIdPostfix);if(mode=='select2'){var a=popupController.getLastPopup().obj;var inp=util.getElementByIdAndTagName(a,'INPUT','user_folder');if(inp===null){inp=$(obj).parent().find('input[id*=user_folder_id]')[0]}if(!inp){inp=$(obj).next().find(ListSelectedItemsController.CLASS_SELECTED_ITEM).find('input')[0]}if(inp){selected=inp.value}}if(selected){var selectedArray=self.cleanArray(selected.split(','));selected=selectedArray.join(',');self.selectedFolders=selected;if(self.exportFolders){if(selectedArray&&self.folderCount==selectedArray.length){folderController.allSelected=true}}}openAjaxForm('/-/cms/v1/folder/?'+access+'&type_id='+type_id+'&object_id='+object_id+'&mode='+mode+(overrideSettings&&overrideSettings.allowOnlyFilled?'&allow_only_filled=1':'')+'&tree_prefix=1'+'&popup='+mode+(disabled_ids?'&disabled='+disabled_ids:'')+'&nodeIdPostfix='+nodeIdPostfix+'&showFolderId='+showFolderId+'&export='+self.exportFolders+(self.is_collect?'&is_collect=1':''),function(r){},function(r){self.tree_prefix=0;self.loadMode='';self.is_search=false;self.selectedFolders='';self.exportFolders=0;self.refs=false;self.tree_changes=[];self.is_collect=false;if(exportFolders){var previousPopup=popupController.getPreviousPopup();var folder_ids_span=null;var objectEditFolderList_span=null;if(previousPopup){var a=previousPopup.obj;folder_ids_span=util.getElementByIdAndTagName(a,'INPUT','folder_ids'+nodeIdPostfix);objectEditFolderList_span=util.getElementByIdAndTagName(a,'UL','objectEditFolderList'+this.nodeIdPostfix)}if(!folder_ids_span||!objectEditFolderList_span){folder_ids_span=util.getObject('folder_ids'+nodeIdPostfix);objectEditFolderList_span=document.getElementById('objectEditFolderList'+nodeIdPostfix)}if(folder_ids_span&&objectEditFolderList_span){var p=popupController.getLastPopup();if(!p){return}p.url=util.urlParamReplace(p.url,'reload',1);p.putParams='&folder_ids'+nodeIdPostfix+'='+folder_ids_span.value;popupController.reloadLastPopup(p.url,true)}}if(reload){folderController.reloadPopupWithSavingDataFormWhenManipulatingFolders(nodeIdPostfix)}if(type_id==43){folderController.initMainFolder()}},null,'&selected='+self.selectedFolders,function(){if(afterRender&&{}.toString.call(afterRender)==='[object Function]'){afterRender()}Preloader.hide()},)},getFoldersFromBrowser:function(){var d=$(popupController.getLastPopup().obj).is('.s3-tree')?popupController.getLastPopup().obj:$(popupController.getLastPopup().obj).find('.s3-tree').get(0);var elements=util.getElementsByClassName(d,'SPAN','folder-name');var inputs=d.getElementsByTagName('INPUT');var res=new Object;for(var i=0;i<elements.length;i++){var folder_id=parseInt(elements[i].id.replace('folder',''));var s=(inputs&&inputs[i]&&$(inputs[i]).parent().hasClass('active'))?true:false;res[folder_id]={name:elements[i].innerHTML,checked:s}}return res},selectAll:function(){var tree=$('.s3-tree-wrapper-in.popup .s3-tree').dynatree('getTree');tree.renderInvisibleNodes();var res=this.getFoldersFromBrowser();for(var i in res){if(res[i].checked==false){$('.s3-tree-wrapper-in.popup .folder-'+i).find('span.checkbox label').click()}}},unSelectAll:function(){var tree=$('.s3-tree-wrapper-in.popup .s3-tree').dynatree('getTree');tree.renderInvisibleNodes();var res=this.getFoldersFromBrowser();for(var i in res){if(res[i].checked==true){$('.s3-tree-wrapper-in.popup .folder-'+i).find('span.checkbox label').click()}}},selectOne:function(folder_id){var self=this,f=$('.s3-tree-wrapper-in.popup .folder-'+folder_id);if(f.hasClass('filter')||f.hasClass('link')){return false}f.find('span.checkbox label').click()},editOne:function(folder_id){var self=this,f=$('.s3-tree-wrapper-in.popup .folder-'+folder_id);if(f.hasClass('filter')||f.hasClass('link')){return false}f.find('span.dynatree-title.folder-name').click()},select:function(){var self=this,previousPopup=popupController.getPreviousPopup(),lastPopup=popupController.getLastPopup();self.nodeIdPostfix=$(lastPopup.obj).find('.s3-tree').data('nodeidpostfix');if(previousPopup){var a=previousPopup.obj;folder_ids_span=util.getElementByIdAndTagName(a,'INPUT','folder_ids'+self.nodeIdPostfix);objectEditFolderList_span=util.getElementByIdAndTagName(a,'UL','objectEditFolderList'+self.nodeIdPostfix)}if(!folder_ids_span||!objectEditFolderList_span){folder_ids_span=util.getObject('folder_ids'+self.nodeIdPostfix);objectEditFolderList_span=document.getElementById('objectEditFolderList'+self.nodeIdPostfix)}if(folder_ids_span&&objectEditFolderList_span){var ids=folder_ids_span.value.split(',');var res=self.getFoldersFromBrowser();var res_html='';var folder_ids=[];var folder_names=[];var folder_length=0;for(var i in res){folder_length+=1;if(res[i].checked){folder_ids.push(i);folder_names.push(res[i].name)}}folderController.folders_length=folder_length;if(folder_ids.length==0){folder_names.push('&mdash;')}folder_ids_span.value=folder_ids.join(',');if(folder_ids.length==0){res_html=''}else{for(i=0;i<folder_names.length;i++){res_html+='<li data-prefix="'+self.nodeIdPostfix+'"><span class="title"><span class="s3-ico i-folder-dark"></span><span class="name">'+folder_names[i]+'</span></span><span class="remove" onclick="folderController.delete('+folder_ids[i]+', this.parentNode)"><span class="s3-ico i-delete-svg"></span></span></li>'}}objectEditFolderList_span.innerHTML=res_html}},filter:function(folder_id,type,folder_name){var cookie_name='last_folder_for_type_'+type;if(folder_id==0||folder_id==-1){util.eraseCookie(cookie_name);cookie_name='last_page_for_type_'+type;util.eraseCookie(cookie_name)}else{util.createCookie(cookie_name,folder_id,7);cookie_name='last_page_for_type_'+type;util.eraseCookie(cookie_name)}var d=popupController.getPreviousPopup();var url=(d)?d.url:s3.lastContentUrl;url=util.urlParamReplace(url,'folder_id',folder_id);url=util.urlParamReplace(url,'p',0);url=util.urlParamReplace(url,'s[_folder_ids]',0);if(d){d.url=url;d.reload()}else{s3.loadContent(url)}var name=(folder_id==0)?s3.loc('JS_FOLDERS_ALL'):folder_name;var filter=document.getElementById('filters'+this.nodeIdPostfix);if(filter){filter.innerHTML=name}popupController.closeLastPopup()},search:function(form){var self=this,text=form.elements['s[text]'].value.trim(),type_id=form.elements['type_id'].value||0,object_id=form.elements['object_id'].value||0,mode=form.elements['mode'].value||'browse',nodeIdPostfix=self.nodeIdPostfix||'',showFolderId=self.showFolderId||'',global=form.elements['global'].value||0,search_text=encodeURIComponent(text),url='/-/cms/v1/folder/?act=search&'+S3_ACCESS+'&type_id='+type_id+'&search='+search_text+'&object_id='+object_id+'&mode='+mode+'&nodeIdPostfix='+nodeIdPostfix+'&showFolderId='+showFolderId+text+'&global='+global,result_div=(mode=='search_tree')?$(form).parents('.s3-tree-wr:first').find('#tree_search_result_div'):$(form).parent().next(),r;if(text){if(text.length<=3){s3.alert(s3.loc('JS_DYNA_TREE_SEARCH_ERROR_ALERT')+': 4');return false}r=util.makeGetRequest(url);if(r&&!r.error){result_div.html(r.text);result_div.S3ChangeControls();$(form).parent().addClass('search');self.is_search=true;self.selectedFolders=(self.selectedFolders)?self.selectedFolders:'';var foldersArray=self.selectedFolders.split(',');result_div.find('li.dynatree-node').each(function(){var id=$(this).data('id').toString();if(foldersArray.indexOf(id)!=-1){$(this).find('.s3-cb, .s3-rb').addClass('active');$(this).find('.s3-cb input, .s3-rb input').attr('checked','checked')}})}S3ContextMenuController.closeContextMenu()}if($(form).find('input[name="s[text]"]').val()){$(form).parent().find('.reset').css('opacity','1')}return false},resetSearch:function(reset_button,in_content){var self=this,result_div,parent;if(in_content){parent=$(reset_button).parents('.s3-tree-wr').find('.s3-tree-folders-context .search-inputs-wrap');result_div=$(reset_button).parents('.s3-tree-wr').find('#tree_search_result_div')}else{parent=$(reset_button).parents('.folders-search').find('.search-inputs-wrap');result_div=parent.next()}result_div.empty();parent.removeClass('search');parent.find('form:first').trigger('reset');parent.find('input[name="s[text]"]').val('');parent.find('.reset').css('opacity','0');self.is_search=false;return false},cleanArray:function(array){for(var i=0;i<array.length;i++){if(array[i]==''){array.splice(i,1);i--}}return array},getTreeModified:function(tree_id,menu_modified,folder_id){var self=this,last_menu_modified='';$.ajax({type:'POST',url:'/-/cms/v1/folder/?act=get_modified&'+S3_ACCESS,data:{'action':'modified','object_id':tree_id,},async:false,success:function(data){var div=$('#dynatree-id-'+folder_id);var f=function(){self.reloadTree();popupController.closeLastPopup()};if(menu_modified!==data){s3.confirm(s3.loc('JS_FOLDERS_CHANGED'),f,div.get(0))}last_menu_modified=data},});return last_menu_modified},saveStructureFirstAlert:function(){s3.alert(s3.loc('JS_SAVING_FOLDER_STRUCTURE_INSTRUCTION'),null)},}})(jQuery);var ForumController={};(function($){ForumController={forumSortButtons:false,reloadContentAfterEdit:false,edit:function(forum_id){var self=this;openAjaxForm('/-/cms/v1/forum/?act=edit&'+S3_ACCESS+'&forum_id='+forum_id,function(r){popupController.closeLastPopup();s3.reloadVisibleContent()},function(){if(self.reloadContentAfterEdit){s3.reloadVisibleContent()}self.reloadContentAfterEdit=false},function(){self.reloadContentAfterEdit=true})},save:function(form,reload){var self=this,form=$(form),data=form.serializeObject();$.ajax({url:form.attr('action'),data:data,type:form.attr('method'),dataType:'json',success:function(data){if(typeof data!='object'){s3.alert(s3.loc('JS_ERROR')+' code: 1');return}if(data.error){s3.alert(s3.loc('JS_ERROR')+' code: 3'+' -- '+data.error);return}popupController.closeLastPopup();if(reload){s3.reloadVisibleContent()}},error:function(){s3.alert(s3.loc('JS_ERROR')+' code: 2')}})},delete:function(forum_id){var self=this,url='/-/cms/v1/forum/?act=delete&'+S3_ACCESS,forum_id=parseInt(forum_id,10);if(!forum_id){return false}s3.confirm(s3.loc('JS_FORUM_CONFIRM_DELETE_FORUM_AND_SUBFORUMS'),function(){$.ajax({url:url,data:{'forum_id':forum_id},type:'post',dataType:'json',success:function(data){if(typeof data!='object'){s3.alert(s3.loc('JS_ERROR')+' code: 1');return}if(data.error){s3.alert(s3.loc('JS_ERROR')+' code: 3'+' -- '+data.error);return}popupController.closeLastPopup();s3.reloadVisibleContent()},error:function(){s3.alert(s3.loc('JS_ERROR')+' code: 2')}})})},saveSortPosition:function(obj){var self=this,pos=[];$(obj).each(function(item){$this=$(this);pos.push({key:$this.data('id'),index:$this.index()})});$.ajax({url:'/-/cms/v1/forum/?act=set_position&'+S3_ACCESS,data:{sort_data:JSON.stringify(pos)},type:'post',dataType:'json',success:function(data){if(data.done){s3.alert(s3.loc('JS_SAVED'));self.forumSortButtons.css('display','none')}},error:function(){s3.alert('error')}})},initSort:function(){var self=this;self.forumSortButtons=$('.forum-sort-button');$('.forum-list tbody').sortable({handle:'.forum-handle',update:function(){if(self.forumSortButtons.is(':hidden')){s3.alert(s3.loc('JS_FORUM_SORT_MESSAGE'));self.forumSortButtons.css('display','inline-block')}}});$('.forum-list .subforums').sortable({handle:'.subforum-handle',update:function(){if(self.forumSortButtons.is(':hidden')){s3.alert(s3.loc('JS_FORUM_SORT_MESSAGE'));self.forumSortButtons.css('display','inline-block')}}})},dropUserBan:function(user_id){var self=this,url='/-/cms/v1/forum/?act=ban&'+S3_ACCESS;s3.confirm(s3.loc('JS_FORUM_USER_CONFIRM_DROP_BAN'),function(){$.ajax({url:url,data:{'user_id':user_id,'days':0},type:'post',dataType:'json',success:function(data){if(typeof data!='object'){s3.alert(s3.loc('JS_ERROR')+' code: 1');return}if(data.error){s3.alert(s3.loc('JS_ERROR')+' code: 3'+' -- '+data.error);return}popupController.closeLastPopup();s3.reloadVisibleContent()},error:function(){s3.alert(s3.loc('JS_ERROR')+' code: 2')}})})},toggleEditTime:function(condition){if(condition==true){$('input[name="edit_time"]').attr('disabled','disabled')}else{$('input[name="edit_time"]').removeAttr('disabled')}}}})(jQuery);(function($){var xhrUploadFlag=false;if(window.XMLHttpRequest){var testXHR=new XMLHttpRequest();xhrUploadFlag=(testXHR.upload!=null)}$.extend($.support,{fileSelecting:(window.File!=null)&&(window.FileList!=null),fileReading:(window.FileReader!=null),fileSending:(window.FormData!=null),uploadControl:xhrUploadFlag});var uniq=function(length,prefix){length=parseInt(length);prefix=prefix||'';if((length==0)||isNaN(length)){return prefix}var ch=String.fromCharCode(Math.floor(Math.random()*26)+97);return prefix+ch+uniq(--length)};var checkIsFile=function(item){return(item instanceof File)};$.fn.fileUploader=function(params){if(this.length==0){return this}else if(this.length>1){return this.each(function(){$(this).fileUploader(params)})}var self=this;var queue=self._fileUploaderQueue;var set=self._fileUploaderSettings||{};var current_xhr;var xhr_active=true;var last_action=false;var mode=false;self._fileUploaderSettings=$.extend({url:'',multiple:true,fieldName:'files',dropping:true,dropBox:false,limit:false,onSelect:false,onSelectFinally:false,onDrop:false,onLimitExceeded:false,onAllComplete:false,uploadedForm:null},params||{});self._fileUploaderQueue=[];self._fileUploaderItemsCount=0;queue=self._fileUploaderQueue;set=self._fileUploaderSettings;self._fileUploaderFilesAddMap=function(files,callback,finallyCallback){var callbackDefined=$.isFunction(callback);if(!$.support.fileSelecting){if(self._fileUploaderItemsCount===set.limit){return $.isFunction(set.onLimitExceeded)?set.onLimitExceeded.call(self):false}var file={fake:true,name:files.value,inputElement:files};if(callbackDefined){if(!callback.call(self,file)){return true}}self.fileAdd(file);return true}if(files instanceof FileList){$.each(files,function(i,file){if(self._fileUploaderItemsCount===set.limit){if(self._fileUploaderItemsCount===set.limit){return $.isFunction(set.onLimitExceeded)?set.onLimitExceeded.call(self):false}}if(callbackDefined){if(!callback.call(self,file)){return true}}self.fileAdd({file:file})});if($.isFunction(finallyCallback)){if(!finallyCallback.call(self)){return true}}}else if(files instanceof File){var file=files;if(self._fileUploaderItemsCount===set.limit){if(self._fileUploaderItemsCount===set.limit){return $.isFunction(set.onLimitExceeded)?set.onLimitExceeded.call(self):false}}if(callbackDefined){if(!callback.call(self,file)){return true}}self.fileAdd({file:file})}return true};self._fileUploaderUploadItem=function(url,item,global){if(!checkIsFile(item.file)||!xhr_active){xhr_active=true;return false}var ext="?";if(url.indexOf("?")!=-1){ext="&"}var xhr=new XMLHttpRequest();current_xhr=xhr;var progress=0;var uploaded=false;if(xhr.upload){xhr.upload.addEventListener("progress",function(e){if(e.lengthComputable){if($.isFunction(item.onProgress)){item.onProgress.call(item,e.loaded,e.total)}}},false);xhr.upload.addEventListener("load",function(e){progress=100;uploaded=true},false)}else{uploaded=true}if($.isFunction(item.onLoadStart)){item.onLoadStart.call(item)}xhr.onreadystatechange=function(){var callbackDefined=$.isFunction(item.onComplete);if(this.readyState==4){var response=this.responseText;if(util.getElementFromText(response,'UL')){response="unique"}item.cancelled=item.cancelled||false;if(this.status<400){if(response!='unique'){last_action=uploadSend;var blp=util.getElementFromText(response,'DIV');if(response&&blp){item.onCheck.call(item,response);return}}if(!uploaded){if(callbackDefined){item.onComplete.call(item,false,null,0)}}else{if($.isFunction(item.onProgress)){item.onProgress.call(item,100,100)}if(callbackDefined){item.onComplete.call(item,true,this.responseText)}}}else{if(callbackDefined){item.onComplete.call(item,false,null,this.status)}}}};if(set.notTest){uploadSend()}else{$.post(set.fileTestUrl+"&time="+(new Date).getTime(),{'filename':item.file.name,'global':global}).done(function(result){last_action=uploadSend;item.onCheck.call(item,result)}).fail(function(e){set.notTest=true;uploadSend()})}function uploadSend(mode){last_action=false;mode=mode||false;xhr.open("POST",url+ext+"time="+(new Date()).getTime());if($.support.fileSending){var formData=new FormData();$(set.uploadedForm).find("[type='hidden'],input:checked[type='checkbox']").each(function(i,e){formData.append(e.name,e.value)});if(mode){formData.append('replace_mode',mode)}formData.append('names',item.name);formData.append((item.fieldName||'files'),item.file);xhr.send(formData)}else{throw"file sending is not supported";xhr.setRequestHeader('Upload-Filename',item.file.name);xhr.setRequestHeader('Upload-Size',item.file.size);xhr.setRequestHeader('Upload-Type',item.file.type);xhr.send(item.file)}item.xhr=xhr}};var isFileField=((self.get(0).tagName=='INPUT')&&(this.attr('type')=='file'));if(isFileField){var myName=self.eq(0).attr('name');if(!$.support.fileSelecting){if(myName.charAt(myName.length-1)!=']'){myName+='[]'}self.attr('name',myName);self.attr('multiple',false);var action=self.parents('form').attr('action');self._fileUploaderFakeForm=$('<form/>').attr({method:'post',enctype:'multipart/form-data',action:action}).hide().appendTo('body')}else{self.attr('multiple',true)}self._fileUploaderChangeCallback=function(){self._fileUploaderFilesAddMap($.support.fileSelecting?this.files:this,set.onSelect,set.onSelectFinally)};self.on({change:self._fileUploaderChangeCallback})};self.upload=function(n){if(!set.url){return self}if(!$.support.fileSelecting){self._fileUploaderFakeForm.submit();return self}var queueId=n||0;var item=queue[queueId];if(item){var compl=item.onComplete;item.fieldName=item.fieldName||set.fieldName;item.onComplete=function(successful,data,error){if(!this.cancelled){delete queue[queueId];self._fileUploaderItemsCount--}if($.isFunction(compl)){compl.call(this,successful,data,error)}if((self._fileUploaderItemsCount==0)&&($.isFunction(set.onAllComplete))){set.onAllComplete.call(self);xhr_active=true}};self._fileUploaderUploadItem(set.url,item,set.global)}return self};self.abort=function(){xhr_active=true;if(current_xhr.abort){current_xhr.abort()}};self.continue=function(m){if(m){mode=m};if(last_action){last_action(mode)}};self.skip=function(n){var item=queue[n];if(item){self._fileUploaderItemsCount--;item.onSkip.call(item);if((self._fileUploaderItemsCount==0)&&($.isFunction(set.onAllComplete))){set.onAllComplete.call(self);xhr_active=true}}};self.fileExclude=function(queueId,item){if(queueId>=0&&self._fileUploaderItemsCount>0){if(!$.support.fileSelecting){var removingItem=$('#'+queueId);if(removingItem.length>0){removingItem.remove();self._fileUploaderItemsCount--}return self}if(queue[queueId]!==undefined){if(queue[queueId].xhr){queue[queueId].cancelled=true;queue[queueId].xhr.abort()}delete queue[queueId];self._fileUploaderItemsCount--}}return self};self.resetAll=function(){self._fileUploaderItemsCount=0;if(!$.support.fileSelecting){self._fileUploaderFakeForm.empty();return self}queue=[];return self};self.fileAdd=function(uploadItem){if(!uploadItem||!uploadItem.file){return false}if(!checkIsFile(uploadItem.file)){return false}var ind=queue.length;uploadItem['ind']=ind;queue[ind]=uploadItem;self._fileUploaderItemsCount++;return ind};self.filesCount=function(){return self._fileUploaderItemsCount};self.fileUploaderOptions=function(name,value){var acceptParams=['url','multiple','fieldName','limit'];if(value===undefined){return self._fileUploaderSettings[name]}if($.isPlainObject(name)){$.each(name,function(key,val){self.fileUploaderOptions(key,val)})}else{$.inArray(name,acceptParams)&&(self._fileUploaderSettings[key]=value)}return self};self.getEntry=function(item){var entry;if(item.webkitGetAsEntry){entry=item.webkitGetAsEntry();if(entry){entry._file=item.getAsFile();return entry}}if(item.getAsEntry){return item.getAsEntry()}};self.handleFileSelect=function(evt){evt.stopPropagation();evt.preventDefault();evt.dataTransfer=evt.originalEvent&&evt.originalEvent.dataTransfer;var items=evt.dataTransfer.items||evt.dataTransfer.files;if(items&&items.length&&(items[0].webkitGetAsEntry||items[0].getAsEntry)){var entries=[];for(var i=0;i<items.length;i++){var ent=self.getEntry(items[i]);if(ent)entries.push(ent)}self._getFiles(entries)}else if(items&&items.length){for(var i=0;i<items.length;i++){if(items[i].type&&items[i].size){self._fileUploaderFilesAddMap(items[i],self._fileUploaderSettings.onDrop,false)}}}$(self._fileUploaderSettings.dropDiv).removeClass('dragover');if(items){self.upload()}};self._getFiles=function(entries){for(var i=0;i<entries.length;i++){if(entries[i].isFile){if(entries[i]._file){self._fileUploaderFilesAddMap(entries[i]._file,self._fileUploaderSettings.onDrop,false)}else{entries[i].file(function(file){self._fileUploaderFilesAddMap(file,self._fileUploaderSettings.onDrop,false)})}}else if(entries[i].isDirectory){var dirReader=entries[i].createReader();dirReader.readEntries(function(results){if(results.length){self._getFiles(results)}})}}};self.handleDragOver=function(evt){evt.stopPropagation();evt.preventDefault();evt.dataTransfer.dropEffect='copy';$(self._fileUploaderSettings.dropDiv).addClass('dragover')};self.handleDragLeave=function(evt){evt.stopPropagation();evt.preventDefault();$(self._fileUploaderSettings.dropDiv).removeClass('dragover')};self.unBindDrop=function(){if(self._fileUploaderSettings.dropBox){$(self._fileUploaderSettings.dropBox).get(0).removeEventListener('dragover',self.handleDragOver);$(self._fileUploaderSettings.dropDiv).get(0).removeEventListener('dragleave',self.handleDragLeave);$(self._fileUploaderSettings.dropBox).get(0).removeEventListener('drop',self.handleFileSelect)}};if(self._fileUploaderSettings.dropBox){$(self._fileUploaderSettings.dropBox).get(0).addEventListener('dragover',self.handleDragOver,false);$(self._fileUploaderSettings.dropBox).get(0).addEventListener('drop',self.handleFileSelect,false);$(self._fileUploaderSettings.dropDiv).get(0).addEventListener('dragleave',self.handleDragLeave,false)};return self}})(window.jQuery);var button_generator;(function($){button_generator={fill_type:1,is_in_progress:false,text_timeout:null,palettes_data:{},mode:'',colour_fields:['button_color','gradient_start','gradient_end','border_color','text_color','button_shadow_color','button_inner_shadow_color','text_shadow_color'],sliders_options:{border_radius:{min:0,max:40},button_inner_shadow_size:{min:0,max:20},text_shadow_opacity:{min:0,max:100},button_shadow_opacity:{min:0,max:100}},showApplyButton:function(){$('#generate_action_btn').show()},applyButtonParams:function(button_id){var self=this;if(button_id&&!self.is_in_progress){$.get('/-/cms/v1/button/?act=get&'+site_u,{'button_id':button_id},function(data){if(data){$('.s3-button-generator :input').each(function(){var $el=$(this);var type=$el.prop("tagName"),name=$el.attr('name'),val=data[name];switch(type){case'INPUT':switch($el.attr('type')){case'checkbox':if(val){$el.prop('checked',true)}else{$el.prop('checked',false)}break;case'radio':$el.filter('[value="'+val+'"]').prop('checked',true);break;default:if(name=='button_text')break;if(name=='button_id')break;$el.val(val);break}break;case'SELECT':if(name!='palette_id'){$el.val(val);$el.trigger("liszt:updated")}if(name=='fill_type'){self.fill_type=val}break}});$('input[name=ver_id]').val(ver_id);self.setFillType();self.toggleButtonGeneratorGroupControls('is_text_shadow_on','text_shadow_wrap');self.toggleButtonGeneratorGroupControls('is_button_shadow_on','button_shadow_wrap');self.toggleButtonGeneratorGroupControls('is_button_inner_shadow_on','button_inner_shadow_wrap');self.changeSliderValues();self.updateColorSelects();self.build()}},"json")}},applyPalette:function(button_id){var self=this;if(button_id){$.get('/-/cms/v1/button/?act=get&'+site_u,{'palette_id':button_id},function(data){if(data){for(var c in self.colour_fields){$("input[name="+self.colour_fields[c]+"]").val(data[self.colour_fields[c]])}self.updateColorSelects();self.build()}},"json")}},applyEditModePalette:function(){if(edit_mode_palette){for(var c in this.colour_fields){$("input[name="+this.colour_fields[c]+"]").val(edit_mode_palette[this.colour_fields[c]])}if(this.fill_type==1){$('#palette_chooser_selected').css('background-color',edit_mode_palette['button_color'])}else{$('#palette_chooser_selected').css('background-color',edit_mode_palette['gradient_start'])}this.updateColorSelects();this.build()}},delButton:function(button_id){if(confirm(s3.loc('JS_BUTTONS_DELETE_BUTTON'))){$.post('/-/cms/v1/button/?act=delete&'+site_u,{"button_id":button_id},function(result){if(result){$('#button_el_'+button_id).remove();if(($('#s3_buttons_list li').length<1)&&current_page>0){s3.changePage(--current_page)}}})}},saveButton:function(is_global){var self=this;data=$("#settings").serialize();var param_mode='';if(self.mode!=''){param_mode+='&mode='+self.mode}if(is_global){param_mode+='&is_global=1'}$.post('/-/cms/v1/button/?act=save&'+site_u+param_mode,data,function(result){if(result){if(is_global){$('#s3_user_buttons').prepend(result)}else{if(self.mode=="edit"){var editing_elem_id=$(result).attr("id");$('#'+editing_elem_id).replaceWith($(result))}else{$('.s3_buttons_list').prepend(result)}}util.msg(s3.loc('JS_BUTTONS_BUTTON_SAVED'));popupController.closeLastPopup()}})},savePalette:function(){var self=this;data=$("#settings").serializeArray();data.push({"name":"type","value":"palette"});$.post('/-/cms/v1/button/?act=save&'+site_u,data,function(result){util.msg(s3.loc('JS_BUTTONS_PALETTE_SAVED'))},"json")},initColorPickers:function(){var self=this;$.each(self.colour_fields,function(key,id){$('#select_'+id).ColorPicker({color:self.getColor(id),onShow:function(colpkr){$(colpkr).show();return false},onHide:function(colpkr){$(colpkr).hide();return false},onChange:function(a,b,c){self.updateColorField($(c).attr('id'),'#'+b[1])},onSubmit:function(hsb,hex,rgb,el){$(el).ColorPickerHide();self.build()}})})},destroyColorPickers:function(){$('.colorpicker').hide()},initSliders:function(){for(var name in this.sliders_options){var self=this;var slider=function(name){$('#'+name).slider({range:"min",min:self.sliders_options[name]['min'],max:self.sliders_options[name]['max'],value:$('input[name='+name+']').val(),slide:function(event,ui){$("input[name="+name+"]").val(ui.value);$("#"+name+"_info").text(ui.value)},change:function(){$("#"+name+"_info").text($('input[name='+name+']').val())},create:function(event,ui){$("#"+name+"_info").text($('input[name='+name+']').val())},stop:function(){self.build()}})}(name)}},getColor:function(id){if(id){var val=$('input[name='+id+']').val();if(val){return val}else{return'#000000'}}else{return'#000000'}},updateColorField:function(id,val){if(id&&val){$('#'+id).css('backgroundColor',val);id=id.replace('select_','');$('input[name='+id+']').val(val)}},updateColorSelects:function(){for(var c in this.colour_fields){var hex=$("input[name="+this.colour_fields[c]+"]").val();$('#select_'+this.colour_fields[c]).css('backgroundColor',hex);$('#select_'+this.colour_fields[c]).ColorPickerSetColor(hex)}},changeSliderValues:function(){for(var name in this.sliders_options){var val=$('input[name='+name+']').val();$('#'+name).slider("value",val);$("#"+name+"_info").text(val)}},setFillType:function(){var val=$("select[name=fill_type] option:selected").val();if(val==1){$('#fill_type_gradient').hide();$('#fill_type_color').show()}else{$('#fill_type_gradient').show();$('#fill_type_color').hide()}},toggleButtonGeneratorGroupControls:function(el,id){if($('input[name='+el+']').is(':checked')){$('#'+id).show()}else{$('#'+id).hide()}button_generator.setRightColSize()},initPaletteSelector:function(){var self=this;var bg_color=$('#palette_chooser_list li:first').css('background-color');$(document).bind('click',function(event){var $clicked=$(event.target);if($clicked.is('#palette_chooser_list')){return}if($clicked.is('#palette_chooser_list li')){var button_id=$clicked.data('id');if(button_id){$('select[name=palette_id]').val(button_id);bg_color=$('select[name=palette_id] option:selected').text();$('#palette_chooser_selected').css('background-color',bg_color);self.applyPalette(button_id);self.paletteSelectorHide();return}}if((($clicked.parents().is('#palette_chooser')||$clicked.is('#palette_chooser'))&&($('#palette_chooser_list').css('display')=="none"))){self.paletteSelectorShow()}else{self.paletteSelectorHide()}});$('#palette_chooser_selected').css('background-color',bg_color)},paletteSelectorShow:function(){$('#palette_chooser span').css("background-position","-163px -234px");$('#palette_chooser_list').show()},paletteSelectorHide:function(){$('#palette_chooser span').css("background-position","-60px -181px");$('#palette_chooser_list').hide()},setRightColSize:function(){var height=$('#settings').height();if(height<500){height=500}$('#s3_user_buttons').height(height)},build:function(){var self=this;if(!self.is_in_progress&&$("#settings input[name=button_text]").val()!=''){$("#s3_button_save_action").removeClass('green').unbind('click');self.is_in_progress=true;data=$("#settings").serialize();$.post('/-/cms/v1/button/?act=generate&'+site_u,data,function(button_id){$("#button").attr('src',site_root_url+'/d/buttons/1.png?'+Math.random());if(self.mode!='edit'){$("#button_id").val(button_id)}self.is_in_progress=false;$("#s3_button_save_action").addClass('green').bind('click')})}},open:function(){this.mode='new';s3.openModalPopup('/-/cms/v1/button/?act=builder&mode=new&popup=true&'+site_u,true)},editButton:function(obj,button_id){if(obj){this.elementTagName='LI';this.obj=util.getElement(obj,this.elementTagName);if(selector.taken(this.obj,obj))return false}this.mode='edit';s3.openModalPopup('/-/cms/v1/button/?act=builder&popup=true&mode=edit&button_id='+button_id+'&'+site_u,true)},copyButton:function(button_id){this.mode='copy';s3.openModalPopup('/-/cms/v1/button/?act=builder&popup=true&mode=copy&button_id='+button_id+'&'+site_u,true)}}})(jQuery);(function($,window,document,undefined){"use strict";var pluginName="logo",defaults={logo:"generator",width:450,height:450},dataKey="plugin_"+pluginName;function Plugin(element,options){this.element=element;this.settings=$.extend({},defaults,options);this._defaults=defaults;this.favicon_id=0;this.middle_x=0;this.middle_y=0;this._name=pluginName;this.logo=undefined;this.import_svg=undefined;this.current_layer='text';this.move_timeout=0;this.rand_colors=['#ffbf00','#6E95D4','#62dec9','#b3a983','#b383b1','#f088ab','#31c292','#8b8c8f'];this.random_color_generated='';this.getRandomColor();this.shadow=[2,3,3,0.5];this.is_paid=0;this.free_transform=undefined;this.layers={'layer_1':{'el':undefined,'fill':this.random_color_generated,'fill_enabled':true,'shadow_enabled':false,'stroke_enabled':false,'fill_type':'color','last_fill':this.random_color_generated,'stroke':'#000000','stroke-width':10,'is_hidden':false,'gradient':{'is_enabled':false,'start':this.random_color_generated,'end':'#000000','angle':90},'current_figure':'001','transform':{'val':''},'draggable':false},'layer_2':{'el':undefined,'fill':'#ffffff','fill_enabled':true,'shadow_enabled':false,'stroke_enabled':true,'fill_type':'color','last_fill':'#ffffff','stroke':'#d5d5d5','stroke-width':2,'is_hidden':false,'gradient':{'is_enabled':false,'start':'#ffffff','end':'#000000','angle':90},'current_figure':'001-010','transform':{'val':''},'draggable':true},'text':{'el':undefined,'size':220,'min_size':140,'max_size':300,'fill':'#ffffff','fill_enabled':true,'shadow_enabled':false,'stroke_enabled':false,'fill_type':'color','last_fill':'#ffffff','stroke':'#000000','stroke-width':2,'is_hidden':false,'font':'adonis','caption':'MG','style':'','text-anchor':'middle','is_regular':false,'is_italic_enabled':false,'is_bold_enabled':true,'pos':{'x':91,'y':229},'gradient':{'is_enabled':false,'start':'#ffffff','end':'#000000','angle':90},'transform':{'val':''},'draggable':true},'svg':undefined};this.current_category=10;this.categories={10:{name:"Абстракции",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 160 160"><path d="M45.2 88L0 130.6V160h160V55l-64.8 65-50-32"/><path d="M95.2 77.8L45.2 46 0 88.6v22L45.2 68l50 31.8L160 35V13L95.2 77.8"/></svg>'},20:{name:"Строительство",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 160 160"><path d="M0 60h30v40H0zM0 10h70v40H0zM40 60h80v40H40zM90 110h70v40H90zM0 110h80v40H0z" /></svg>'},30:{name:"Транспорт",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 160 160"><path d="M160 49.8c-15.4.2-47.4-2.9-70-6.8v-.6c10.5-7.8 26.9-20.7 38-21.8 7.2-.7 19.9-.4 32 .4v28.8zm-17.7 4.9c5.8 1 11.8 1.5 17.7 1.7v36.8c-.6-2.8-1.5-5-3-6.3-6.8-6-18.3 1.3-25.5 15.8s-7.2 33.7-12.7 33.2S92 144 72.5 141s-48-10.7-53.9-20-.8-7.7-.8-7.7c16 10.2 57.2 18.7 64.4 17.5s3-6-2.1-6.4-31-4.7-48.8-11.1-20.7-11.9-21.2-20c-.4-6.3 1.6-7.9 1.6-7.9.1-.1.1-.2.2-.4.2-.3.3-.7.5-1 .2-.4 1-3.3 1.7-2.8l1 1 .1.1.2.2c.1.1.3.3.5.4l.1.1c.2.1.3.3.5.4l.2.2c.2.1.4.2.6.4.1 0 .1.1.2.1l.9.6c1.2.7 2.4 1.2 3.7 1.4.8 0 1.6-.1 2.4-.2.8-.1 1.4-.6 1.7-1.3.4-.6.6-1.4.4-2.1v-.1c0-.3-.1-.5-.2-.8 0-.1-.1-.1-.1-.2-.1-.2-.2-.5-.3-.7-.1-.1-.2-.2-.2-.3-.1-.2-.2-.4-.4-.6s-.3-.4-.5-.7c-.1-.1-.2-.2-.3-.4-.3-.4-.7-.7-1.1-1.1L19.9 74c-.4-.3-.6-.7-.8-1.1 0-.3.1-.7.3-.9 12.3-10.4 33.3-14.3 50.7-19.7 2.8-.7 5.5-1.6 8.2-2.7 0 0 3.1-1.4 8.9-.8 8.8 1 22.7 3.6 35.8 4.8 7.5.7 14.7 1 19.3 1.1zm-37.6 35.4c-9.3.6-16.3-.6-27.6 3.2-11.9 3.9-.8 7.7-.8 7.7s19.5 7.7 37.4-2.1c0-.1.4-9.5-9-8.8zm26.7 36.5c3.2-12.6 6.6-25.9 16.1-35.1.6-.4 1.2-.8 1.8-1.1l.8-.4c2.5-.9 7.3-2.5 9.9 5.3v31.1c-.7 3.2-1.7 6.3-2.7 9.5-4.8 9.2-11.4 11.3-20.3 11.1-3.6-.2-12.3-1-15.7-8 .4-.1.8-.2 1.2-.2 3.2-.2 5.7.4 8.9-12.2zm21.3 9.3c2.2.2 4.9-8.1 5.9-18.5s.1-19.1-2.1-19.3-4.9 8.1-5.9 18.5-.2 19.1 2.1 19.3z"/></svg>'},40:{name:"Животные и природа",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 160 160"><path fill="#000" fill-opacity=".98" fill-rule="evenodd" d="M34.098 82.523c5.501-38.51 43.02-27.508 43.02-49.514 0-22.006 11.995-22.006 11.995-22.006L94.614 0s0 11.003 5.502 11.003c5.501 0 22.006 5.502 22.006 16.505S111.119 38.51 111.119 38.51s5.501 27.507-5.502 38.51c-11.003 11.003-11.003 33.01 0 38.51 11.003 5.502-.66 14.208-.66 14.208H42.66c-.872 2.07-1.433 4.045-1.618 5.85-.989 9.6 32.177-2.034 38.915 4.411 6.737 6.445-5 10-15 10s-36.765 2.959-34.86-15.538c.451-4.386 2.058-8.817 4.475-13.227-3.224-7.605-3.167-19.864-.474-38.712z"/></svg>'},50:{name:"Недвижимость",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 160 160"><path d="M72 132H41v-31h31v31zm88 27.1L56.3 56 0 112.2v-32L56.7 23 99 38v17l12 13V20l23 8v25l26 25.9v80.2z"/></svg>'},60:{name:"Люди",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 160 160"><path d="M15.667 155.285c-4.587-9.415-10.381-27.279.24-47.92s23.538-32.831 48.765-43.332 34.22-15.088 42.488-23.839 10.863-16.6 11.406-22.571-.844-13.218-3.38-17.321c-2.051 6.337-11.285 15.993-24.623 21.847S58.697 36.694 46.506 43.513s-22.33 14.062-30.84 25.529-8.931 16.3-8.931 16.3 1.87-17.743 14.484-30.719 32.168-27.4 48.885-35.426c9.2-4.42 21.345-11.375 29.57-19.195h25.367a44.715 44.715 0 0 1 3.182 8.754 78.807 78.807 0 0 1-.181 37.116c-.785 3.44-3.742 11.849-3.742 14.947s.523 5.512 2.615 9.576 10.3 15.249 11.547 17.744 3.34 4.355-.342 7.523-7.3 1.328-9.445 2.656-3.047 3.41-1.871 6.307 3.38 4.073 2.565 5.763-4.37 1.98-5.383 2.752-1.255 1.5-.145 2.849 3.066 1.931 2.342 4.128-3.742 1.134-5.987 3.114-3.09 3.114-2.85 7.267.895 7.555-2.92 9.535-10.791 1.449-16.32.024a97.397 97.397 0 0 0-19.877-2.447c-4.335.106-12.567.323-20.775 4.378a88.033 88.033 0 0 0-20.5 13.758 28.293 28.293 0 0 0-3.688 4.252H18.412a41.7 41.7 0 0 1-2.745-4.713zm92.87-85.08c3.7-1.105 6.122-5.445 6.025-8.289-2.747 2.072-11.716 4.991-22.41.145 0 0 5.929 10.313 16.386 8.144z"/></svg>'},70:{name:"Еда",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 160 160"><path d="M80 0C57.9 0 40 17.9 40 40v70c0 5.5 4.5 10 10 10h20v30c0 5.5 4.5 10 10 10s10-4.5 10-10v-30h20c5.4 0 10-4.5 10-10V40c0-22.1-17.9-40-40-40zM50 110V41.4c5.3-2.7 13.6-4.2 20 8.6 7 14.1 21.5 23.2 40 15.1V110H50z"/></svg>'},80:{name:"Бизнес",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 160 160"><path d="M90 20h-.4l-.2 70-69.4-.1v.1c0 38.7 31.3 70 70 70s70-31.3 70-70-31.3-70-70-70z"/><path d="M79.9 0c-3.2 0-6.3.2-9.4.6-.2 0-.4 0-.6.1C33.7 5.2 5.1 33.9.6 70.1c-.1.4-.1.9-.1 1.3 0 .2 0 .4-.1.6-.1 1.2-.2 2.3-.3 3.5v.7C0 77.4 0 78.5 0 79.6v.5l79.8.1.1-80.2zM69.8 70.2l-59.1-.1C15 39.5 39.2 15.2 69.9 10.7l-.1 59.5z"/></svg>'},90:{name:"Медицина",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 160 160"><path d="M147.6 87.5L72.5 12.4c-16.5-16.5-43.4-16.5-60 0s-16.6 43.5 0 60l75.1 75.1c16.5 16.5 43.4 16.5 60 0 16.5-16.5 16.6-43.4 0-60zm-90.1 15L19.9 64.9c-12.4-12.4-12.4-32.6 0-45 12.4-12.4 32.6-12.4 45 0l37.6 37.6-45 45z"/></svg>'}};this.icons=[{figure_id:'001',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><rect width="160" height="160"/></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 55 55"><rect width="55" height="55" stroke="#e2e2e2" stroke-width="2" fill="#ffffff"/></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{figure_id:'007',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#000" fill-rule="evenodd" d="M120.038 0H39.962C17.892 0 0 17.888 0 39.962v80.076C0 142.108 17.888 160 39.962 160h80.076c22.07 0 39.962-17.888 39.962-39.962V39.962C160 17.892 142.112 0 120.038 0z"/></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 160 160"><path stroke=\"#e2e2e2\" stroke-width=\"2\" fill=\"#ffffff\" fill-rule="evenodd" d="M120.038 0H39.962C17.892 0 0 17.888 0 39.962v80.076C0 142.108 17.888 160 39.962 160h80.076c22.07 0 39.962-17.888 39.962-39.962V39.962C160 17.892 142.112 0 120.038 0z"/></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{"figure_id":'018',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 20 0 L 140 0 C 151.078125 0 160 8.921875 160 20 L 160 140 C 160 151.078125 151.078125 160 140 160 L 20 160 C 8.921875 160 0 151.078125 0 140 L 0 20 C 0 8.921875 8.921875 0 20 0 Z M 20 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="-1 -1 18 18"><path stroke="#e2e2e2" stroke-width="0.3" fill="#ffffff" d="m 2,0 12,0 c 1.108,0 2,0.892 2,2 l 0,12 c 0,1.108 -0.892,2 -2,2 L 2,16 C 0.892,16 0,15.108 0,14 L 0,2 C 0,0.892 0.892,0 2,0 Z"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{figure_id:'002',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0,80a80,80 0 1,0 160,0a80,80 0 1,0 -160,0" /></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 160 160"><path d="M0,80a80,80 0 1,0 160,0a80,80 0 1,0 -160,0" stroke="#e2e2e2" stroke-width="2" fill="#ffffff" /></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{"figure_id":'019',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 0 C 35.816406 0 0 35.816406 0 80 C 0 124.183594 35.816406 160 80 160 C 124.183594 160 160 124.183594 160 80 C 160 35.816406 124.183594 0 80 0 Z M 80 140 C 46.863281 140 20 113.136719 20 80 C 20 46.863281 46.863281 20 80 20 C 113.136719 20 140 46.863281 140 80 C 140 113.136719 113.136719 140 80 140 Z M 80 140"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 0 C 3.581641 0 0 3.581641 0 8 C 0 12.418359 3.581641 16 8 16 C 12.418359 16 16 12.418359 16 8 C 16 3.581641 12.418359 0 8 0 Z M 8 14 C 4.686328 14 2 11.313672 2 8 C 2 4.686328 4.686328 2 8 2 C 11.313672 2 14 4.686328 14 8 C 14 11.313672 11.313672 14 8 14 Z M 8 14" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'020',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 0 C 35.816406 0 0 35.816406 0 80 C 0 124.183594 35.816406 160 80 160 C 124.183594 160 160 124.183594 160 80 C 160 35.816406 124.183594 0 80 0 Z M 80 150 C 41.339844 150 10 118.660156 10 80 C 10 41.339844 41.339844 10 80 10 C 118.660156 10 150 41.339844 150 80 C 150 118.660156 118.660156 150 80 150 Z M 80 150"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 0 C 3.581641 0 0 3.581641 0 8 C 0 12.418359 3.581641 16 8 16 C 12.418359 16 16 12.418359 16 8 C 16 3.581641 12.418359 0 8 0 Z M 8 15 C 4.133984 15 1 11.866016 1 8 C 1 4.133984 4.133984 1 8 1 C 11.866016 1 15 4.133984 15 8 C 15 11.866016 11.866016 15 8 15 Z M 8 15" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{figure_id:'003',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 0l80 40v80l-80 40-80-40V40L80 0"/></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 160 160"><path d="M80 0l80 40v80l-80 40-80-40V40L80 0" stroke="#e2e2e2" stroke-width="2" fill="#ffffff"/></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{figure_id:'004',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M110,40V30a30,30,0,0,0-60,0V40H0V160H160V40H110ZM55,60a5,5,0,1,1,5-5A5,5,0,0,1,55,60Zm5-30a20,20,0,0,1,40,0V40H60V30Zm45,30a5,5,0,1,1,5-5A5,5,0,0,1,105,60Z"/></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 160 160"><path d="M110,40V30a30,30,0,0,0-60,0V40H0V160H160V40H110ZM55,60a5,5,0,1,1,5-5A5,5,0,0,1,55,60Zm5-30a20,20,0,0,1,40,0V40H60V30Zm45,30a5,5,0,1,1,5-5A5,5,0,0,1,105,60Z" stroke="#e2e2e2" stroke-width="2" fill="#ffffff"/></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{figure_id:'005',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M11.42857,81.571v0.04589L80,150.00054l68.57141-68.3837V81.571A41.52992,41.52992,0,0,0,160,53.07745c0-23.79072-20.467-43.07691-45.7143-43.07691A46.84644,46.84644,0,0,0,80,24.584,46.8465,46.8465,0,0,0,45.71428,10.00054C20.467,10.00054,0,29.28673,0,53.07745A41.53,41.53,0,0,0,11.42857,81.571Z"/></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 160 160"><path d="M11.42857,81.571v0.04589L80,150.00054l68.57141-68.3837V81.571A41.52992,41.52992,0,0,0,160,53.07745c0-23.79072-20.467-43.07691-45.7143-43.07691A46.84644,46.84644,0,0,0,80,24.584,46.8465,46.8465,0,0,0,45.71428,10.00054C20.467,10.00054,0,29.28673,0,53.07745A41.53,41.53,0,0,0,11.42857,81.571Z" stroke="#e2e2e2" stroke-width="2" fill="#ffffff" /></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{figure_id:'006',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 160c33.1 0 60-26 60-58.2S80 0 80 0 20 69.7 20 101.8 46.9 160 80 160z"/></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 160 160"><path stroke="#e2e2e2" stroke-width="2" fill="#ffffff" d="M80 159.993a59.11 59.11 0 0 0 59.997-58.18C139.997 69.683 80 0 80 0S20.003 69.682 20.003 101.814A59.11 59.11 0 0 0 80 159.994z"/></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{figure_id:'008',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#000" fill-rule="evenodd" d="M80 0l56.569 23.431L160 80l-23.431 56.569L80 160l-56.569-23.431L0 80l23.431-56.569z"/></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 160 160"><path stroke="#e2e2e2" stroke-width="2" fill="#ffffff" fill-rule="evenodd" d="M80 0l56.569 23.431L160 80l-23.431 56.569L80 160l-56.569-23.431L0 80l23.431-56.569z"/></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{figure_id:'009',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M.4 50L30 10h100l30 40-79.6 100L.4 50z"/></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 160 160"><path stroke="#e2e2e2" stroke-width="2" fill="#ffffff" d="M.4 50L30 10h100l30 40-79.6 100L.4 50z"/></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{figure_id:'010',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#000" fill-rule="evenodd" d="M80 0l80 80-80 80L0 80z"/></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 160 160"><path stroke="#e2e2e2" stroke-width="2" fill="#ffffff" fill-rule="evenodd" d="M80 0l80 80-80 80L0 80z"/></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{figure_id:'011',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#000" fill-rule="evenodd" d="M28.759 140H131.26c17.069 0 23.687-11.914 14.772-26.627l-49.89-82.34c-8.91-14.707-23.352-14.714-32.267 0l-49.89 82.34C5.076 128.078 11.579 140 28.759 140z"/></svg>',form_bg:'<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 160 160"><path stroke="#e2e2e2" stroke-width="2" fill="#ffffff" fill-rule="evenodd" d="M28.759 140H131.26c17.069 0 23.687-11.914 14.772-26.627l-49.89-82.34c-8.91-14.707-23.352-14.714-32.267 0l-49.89 82.34C5.076 128.078 11.579 140 28.759 140z"/></svg>',rotate:'',scale:'',is_form:true,is_figure:false,is_free:false},{"figure_id":'013',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 0 160 L 160 160 L 160 0 Z M 140 140 L 20 140 L 20 20 L 140 20 Z M 140 140"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 0 16 L 16 16 L 16 0 Z M 14 14 L 2 14 L 2 2 L 14 2 Z M 14 14" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'014',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 0 160 L 160 160 L 160 0 Z M 150 150 L 10 150 L 10 10 L 150 10 Z M 150 150"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 0 16 L 16 16 L 16 0 Z M 15 15 L 1 15 L 1 1 L 15 1 Z M 15 15" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'016',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 129.976562 0 L 30.023438 0 C 13.453125 0.0234375 0.0234375 13.453125 0 30.023438 L 0 129.976562 C 0.0234375 146.546875 13.453125 159.976562 30.023438 160 L 129.976562 160 C 146.546875 159.976562 159.976562 146.546875 160 129.976562 L 160 30.023438 C 159.976562 13.453125 146.546875 0.0234375 129.976562 0 Z M 140 129.976562 C 139.976562 135.5 135.5 139.976562 129.976562 140 L 30.023438 140 C 24.5 139.976562 20.023438 135.5 20 129.976562 L 20 30.023438 C 20.023438 24.5 24.5 20.023438 30.023438 20 L 129.976562 20 C 135.5 20.023438 139.976562 24.5 140 30.023438 Z M 140 129.976562"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 12.997656 0 L 3.002344 0 C 1.345312 0.00234375 0.00234375 1.345312 0 3.002344 L 0 12.997656 C 0.00234375 14.654687 1.345312 15.997656 3.002344 16 L 12.997656 16 C 14.654687 15.997656 15.997656 14.654687 16 12.997656 L 16 3.002344 C 15.997656 1.345312 14.654687 0.00234375 12.997656 0 Z M 14 12.997656 C 13.997656 13.55 13.55 13.997656 12.997656 14 L 3.002344 14 C 2.45 13.997656 2.002344 13.55 2 12.997656 L 2 3.002344 C 2.002344 2.45 2.45 2.002344 3.002344 2 L 12.997656 2 C 13.55 2.002344 13.997656 2.45 14 3.002344 Z M 14 12.997656" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'017',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 139.929688 0 L 20.070312 0 C 8.984375 -0.00390625 -0.00390625 8.984375 0 20.070312 L 0 139.929688 C -0.00390625 151.015625 8.984375 160.003906 20.070312 160 L 139.929688 160 C 151.015625 160.003906 160.003906 151.015625 160 139.929688 L 160 20.070312 C 160.003906 8.984375 151.015625 -0.00390625 139.929688 0 Z M 150 139.929688 C 150 142.601562 148.941406 145.164062 147.050781 147.050781 C 145.164062 148.941406 142.601562 150 139.929688 150 L 20.070312 150 C 17.398438 150 14.835938 148.941406 12.949219 147.050781 C 11.058594 145.164062 10 142.601562 10 139.929688 L 10 20.070312 C 10 17.398438 11.058594 14.835938 12.949219 12.949219 C 14.835938 11.058594 17.398438 10 20.070312 10 L 139.929688 10 C 142.601562 10 145.164062 11.058594 147.050781 12.949219 C 148.941406 14.835938 150 17.398438 150 20.070312 Z M 150 139.929688"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 13.992969 0 L 2.007031 0 C 0.898437 -0.000390625 -0.000390625 0.898437 0 2.007031 L 0 13.992969 C -0.000390625 15.101562 0.898437 16.000391 2.007031 16 L 13.992969 16 C 15.101562 16.000391 16.000391 15.101562 16 13.992969 L 16 2.007031 C 16.000391 0.898437 15.101562 -0.000390625 13.992969 0 Z M 15 13.992969 C 15 14.260156 14.894141 14.516406 14.705078 14.705078 C 14.516406 14.894141 14.260156 15 13.992969 15 L 2.007031 15 C 1.739844 15 1.483594 14.894141 1.294922 14.705078 C 1.105859 14.516406 1 14.260156 1 13.992969 L 1 2.007031 C 1 1.739844 1.105859 1.483594 1.294922 1.294922 C 1.483594 1.105859 1.739844 1 2.007031 1 L 13.992969 1 C 14.260156 1 14.516406 1.105859 14.705078 1.294922 C 14.894141 1.483594 15 1.739844 15 2.007031 Z M 15 13.992969" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'022',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 0 L 0 160 L 160 160 Z M 80 45 L 128 140 L 32 140 Z M 80 45"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 0 L 0 16 L 16 16 Z M 8 4.5 L 12.8 14 L 3.2 14 Z M 8 4.5" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'023',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 0 L 0 160 L 160 160 Z M 80 22 L 144 150 L 16 150 Z M 80 22"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 0 L 0 16 L 16 16 Z M 8 2.2 L 14.4 15 L 1.6 15 Z M 8 2.2" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'024',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 0 L 0 160 L 160 160 L 80 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 0 L 0 16 L 16 16 L 8 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'025',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 0 L 10 40 L 10 120 L 80 160 L 150 120 L 150 40 Z M 130 108.394531 L 80 136.964844 L 30 108.394531 L 30 51.605469 L 80 23.035156 L 130 51.605469 Z M 130 108.394531"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 0 L 1 4 L 1 12 L 8 16 L 15 12 L 15 4 Z M 13 10.839453 L 8 13.696484 L 3 10.839453 L 3 5.160547 L 8 2.303516 L 13 5.160547 Z M 13 10.839453" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'026',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 0 L 10 40 L 10 120 L 80 160 L 150 120 L 150 40 Z M 140 114.195312 L 80 148.484375 L 20 114.195312 L 20 45.804688 L 80 11.515625 L 140 45.804688 Z M 140 114.195312"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 0 L 1 4 L 1 12 L 8 16 L 15 12 L 15 4 Z M 14 11.419531 L 8 14.848437 L 2 11.419531 L 2 4.580469 L 8 1.151562 L 14 4.580469 Z M 14 11.419531" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'027',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 0 L 10 40 L 10 120 L 80 160 L 150 120 L 150 40 L 80 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 0 L 1 4 L 1 12 L 8 16 L 15 12 L 15 4 L 8 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'028',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 10 L 10 60.859375 L 36.738281 143.148438 L 123.261719 143.148438 L 150 60.859375 Z M 108.730469 123.148438 L 51.269531 123.148438 L 33.511719 68.496094 L 80 34.722656 L 126.488281 68.496094 Z M 108.730469 123.148438"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 1 L 1 6.085937 L 3.673828 14.314844 L 12.326172 14.314844 L 15 6.085937 Z M 10.873047 12.314844 L 5.126953 12.314844 L 3.351172 6.849609 L 8 3.472266 L 12.648828 6.849609 Z M 10.873047 12.314844" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'029',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 10 L 10 60.859375 L 36.738281 143.148438 L 123.261719 143.148438 L 150 60.859375 Z M 115.996094 133.148438 L 44.003906 133.148438 L 21.757812 64.675781 L 80 22.359375 L 138.242188 64.675781 Z M 115.996094 133.148438"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 1 L 1 6.085937 L 3.673828 14.314844 L 12.326172 14.314844 L 15 6.085937 Z M 11.599609 13.314844 L 4.400391 13.314844 L 2.175781 6.467578 L 8 2.235937 L 13.824219 6.467578 Z M 11.599609 13.314844" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'030',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 10 L 10 60.859375 L 36.738281 143.160156 L 123.261719 143.160156 L 150 60.851562 L 80 10"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 1 L 1 6.085937 L 3.673828 14.316016 L 12.326172 14.316016 L 15 6.085156 L 8 1" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'031',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 129.496094 30.503906 L 80 10 L 30.503906 30.503906 L 10 80 L 30.503906 129.496094 L 80 150 L 129.496094 129.496094 L 150 80 Z M 114.191406 114.191406 L 80 128.351562 L 45.808594 114.191406 L 31.648438 80 L 45.808594 45.808594 L 80 31.648438 L 114.191406 45.808594 L 128.351562 80 Z M 114.191406 114.191406"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 12.949609 3.050391 L 8 1 L 3.050391 3.050391 L 1 8 L 3.050391 12.949609 L 8 15 L 12.949609 12.949609 L 15 8 Z M 11.419141 11.419141 L 8 12.835156 L 4.580859 11.419141 L 3.164844 8 L 4.580859 4.580859 L 8 3.164844 L 11.419141 4.580859 L 12.835156 8 Z M 11.419141 11.419141" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'032',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 129.496094 30.503906 L 80 10 L 30.503906 30.503906 L 10 80 L 30.503906 129.496094 L 80 150 L 129.496094 129.496094 L 150 80 Z M 121.84375 121.84375 L 80 139.175781 L 38.15625 121.84375 L 20.824219 80 L 38.15625 38.15625 L 80 20.824219 L 121.84375 38.15625 L 139.175781 80 Z M 121.84375 121.84375"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 12.949609 3.050391 L 8 1 L 3.050391 3.050391 L 1 8 L 3.050391 12.949609 L 8 15 L 12.949609 12.949609 L 15 8 Z M 12.184375 12.184375 L 8 13.917578 L 3.815625 12.184375 L 2.082422 8 L 3.815625 3.815625 L 8 2.082422 L 12.184375 3.815625 L 13.917578 8 Z M 12.184375 12.184375" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'033',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 129.5 30.5 L 80 10 L 30.5 30.5 L 10 80 L 30.5 129.5 L 80 150 L 129.5 129.5 L 150 80 L 129.5 30.5"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 12.95 3.05 L 8 1 L 3.05 3.05 L 1 8 L 3.05 12.95 L 8 15 L 12.95 12.95 L 15 8 L 12.95 3.05" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'034',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 10 L 20 80 L 80 150 L 140 80 Z M 46.339844 80 L 80 40.730469 L 113.660156 80 L 80 119.269531 Z M 46.339844 80"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 1 L 2 8 L 8 15 L 14 8 Z M 4.633984 8 L 8 4.073047 L 11.366016 8 L 8 11.926953 Z M 4.633984 8" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'035',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 10 L 20 80 L 80 150 L 140 80 Z M 33.171875 80 L 80 25.367188 L 126.828125 80 L 80 134.632812 Z M 33.171875 80"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 1 L 2 8 L 8 15 L 14 8 Z M 3.317187 8 L 8 2.536719 L 12.682812 8 L 8 13.463281 Z M 3.317187 8" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'036',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 10 L 20 80 L 80 150 L 140 80 L 80 10"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 1 L 2 8 L 8 15 L 14 8 L 8 1" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'038',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 130 0 L 0 129.589844 L 0 160 L 30 160 L 160 30 L 160 0 Z M 130 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 13 0 L 0 12.958984 L 0 16 L 3 16 L 16 3 L 16 0 Z M 13 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'039',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 50 10 L 70 10 L 70 30 L 50 30 Z M 50 130 L 70 130 L 70 150 L 50 150 Z M 10 10 L 30 10 L 30 30 L 10 30 Z M 10 50 L 30 50 L 30 70 L 10 70 Z M 10 130 L 30 130 L 30 150 L 10 150 Z M 10 90 L 30 90 L 30 110 L 10 110 Z M 90 10 L 110 10 L 110 30 L 90 30 Z M 90 130 L 110 130 L 110 150 L 90 150 Z M 130 10 L 150 10 L 150 30 L 130 30 Z M 130 50 L 150 50 L 150 70 L 130 70 Z M 130 130 L 150 130 L 150 150 L 130 150 Z M 130 90 L 150 90 L 150 110 L 130 110 Z M 130 90"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 5 1 L 7 1 L 7 3 L 5 3 Z M 5 13 L 7 13 L 7 15 L 5 15 Z M 1 1 L 3 1 L 3 3 L 1 3 Z M 1 5 L 3 5 L 3 7 L 1 7 Z M 1 13 L 3 13 L 3 15 L 1 15 Z M 1 9 L 3 9 L 3 11 L 1 11 Z M 9 1 L 11 1 L 11 3 L 9 3 Z M 9 13 L 11 13 L 11 15 L 9 15 Z M 13 1 L 15 1 L 15 3 L 13 3 Z M 13 5 L 15 5 L 15 7 L 13 7 Z M 13 13 L 15 13 L 15 15 L 13 15 Z M 13 9 L 15 9 L 15 11 L 13 11 Z M 13 9" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'040',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 30 0 L 40 0 L 40 10 L 30 10 Z M 30 150 L 40 150 L 40 160 L 30 160 Z M 60 150 L 70 150 L 70 160 L 60 160 Z M 0 0 L 10 0 L 10 10 L 0 10 Z M 0 60 L 10 60 L 10 70 L 0 70 Z M 0 120 L 10 120 L 10 130 L 0 130 Z M 0 30 L 10 30 L 10 40 L 0 40 Z M 0 150 L 10 150 L 10 160 L 0 160 Z M 0 90 L 10 90 L 10 100 L 0 100 Z M 60 0 L 70 0 L 70 10 L 60 10 Z M 90 150 L 100 150 L 100 160 L 90 160 Z M 150 90 L 160 90 L 160 100 L 150 100 Z M 150 60 L 160 60 L 160 70 L 150 70 Z M 150 30 L 160 30 L 160 40 L 150 40 Z M 150 0 L 160 0 L 160 10 L 150 10 Z M 90 0 L 100 0 L 100 10 L 90 10 Z M 150 120 L 160 120 L 160 130 L 150 130 Z M 120 0 L 130 0 L 130 10 L 120 10 Z M 120 150 L 130 150 L 130 160 L 120 160 Z M 150 150 L 160 150 L 160 160 L 150 160 Z M 150 150"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 3 0 L 4 0 L 4 1 L 3 1 Z M 3 15 L 4 15 L 4 16 L 3 16 Z M 6 15 L 7 15 L 7 16 L 6 16 Z M 0 0 L 1 0 L 1 1 L 0 1 Z M 0 6 L 1 6 L 1 7 L 0 7 Z M 0 12 L 1 12 L 1 13 L 0 13 Z M 0 3 L 1 3 L 1 4 L 0 4 Z M 0 15 L 1 15 L 1 16 L 0 16 Z M 0 9 L 1 9 L 1 10 L 0 10 Z M 6 0 L 7 0 L 7 1 L 6 1 Z M 9 15 L 10 15 L 10 16 L 9 16 Z M 15 9 L 16 9 L 16 10 L 15 10 Z M 15 6 L 16 6 L 16 7 L 15 7 Z M 15 3 L 16 3 L 16 4 L 15 4 Z M 15 0 L 16 0 L 16 1 L 15 1 Z M 9 0 L 10 0 L 10 1 L 9 1 Z M 15 12 L 16 12 L 16 13 L 15 13 Z M 12 0 L 13 0 L 13 1 L 12 1 Z M 12 15 L 13 15 L 13 16 L 12 16 Z M 15 15 L 16 15 L 16 16 L 15 16 Z M 15 15" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'041',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 10 C 74.476562 10 70 14.476562 70 20 C 70 25.523438 74.476562 30 80 30 C 85.523438 30 90 25.523438 90 20 C 90 14.476562 85.523438 10 80 10 Z M 37.714844 27.578125 C 35.015625 27.542969 32.417969 28.597656 30.507812 30.507812 C 26.605469 34.414062 26.605469 40.742188 30.507812 44.648438 C 34.414062 48.550781 40.742188 48.550781 44.648438 44.648438 C 48.550781 40.742188 48.550781 34.414062 44.648438 30.507812 C 42.808594 28.664062 40.320312 27.613281 37.714844 27.578125 Z M 122.578125 27.578125 C 119.871094 27.535156 117.265625 28.59375 115.351562 30.507812 C 111.449219 34.414062 111.449219 40.742188 115.351562 44.648438 C 119.257812 48.550781 125.585938 48.550781 129.492188 44.648438 C 133.394531 40.742188 133.394531 34.414062 129.492188 30.507812 C 127.65625 28.671875 125.175781 27.621094 122.578125 27.578125 Z M 20 70 C 14.476562 70 10 74.476562 10 80 C 10 85.523438 14.476562 90 20 90 C 25.523438 90 30 85.523438 30 80 C 30 74.476562 25.523438 70 20 70 Z M 140 70 C 134.476562 70 130 74.476562 130 80 C 130 85.523438 134.476562 90 140 90 C 145.523438 90 150 85.523438 150 80 C 150 74.476562 145.523438 70 140 70 Z M 37.714844 112.421875 C 35.015625 112.386719 32.417969 113.441406 30.507812 115.351562 C 26.605469 119.257812 26.605469 125.585938 30.507812 129.492188 C 34.414062 133.394531 40.742188 133.394531 44.648438 129.492188 C 48.550781 125.585938 48.550781 119.257812 44.648438 115.351562 C 42.808594 113.507812 40.320312 112.457031 37.714844 112.421875 Z M 122.578125 112.421875 C 119.871094 112.378906 117.265625 113.4375 115.351562 115.351562 C 111.449219 119.257812 111.449219 125.585938 115.351562 129.492188 C 119.257812 133.394531 125.585938 133.394531 129.492188 129.492188 C 133.394531 125.585938 133.394531 119.257812 129.492188 115.351562 C 127.65625 113.515625 125.175781 112.464844 122.578125 112.421875 Z M 80 130 C 74.476562 130 70 134.476562 70 140 C 70 145.523438 74.476562 150 80 150 C 85.523438 150 90 145.523438 90 140 C 90 134.476562 85.523438 130 80 130 Z M 80 130"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 1 C 7.447656 1 7 1.447656 7 2 C 7 2.552344 7.447656 3 8 3 C 8.552344 3 9 2.552344 9 2 C 9 1.447656 8.552344 1 8 1 Z M 3.771484 2.757812 C 3.501562 2.754297 3.241797 2.859766 3.050781 3.050781 C 2.660547 3.441406 2.660547 4.074219 3.050781 4.464844 C 3.441406 4.855078 4.074219 4.855078 4.464844 4.464844 C 4.855078 4.074219 4.855078 3.441406 4.464844 3.050781 C 4.280859 2.866406 4.032031 2.761328 3.771484 2.757812 Z M 12.257812 2.757812 C 11.987109 2.753516 11.726562 2.859375 11.535156 3.050781 C 11.144922 3.441406 11.144922 4.074219 11.535156 4.464844 C 11.925781 4.855078 12.558594 4.855078 12.949219 4.464844 C 13.339453 4.074219 13.339453 3.441406 12.949219 3.050781 C 12.765625 2.867187 12.517578 2.762109 12.257812 2.757812 Z M 2 7 C 1.447656 7 1 7.447656 1 8 C 1 8.552344 1.447656 9 2 9 C 2.552344 9 3 8.552344 3 8 C 3 7.447656 2.552344 7 2 7 Z M 14 7 C 13.447656 7 13 7.447656 13 8 C 13 8.552344 13.447656 9 14 9 C 14.552344 9 15 8.552344 15 8 C 15 7.447656 14.552344 7 14 7 Z M 3.771484 11.242187 C 3.501562 11.238672 3.241797 11.344141 3.050781 11.535156 C 2.660547 11.925781 2.660547 12.558594 3.050781 12.949219 C 3.441406 13.339453 4.074219 13.339453 4.464844 12.949219 C 4.855078 12.558594 4.855078 11.925781 4.464844 11.535156 C 4.280859 11.350781 4.032031 11.245703 3.771484 11.242187 Z M 12.257812 11.242187 C 11.987109 11.237891 11.726562 11.34375 11.535156 11.535156 C 11.144922 11.925781 11.144922 12.558594 11.535156 12.949219 C 11.925781 13.339453 12.558594 13.339453 12.949219 12.949219 C 13.339453 12.558594 13.339453 11.925781 12.949219 11.535156 C 12.765625 11.351562 12.517578 11.246484 12.257812 11.242187 Z M 8 13 C 7.447656 13 7 13.447656 7 14 C 7 14.552344 7.447656 15 8 15 C 8.552344 15 9 14.552344 9 14 C 9 13.447656 8.552344 13 8 13 Z M 8 13" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'042',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 0 C 77.238281 0 75 2.238281 75 5 C 75 7.761719 77.238281 10 80 10 C 82.761719 10 85 7.761719 85 5 C 85 2.238281 82.761719 0 80 0 Z M 42.382812 10.058594 C 41.546875 10.078125 40.726562 10.304688 40 10.722656 C 38.847656 11.382812 38.007812 12.476562 37.664062 13.761719 C 37.320312 15.042969 37.5 16.410156 38.164062 17.558594 C 39.550781 19.949219 42.609375 20.761719 45 19.375 C 47.386719 17.996094 48.207031 14.949219 46.835938 12.558594 C 45.921875 10.972656 44.214844 10.015625 42.382812 10.058594 Z M 117.265625 10.058594 C 115.5625 10.136719 114.015625 11.082031 113.164062 12.558594 C 111.792969 14.949219 112.613281 17.996094 115 19.375 C 117.390625 20.761719 120.449219 19.949219 121.835938 17.558594 C 122.5 16.410156 122.679688 15.042969 122.335938 13.761719 C 121.992188 12.476562 121.152344 11.382812 120 10.722656 C 119.171875 10.242188 118.222656 10.011719 117.265625 10.058594 Z M 14.804688 37.5 C 13.109375 37.585938 11.570312 38.527344 10.722656 40 C 10.058594 41.148438 9.878906 42.515625 10.222656 43.796875 C 10.566406 45.082031 11.40625 46.175781 12.558594 46.835938 C 14.949219 48.207031 17.996094 47.386719 19.375 45 C 20.761719 42.609375 19.949219 39.550781 17.558594 38.164062 C 16.722656 37.683594 15.765625 37.453125 14.804688 37.5 Z M 144.824219 37.5 C 143.988281 37.519531 143.167969 37.746094 142.441406 38.164062 C 140.050781 39.550781 139.238281 42.609375 140.625 45 C 142.003906 47.386719 145.050781 48.207031 147.441406 46.835938 C 148.59375 46.175781 149.433594 45.082031 149.777344 43.796875 C 150.121094 42.515625 149.941406 41.148438 149.277344 40 C 148.363281 38.414062 146.65625 37.457031 144.824219 37.5 Z M 5 75 C 2.238281 75 0 77.238281 0 80 C 0 82.761719 2.238281 85 5 85 C 7.761719 85 10 82.761719 10 80 C 10 77.238281 7.761719 75 5 75 Z M 155 75 C 152.238281 75 150 77.238281 150 80 C 150 82.761719 152.238281 85 155 85 C 157.761719 85 160 82.761719 160 80 C 160 77.238281 157.761719 75 155 75 Z M 14.941406 112.5 C 14.105469 112.519531 13.285156 112.746094 12.558594 113.164062 C 11.40625 113.824219 10.566406 114.917969 10.222656 116.203125 C 9.878906 117.484375 10.058594 118.851562 10.722656 120 C 11.382812 121.152344 12.476562 121.992188 13.761719 122.335938 C 15.042969 122.679688 16.410156 122.5 17.558594 121.835938 C 19.949219 120.449219 20.761719 117.390625 19.375 115 C 18.464844 113.421875 16.765625 112.460938 14.941406 112.5 Z M 144.707031 112.5 C 143.011719 112.585938 141.472656 113.527344 140.625 115 C 139.238281 117.390625 140.050781 120.449219 142.441406 121.835938 C 143.589844 122.5 144.957031 122.679688 146.238281 122.335938 C 147.523438 121.992188 148.617188 121.152344 149.277344 120 C 149.941406 118.851562 150.121094 117.484375 149.777344 116.203125 C 149.433594 114.917969 148.59375 113.824219 147.441406 113.164062 C 146.613281 112.683594 145.664062 112.453125 144.707031 112.5 Z M 42.265625 139.960938 C 40.566406 140.035156 39.019531 140.96875 38.164062 142.441406 C 37.5 143.589844 37.320312 144.957031 37.664062 146.238281 C 38.007812 147.523438 38.847656 148.617188 40 149.277344 C 41.148438 149.941406 42.515625 150.121094 43.796875 149.777344 C 45.082031 149.433594 46.175781 148.59375 46.835938 147.441406 C 48.207031 145.050781 47.386719 142.003906 45 140.625 C 44.171875 140.144531 43.222656 139.914062 42.265625 139.960938 Z M 117.382812 139.960938 C 116.546875 139.980469 115.726562 140.207031 115 140.625 C 112.613281 142.003906 111.792969 145.050781 113.164062 147.441406 C 113.824219 148.59375 114.917969 149.433594 116.203125 149.777344 C 117.484375 150.121094 118.851562 149.941406 120 149.277344 C 121.152344 148.617188 121.992188 147.523438 122.335938 146.238281 C 122.679688 144.957031 122.5 143.589844 121.835938 142.441406 C 120.917969 140.863281 119.207031 139.914062 117.382812 139.960938 Z M 80 150 C 77.238281 150 75 152.238281 75 155 C 75 157.761719 77.238281 160 80 160 C 82.761719 160 85 157.761719 85 155 C 85 152.238281 82.761719 150 80 150 Z M 80 150"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 0 C 7.723828 0 7.5 0.223828 7.5 0.5 C 7.5 0.776172 7.723828 1 8 1 C 8.276172 1 8.5 0.776172 8.5 0.5 C 8.5 0.223828 8.276172 0 8 0 Z M 4.238281 1.005859 C 4.154687 1.007812 4.072656 1.030469 4 1.072266 C 3.884766 1.138281 3.800781 1.247656 3.766406 1.376172 C 3.732031 1.504297 3.75 1.641016 3.816406 1.755859 C 3.955078 1.994922 4.260937 2.076172 4.5 1.9375 C 4.738672 1.799609 4.820703 1.494922 4.683594 1.255859 C 4.592187 1.097266 4.421484 1.001562 4.238281 1.005859 Z M 11.726562 1.005859 C 11.55625 1.013672 11.401562 1.108203 11.316406 1.255859 C 11.179297 1.494922 11.261328 1.799609 11.5 1.9375 C 11.739062 2.076172 12.044922 1.994922 12.183594 1.755859 C 12.25 1.641016 12.267969 1.504297 12.233594 1.376172 C 12.199219 1.247656 12.115234 1.138281 12 1.072266 C 11.917187 1.024219 11.822266 1.001172 11.726562 1.005859 Z M 1.480469 3.75 C 1.310937 3.758594 1.157031 3.852734 1.072266 4 C 1.005859 4.114844 0.987891 4.251562 1.022266 4.379687 C 1.056641 4.508203 1.140625 4.617578 1.255859 4.683594 C 1.494922 4.820703 1.799609 4.738672 1.9375 4.5 C 2.076172 4.260937 1.994922 3.955078 1.755859 3.816406 C 1.672266 3.768359 1.576562 3.745312 1.480469 3.75 Z M 14.482422 3.75 C 14.398828 3.751953 14.316797 3.774609 14.244141 3.816406 C 14.005078 3.955078 13.923828 4.260937 14.0625 4.5 C 14.200391 4.738672 14.505078 4.820703 14.744141 4.683594 C 14.859375 4.617578 14.943359 4.508203 14.977734 4.379687 C 15.012109 4.251562 14.994141 4.114844 14.927734 4 C 14.836328 3.841406 14.665625 3.745703 14.482422 3.75 Z M 0.5 7.5 C 0.223828 7.5 0 7.723828 0 8 C 0 8.276172 0.223828 8.5 0.5 8.5 C 0.776172 8.5 1 8.276172 1 8 C 1 7.723828 0.776172 7.5 0.5 7.5 Z M 15.5 7.5 C 15.223828 7.5 15 7.723828 15 8 C 15 8.276172 15.223828 8.5 15.5 8.5 C 15.776172 8.5 16 8.276172 16 8 C 16 7.723828 15.776172 7.5 15.5 7.5 Z M 1.494141 11.25 C 1.410547 11.251953 1.328516 11.274609 1.255859 11.316406 C 1.140625 11.382422 1.056641 11.491797 1.022266 11.620312 C 0.987891 11.748437 1.005859 11.885156 1.072266 12 C 1.138281 12.115234 1.247656 12.199219 1.376172 12.233594 C 1.504297 12.267969 1.641016 12.25 1.755859 12.183594 C 1.994922 12.044922 2.076172 11.739062 1.9375 11.5 C 1.846484 11.342187 1.676562 11.246094 1.494141 11.25 Z M 14.470703 11.25 C 14.301172 11.258594 14.147266 11.352734 14.0625 11.5 C 13.923828 11.739062 14.005078 12.044922 14.244141 12.183594 C 14.358984 12.25 14.495703 12.267969 14.623828 12.233594 C 14.752344 12.199219 14.861719 12.115234 14.927734 12 C 14.994141 11.885156 15.012109 11.748437 14.977734 11.620312 C 14.943359 11.491797 14.859375 11.382422 14.744141 11.316406 C 14.661328 11.268359 14.566406 11.245312 14.470703 11.25 Z M 4.226562 13.996094 C 4.056641 14.003516 3.901953 14.096875 3.816406 14.244141 C 3.75 14.358984 3.732031 14.495703 3.766406 14.623828 C 3.800781 14.752344 3.884766 14.861719 4 14.927734 C 4.114844 14.994141 4.251562 15.012109 4.379687 14.977734 C 4.508203 14.943359 4.617578 14.859375 4.683594 14.744141 C 4.820703 14.505078 4.738672 14.200391 4.5 14.0625 C 4.417187 14.014453 4.322266 13.991406 4.226562 13.996094 Z M 11.738281 13.996094 C 11.654687 13.998047 11.572656 14.020703 11.5 14.0625 C 11.261328 14.200391 11.179297 14.505078 11.316406 14.744141 C 11.382422 14.859375 11.491797 14.943359 11.620312 14.977734 C 11.748437 15.012109 11.885156 14.994141 12 14.927734 C 12.115234 14.861719 12.199219 14.752344 12.233594 14.623828 C 12.267969 14.495703 12.25 14.358984 12.183594 14.244141 C 12.091797 14.086328 11.920703 13.991406 11.738281 13.996094 Z M 8 15 C 7.723828 15 7.5 15.223828 7.5 15.5 C 7.5 15.776172 7.723828 16 8 16 C 8.276172 16 8.5 15.776172 8.5 15.5 C 8.5 15.223828 8.276172 15 8 15 Z M 8 15" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'043',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 10 0 L 0 0 L 0 160 L 20 160 L 20 20 L 160 20 L 160 0 Z M 10 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 1 0 L 0 0 L 0 16 L 2 16 L 2 2 L 16 2 L 16 0 Z M 1 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'044',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 5 0 L 0 0 L 0 160 L 10 160 L 10 10 L 160 10 L 160 0 Z M 5 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0.5 0 L 0 0 L 0 16 L 1 16 L 1 1 L 16 1 L 16 0 Z M 0.5 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'045',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 140 L 160 140 L 160 160 L 0 160 Z M 0 0 L 160 0 L 160 20 L 0 20 Z M 0 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 14 L 16 14 L 16 16 L 0 16 Z M 0 0 L 16 0 L 16 2 L 0 2 Z M 0 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'046',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 160 0 L 160 10 L 0 10 Z M 0 150 L 160 150 L 160 160 L 0 160 Z M 0 150"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 16 0 L 16 1 L 0 1 Z M 0 15 L 16 15 L 16 16 L 0 16 Z M 0 15" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'047',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 20 0 L 20 160 L 0 160 Z M 0 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 2 0 L 2 16 L 0 16 Z M 0 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'048',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 10 0 L 10 160 L 0 160 Z M 0 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 1 0 L 1 16 L 0 16 Z M 0 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'049',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 59.101562 0 L 0 160 L 100.898438 160 L 160 0 Z M 59.101562 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 5.910156 0 L 0 16 L 10.089844 16 L 16 0 Z M 5.910156 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'050',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 110 0 L 0 0 L 0 160 L 110 160 L 160 80 Z M 110 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 11 0 L 0 0 L 0 16 L 11 16 L 16 8 Z M 11 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'051',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 80 0 L 30 0 L 80 80 L 30 160 L 80 160 L 130 80 Z M 80 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 8 0 L 3 0 L 8 8 L 3 16 L 8 16 L 13 8 Z M 8 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'052',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 110 0 L 90 0 L 140 80 L 90 160 L 110 160 L 160 80 Z M 110 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 11 0 L 9 0 L 14 8 L 9 16 L 11 16 L 16 8 Z M 11 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'053',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 110 0 L 90 0 L 140 80 L 90 160 L 110 160 L 160 80 Z M 50 0 L 0 80 L 50 160 L 70 160 L 20 80 L 70 0 Z M 50 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 11 0 L 9 0 L 14 8 L 9 16 L 11 16 L 16 8 Z M 5 0 L 0 8 L 5 16 L 7 16 L 2 8 L 7 0 Z M 5 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'054',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 90 70 L 90 10 L 70 10 L 70 70 L 10 70 L 10 90 L 70 90 L 70 150 L 90 150 L 90 90 L 150 90 L 150 70 Z M 90 70"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 9 7 L 9 1 L 7 1 L 7 7 L 1 7 L 1 9 L 7 9 L 7 15 L 9 15 L 9 9 L 15 9 L 15 7 Z M 9 7" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'055',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 136.570312 37.570312 L 122.429688 23.429688 L 80 65.859375 L 37.570312 23.429688 L 23.429688 37.570312 L 65.859375 80 L 23.429688 122.429688 L 37.570312 136.570312 L 80 94.140625 L 122.429688 136.570312 L 136.570312 122.429688 L 94.140625 80 Z M 136.570312 37.570312"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 13.657031 3.757031 L 12.242969 2.342969 L 8 6.585937 L 3.757031 2.342969 L 2.342969 3.757031 L 6.585937 8 L 2.342969 12.242969 L 3.757031 13.657031 L 8 9.414062 L 12.242969 13.657031 L 13.657031 12.242969 L 9.414062 8 Z M 13.657031 3.757031" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'056',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 23.429688 122.429688 L 122.429688 23.429688 L 136.570312 37.570312 L 37.570312 136.570312 Z M 23.429688 122.429688"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 2.342969 12.242969 L 12.242969 2.342969 L 13.657031 3.757031 L 3.757031 13.657031 Z M 2.342969 12.242969" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'057',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 10 70 L 150 70 L 150 90 L 10 90 Z M 10 70"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 1 7 L 15 7 L 15 9 L 1 9 Z M 1 7" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'058',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 20 10 L 10 10 L 10 150 L 150 150 L 150 10 Z M 130 130 L 30 130 L 30 110 L 130 110 Z M 130 90 L 30 90 L 30 70 L 130 70 Z M 130 50 L 30 50 L 30 30 L 130 30 Z M 130 50"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 2 1 L 1 1 L 1 15 L 15 15 L 15 1 Z M 13 13 L 3 13 L 3 11 L 13 11 Z M 13 9 L 3 9 L 3 7 L 13 7 Z M 13 5 L 3 5 L 3 3 L 13 3 Z M 13 5" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'059',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 0 160 L 160 0 Z M 0 0"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 0 16 L 16 0 Z M 0 0" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'060',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 160 L 80 80 L 0 0 Z M 80 80 L 160 160 L 160 0 Z M 80 80"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 16 L 8 8 L 0 0 Z M 8 8 L 16 16 L 16 0 Z M 8 8" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{"figure_id":'061',"parent":"","svg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 0 160 L 160 160 L 160 0 Z M 80 140 C 46.863281 140 20 113.136719 20 80 C 20 46.863281 46.863281 20 80 20 C 113.136719 20 140 46.863281 140 80 C 140 113.136719 113.136719 140 80 140 Z M 80 140"/></svg>',"form_bg":'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 0 0 L 0 16 L 16 16 L 16 0 Z M 8 14 C 4.686328 14 2 11.313672 2 8 C 2 4.686328 4.686328 2 8 2 C 11.313672 2 14 4.686328 14 8 C 14 11.313672 11.313672 14 8 14 Z M 8 14" transform="scale(10)" fill="#fff" stroke-width=".3" stroke="#e2e2e2"/></svg>',"rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},{figure_id:'001-001',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 90L80 20 0 90h40v70h80V90h40"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-002',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M45.2 88L0 130.6V160h160V55l-64.8 65-50-32"/><path d="M95.2 77.8L45.2 46 0 88.6v22L45.2 68l50 31.8L160 35V13L95.2 77.8"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-003',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M99.84277,20.00185h19.96855L59.90566,139.99815H39.93711L99.84277,20.00185h0Zm-39.93711,0H79.87422L19.96855,139.99815H0L59.90566,20.00185h0Zm-19.96855,0L0.77612,98.44474V58.446L19.96855,20.00185H39.93711Zm99.84277,0h19.96855L99.84277,139.99815H79.87422l59.90566-119.9963h0ZM160,99.4955l-20.22012,40.50265H119.81133l39.93905-80.00144Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-004',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M94.26946,0c0,0.00458-22.98865.00458-22.98865,0.00458C50.79546,34.14307,19.52989,69.72412,19.52989,98.49445c0,34.75342,28.00116,55.00555,62.75464,55.00555s63.09875-20.25214,63.09875-55.00555C145.38329,69.72278,115.73222,34.13983,94.26946,0ZM74.38231,136.22028c-16.41119-1.60889-27.15253-8.54614-32.87628-19.09979a36.85747,36.85747,0,0,1-3.97375-11.92828,35.483,35.483,0,0,1-.43268-7.13672c0.02509-.42816.02509-0.42816,0.039-0.58417a4.1786,4.1786,0,0,1,8.32135.77325l-0.01343.22565a28.41009,28.41009,0,0,0,3.40582,14.666c4.3822,8.08,12.658,13.42487,26.3454,14.76678A4.1786,4.1786,0,0,1,74.38231,136.22028Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-005',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M148.89518,11.20938S86.87559,2.16117,44.86607,48.6948s-34.182,103.2408-34.182,103.2408,66.0697,6.706,106.97786-39.69509C158.57012,65.84006,148.89518,11.20938,148.89518,11.20938ZM106.02666,101.983a94.641,94.641,0,0,1-32.4362,23.65434,126.95943,126.95943,0,0,1-36.81892,10.048c-3.93461.486-7.63064,0.76622-11.11081,0.92527A121.47126,121.47126,0,0,1,39.74111,83.11976,30.97087,30.97087,0,1,0,76.72224,42.08789c2.64642-1.64542,5.361-3.17848,8.16144-4.56765A113.45721,113.45721,0,0,1,134.41212,26.0118,113.47472,113.47472,0,0,1,106.02666,101.983Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-006',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M149.3572,7.29678S127.26827,21.56605,98.94407,24.83423c-24.42376,2.81813-52.17,11.04334-65.86355,24.73688C11.94706,70.70935,9.31492,102.52073,21.3438,123.78175,45.41558,88.26407,82.99059,65.76554,103.03059,59.503c-50.72626,31.31251-74.64276,69.23984-92.3878,95.20018l10.701-.60179a52.07919,52.07919,0,0,1,11.73672-18.43373c21.3535,15.1509,58.10707,10.60761,80.59266-11.886C145.61193,93.09549,149.3572,7.29678,149.3572,7.29678Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-007',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M150,10V150H10Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-008',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M125,80L90,0h70V160H90Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-009',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M27.09534,111.68762C34.234,103.62244,38.83667,99.48242,50.40588,92.804c2.26135-1.30676,5.66956-3.43689,7.80945-.62317,1.50146,1.97083.52368,4.15894-1.236,5.40771-7.912,5.63416-16.319,13.69934-20.84167,26.81763C33.67,131.56311,30.18982,144.66736,33.68347,160H50.01282a71.92188,71.92188,0,0,1,.01587-26.10413c2.14966-10.55664,4.06311-16.43982,10.74524-28.01208,1.30615-2.26135,3.194-5.80994,6.452-4.44641,2.287,0.95825,2.533,3.338,1.63574,5.30212-4.03442,8.83179-7.28271,20.0238-4.64111,33.6438A71.46964,71.46964,0,0,0,71.01563,160H90.68115a69.95282,69.95282,0,0,1-9.68872-18.34534c-3.41736-10.21484-4.70154-16.27075-4.70154-29.62524,0-2.60986-.14038-6.63147,3.3667-7.07825,2.45911-.31616,3.86169,1.62537,4.06616,3.775,0.92285,9.66553,3.70178,20.98267,12.80212,31.4624,4.92432,5.67017,14.422,15.12756,29.2395,19.8114H160v-9.38416c-22.77649-.22339-39.8822-10.26062-48.31177-17.71606-8.06824-7.13623-12.20459-11.74194-18.88367-23.3075-1.30615-2.262-3.43994-5.66956-.62622-7.81311,1.97388-1.50146,4.15894-.52368,5.41077,1.236,5.63171,7.912,13.7,16.319,26.81824,20.84167,7.1582,2.46765,20.26245,5.94727,35.59265,2.45667V109.98474a71.92825,71.92825,0,0,1-26.10291-.01587c-10.55664-2.14661-16.44043-4.06311-28.00964-10.74158-2.26135-1.3031-5.813-3.19092-4.44946-6.45569,0.95825-2.287,3.34106-2.533,5.30273-1.63513,8.83484,4.03748,20.0238,7.28271,33.64685,4.64111A71.52651,71.52651,0,0,0,160,88.985V69.32129a69.89853,69.89853,0,0,1-18.338,9.68384c-10.21484,3.418-16.27136,4.70154-29.62891,4.70154-2.60986,0-6.63086.144-7.07825-3.36609-0.31311-2.45972,1.626-3.86169,3.77563-4.06616,9.66553-.92041,20.98206-3.70239,31.45874-12.80212C145.85876,58.54553,155.31616,49.04785,160,34.2334V0h-9.38049c-0.22461,22.77527-10.26062,39.881-17.71606,48.30994-7.13562,8.06824-11.73828,12.20459-23.3075,18.88672-2.26135,1.3031-5.66956,3.43689-7.8125.62256-1.50146-1.97388-.52063-4.162,1.239-5.41077,7.912-5.6311,16.319-13.69629,20.84167-26.81763,2.46765-7.1582,5.94666-20.26,2.45544-35.59082h-16.3324a71.95792,71.95792,0,0,1-.0177,26.10413c-2.146,10.55664-4.05945,16.44043-10.73853,28.0127-1.30615,2.2583-3.194,5.80994-6.45508,4.4458-2.287-.95825-2.52991-3.34106-1.63208-5.30518,4.03381-8.83179,7.2821-20.02075,4.64111-33.6438A71.55514,71.55514,0,0,0,88.98865,0H69.32739a69.89626,69.89626,0,0,1,9.682,18.33618c3.41736,10.21484,4.70154,16.27075,4.70154,29.62524,0,2.60986.14038,6.63086-3.3667,7.07825-2.45972.31616-3.86169-1.626-4.06616-3.77563C75.35522,41.59912,72.57629,30.282,63.476,19.80225,58.55469,14.13574,49.06677,4.6875,34.267,0H0V9.37805c22.7771,0.22339,39.884,10.26,48.3136,17.71606,8.06824,7.13623,12.20459,11.74194,18.88367,23.3075,1.30615,2.262,3.43994,5.66956.62317,7.81311-1.97083,1.50146-4.15894.52368-5.40771-1.236-5.63171-7.912-13.7-16.319-26.81824-20.84167C28.43567,33.66943,15.33081,30.18982,0,33.68225V50.00854a71.95154,71.95154,0,0,1,26.10474.01648c10.55664,2.14661,16.44043,4.06311,28.00964,10.74158,2.26135,1.3031,5.813,3.19092,4.4458,6.45569-0.95459,2.287-3.3374,2.533-5.30212,1.63513-8.83179-4.03442-20.0238-7.28271-33.6438-4.64111A71.51063,71.51063,0,0,0,0,71.01013V90.67688a69.90507,69.90507,0,0,1,18.33984-9.68506c10.21484-3.41736,16.27136-4.70154,29.62891-4.70154,2.60925,0,6.63086-.144,7.07825,3.3667,0.31311,2.45911-1.626,3.86169-3.77563,4.06616-9.66553.9198-20.98206,3.70178-31.45874,12.80151C14.14185,101.452,4.68323,110.95215,0,125.76965V160H9.37866C9.60205,137.22351,19.63928,120.11719,27.09534,111.68762Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-010',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0.01221,90v16.665c0.52209-.067,86.28394-11.11719,128.65448-49.99841C85.66669,109.5.01221,123.33331,0.01221,123.33331V160h45.625S159.989,116.47705,159.989,0C125.64941,80,.01221,90,0.01221,90Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-011',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M4.582,97.1709C16.85474,86.5882,29.26514,80.26855,41.92017,80.26855c7.64587,0,14.9939,2.44849,23.54266,7.22754,3.92572,2.19464,4.018,2.25354,14.687,9.20892,16.35632,10.663,25.78546,14.81354,37.70782,14.81354,13.6488,0,26.15271-4.8797,37.62238-13.19818,1.357-.98419,3.685-2.84253,4.52-3.51251V80s-16.66669,20-43.33331,20S70,70,43.33331,70,0,88.75,0,88.75V160H160V107.364c-12.69348,8.88336-26.69739,14.1546-42.14233,14.1546-14.4314,0-25.28528-4.77765-43.169-16.43646-10.377-6.765-10.47778-6.82935-14.10547-8.85736-7.18915-4.019-13.00275-5.95618-18.663-5.95618-9.74976,0-20.17981,5.31122-30.80774,14.47559-2.725,2.34979-10.97333,9.27441-10.97333,9.27441V101.25641S3.23785,98.33,4.582,97.1709Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-012',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M120,0V0.00006A39.99992,39.99992,0,0,0,159.99994,40H160V0H120Z M31.02734,6.24561Q31.02734,3.104,31.185,0H0.16473C0.08148,2.07269.02734,4.15283,0.02734,6.24561c0,84.76514,68.96191,153.72705,153.72754,153.72705,2.09265,0,4.17255-.05414,6.24512-0.13739V128.815q-3.10327.15628-6.24512,0.15765A122.86653,122.86653,0,0,1,31.02734,6.24561Z M90.5,0h-31A100.61366,100.61366,0,0,0,160,100.5v-31A69.57892,69.57892,0,0,1,90.5,0Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-013',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M124.16406,116c-7.71484,0-11.76465-4.40039-14.72266-7.61426C106.71582,105.42383,105.26465,104,102.07813,104c-3.18555,0-4.63672,1.42383-7.36133,4.38574C91.75977,111.59863,87.71,116,79.99561,116s-11.76367-4.40137-14.7207-7.61426C62.5498,105.42383,61.09863,104,57.91357,104s-4.63623,1.42383-7.36133,4.38574C47.59521,111.59863,43.5459,116,35.83154,116s-11.76318-4.40137-14.72021-7.61426C18.38623,105.42383,16.93506,104,13.75,104a5,5,0,0,1,0-10c7.71436,0,11.76367,4.40137,14.7207,7.61426C31.19531,104.57617,32.64648,106,35.83154,106s4.63623-1.42383,7.36133-4.38574C46.1499,98.40137,50.19922,94,57.91357,94s11.76367,4.40137,14.7207,7.61426C75.35938,104.57617,76.81055,106,79.99561,106s4.63721-1.42383,7.36182-4.38574C90.31445,98.40137,94.36328,94,102.07813,94s11.76465,4.40039,14.72266,7.61426C119.52637,104.57617,120.97754,106,124.16406,106s4.6377-1.42383,7.36328-4.38574C134.48535,98.40039,138.53516,94,146.25,94a5,5,0,0,1,0,10c-3.18652,0-4.6377,1.42383-7.36328,4.38574C135.92871,111.59961,131.87891,116,124.16406,116Z"/>  <path d="M124.16406,81c-7.71484,0-11.76465-4.40088-14.72266-7.61426C106.71582,70.42383,105.26465,69,102.07813,69c-3.18555,0-4.63672,1.42383-7.36133,4.38525C91.75977,76.59912,87.71,81,79.99561,81s-11.76367-4.40088-14.7207-7.61475C62.5498,70.42383,61.09863,69,57.91357,69s-4.63623,1.42383-7.36133,4.38525C47.59521,76.59912,43.5459,81,35.83154,81s-11.76318-4.40088-14.72021-7.61426C18.38623,70.42383,16.93506,69,13.75,69a5,5,0,0,1,0-10c7.71436,0,11.76367,4.40088,14.7207,7.61475C31.19531,69.57617,32.64648,71,35.83154,71s4.63623-1.42383,7.36133-4.38525C46.1499,63.40088,50.19922,59,57.91357,59s11.76367,4.40088,14.7207,7.61475C75.35938,69.57617,76.81055,71,79.99561,71s4.63721-1.42383,7.36182-4.38574C90.31445,63.40088,94.36328,59,102.07813,59s11.76465,4.40088,14.72266,7.61426C119.52637,69.57617,120.97754,71,124.16406,71s4.6377-1.42383,7.36328-4.38574C134.48535,63.40088,138.53516,59,146.25,59a5,5,0,0,1,0,10c-3.18652,0-4.6377,1.42383-7.36328,4.38574C135.92871,76.59912,131.87891,81,124.16406,81Z"/>  <path d="M124.16406,151c-7.71484,0-11.76465-4.40039-14.72266-7.61426C106.71582,140.42383,105.26465,139,102.07813,139c-3.18555,0-4.63672,1.42383-7.36133,4.38574C91.75977,146.59863,87.71,151,79.99512,151c-7.71436,0-11.76367-4.40137-14.72021-7.61426C62.5498,140.42383,61.09863,139,57.91357,139s-4.63623,1.42383-7.36133,4.38574C47.59521,146.59863,43.5459,151,35.83154,151s-11.76367-4.40137-14.7207-7.61426C18.38623,140.42383,16.93506,139,13.75,139a5,5,0,0,1,0-10c7.71436,0,11.76318,4.40137,14.72021,7.61426C31.19531,139.57617,32.64648,141,35.83154,141s4.63623-1.42383,7.36133-4.38574C46.1499,133.40137,50.19922,129,57.91357,129s11.76367,4.40137,14.7207,7.61426C75.35889,139.57617,76.81006,141,79.99512,141c3.18555,0,4.6377-1.42383,7.3623-4.38574C90.31445,133.40137,94.36426,129,102.07813,129c7.71484,0,11.76465,4.40039,14.72266,7.61426C119.52637,139.57617,120.97754,141,124.16406,141s4.6377-1.42383,7.36328-4.38574C134.48535,133.40039,138.53516,129,146.25,129a5,5,0,0,1,0,10c-3.18652,0-4.6377,1.42383-7.36328,4.38574C135.92871,146.59961,131.87891,151,124.16406,151Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-014',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M145,95H124.71552a44.99347,44.99347,0,0,0-89.431,0H15a5,5,0,0,0,0,10H145A5,5,0,0,0,145,95ZM45.356,95a35.00321,35.00321,0,0,1,69.2876,0H45.356Z M79,45.345a5,5,0,0,0,5-5v-20a5,5,0,1,0-10,0v20A5,5,0,0,0,79,45.345Z M39.09442,55.95166a5,5,0,1,0,7.071-7.071L32.02332,34.73846a5,5,0,0,0-7.071,7.071Z M118.35669,55.95166l14.14215-14.14215a5.00006,5.00006,0,0,0,0-7.071h-0.00006a4.99994,4.99994,0,0,0-7.071,0L111.28558,48.88062A5,5,0,1,0,118.35669,55.95166Z M122,115H38a5,5,0,0,0,0,10h84A5,5,0,0,0,122,115Z M102.09106,135H56.16351a5.1131,5.1131,0,0,0-5.14435,4.55243A4.96522,4.96522,0,0,0,55.90894,145h45.92755a5.1131,5.1131,0,0,0,5.14435-4.55243A4.96522,4.96522,0,0,0,102.09106,135Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-015',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0 0v80h80L0 0zm0 160h80L0 80v80zm80 0h80L80 80v80zM80 0v80h80L80 0z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-016',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M137.087 22.92a9.995 9.995 0 0 0-14.169.049L94.725 51.16 24.12 37.04l-7.06 7.06 49.422 35.3-21.18 21.18H17.06L10 107.64l28.242 14.12L52.362 150l7.06-7.06V114.7l21.183-21.18 35.301 49.42 7.06-7.06-14.12-70.6 28.193-28.191a10.013 10.013 0 0 0 .048-14.169z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'001-017',parent:'001',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M141.238 79.36l-26.886 16.164 12.997 5.516a51.913 51.913 0 0 1-34.495 29.145l-7.207-81.007a20.022 20.022 0 1 0-10.682.157l-6.974 81.06a51.904 51.904 0 0 1-35.538-29.807l13.461-5.712-26.886-16.164-13.114 33.14 13.92-5.908C29.963 131.192 51.035 150 80 150c28.795 0 49.75-18.59 59.943-43.615l14.409 6.115zM70 30a10 10 0 1 1 10 10 10 10 0 0 1-10-10z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-001',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M119.4201 90h39.35565c.02112-.16925.04437-.33777.06445-.50739L79.4201 20 0 89.4926c.0201.16963.04333.33815.06445.5074H39.4201v59.27081a79.92753 79.92753 0 0 0 80 0V90z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-002',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M 149.4708,41.16106 98.1347,92.952 51.4668,63.15076 46.34943,59.88306 41.92756,64.04419 2.3707948,101.06407 c 1.6256094,5.65683 3.3931001,10.90372 6.3485239,16.11328 L 48.22,79.57959 l 46.83411,29.90723 5.28613,3.37561 4.4295,-4.441 51.40057,-51.524 C 154.4678,51.40557 152.54998,45.842881 149.4708,41.16106 Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-003',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M107.30862 4.92361L50.22928 119.08286h19.84717l53.123-106.246a79.03374 79.03374 0 0 0-15.89083-7.91325zM80 0a79.71073 79.71073 0 0 0-10.29489.74252L10.8887 118.37479c.13629.24048.29132.46881.43.708h19.06341L89.605.63718A79.89409 79.89409 0 0 0 80 0zm57.23441 24.4606l-47.3108 94.62226h19.84711l39.34058-78.68055a79.59787 79.59787 0 0 0-11.87689-15.94171z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-004',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#231f20" d="M80.76416 133.74023c28.32871 0 48.31411-21.05016 47.26179-50.30926-1.06878-29.71661-31.81253-41.08626-47.26179-79.69074 0 .00389.38177 22.93694-13.125 37.88818-13.2674 14.68628-25.41926 17.09938-30.57373 38.19581-5.98976 25.32078 15.37001 53.91601 43.69873 53.91601z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-005',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M80.262 32.784C43.56561 34.659 16.84027 51.61359 1.48334 64.67206a79.7223 79.7223 0 0 0-.10577 30.06348c16.9671 14.33606 47.2135 33.62823 85.2066 31.2381a124.59816 124.59816 0 0 0 71.43073-28.29187 79.85375 79.85375 0 0 0-.90326-38.97717C140.567 45.60571 114.24915 31.04742 80.262 32.784zm22.23291 16.39386a93.54589 93.54589 0 0 1 12.75709 3.32061 109.85668 109.85668 0 0 1 41.76813 25.97272 109.2516 109.2516 0 0 1-52.07892 29.59216 109.03926 109.03926 0 0 1-19.2984 2.94647 91.48771 91.48771 0 0 1-38.33807-6.0022 122.74013 122.74013 0 0 1-32.03357-18.298c-3.03088-2.365-5.78595-4.71436-8.27954-6.99109a117.621 117.621 0 0 1 50.24262-28.15664 29.98691 29.98691 0 1 0 45.26062-2.38403z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-006',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M87.0708 80l41.46436-41.46436a4.99981 4.99981 0 1 0-7.07031-7.07129L80 72.9292 38.53564 31.46436a5.00016 5.00016 0 0 0-7.07129 7.07129L72.9292 80l-41.46484 41.46484a4.99981 4.99981 0 1 0 7.07129 7.07031L80 87.0708l41.46484 41.46436a4.99947 4.99947 0 1 0 7.07031-7.07031z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-007',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M80 0a80 80 0 0 1 0 160V0z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-008',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M0 80a80.01365 80.01365 0 0 0 62.57623 78.0744c4.58392-24.82275 21.70343-98.88428 67.90436-136.38593C76.1449 22.25012 26.57953 53.16064.3252 72.97528.12347 75.29187 0 77.631 0 80z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-009',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M122.95188 28.83868c-6.28533-5.02826-12.82206-9.30228-20.36445-11.81641-14.582-4.77685-25.1413-5.53109-39.72325-1.00565-4.77685 1.25707-11.81641 4.77685-16.09044 7.291C27.66636 35.62683 20.87821 53.98 21.381 75.85291c.50283 19.86163 10.55934 35.70065 28.15825 42.99162 20.86728 8.79946 52.2939 0 64.86455-19.10738 10.81077-16.34185 9.05086-41.73455-11.06218-51.79108-19.35876-9.80507-46.76277-1.75989-53.80235 16.09044-4.52543 10.81076 1.25707 27.1526 14.33054 30.16956 8.79946 2.0113 19.86163-1.50847 25.1413-7.7938 4.0226-5.02826 3.51979-13.82772-2.0113-17.09608a5.843 5.843 0 0 0-5.02826-.25141 5.50311 5.50311 0 0 0-2.51413 2.26272c-1.25707 2.0113-1.50847 4.0226-2.51413 6.28533-2.51413 4.77685-10.81076 5.27967-13.57631 0-2.76554-5.7825-1.00566-10.81076 2.76554-14.33054 3.51979-3.017 7.54239-4.77685 11.81641-6.53673 8.29664-3.5198 24.63848 1.50844 28.66107 11.06216s-1.257 21.1187-8.0452 28.40967A35.07435 35.07435 0 0 1 70.658 107.531c-14.582-.50283-21.62151-2.76554-29.41532-14.582-4.52543-6.53673-5.53109-17.3475-5.02826-25.1413.50283-11.565 6.03392-18.856 11.81641-25.89554 10.55935-11.81641 31.17522-14.33054 46.26-11.565 12.57065 2.26272 22.37576 9.05087 29.41531 19.10739 17.85032 25.39272 11.8164 52.54531-10.30793 71.90413-8.04522 7.03957-24.63847 13.57631-39.22042 13.57631-5.27967 0-15.58761-2.26272-18.60457 1.25706C50.04208 143.23164 64.37263 146.5 71.41219 146.5c43.74586 0 69.13859-30.67238 73.4126-53.80239 5.2797-23.88427-2.51409-48.52274-21.87291-63.85893z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-010',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M71.11523 82.94336C85.042 91.998 100.82617 102.26074 120.998 102.26074c14.09692 0 28.68365-7.169 38.4787-13.2135A80.767 80.767 0 0 0 160 80c0-1.08228-.03894-2.15509-.08154-3.22693-7.95361 5.54852-24.24774 15.48767-38.92041 15.48767-17.20605 0-31.04688-8.999-44.43213-17.70068C64.35742 66.62256 52.82568 59.125 39.66895 59.125 26.544 59.125 10.7168 70.063.02667 78.94452.02209 79.29742 0 79.646 0 80a80.6064 80.6064 0 0 0 .83551 11.50439C10.91016 82.41608 28.142 69.125 39.66895 69.125c10.19189 0 20.0415 6.40381 31.44628 13.81836z M71.01709 111.20117c13.92676 9.05469 29.71094 19.31738 49.88281 19.31738 8.0144 0 16.902-2.34064 25.21472-5.47668a79.80539 79.80539 0 0 0 7.74756-14.28009c-10.04456 4.86029-22.71149 9.75677-32.96228 9.75677-17.20605 0-31.04687-8.999-44.43213-17.70068-12.2085-7.9375-23.74023-15.43506-36.897-15.43506-12.09662 0-25.42157 10.02448-35.08014 19.049a79.49485 79.49485 0 0 0 4.32269 10.05646c9.13953-8.9541 21.19012-19.10547 30.75745-19.10547 10.19193.00001 20.04153 6.40382 31.44632 13.81837z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-011',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M118.6947 9.9787a79.56635 79.56635 0 0 0-11.08758-5.0847L39.06287 44.43048V11.26807a80.213 80.213 0 0 0-9.94187 6.9934l.01077 80.47053L.08307 83.28656A80.17545 80.17545 0 0 0 1.51953 95.5304L71.002 133.999l-28.6983 16.569a79.54232 79.54232 0 0 0 11.28546 4.94849l69.07831-40.033v32.17535a80.26472 80.26472 0 0 0 9.93036-7.40839l-.13012-78.91545 27.42914 14.58435a80.05073 80.05073 0 0 0-1.58221-12.30243l-67.5351-37.5214z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-012',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M101.00079 90.43823h31.26062L91.2511 50.05609h28.95581L80.31116 10.51471v149.47742a80.60349 80.60349 0 0 0 10.93994-.79541V130.857h58.56415z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-013',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M80 160a80.0599 80.0599 0 0 0 76.03349-104.94737C156.0335 54.63018 80 100.61279 80 100.61279L4.10634 54.63018A80.059 80.059 0 0 0 80 160z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-014',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M86.5332.28784L39.92371 83.92065l28.87183 5.42816L57.913 156.88684a79.72536 79.72536 0 0 0 16.422 2.89136h1.808l43.93335-84.86957L88.905 69.81262l16.09128-65.80768A79.61783 79.61783 0 0 0 86.5332.28784z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-015',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M58.65234 95.95477l6.79456-6.79449a17.8842 17.8842 0 0 0 1.63953-22.68781L52.96271 47.60388l-6.18921 8.893c-4.71942 6.78125-4.55737 17.72235.438 24.32837zm-12.77911-8.2691L31.74945 68.81708l-6.18915 8.893c-4.71948 6.78125-4.55737 17.72235.438 24.32837L37.43915 117.168l6.79449-6.79449a17.88413 17.88413 0 0 0 1.63959-22.68784zm25.13135 7.03577l-6.79449 6.79449 15.12952 11.4408c6.606 4.99542 17.54706 5.15753 24.32831.438l8.893-6.18915-18.8686-14.12373a17.884 17.884 0 0 0-22.68774 1.63959zm18.59698-24.61738a4.99994 4.99994 0 0 0 7.071 0l21.2132-21.2132a5 5 0 1 0-7.071-7.071L89.60156 63.033a4.99994 4.99994 0 0 0 0 7.07106zM132.028 55.96191a5.00006 5.00006 0 0 0-7.071 0l-14.14224 14.14215a5 5 0 1 0 7.071 7.07111L132.028 63.033a4.99994 4.99994 0 0 0 0-7.071v-.00009zm-42.42644-7.07104l14.14215-14.14215a5.00006 5.00006 0 0 0 0-7.071h-.00006a4.99994 4.99994 0 0 0-7.071 0l-14.14219 14.1421a5 5 0 1 0 7.0711 7.07105zm-39.81018 67.04376l-6.79456 6.79449 15.12958 11.4408c6.606 4.99542 17.54706 5.15753 24.32831.438l8.893-6.18915L72.47913 114.295a17.884 17.884 0 0 0-22.68775 1.63963zM24.66 108.89886L10.53625 90.03027l-6.18914 8.89307a17.23724 17.23724 0 0 0-1.42462 2.49225 79.84931 79.84931 0 0 0 17.87683 32.39221l2.22113-2.22113A17.88413 17.88413 0 0 0 24.66 108.89886zM70.13452 149.632l-18.86859-14.1237a17.88406 17.88406 0 0 0-22.68781 1.63953l-2.20831 2.20831a79.83475 79.83475 0 0 0 32.53271 17.81171 17.1771 17.1771 0 0 0 2.339-1.34668z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-016',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M67.6254 122.507a17.47 17.47 0 0 0 24.2893 0l36.05068-35.86672A31.66623 31.66623 0 1 0 83.18869 41.8513l-3.20709 3.158-3.1703-3.158a31.66406 31.66406 0 0 0-44.77667 44.7828z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-017',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">  <path d="M80.445 35.06183v.00006a5 5 0 0 0 5 5h63.8614a80.14326 80.14326 0 0 0-6.82849-10H85.445a5 5 0 0 0-5 4.99994zm0 79.89007a5 5 0 0 0 5 5h63.85345a79.63123 79.63123 0 0 0 4.88306-10H85.445a5 5 0 0 0-5 5zM66.7392 55.03436a5 5 0 0 0 5 5h85.74854a79.31707 79.31707 0 0 0-3.31165-10H71.7392a5 5 0 0 0-5 5zm0 39.94501a5 5 0 0 0 5 5h85.74536a79.72262 79.72262 0 0 0 1.87372-10H71.7392a5 5 0 0 0-5 5zM160 80.007V80v.007M49.93127 75.0069a5 5 0 0 0 5 5h105.06855L160 80a80.64959 80.64959 0 0 0-.64349-9.9931H54.93127a5 5 0 0 0-5 5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-018',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="123.91968" height="141.60785" viewBox="0 0 123.91968 141.60785">  <path d="M117.92248 35.33575l-20.64709-1.62829L82.11047 2.50855c-1.9624-.9093-3.95892-1.75757-6.00354-2.50854L60.81061 30.99377 0 36.74701 38.79394 70.8266 13.6206 141.60785l64.89667-46.311 37.50812 12.55123-8.85809-43.17419 16.75238-16.32959a79.5557 79.5557 0 0 0-5.9972-13.00855z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-019',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 17.776a62.224 62.224 0 1 0 62.222 62.222A62.292 62.292 0 0 0 80 17.776zm-17.778 88.89a8.889 8.889 0 1 1 8.89-8.89 8.889 8.889 0 0 1-8.89 8.89zm0-35.556a8.889 8.889 0 1 1 8.89-8.889 8.889 8.889 0 0 1-8.89 8.89zm35.556 35.556a8.889 8.889 0 1 1 8.889-8.89 8.889 8.889 0 0 1-8.89 8.89zm0-35.556a8.889 8.889 0 1 1 8.889-8.889 8.889 8.889 0 0 1-8.89 8.89z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-020',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M70,80a10,10 0 1,0 20,0a10,10 0 1,0 -20,0 M80 50v10a20 20 0 0 1 20 20h10a30 30 0 0 0-30-30zM60 80H50a30 30 0 0 0 30 30v-10a20 20 0 0 1-20-20zm20-70v10a60 60 0 0 1 60 60h10a70 70 0 0 0-70-70zM20 80H10a70 70 0 0 0 70 70v-10a60 60 0 0 1-60-60z M80 30v10a40 40 0 0 1 40 40h10a50 50 0 0 0-50-50zM40 80H30a50 50 0 0 0 50 50v-10a40 40 0 0 1-40-40z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-021',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M139.17 70A60.051 60.051 0 0 0 90 20.83V70h49.17zM90 90v49.17A60.051 60.051 0 0 0 139.17 90H90zm-69.17 0A60.051 60.051 0 0 0 70 139.17V90H20.83zm0-20H70V20.83A60.051 60.051 0 0 0 20.83 70z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-022',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 130l40-70H40l40 70z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-023',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M105.502 54.502L24.73 22.194q-1.297 1.24-2.537 2.537l32.31 80.773 80.765 32.306q1.299-1.243 2.54-2.541zM63.01 97.01l34-34 21.14 55.005z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-024',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M100 60V30H60v30H30v40h30v30h40v-30h30V60h-30zM40 90V70h20v20H40zm50 30H70V40h20v80zm30-30h-20V70h20v20z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-025',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 0A80 80 0 0 0 0 80v80h80A80 80 0 1 0 80 0zm0 150a70 70 0 1 1 70-70 70 70 0 0 1-70 70z M70,80a10,10 0 1,0 20,0a10,10 0 1,0 -20,0 M40,80a10,10 0 1,0 20,0a10,10 0 1,0 -20,0 M100,80a10,10 0 1,0 20,0a10,10 0 1,0 -20,0"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-026',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M79.299 120.135l-21.35 36.766 1.377-42.493-36.873 21.165 22.439-36.112-42.516-.107 37.489-20.055-36.766-21.35 42.493 1.377-21.165-36.873 36.112 22.439.107-42.516 20.055 37.489 21.35-36.766-1.377 42.493 36.873-21.165-22.439 36.112 42.516.107-37.489 20.055 36.766 21.35-42.493-1.377 21.165 36.873-36.112-22.439-.107 42.516-20.055-37.489z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-027',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M75 145.813v-44.877a3.629 3.629 0 0 0-6.195-2.566l-31.743 31.744a3.62 3.62 0 0 0 .32 5.421 69.652 69.652 0 0 0 33.484 13.874A3.642 3.642 0 0 0 75 145.813zM10.101 83.797a69.658 69.658 0 0 0 14.467 38.955 3.614 3.614 0 0 0 5.406.307l36.864-36.864A3.629 3.629 0 0 0 64.272 80h-50.54a3.626 3.626 0 0 0-3.63 3.797zm79.033 65.613a69.655 69.655 0 0 0 33.607-13.97 3.621 3.621 0 0 0 .315-5.417L91.195 98.162A3.629 3.629 0 0 0 85 100.728v45.085a3.642 3.642 0 0 0 4.134 3.596zm4.236-63.215l36.746 36.745a3.643 3.643 0 0 0 5.475-.394 69.655 69.655 0 0 0 14.308-38.75A3.626 3.626 0 0 0 146.268 80H95.936a3.629 3.629 0 0 0-2.566 6.195z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-028',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#231f20" d="M132.718 99.94a54.93 54.93 0 0 1-45.996 36.29l.03-11.272a44.293 44.293 0 0 0 35.637-27.506l-8.337-4.822a34.778 34.778 0 0 1-27.273 22.731l.082-29.93 57.666-33.011-.027-.056.019-.01a69.77 69.77 0 0 0-10.859-16.829l-.02.011a69.965 69.965 0 0 0-67.113-22.492l.066 15.4a55.013 55.013 0 0 1 53.715 14.741l-9.04 5.187a44.31 44.31 0 0 0-39.145-10.788l.042 9.756a34.73 34.73 0 0 1 26.559 3.514 35.15 35.15 0 0 1 3.784 2.543l-25.24 14.48-51.254-29.779a69.956 69.956 0 0 0-1.643 84.75l12.954-7.725a55.08 55.08 0 0 1-8.223-52.1l9.547 5.547a44.435 44.435 0 0 0 6.77 38.57l8.206-4.892a34.936 34.936 0 0 1-6.44-28.718l19.677 11.432-.203 65.122.025.005v.021a69.757 69.757 0 0 0 19.996 1.204v-.03a69.931 69.931 0 0 0 59.199-43.73z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'002-029',parent:'002',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M51.806 62.808l28.187 25.187 60.245-61.169s2.49 3.186 5.688 7.616A46.907 46.907 0 0 1 150.51 42l-70.517 70.37L40 76.346z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-001',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M20 102.5h30V145l30 15 30-15v-42.5h30L80 50l-60 52.5"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-002',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0 40v20l80 40 80-40V40L80 80 0 40 M0 80v20l80 40 80-40V80l-80 40L0 80"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-003',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M91.72086,39.84253h13.301L65.11894,121.22292H51.818L91.72086,39.84253h0Z M65.11894,39.84253h13.301L38.517,121.22292h-13.301L65.11894,39.84253h0Z M118.32278,39.84253h13.301L91.72086,121.22292H78.4199l39.90288-81.38039h0Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-004',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80,120c16.56855,0,30-14.6525,30-32.72727S80,30,80,30,50,69.198,50,87.27273,63.43146,120,80,120Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-005',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 30L40 50v10l40-20 40 20V50L80 30m-40 70v10l40 20 40-20v-10l-40 20-40-20 M60,79.54895a19.7229,19.54895 0 1,0 39.4458,0a19.7229,19.54895 0 1,0 -39.4458,0"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-006',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M85,84.43593V135a5,5,0,0,1-5,5h0a5,5,0,0,1-5-5V84.20392L20,56.18a5,5,0,0,1-2.18508-6.725h0A5,5,0,0,1,24.5399,47.27L80.22768,75.64429l55.68778-28.37434a5,5,0,0,1,6.725,2.18508h0a5,5,0,0,1-2.18508,6.725L85,84.43593h0Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-007',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 0v160L0 120V40L80 0"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-008',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80,160L0,120c34.82931,0,80-50,80-88.728C81.39648,70,125.17069,120,160,120Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-009',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80,10L10,45v70l70,35,70-35V45Zm60,100L80,140,20,110V50L80,20l60,30v60Z M30,55v50l50,25,50-25V55L80,30Zm90,45L80,120,40,100V60L80,40l40,20v40Z M50,65V95l30,15,30-15V65L80,50Zm50,25L80,100,60,90V70L80,60l20,10V90Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-010',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M77.23,104.38086C37.08,70.0011-.00085,109.99664-0.00085,109.99664v9.9989l80.00879,39.99561,79.99121-39.99561V103.38239S117.37994,138.76056,77.23,104.38086Z M100.00574,65.00165a14.99835,14.99835 0 1,0 29.9967,0a14.99835,14.99835 0 1,0 -29.9967,0"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-011',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M90 125l40-20V55L90 35V5L80 0 70 5v30L30 55v50l40 20v30l10 5 10-5v-30"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-012',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M120 90L90 60h20L80 30 50 60h20L40 90h20l-30 30h40v35l10 5 10-5v-35h40l-30-30h20"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-013',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 0l80 40-80 40L0 40 80 0"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-014',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M103.68 11.84L32.44 91.914h40.793l-15.271 57.067 3.13 1.565 73.363-82.46H93.662l14.457-54.027-4.439-2.219"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-015',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M40 100v20l30 15v20l10 5 10-5v-20l30-15v-20l-40 20-40-20 M70,30a10,10 0 1,0 20,0a10,10 0 1,0 -20,0 M80 60L40 40v20l40 20 40-20V40L80 60 M40 70v20l40 20 40-20V70L80 90 40 70"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-016',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M37.14286,86.00955A27.10748,27.10748,0,0,1,30,67.69231C30,52.39827,42.79186,40,58.57143,40A28.89812,28.89812,0,0,1,80,49.37506,28.89811,28.89811,0,0,1,101.42858,40C117.20814,40,130,52.39827,130,67.69231a27.10746,27.10746,0,0,1-7.14286,18.31724v0.02951L80,130,37.14286,86.03906V86.00955Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-017',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M60.18188,40.48584h10v80h-10v-80Zm30,0h10v80h-10v-80Zm30,0h10v80h-10v-80Zm-90,0h10v80h-10v-80Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'003-018',parent:'003',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80.482 104.626L51.239 120l5.585-32.562-23.658-23.061 32.694-4.751L80.482 30l14.621 29.626 32.695 4.751-23.658 23.061L109.725 120l-29.243-15.374"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'004-001',parent:'004',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 66l-60 40h25v54h70v-54h25L80 66"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'004-002',parent:'004',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0 130h160v20H0zM0 100h160v20H0z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'004-003',parent:'004',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M150 40L50 160h20l90-108V40h-10m-42.353 120L160 97.176v-24L87.647 160h20m37.647 0L160 142.353v-24L125.294 160h20"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'004-004',parent:'004',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M120,74v6.06934a40.00006,40.00006,0,0,1-80,0V74H20v6.06934a60,60,0,0,0,120,0V74H120Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'004-005',parent:'004',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M150,47.33333V150H10Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'004-006',parent:'004',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80,147l80-30v43H0V117Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'004-007',parent:'004',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M110.03 150h50v10h-50zM90.03 130h70v10h-70zM70 110h90v10H70zM50 90h110v10H50z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-001',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M45.71429,10C20.467,10,0,29.28619,0,53.0769A41.52986,41.52986,0,0,0,11.42859,81.57037v0.0459L80,150V24.58344A46.84652,46.84652,0,0,0,45.71429,10Z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-002',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M117.727 10.175L29.57 99.742l12.92 12.883 95.065-96.587a47.42 47.42 0 0 0-19.828-5.863zM66.956 14.96L6.946 75.93a43.52 43.52 0 0 0 4.49 5.682v.045l5.887 5.87L79.62 24.232a45.627 45.627 0 0 0-12.664-9.27zM150.82 27.218L54.738 124.84l13.698 13.66 90.957-92.413a41.63 41.63 0 0 0-8.57-18.87zM45.722 10.04C20.475 10.04.008 29.328.008 53.12a40.995 40.995 0 0 0 .304 4.895l47.172-47.926c-.586-.02-1.17-.046-1.762-.046z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-003',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M63.124 39.67l24.964 21.874L69.06 87.48l20.626 26.25L80 150l68.57-68.384A41.726 41.726 0 0 0 160 53.076C160 29.286 139.533 10 114.286 10A46.846 46.846 0 0 0 80 24.583z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-004',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M121.237 48.725h-32.1l9.855-36.827a46.834 46.834 0 0 0-18.03 11.785c-.18-.188-.367-.364-.55-.55l-39.45 44.342h32.1L59.516 118.1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-005',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 70a10 10 0 1 0-10-10 10 10 0 0 0 10 10zM63.244 59.97a12.707 12.707 0 0 1 2.23-6.84L26.447 33.28a58.193 58.193 0 0 0-6.7 27.056c-.092 16.698 7.637 26.382 7.637 26.382l38.092-20.146a12.296 12.296 0 0 1-2.23-6.603zm33.055.468a12.707 12.707 0 0 0-2.23-6.84l39.298-19.782a58.193 58.193 0 0 1 6.7 27.055c.092 16.699-7.638 26.382-7.638 26.382l-38.36-20.21a12.296 12.296 0 0 0 2.23-6.605z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-006',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M126.059 59.49a50.021 50.021 0 0 1-92.118 0l8.126-4.01C47.07 71.866 61.977 80 80 80s33.592-8.134 38.594-24.52z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-007',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M17.35 87.522l-5.921-5.905v-.046A41.53 41.53 0 0 1 0 53.078c0-23.79 20.467-43.077 45.714-43.077A46.846 46.846 0 0 1 80 24.585q.188-.198.378-.394l-.04.343z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-008',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M40 60a10 10 0 1 0-10-10 10 10 0 0 0 10 10zm0 10a20 20 0 1 1 20-20 20 20 0 0 1-20 20z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-009',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M30,50a10,10 0 1,0 20,0a10,10 0 1,0 -20,0 M110,50a10,10 0 1,0 20,0a10,10 0 1,0 -20,0" /></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-010',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M144 80a16.054 16.054 0 0 1-14.741-9.159 1.362 1.362 0 0 0-2.518 0 16.443 16.443 0 0 1-29.482 0 1.362 1.362 0 0 0-2.518 0 16.443 16.443 0 0 1-29.482 0 1.362 1.362 0 0 0-2.518 0A16.054 16.054 0 0 1 48 80a16.054 16.054 0 0 1-14.741-9.159 1.362 1.362 0 0 0-2.518 0A16.054 16.054 0 0 1 16 80a16.794 16.794 0 0 1-7.353-1.675 41.533 41.533 0 0 0 2.782 3.247L80 150.002l68.571-68.385a42.04 42.04 0 0 0 2.819-3.31A16.791 16.791 0 0 1 144 80z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-011',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M118.367 40c-6.13-.041-13.947 4.387-16.224 10.95-2.41-6.563-10.095-10.991-16.225-10.95-11.947 0-21.633 9.127-21.633 20.385a19.653 19.653 0 0 0 5.409 13.484l32.449 32.382 32.449-32.36A19.745 19.745 0 0 0 140 60.385C140 49.127 130.315 40 118.367 40z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-012',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M108.571 70L130 48.571l-28.571-28.57L80 41.427 58.571 20 30 48.571l21.429 21.43L30 91.427 58.571 120 80 98.571l21.429 21.43L130 91.427zM44.286 48.571l14.286-14.286 14.285 14.286-14.285 14.286zM80 84.286l-21.428 21.428-14.286-14.286 57.143-57.143 14.285 14.286L80 84.285v.001zm21.429 21.428L87.143 91.428l14.286-14.286 14.285 14.286z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-013',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M49.5 40A30.113 30.113 0 0 0 20 64.082h12.466a18.069 18.069 0 0 1 34.068 0H79A30.113 30.113 0 0 0 49.5 40zM109.5 40A30.113 30.113 0 0 0 80 64.082h12.466a18.069 18.069 0 0 1 34.068 0H139A30.113 30.113 0 0 0 109.5 40z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-014',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M159.4 60h-47.332a5 5 0 0 0-4.035 2.047c-.731 1-18.217 25.134-18.217 25.134S74.715 43.496 74.144 41.823a5 5 0 0 0-8.425-1.757L47.52 60H.6a41.533 41.533 0 0 0 3.056 10h46.067a5 5 0 0 0 3.693-1.629l14.128-14.94s15.528 44.467 15.705 44.9c.141.343.141.343.308.708-.34.287 2.026 2.872 3.629 3.135s4.68-1.452 4.688-1.769c.252-.272.252-.272.45-.505.352-.426 17.063-22.9 22.26-29.9h41.758a41.533 41.533 0 0 0 3.056-10z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-015',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M51.806 55.981l28.187 25.188 47.255-46.377 12.16 12.718-59.415 58.034L40 69.52l11.806-13.539z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-016',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M95 63.444V14.01a46.834 46.834 0 0 0-15 10.574A46.834 46.834 0 0 0 65 14.01v49.433H44.614l35.355 35.355 35.356-35.355H95z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-017',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M100 70.854V44L70 56v39.176h-.001A15 15 0 0 1 55 110c-8.284 0-12.292-3.857-12.292-12.142a15 15 0 0 1 15-15A2.068 2.068 0 0 0 60 80.854V40l50-20v65.176h-.001A15 15 0 0 1 95 100c-8.284 0-12.292-3.857-12.292-12.142a15 15 0 0 1 15-15c1.754 0 1.821-.781 2.292-2.004z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-018',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M157.82 66.237A10.003 10.003 0 0 1 140 60V49.998a10 10 0 0 0-20 0v40.027a10 10 0 0 1-20 0V60a10 10 0 1 0-20 0v10.025a10 10 0 0 1-20 0V49.97a10 10 0 0 0-20 0v20.055a10 10 0 0 1-20 0V60A9.993 9.993 0 0 0 .274 57.726 41.535 41.535 0 0 1 0 53.078c0-23.79 20.467-43.077 45.714-43.077A46.846 46.846 0 0 1 80 24.585 46.846 46.846 0 0 1 114.286 10c25.247 0 45.714 19.286 45.714 43.077a41.52 41.52 0 0 1-2.18 13.159z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'005-019',parent:'005',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0 53.078A41.524 41.524 0 0 0 3.657 70H60V50H.115Q0 51.525 0 53.078zM159.885 50H100v20h56.343A41.524 41.524 0 0 0 160 53.078q0-1.552-.115-3.078zM70 16.595v123.433l10 9.973 10-9.973V16.595a46.828 46.828 0 0 0-10 7.99 46.828 46.828 0 0 0-10-7.99z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-001',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 159.993a59.11 59.11 0 0 0 59.997-58.18C139.997 69.683 80 0 80 0v159.993z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-002',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 160c33.137 0 60-26.049 60-58.182-10.834 0-9.904-10-19.8-10s-9.652 10-19.792 10-10.453-10-20.417-10-9.808 10-19.792 10-9.943-10-20.017-10-9.245 10-20.182 10C20 134.655 46.863 160 80 160z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-003',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M126.059 109.49a50.021 50.021 0 0 1-92.118 0l8.126-4.01C47.07 121.866 61.977 130 80 130s33.592-8.134 38.594-24.52z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-004',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M100 130c16.569 0 30-13.024 30-29.09S100 50 100 50s-30 34.843-30 50.91S83.431 130 100 130z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-005',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 58.542s-38.047 44.188-38.047 64.564C41.953 143.482 58.987 160 80 160c-9.45 0-17.11-8.31-17.11-18.56 0-10.251 17.11-32.482 17.11-32.482s17.11 22.23 17.11 32.482C97.11 151.69 89.45 160 80 160c21.013 0 38.047-16.518 38.047-36.894C118.047 102.73 80 58.542 80 58.542z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-006',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M30 102.727C30 128.835 52.386 150 80 150s50-21.165 50-47.273zM65 90h30a5 5 0 0 0 0-10H65a5 5 0 0 0 0 10zm10-20h10a5 5 0 0 0 0-10H75a5 5 0 0 0 0 10z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-007',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M142.665 65.889c-4.118 5.49-5.867 6.889-9.335 6.889s-5.217-1.4-9.335-6.89C118.112 58.045 114.305 55 106.66 55s-11.45 3.045-17.333 10.889c-4.117 5.49-5.866 6.889-9.333 6.889s-5.216-1.4-9.333-6.889C64.78 58.044 60.973 55 53.33 55c-7.644 0-11.45 3.045-17.333 10.889-4.117 5.49-5.866 6.889-9.332 6.889-3.467 0-5.216-1.4-9.333-6.889C11.45 58.045 7.643 55 0 55v10c3.466 0 5.215 1.4 9.332 6.888 5.882 7.844 9.689 10.89 17.333 10.89 7.643 0 11.45-3.045 17.332-10.889C48.114 66.399 49.863 65 53.33 65c3.466 0 5.215 1.4 9.332 6.888 5.882 7.844 9.689 10.89 17.333 10.89s11.45-3.045 17.333-10.89C101.445 66.4 103.194 65 106.661 65c3.467 0 5.217 1.4 9.334 6.889 5.883 7.844 9.69 10.889 17.335 10.889s11.451-3.045 17.335-10.889C154.783 66.4 156.532 65 160 65V55c-7.645 0-11.451 3.045-17.335 10.889zm0-34.783c-4.118 5.49-5.867 6.89-9.335 6.89s-5.217-1.4-9.335-6.89c-5.883-7.844-9.69-10.889-17.334-10.889s-11.45 3.046-17.333 10.89c-4.117 5.489-5.866 6.888-9.333 6.888s-5.216-1.4-9.333-6.889c-5.882-7.843-9.689-10.889-17.332-10.889-7.644 0-11.45 3.046-17.333 10.89-4.117 5.489-5.866 6.888-9.332 6.888-3.467 0-5.216-1.4-9.333-6.889C11.45 23.263 7.643 20.217 0 20.217v10c3.466 0 5.215 1.4 9.332 6.889 5.882 7.844 9.689 10.89 17.333 10.89 7.643 0 11.45-3.046 17.332-10.89 4.117-5.49 5.866-6.889 9.333-6.889 3.466 0 5.215 1.4 9.332 6.889 5.882 7.844 9.689 10.89 17.333 10.89s11.45-3.046 17.333-10.89c4.117-5.49 5.866-6.889 9.333-6.889 3.467 0 5.217 1.4 9.334 6.889 5.883 7.844 9.69 10.89 17.335 10.89s11.451-3.046 17.335-10.89c4.118-5.49 5.867-6.889 9.335-6.889v-10c-7.645 0-11.451 3.045-17.335 10.889z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-008',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M103.43 29.707a487.991 487.991 0 0 1 5.917 8.225m-5.917-8.225l-82.36 82.36a58.65 58.65 0 0 0 3.214 10.928l85.063-85.063a488.14 488.14 0 0 0-5.917-8.225zm12.357 17.643l-86.042 86.042a59.335 59.335 0 0 0 6.227 7.915l85.342-85.342a333.26 333.26 0 0 0-5.527-8.615zm11.411 18.59l-82.8 82.8a59.125 59.125 0 0 0 8.844 5.297l78.807-78.806a180.274 180.274 0 0 0-4.851-9.292z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-009',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M115.985 20.371l-12.163-8.485L150.312 10l-8.75 51.767-8.66-20.11C38.537 126.38 80.313 160 80.313 160S7.987 118.799 115.986 20.371z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-010',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M125.043 62.164l-45.05 44.213L51.806 81.19 40 94.728l39.993 36.024 53.562-52.317a181.022 181.022 0 0 0-8.512-16.271z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-011',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M110 117.236l-51.55 39.375 21.882-56.25-60.958-30.312h71.271L110 29.088l19.999 40.961h29.721l-21.56 21.236 19.653 50.264L110 117.236z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-012',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 50a50 50 0 1 0 50 50 50 50 0 0 0-50-50zm0 90a40 40 0 1 1 40-40 40 40 0 0 1-40 40z M80 70a30 30 0 1 0 30 30 30 30 0 0 0-30-30zm0 50a20 20 0 1 1 20-20 20 20 0 0 1-20 20z M70,100a10,10 0 1,0 20,0a10,10 0 1,0 -20,0"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-013',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M65.32 158.382l54.68-77.5H85.779L95 19.393l-55 78.97h34.186L64.173 158.08c.383.1.761.209 1.147.3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-014',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M100.322 110.647c-6.875 13.125 0 20 0 20C78.76 127.522 76.914 100 76.914 100c-12.5 16.897-2.53 35.647-2.53 35.647-16.874-3.09-24.405-26.3-23.124-38.125C55.197 61.162 80 12.209 80 12.209 67.822 26.272 30 72.386 30 100a50.007 50.007 0 0 0 93.827 24.086s-14.442 4.373-23.505-13.439z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'006-015',parent:'006',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M85 151.64l54.61-54.611a59.273 59.273 0 0 0-3-11.14L85 137.497v-25.859l43.441-43.44a232.635 232.635 0 0 0-5.15-8.993L85 97.498V71.639l28.176-28.175a441.879 441.879 0 0 0-5.812-8.331L85 57.498V5.988C81.894 2.2 80 0 80 0s-1.894 2.2-5 5.987V57.93L52.456 35.385a439.19 439.19 0 0 0-5.806 8.336L75 72.071v25.858L36.546 59.475a230.26 230.26 0 0 0-5.137 9.005L75 112.07v25.86L23.274 86.202a57.678 57.678 0 0 0-2.936 11.207L75 152.07v7.713c1.65.132 3.315.217 5 .217s3.35-.085 5-.217v-8.144z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:true,is_free:false},{figure_id:'free-001',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M137.99 25.144c-2.593-2.7-27.452-5.164-54.838.631S37.985 44.588 30.285 59.353s-7.86 24.91-7.939 32.531 1.641 17.651 2.7 22.679a111.861 111.861 0 0 0 3.07 10.929 121.498 121.498 0 0 1-22.512 5.028 91.72 91.72 0 0 1-5.6.59v10.22c5.479-.447 10.866-1.152 15.247-1.918a139.52 139.52 0 0 0 21.646-6.113s5.687 3.125 21.965 5.425c21.114 2.858 34.663-.423 49.8-12.279s22.388-33.344 24.981-42.712 5.187-24.716 5.61-32.55c.424-7.833 1.33-23.339-1.263-26.039zm-36.899 44.671c-2.54 3.335-29.825 39.223-63.354 52.568a92.1 92.1 0 0 1-4.392-22.135c-.793-12.014-.475-23.079 5.4-33.979s15.613-19.955 33.555-26.2c17.943-6.245 44.422-7.069 52.2-6.275-7.33 15.667-20.869 32.686-23.409 36.021z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-002',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M15.667 155.285c-4.587-9.415-10.381-27.279.24-47.92s23.538-32.831 48.765-43.332 34.22-15.088 42.488-23.839 10.863-16.6 11.406-22.571-.844-13.218-3.38-17.321c-2.051 6.337-11.285 15.993-24.623 21.847S58.697 36.694 46.506 43.513s-22.33 14.062-30.84 25.529-8.931 16.3-8.931 16.3 1.87-17.743 14.484-30.719 32.168-27.4 48.885-35.426c9.2-4.42 21.345-11.375 29.57-19.195h25.367a44.715 44.715 0 0 1 3.182 8.754 78.807 78.807 0 0 1-.181 37.116c-.785 3.44-3.742 11.849-3.742 14.947s.523 5.512 2.615 9.576 10.3 15.249 11.547 17.744 3.34 4.355-.342 7.523-7.3 1.328-9.445 2.656-3.047 3.41-1.871 6.307 3.38 4.073 2.565 5.763-4.37 1.98-5.383 2.752-1.255 1.5-.145 2.849 3.066 1.931 2.342 4.128-3.742 1.134-5.987 3.114-3.09 3.114-2.85 7.267.895 7.555-2.92 9.535-10.791 1.449-16.32.024a97.397 97.397 0 0 0-19.877-2.447c-4.335.106-12.567.323-20.775 4.378a88.033 88.033 0 0 0-20.5 13.758 28.293 28.293 0 0 0-3.688 4.252H18.412a41.7 41.7 0 0 1-2.745-4.713zm92.87-85.08c3.7-1.105 6.122-5.445 6.025-8.289-2.747 2.072-11.716 4.991-22.41.145 0 0 5.929 10.313 16.386 8.144z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-003',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M126.567 67.01c-6.848 11.86-20.465 21.09-29.725 22.64 12.606 6.82 31.826 19.15 34.394 20.94s1.712 4.18 0 10.54a46.274 46.274 0 0 1-25.057 28.22c-5.991 2.87-9.493 3.8-10.271.78s-9.46-39.6-23.189-40.63c-23.721-1.53-36.028-8.99-41.242-19.85s-2.161-20.94-2.645-25.43-3.463-5.97-5.759-8.99a12.47 12.47 0 0 1-2.334-6.67 25.738 25.738 0 0 1-4.669-4.03c-1.595-1.98-.934-3.26-.934-3.26 2.084-3.35 8.093-2.33 8.093-2.33s1.867-5.27 10.894-7.6 15.1 2.95 18.52 9 11.205 15.51 11.205 15.51 8.715-1.79 21.166-8.38 24.122-20.39 35.016-26.36 13.526-1.37 14.941 7.6c1.454 9.21-1.556 26.44-8.404 38.3zM72.811 46.4c10.083-9.18 18.279-23.92 27.241-31.6 8.421-7.22 12.129-4.82 15.128 1.81-10.651 6.2-22.038 19.44-34.166 25.86a107.67 107.67 0 0 1-8.203 3.93z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-004',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M149.448 51.76a7.688 7.688 0 0 0-1.578-8.28c-3.646-3.94-11.74-2.37-16.5-.85a101.89 101.89 0 0 0-28.846 15.27A98.897 98.897 0 0 0 84.01 76.03V118s-.143 3.28 2.727 8.71 9.077 18.09 18.37 17.27 17.8-6.64 23.823-16.99 6.124-17.99 1.149-24.69c-2.592-3.42-4.449-4.11-4.162-5.71s2.726-1.36 5.453-3.29 5.454-5.14 5.167-9.85-.538-10.38 1-13.56 3.875-6.1 7.463-10.42a22.065 22.065 0 0 0 4.448-7.71zm-138.865 0a7.691 7.691 0 0 1 1.578-8.28c3.643-3.94 11.734-2.37 16.5-.85A101.824 101.824 0 0 1 57.494 57.9a98.888 98.888 0 0 1 18.5 18.13V118s.143 3.28-2.726 8.71-9.073 18.09-18.361 17.27-17.787-6.64-23.812-16.99-6.121-17.99-1.148-24.69c2.59-3.42 4.447-4.11 4.16-5.71s-2.725-1.36-5.451-3.29-5.451-5.14-5.164-9.85.538-10.38-1-13.56-3.873-6.1-7.459-10.42a22.055 22.055 0 0 1-4.45-7.71zM130.5 29a9.482 9.482 0 0 1-7.242-3.36c-3.392 1.44-10.467 4.7-15.645 8.92-7.047 5.75-16.064 13.74-21.289 20.92-4.591 6.31-4.557 8.93-6.616 8.48-1.853-.26-1-1.5-6.082-8.5-5.218-7.18-14.223-15.16-21.262-20.91-4.845-3.95-11.317-7.04-14.9-8.6A9.488 9.488 0 1 1 40 19.5c0 .08-.01.16-.012.24 7.9 3.62 17.545 10.59 24.547 16.97 7.312 6.65 14.522 17.19 15.443 18.55.977-1.44 8.161-11.91 15.449-18.54 7.312-6.65 17.5-13.95 25.583-17.42a9.5 9.5 0 1 1 9.49 9.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-005',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M145.153 160a65.841 65.841 0 0 0-48.46-63.35l21.714-22A88.007 88.007 0 0 1 160 118.84V160h-14.847zM88.124 41l24.438-24.29L137 41H88.124zM56.166 13h48.876L80.6 37.29zm-7.728 28H24l24.438-24.29L72.876 41H48.438zm31.833 8h54.864l-54.864 55.67L25.407 49h54.864zM41.446 74.21L63.32 96.38A65.824 65.824 0 0 0 13.847 160H0v-43.45a87.985 87.985 0 0 1 41.446-42.34z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-006',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M116.983 91.59c-5.815 13.25-18.968 11-22.558 8.13s-5.828-5.84-5.7-12.31 4.163-12.45 5.7-14.9a54.785 54.785 0 0 0 6.166-18.14 49.488 49.488 0 0 0-.078-14.98c15.455 19.56 22.287 38.96 16.47 52.2zm-92.877 46.53c-7.177-20.48-4.065-35.57 2.61-51.11s22.788-34.92 29.212-42.29S70.986 22.58 74.6 10.65A48.201 48.201 0 0 0 76.441 0h7.429c12.7 28.35 5.888 46.57 4.081 54.04-2.108 8.72-8.533 18.04-12.649 29.77s-.753 21.54 2.108 25.45 19.425 20.04 38.749 8.42 14.355-35.28 14.355-35.28 13.25 18.34 8.432 45.4c-2.226 12.5-9.062 23.73-18.4 32.2H39.227a53.574 53.574 0 0 1-15.121-21.88z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-007',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M73.963 13c.077 40.87.185 118.23-.053 134-17.3 0-54.386-10.31-56.834-51.98C15.599 69.87 36.607 35.95 53.498 13h20.465zm47.278 20.09c-4.275 23.85-17.137 43.49-34.186 53.29 0-7.32-.008-14.84-.008-22.3 12.1-11.47 20.265-29.38 21.4-49.79 4.179 5.73 8.573 12.09 12.794 18.8zm5.254 8.72a188.939 188.939 0 0 1 9.38 18.39c-5.7 30.61-24.725 54.57-48.769 61.24-.018-6.82-.031-14.52-.04-22.69 19.811-8.72 34.968-30.28 39.434-56.94h-.005zm14.253 31.38c2.341 7.66 3.573 15.06 3.175 21.83-2.449 41.67-39.36 51.98-56.673 51.98-.042-2.84-.077-7.68-.1-13.95 25.839-4.26 46.863-28.27 53.598-59.86zM87.064 13h16.2c-2.1 14.82-7.933 27.96-16.221 37.76.006-13.92.013-27.08.021-37.76z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-008',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 88.72a40.89 40.89 0 0 1-18.835 5.02c-21.766.9-43.869-14-43.869-14-.4-.27-.4-.4 0-.67 0 0 22.1-14.93 43.869-14.03A40.89 40.89 0 0 1 160 70.06v18.66zm-26.557-43.05c-14.751 16.06-40.892 21.18-40.892 21.18-.473.09-.569-.01-.474-.48 0 0 5.075-26.23 21.093-41.02 15.96-14.73 30.423-10.29 30.527-10.25.034.1 4.444 14.58-10.254 30.57zM93.928 17.89c.895 21.81-13.982 43.96-13.982 43.96-.271.4-.405.4-.67 0 0 0-14.915-22.15-14.018-43.96A41.572 41.572 0 0 1 69.746 0h19.705a41.655 41.655 0 0 1 4.477 17.89zm-78.379-2.83c.1-.03 14.556-4.47 30.5 10.25 16.006 14.77 21.077 40.98 21.077 40.98.1.47 0 .56-.473.47 0 0-26.122-5.11-40.862-21.15C11.104 29.63 15.51 15.17 15.542 15.06h.007zM0 69.52a41.247 41.247 0 0 1 17.837-4.48c21.768-.9 43.872 14.03 43.872 14.03.4.27.4.4 0 .67 0 0-22.1 14.9-43.872 14A41.543 41.543 0 0 1 0 89.27V69.52zm25.8 43.84C40.537 97.32 66.654 92.2 66.654 92.2c.473-.09.568.01.474.48 0 0-5.071 26.22-21.074 41-15.946 14.72-30.4 10.28-30.5 10.25-.037-.11-4.442-14.57 10.246-30.57zm39.452 27.74c-.9-21.82 14.015-43.98 14.015-43.98.266-.4.4-.4.67 0 0 0 14.875 22.16 13.98 43.98a41.085 41.085 0 0 1-5.022 18.9H70.283a41.014 41.014 0 0 1-5.035-18.9h.004zm78.426 2.79c-.1.04-14.564 4.48-30.522-10.26C97.141 118.84 92.067 92.6 92.067 92.6c-.1-.47 0-.57.474-.48 0 0 26.136 5.12 40.884 21.18 14.695 16.01 10.287 30.49 10.254 30.59h-.001z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-009',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M139.37 59.21c-7.075 15.95-12.751 19.52-23.558 23.93-8.911 3.63-10.418 3.7-10.674 3.62l-.055-.05a.068.068 0 0 0 .055.05 42.443 42.443 0 0 1 12.54 18.53c4.012 11.92 6.064 36.43 6.064 36.43s-18.519 2.85-29.155-9.29-9.563-28.93-9.563-28.93V67.78s-.14-18.71 9.329-31.43S116.325 17.02 148 19.56c0 0-1.555 23.69-8.63 39.65zm-73.957 73.22c-10.636 12.14-29.155 9.29-29.155 9.29s2.052-24.51 6.064-36.43a42.443 42.443 0 0 1 12.54-18.53.068.068 0 0 0 .055-.05l-.055.05c-.256.08-1.763.01-10.674-3.62-10.807-4.41-16.483-7.98-23.558-23.93S12 19.56 12 19.56c31.675-2.54 44.177 4.07 53.646 16.79s9.33 31.43 9.33 31.43v35.72s1.073 16.79-9.563 28.93z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-010',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 54.58L82.215 33.24l32-31.28L160 48.62v5.96zm-119.385.82L29.39 12.22 74.284 0h21.463zM16.743 15.74l22.247 86.37L0 91.26V76.17zM0 106.42l77.786 21.33-32 31.29L0 112.37v-5.95zm160-36.68v15.1l-16.736 60.41-22.253-86.36zm-40.61 35.85l11.222 43.18L89.371 160H65.243z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:10},{figure_id:'free-011',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M141 98h-29.051c.022-.33.051-.66.051-1V63a15 15 0 0 0-15-15H63a15 15 0 0 0-15 15v34a15 15 0 0 0 15 15h34c.338 0 .668-.03 1-.05V141H59a40 40 0 0 1-40-40V59a40 40 0 0 1 40-40h42a40 40 0 0 1 40 40m0 82h-29v-29h29v29z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:10},{figure_id:'free-012',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M42.4 42.1c-21 21-21 54.9 0 75.9 21 20.9 54.9 20.9 75.9.1 21-21 21-54.9 0-75.9s-54.9-21-75.9-.1zM96.2 115c-19.3 8.8-42.1.3-50.9-19l40.2-15.2-41-15.1c1.9-4.9 4.9-9.3 8.6-13 15-15 39.3-14.9 54.3.1 3.3 3.3 5.9 7.1 7.8 11.3 8.8 19.3.3 42.1-19 50.9z M67.3 146.1c-20.1-2.1-34.8-18.2-34.8-18.2s-16-14.7-18.2-34.9c-1.2-12.3 0-24.7 3.7-36.5 0 0-10.6 12.2-18 33.3V160h71.7c20.3-7.4 32-17.6 32-17.6-11.8 3.7-24.2 5-36.4 3.7zM89.1 0C68.6 7.4 56.8 17.7 56.8 17.7 68.6 14 81 12.8 93.2 14c20.1 2.1 34.8 18.2 34.8 18.2s16 14.7 18.2 34.9c1.2 12.3 0 24.7-3.7 36.5 0 0 10.1-11.6 17.5-31.9V0H89.1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-013',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0 160V90h20v50h50v20z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:10},{figure_id:'free-014',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M20 90H0v70h70v-20H20zM0 0v70h20V20h50V0H10zM140 140H90v20h70V90h-20zM150 0H90v20h50v50h20V0z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:10},{figure_id:'free-015',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M30 77.1v40h.2C32.3 129.9 53.8 140 80 140s47.7-10.1 49.8-22.9h.2v-40L80 96.6 30 77.1z M160 60L80 30 0 60l80 30z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-016',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M147.2 61.9c-16-5.2-16 15.5-32.1 15.5C104.6 77.4 94 73 86.5 67c10.7-6.3 17.9-17.8 17.9-30.8C104.4 16.2 87.7 0 67 0 49.6 0 34.9 11.5 30.7 27.1c-6.1.1-14.3-1.1-22.6-6.4-16-10.3-5.3 15.5 5.3 20.6 10.7 5.2-5.3 5.2-5.3 5.2S2.8 62 24.1 56.8c3.8-.9 7.7-1.2 11.4-1 1 1.5 2.1 2.9 3.3 4.2-3.4 7.4-12.7 25.9-25.3 38.1-16 15.5 0 61.9 58.8 61.9s69.5-15.5 80.2-36.1c10.7-20.7 10.7-56.8-5.3-62z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-017',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0 60h30v40H0zM0 10h70v40H0zM40 60h80v40H40zM90 110h70v40H90zM0 110h80v40H0z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-018',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M90 20h-.4l-.2 70-69.4-.1v.1c0 38.7 31.3 70 70 70s70-31.3 70-70-31.3-70-70-70z M79.9 0c-3.2 0-6.3.2-9.4.6-.2 0-.4 0-.6.1C33.7 5.2 5.1 33.9.6 70.1c-.1.4-.1.9-.1 1.3 0 .2 0 .4-.1.6-.1 1.2-.2 2.3-.3 3.5v.7C0 77.4 0 78.5 0 79.6v.5l79.8.1.1-80.2zM69.8 70.2l-59.1-.1C15 39.5 39.2 15.2 69.9 10.7l-.1 59.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-019',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0 80h40v80H0V80zm60-40h40v120H60V40zm60-40h40v160h-40V0z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-020',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M152.6 61.8c.3-.3.5-.7.8-1C165 44.9 157.8 20 157.8 20s-26 .9-37.6 16.8c-.1.2-.2.3-.3.5C108.1 32.7 94.5 30 80 30s-28.1 2.7-39.9 7.3c-.1-.2-.2-.3-.3-.5C28.1 20.9 2.2 20 2.2 20S-5 44.9 6.7 60.8c.3.4.5.7.8 1C2.7 68.9 0 76.7 0 85c0 25.6 25.5 47.2 60.1 53.3C60.9 128 69.5 120 80 120s19.1 8 19.9 18.3c34.5-6.1 60.1-27.6 60.1-53.3 0-8.3-2.7-16.1-7.4-23.2zm-83 37.8s-20.6 3-31.4-7.8C27.4 81 30.4 60.4 30.4 60.4s20.6-3 31.4 7.8c10.8 10.9 7.8 31.4 7.8 31.4zm52.2-7.8c-10.8 10.8-31.4 7.8-31.4 7.8s-3-20.6 7.8-31.4c10.8-10.8 31.4-7.8 31.4-7.8s3 20.5-7.8 31.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-021',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 27.3v-6.4s-110.2.4-110.6-1.4C46.9 8.3 36.9 0 25 0 11.2 0 0 11.2 0 25s11.2 25 25 25c6.7 0 12.9-2.7 17.4-7L90 103.6V150H70v10h50v-10h-20v-46.4l60-76.3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-022',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M103.9 10C103 23 92.7 33.2 80 33.2S57 23 56.1 10C39.4 13.8 17.6 24.6 0 53.7l31.1 21.8 8.8-8.7V150h80V66.8l8.8 8.7L160 53.7c-17.6-29.1-39.4-39.9-56.1-43.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-023',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M60,80a20,20 0 1,0 40,0a20,20 0 1,0 -40,0 M160 90V70h-20.8c-1.5-9.1-5.1-17.5-10.3-24.8l14.7-14.7-14.1-14.1-14.7 14.7C107.6 26 99.2 22.4 90 20.8V0H70v20.8c-9.1 1.5-17.5 5.1-24.8 10.3L30.5 16.4 16.4 30.5l14.7 14.7C26 52.4 22.4 60.8 20.8 70H0v20h20.8c1.5 9.1 5.1 17.5 10.3 24.8l-14.7 14.7 14.1 14.1 14.7-14.7c7.2 5.1 15.6 8.7 24.8 10.3V160h20v-20.8c9.1-1.5 17.5-5.1 24.8-10.3l14.7 14.7 14.1-14.1-14.7-14.7c5.1-7.2 8.7-15.6 10.3-24.8H160zm-80 30c-22.1 0-40-17.9-40-40s17.9-40 40-40 40 17.9 40 40-17.9 40-40 40z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:10},{figure_id:'free-024',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><g><path d="M70,30a10,10 0 1,0 20,0a10,10 0 1,0 -20,0 M0 120h160v20H0zM80 40c-38.7 0-70 31.3-70 70h140c0-38.7-31.3-70-70-70z"/></g></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-025',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 10H20V0H0v160h20v-50h140l-30-50z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-026',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M141.8 141.8L98.5 45.9l9.7-18.3c5.2-9.7.5-17.6-10.6-17.6H62.4c-11 0-15.8 7.8-10.6 17.6l9.7 18.3-43.3 95.9c-4.5 10.1.8 18.2 11.9 18.2H130c11 0 16.3-8.2 11.8-18.2zM57.1 80l13.5-30 2-4.5-2.3-4.3-9.7-18.3C59 19.8 58.9 20 62.4 20h35.3c3.5 0 3.4-.2 1.7 2.9l-9.7 18.3-2.3 4.3 2 4.5 13.5 30H57.1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:90},{figure_id:'free-027',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M150 17.4l-7.4-7.4-17.9 17.9-41.1-3.2L10 98.4 61.6 150l73.7-73.7-3.2-41.1L150 17.4zm-33.1 47.9c-6.1 6.1-16 6.1-22.1 0-6.1-6.1-6.1-16 0-22.1 4.8-4.8 12-5.8 17.8-3.1L105 50l5 5 9.9-7.5c2.8 5.8 1.8 13-3 17.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-028',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 0C57.9 0 40 17.9 40 40v70c0 5.5 4.5 10 10 10h20v30c0 5.5 4.5 10 10 10s10-4.5 10-10v-30h20c5.4 0 10-4.5 10-10V40c0-22.1-17.9-40-40-40zM50 110V41.4c5.3-2.7 13.6-4.2 20 8.6 7 14.1 21.5 23.2 40 15.1V110H50z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-029',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M79.8 42.7h.5c5.3 0 9.7-4.3 9.7-9.7V11.6c0-5.3-4.3-9.7-9.7-9.7h-.5c-5.3 0-9.7 4.3-9.7 9.7V33c0 5.4 4.3 9.7 9.7 9.7zM41.9 92.8l-.1-.5c-1.2-5.1-6.4-8.5-11.6-7.3L9.3 89.9c-5.2 1.2-8.4 6.4-7.2 11.6l.1.5c1.2 5.1 6.4 8.5 11.6 7.3l20.9-4.8c5.2-1.3 8.4-6.5 7.2-11.7zM18.9 46.3l16.7 13.5c4.1 3.3 10.2 2.7 13.6-1.4l.3-.4c3.3-4.1 2.7-10.2-1.4-13.6L31.4 30.9c-4.1-3.3-10.2-2.7-13.6 1.4l-.3.4c-3.3 4.1-2.7 10.3 1.4 13.6zM110.8 58.4c3.3 4.1 9.5 4.8 13.6 1.4l16.7-13.5c4.1-3.3 4.8-9.4 1.4-13.6l-.3-.4c-3.3-4.1-9.5-4.8-13.6-1.4l-16.7 13.5c-4.1 3.3-4.8 9.4-1.4 13.6l.3.4zM110 124.6c-2.3-4.8-8.1-6.8-12.9-4.4l-.4.2c-4.7 2.3-6.8 8.1-4.5 12.9l9.4 19.3c2.3 4.8 8.1 6.8 12.9 4.4l.4-.2c4.7-2.3 6.8-8.1 4.5-12.9l-9.4-19.3zM63.3 120.4l-.4-.2c-4.7-2.3-10.6-.4-12.9 4.4l-9.4 19.3c-2.3 4.8-.3 10.6 4.5 12.9l.4.2c4.7 2.3 10.6.4 12.9-4.4l9.4-19.3c2.3-4.7.3-10.6-4.5-12.9zM150.7 89.9l-20.9-4.8c-5.2-1.2-10.4 2-11.6 7.3l-.1.5c-1.2 5.1 2 10.4 7.2 11.6l20.9 4.8c5.2 1.2 10.4-2 11.6-7.3l.1-.5c1.2-5.2-2-10.4-7.2-11.6z M50.2,80a29.8,30 0 1,0 59.6,0a29.8,30 0 1,0 -59.6,0"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-030',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M150 70V60h-10V31c0-.6-.4-1-1-1h-28c-.6 0-1 .5-1 1v39H50V31c0-.6-.4-1-1-1H21c-.6 0-1 .5-1 1v29H10v10C4.5 70 0 74.5 0 80s4.5 10 10 10v10h10v29c0 .6.4 1 1 1h28c.6 0 1-.5 1-1V90h60v39c0 .6.4 1 1 1h28c.6 0 1-.5 1-1v-29h10V90c5.5 0 10-4.5 10-10s-4.5-10-10-10z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-031',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 0C46.9 0 20 26.9 20 60s60 100 60 100 60-66.9 60-100S113.1 0 80 0zm0 90c-16.6 0-30-13.4-30-30s13.4-30 30-30 30 13.4 30 30-13.4 30-30 30z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-032',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M147.6 87.5L72.5 12.4c-16.5-16.5-43.4-16.5-60 0s-16.6 43.5 0 60l75.1 75.1c16.5 16.5 43.4 16.5 60 0 16.5-16.5 16.6-43.4 0-60zm-90.1 15L19.9 64.9c-12.4-12.4-12.4-32.6 0-45 12.4-12.4 32.6-12.4 45 0l37.6 37.6-45 45z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:90},{figure_id:'free-033',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M98.3 68.7c12.1 3.1 25.1-6.2 29.2-20.8 4-14.6-2.5-29.1-14.5-32.2-12.1-3.1-25.1 6.2-29.2 20.8-4.1 14.6 2.4 29 14.5 32.2zM32.2 71.1c-5.7-9.7-16.9-13.9-24.8-9.4-8 4.5-9.8 15.9-4 25.6 5.7 9.7 16.9 13.9 24.8 9.4 8-4.4 9.8-15.9 4-25.6zM56.4 68.7C68.5 65.5 75 51.1 70.9 36.4c-4-14.6-17.1-24-29.2-20.8-12.1 3.1-18.6 17.6-14.5 32.2 4.1 14.7 17.1 24 29.2 20.9zM152.6 61.7c-8-4.5-19.1-.2-24.8 9.4-5.7 9.7-4 21.1 4 25.6s19.1.2 24.8-9.4c5.8-9.7 4-21.1-4-25.6zM76.9 73.8c-25 0-45.2 36.1-45.2 60.4 0 24.3 20.3 0 45.2 0s45.2 24.3 45.2 0c.1-24.3-20.2-60.4-45.2-60.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-034',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M148.6 80c6.9-5.1 11.4-13.1 11.4-22.2 0-15.3-12.8-27.8-28.6-27.8-13.8 0-25.4 9.5-28 22.2H56.6C53.9 39.5 42.4 30 28.6 30 12.8 30 0 42.4 0 57.8 0 66.9 4.5 74.9 11.4 80 4.5 85.1 0 93.1 0 102.2 0 117.6 12.8 130 28.6 130c13.8 0 25.4-9.5 28-22.2h46.9c2.6 12.7 14.2 22.2 28 22.2 15.8 0 28.6-12.4 28.6-27.8-.1-9.1-4.6-17.1-11.5-22.2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-035',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M135.2 129.5h-4.7c6.3-8.5 10-19.1 10-30.5 0-27.8-22-50.5-49.3-50.9l18.4-23.9c4.9-6.8 3.4-16.3-3.3-21.3-6.7-5-16.1-3.5-20.9 3.4l-50 73.2-9.7-6.7c-4.7-3.2-10.8-1.9-13.9 2.7-3.1 4.7-1.9 11 2.7 14.1L55.9 118c4.7 3.2 10.8 1.9 13.9-2.7 3.1-4.7 1.9-11-2.7-14.1l-11-7.5 19.4-25.2h15.1c16.5 0 29.9 13.7 29.9 30.5 0 16.9-13.4 30.5-29.9 30.5H25.8c-8.4 0-15.3 6.8-15.3 15.3 0 8.4 6.8 15.3 15.3 15.3h109.5c8.4 0 15.3-6.8 15.3-15.3-.1-8.5-6.9-15.3-15.4-15.3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:90},{figure_id:'free-036',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M143.3 83.3c-2.5-1.2-5.9-1.7-9.8-1.9v-.9-.9c3.9-.1 7.3-.7 9.8-1.9 11.9-5.8 16.9-19.9 11.2-31.6-5.7-11.7-19.9-16.4-31.8-10.6-2.4 1.2-4.8 3.4-7.2 6.2-.5-.5-1.1-.9-1.7-1.4 2.1-2.9 3.7-5.7 4.2-8.1 3-12.9-4.9-25.7-17.5-28.6-12.6-2.9-25.3 5.1-28.3 18-.5 2.3-.4 5.2.1 8.3-.9.1-1.7.3-2.6.5-.9-3.1-2.1-5.8-3.6-7.7-8.3-10.3-23.2-12-33.3-3.8-10.1 8.2-11.5 23.1-3.2 33.4 1.3 1.6 3.1 3 5.4 4.4-.3.6-.6 1.2-1 1.9-2.6-1-5.1-1.6-7.2-1.6C13.7 57 3 67.5 3 80.5S13.7 104 26.9 104c2.1 0 4.6-.6 7.2-1.6.3.6.6 1.3 1 1.9-2.3 1.4-4.2 2.8-5.4 4.4-8.3 10.3-6.9 25.2 3.2 33.4 10.1 8.2 25 6.5 33.3-3.8 1.5-1.9 2.7-4.5 3.6-7.7.9.2 1.7.4 2.6.5-.5 3.2-.6 6-.1 8.3 3 12.9 15.6 20.9 28.3 18 12.6-2.9 20.5-15.7 17.5-28.6-.6-2.5-2.1-5.3-4.2-8.1.6-.4 1.1-.9 1.7-1.4 2.4 2.8 4.8 5.1 7.2 6.2 11.9 5.8 26.1 1 31.8-10.6 5.6-11.7.6-25.8-11.3-31.6zm-62 22.9c-14.4 0-26.1-11.5-26.1-25.7s11.7-25.7 26.1-25.7c14.4 0 26.1 11.5 26.1 25.7.1 14.2-11.6 25.7-26.1 25.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-037',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M119.8 94.9C94.6 99.9 44.3 45 19.1 20 4 30-6 64.9 4 79.9c10.1 15 15.1 59.9 15.1 59.9h20.1v-35s-5-40 30.2 10c35.2 49.9 90.6 10 90.6 10v-15c0-9.9-15.1-19.9-40.2-14.9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-038',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0 0h40v40H0zM60 120h40v40H60zM0 120h40v40H0zM60 60h40v40H60zM0 60h40v40H0zM120 60h40v40h-40zM60 0h40v40H60zM120 0h40v40h-40zM120 120h40v40h-40z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:10},{figure_id:'free-039',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M120 90l10-10L50 0 30 20l60 60-60 60 20 20z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:10},{figure_id:'free-040',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 0H0v20h140l-.1 140H160z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:10},{figure_id:'free-041',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 100c16.5 0 30-13.4 30-30V30c0-16.5-13.4-30-30-30-16.5 0-30 13.4-30 30v40c0 16.5 13.4 30 30 30z M120 60v10.1c0 22-17.9 39.9-40 39.9S40 92.1 40 70.1V60H20v10.1c0 29.6 21.6 54.3 50 59.1V160h20v-30.8c28.3-4.8 50-29.4 50-59.1V60h-20z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-042',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M0 0v160h160V0H0zm140 140H20V20h120v120z M120 70H90V40H70v50h50z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-043',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M22.8 61.5c7.2 6.8 16.8 8 24.9 4l8.2 7.9 16-15.4-11.2-10.8c2.1-9.7-.4-20.3-7.6-27.2L38.9 6.4c-10-9.6-25-8.1-33.4 3.3-8.4 11.4-7.1 28.5 3 38.1l14.3 13.7zm-6.9-41.9c3.6-4.9 10.1-5.6 14.4-1.4l14.3 13.6c4.3 4.1 4.9 11.5 1.3 16.5-3.6 4.9-10.1 5.6-14.4 1.4L17.2 36.1c-4.3-4.2-4.9-11.5-1.3-16.5zM85.9 102.3l43.6 41.8c8.8 8.5 21.7 7.1 29.1-2.9L102 86.9l-16.1 15.4z M159.3 18.8c-7.4-10.1-20.6-11.4-29.5-2.9L47.6 94.5c-8-4-17.7-2.9-24.8 4L8.5 112.1c-10 9.6-11.3 26.7-2.9 38.1 8.4 11.5 23.4 13 33.4 3.4L53.3 140c7.2-6.8 9.8-17.5 7.8-27.2l98.2-94zM79.6 72.5c4 0 7.3 3.7 7.3 8.3 0 4.6-3.2 8.3-7.3 8.3-4 0-7.3-3.7-7.3-8.3 0-4.6 3.3-8.3 7.3-8.3zm-35 55.7l-14.3 13.6c-4.3 4.1-10.8 3.5-14.4-1.4-3.6-4.9-3.1-12.3 1.3-16.5l14.3-13.6c4.3-4.1 10.8-3.5 14.4 1.4 3.6 4.9 3.1 12.3-1.3 16.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-044',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M146.8 28C107.5 4.9 78.6 0 78.6 0h-.1-.1S49.5 4.9 10.2 28c0 0-5.2 116.4 68.2 132h.2c73.4-15.7 68.2-132 68.2-132zM78.6 9.9c6.4 1.4 29 7.2 58.5 23.7-.1 21.5-3.8 102.8-58.5 116.5V9.9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-045',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M92.7 108.8c0 2.1-1.6 3.7-3.6 3.7H70.9c-2 0-3.6-1.7-3.6-3.7V95.7L0 80v62.5c0 4.1 3.3 7.5 7.3 7.5h145.5c4 0 7.3-3.3 7.3-7.5V80.1L92.7 95.7v13.1z M152.7 40H7.3c-4 0-7.3 3.3-7.3 7.3v24.3l67.3 15.3v-7c0-2 1.6-3.6 3.6-3.6h18.2c2 0 3.6 1.6 3.6 3.6v7L160 71.7V47.3c0-4-3.3-7.3-7.3-7.3zM51.9 18.6c0-5.4 4.4-9.9 9.9-9.9h36.4c5.4 0 9.9 4.4 9.9 9.9v9.6h8.6v-9.6C116.7 8.5 108.4.2 98.3.2H61.8C51.7.2 43.4 8.5 43.4 18.6v9.6H52l-.1-9.6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-046',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M27.5 85.3l32.7 21.3c2.3 1.5 5.4.8 6.9-1.5l.5-.8c1.5-2.3.9-5.4-1.5-6.9L33.5 76.1c-2.3-1.5-5.4-.8-6.9 1.5l-.5.8c-1.6 2.3-.9 5.4 1.4 6.9zM63.5 30l32.7 21.3c2.3 1.5 5.4.9 6.9-1.5l.5-.8c1.5-2.3.9-5.4-1.5-6.9L69.5 20.8c-2.3-1.5-5.4-.9-6.9 1.5l-.5.8c-1.5 2.3-.9 5.4 1.4 6.9zM73.5 134c0-6.9-5.6-12.5-12.5-12.5H4.5c-1.5 0-3.1.3-4.5.8V144h73.5v-10zM154.2 110.6L93.1 70.8c-1.2-.8-2.5-1.2-3.8-1.4l.8-1.2c3.8-5.8 2.1-13.5-3.7-17.3L67.1 38.3c-5.8-3.8-13.5-2.1-17.3 3.6L38.9 58.7c-3.8 5.8-2.1 13.5 3.7 17.3l19.3 12.6c5.8 3.8 13.5 2.1 17.3-3.6l.8-1.2c.7 1.2 1.7 2.2 2.9 2.9l61.1 39.8c.8 2.9 2.7 5.3 5.2 6.9l3.8 2.5c2.2 1.4 4.7 2.1 7.3 2v-26.7c-2.2-.7-4.2-.9-6.1-.6zM75.5 148.5H0v11h75.5c2.8 0 5-2.2 5-5v-1c0-2.8-2.2-5-5-5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-047',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M92.9 80.3c-1.7 0-3.1 1.4-3.1 3.1v53.3c0 1.7 1.4 3.1 3.1 3.1h13.8c1.7 0 3.1-1.4 3.1-3.1V83.4c0-1.7-1.4-3.1-3.1-3.1H92.9zM132.4 80.3c-1.7 0-3.1 1.4-3.1 3.1v53.3c0 1.7 1.4 3.1 3.1 3.1h13.8c1.7 0 3.1-1.4 3.1-3.1V83.4c0-1.7-1.4-3.1-3.1-3.1h-13.8zM13.1 69.2L79.7 18l66.6 51.2c3.6 2.7 8.7 2.1 11.4-1.4 2.7-3.5 2-8.6-1.5-11.3L85 1.7c-3.2-2.2-7.4-2.2-10.6 0L3.2 56.4h-.1C-.4 59.1-1 64.2 1.7 67.7c2.8 3.6 7.8 4.2 11.4 1.5zM13.8 80.3c-1.7 0-3.1 1.4-3.1 3.1v53.3c0 1.7 1.4 3.1 3.1 3.1h13.8c1.7 0 3.1-1.4 3.1-3.1V83.4c0-1.7-1.4-3.1-3.1-3.1H13.8zM144.2 149.3H15.5c-7.8 0-14.4 4.2-15.5 9.8-.1.2 159.8.2 159.7 0-1.1-5.6-7.7-9.8-15.5-9.8zM53.3 80.3c-1.7 0-3.1 1.4-3.1 3.1v53.3c0 1.7 1.4 3.1 3.1 3.1h13.8c1.7 0 3.1-1.4 3.1-3.1V83.4c0-1.7-1.4-3.1-3.1-3.1H53.3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-048',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M70.1,63.8a16.2,15.3 0 1,0 32.4,0a16.2,15.3 0 1,0 -32.4,0 M93.4 126.6V115h10.9v-10.5c17.2-6.9 28.4-22.9 28.4-40.5 0-24.3-20.7-44-46.3-44S40 39.7 40 64c0 17.7 11.1 33.6 28.3 40.5V115h11.4v22.4c0 1.2 1 2.2 2.3 2.2h77.6v-12.9H93.4zM53.9 64.1c-.1-16.9 14.4-30.7 32.3-30.8 17.9-.1 32.5 13.6 32.5 30.6s-14.5 30.7-32.4 30.8C68.4 94.7 54 81 53.9 64.1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-049',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M126.2 58.7l-5-2.1-83.8-36.1c-3.7-1.6-7.9.6-9.3 4.9l-9.3 28.5c-1.4 4.3.5 9.1 4.2 10.7l30.7 13.2v18.3l-28.9 22.6V97.6c0-1.5-1.1-2.8-2.4-2.8h-10c-1.3 0-2.4 1.2-2.4 2.8v62h14.9v-20l40.5-31.7c1.4-1.1 2.4-2.7 2.9-4.6.1-.2.1-.4.2-.8 0-.2 0-.3.1-.8V84.2l43.2 18.6 8.3-25.6 29.4-8.3-23.3-10.2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-050',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M37.5 115.3c-7.2 0-13 5.8-13 13s5.8 13 13 13 13-5.8 13-13-5.8-13-13-13zM34.6 150C21 150 10 139 10 125.4V20h49.2v105.4c0 13.6-11 24.6-24.6 24.6zm32.9-92.3l24.2-24.2 34.8 34.8-59 59V57.7zm-11 92.3l49.2-49.2H140V150H56.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-051',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M52.2 82.1c.9-4.8 2.3-9.6 4.2-14.2 6.4-15.8 17.3-28 29.5-34.7-2-1.9-4.4-3.4-7-4.4-4.1-1.6-8.6-2-12.9-1.1-9 10.7-14.6 26.1-14.6 43.2 0 3.8.3 7.5.8 11.2m-32.4 66.5c2.2-6.6 6.9-14.8 13.5-18.9s15-5.6 15-5.6-18.8-15.5-15-62.5c3.8-47.2 46.3-57.1 70.4-49.1s41.7 34.7 34.2 63c-7.6 28.3-37.3 53.5-81.8 52.7 5.5 9.8 7.3 13.3 7.3 13.3s2.2 3.5-2.1 4.6-13.5 2.6-13.5 2.6-2.9.5-2.1-3.1 5.2-15.9 5.2-15.9-11.4.5-18.1 8.2-6.7 11.9-9.3 16.4c-1.1 2-2.4 3.9-3.9 5.6H10c3.7-1.4 7.9-5.8 9.8-11.3" /></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:100},{figure_id:'free-052',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M113.6 87.8H47.4c-2.2 0-4.1 1.8-4.1 4s1.7 4 3.8 4.1c5.6 1.5 15.6 2.5 33.3 2.5 17.7 0 27.8-1.1 33.3-2.5 2.2-.1 3.9-2 3.8-4.2.1-2.2-1.7-3.9-3.9-3.9z M80 10c-38.7 0-70 31.3-70 70s31.3 70 70 70 70-31.3 70-70-31.3-70-70-70zm6.9 45.7c.7-8.1 7.8-14 15.9-13.3 7.1.6 12.7 6.2 13.3 13.3h.1v.8h-.1c-.4 2.3-2.6 3.9-5 3.5-1.8-.3-3.2-1.7-3.5-3.5h-.1c-.3-3.3-3.2-5.8-6.5-5.5-3 .2-5.3 2.6-5.5 5.5h-.1c-.4 2.3-2.6 3.9-5 3.5-1.8-.3-3.2-1.7-3.5-3.5h-.1v-.3c0-.1 0-.3.1-.5-.1 0 0 0 0 0zm-43 0c.7-8.1 7.8-14 15.9-13.3 7.1.6 12.7 6.2 13.3 13.3h.1v.8h-.1c-.4 2.3-2.6 3.9-5 3.5-1.8-.3-3.2-1.7-3.5-3.5h-.1c-.3-3.3-3.2-5.8-6.5-5.5-3 .2-5.3 2.6-5.5 5.5h-.1c-.4 2.3-2.6 3.9-5 3.5-1.8-.3-3.2-1.7-3.5-3.5h-.1v-.3c.1-.1.1-.3.1-.5zm84.7 31.6c-4.4 26.7-29.7 44.8-56.4 40.3-20.7-3.4-36.9-19.6-40.3-40.3-.1-.6-.2-1.5-.2-1.5.1-2.3 2-4 4.3-4h88.4c2.3 0 4.2 1.8 4.3 4 0 .5 0 1-.1 1.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:100},{figure_id:'free-053',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 10c-38.7 0-70 31.3-70 70s31.3 70 70 70 70-31.3 70-70-31.3-70-70-70zm.2 127.8c-31.8 0-57.6-25.8-57.6-57.6s25.8-57.6 57.6-57.6 57.6 25.8 57.6 57.6c0 31.9-25.7 57.6-57.6 57.6z M80 31.9c-26.6 0-48.1 21.5-48.1 48.1s21.5 48.1 48.1 48.1 48.1-21.5 48.1-48.1S106.6 31.9 80 31.9zM50.4 80c-2.7-.1-5.3-.5-7.9-1.3.3-20.8 17.3-37.6 38.1-37.6h.6c.7 2.5 1 5.1 1 7.7-16 2.4-28.9 15-31.8 31.2zm53.7 30.1c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-054',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M128 116c0-5.5-4.5-10-10-10s-10 4.5-10 10v5h-7.5v-5c0-5.5-4.5-10-10-10s-10 4.5-10 10v5H52v-5c0-5.5-4.5-10-10-10s-10 4.5-10 10v5H0v9h32v5c0 5.5 4.5 10 10 10s10-4.5 10-10v-5h28.5v5c0 5.5 4.5 10 10 10s10-4.5 10-10v-5h7.5v5c0 5.5 4.5 10 10 10s10-4.5 10-10v-5h32v-9h-32v-5zM128 25v-5c0-5.5-4.5-10-10-10s-10 4.5-10 10v5H79.5v-5c0-5.5-4.5-10-10-10s-10 4.5-10 10v5H52v-5c0-5.5-4.5-10-10-10s-10 4.5-10 10v5H0v9h32v5c0 5.5 4.5 10 10 10s10-4.5 10-10v-5h7.5v5c0 5.5 4.5 10 10 10s10-4.5 10-10v-5H108v5c0 5.5 4.5 10 10 10s10-4.5 10-10v-5h32v-9h-32zM107 68c0-5.5-4.5-10-10-10s-10 4.5-10 10v5h-7.5v-5c0-5.5-4.5-10-10-10s-10 4.5-10 10v5H52v-5c0-5.5-4.5-10-10-10s-10 4.5-10 10v5H0v9h32v5c0 5.5 4.5 10 10 10s10-4.5 10-10v-5h7.5v5c0 5.5 4.5 10 10 10s10-4.5 10-10v-5H87v5c0 5.5 4.5 10 10 10s10-4.5 10-10v-5h53v-9h-53v-5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-055',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M33.5 146.4c3.3-5.6 8.9-19 13.7-28.9 23.1-7.1 40.7-24.8 53.6-43.8-5.9 1.2-8.7 0-8.7 0l12.4-5.6c2.8-4.6 5.4-9.1 7.8-13.6-4.7.8-9.5.6-14.1-.4l18.8-9c5.2-11.5 9.6-23.1 13-35.1.2-.3-42.7 7.2-65 24-22.2 16.8-32 37.8-33.7 61-.5 7.1-.3 12.2.3 15.9 2.3-7.8 7.4-23.3 16.7-38.5 11.6-18.8 30-36 49.3-44.6-5.2 3.4-22.5 17.4-36.6 37.7s-22.4 44.3-26.8 58.2c-.3.9-.5 1.6-.8 2.2-.3 1.4-.7 2.9-1 4.3-2.2 10.7-2.6 15.1-2.5 16.8.1 2.6 2.7 5.2 15.7-.1 18.5-7.5 55.2-17.2 75.7-10.1 27.9 9.6 14.3-5.7-3.5-8.6-16.2-2.6-32.7-.4-49.5 5.5-16.4 5.8-34.3 11.6-34.8 12.7"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-056',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M122.2 97.1c-24.8 4.2-60.1 1-60.1 1 34.8 11.1 60 8.5 67.6 7.3 6.1 3.6 9.6 7.9 9.6 12.4 0 13.1-28.9 23.7-64.6 23.7-35.8 0-64.7-10.6-64.7-23.7 0-9.9 16.5-18.3 40-21.9-13.8-3.6-22.5-9.2-22.5-15.4 0-7.4 12.5-13.8 31.1-17.3-15.3-2.4-26.2-8.7-26.2-16.1-.1-9.4 17.8-17.1 40-17.1s40.1 7.7 40.1 17.2c-.1 2.6-1.3 5-3.2 6.7h-.2c-.2.3-.5.5-.7.8-1.9 1.6-4.1 3-6.4 4.1-14.2 5.9-41 5.6-41 5.6 26.3 3.8 42.9.9 52-2 21.7 3 37 10 37 18.2 0 6.9-11 13-27.8 16.5"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-057',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M87.8 30l.8 16.8H71.5l.7-16.8H37.4L10 140h57.2l1.6-35.6h22.3l1.6 35.6H150L122.6 30H87.8zM70.9 58.7h18.2l1.3 28.7H69.6l1.3-28.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-058',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M67.6 57.5C64.8 70.4 73.1 83.1 86 85.9c12.9 2.7 25.6-5.5 28.4-18.4 2.8-13-5.5-25.7-18.5-28.4-12.8-2.8-25.6 5.4-28.3 18.4z M108.6 139.4c-31.9-4-47.8-22.9-56-38.9-6-11.7-8.1-24.9-6-37.9 1.1-6.1 4.4-21 18.3-31.6 13.9-10.6 31.1-7.6 36.7-4.6-10.6-11-19-13.9-35.7-16-16-2-50.4 1.7-65.9 39V111c3.2 7.4 7.7 14.3 13.3 20.2 4.7 4.7 18.1 19.7 40.6 27.3h59c11.4-3.2 22.3-8.2 32-15 4.4-3.2 11.5-9.8 15-13.1v-4.8c-5.7 5.4-28.9 16.6-51.3 13.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:10},{figure_id:'free-059',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M49.1 75.7L22.3 89.2c-1.3.7-2.3 2.2-2.3 3.5v66.7h31.4V76.8c0-1.3-1-1.8-2.3-1.1zM93.1 66.6L80 60l-13.1 6.6c-1.3.7-2.3 2.2-2.3 3.5v89.2h30.9V70.2c0-1.3-1.1-2.9-2.4-3.6zM137.7 89.2L111 75.7c-1.3-.7-2.3-.2-2.3 1.1v82.6H140V92.7c0-1.3-1-2.9-2.3-3.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-060',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M147.7 49.7l-37.4-37.4c-3-3-8-3-11 0L80.9 30.7l48.4 48.5 18.4-18.5c3.1-3 3.1-7.9 0-11zM35.8 52.2c-6.5 3-6.9 8.5-6.9 8.5l-19 83.4 37.7-37.7c-4.2-6.4-4.4-14.7-.4-21.3 5.7-9.5 18-12.6 27.5-6.9 9.5 5.7 12.6 18 6.9 27.5s-18 12.6-27.5 6.9L16.8 150l82.5-18.9s5.6-.4 8.5-6.9c2.8-6.2 14.4-36.5 15.4-38.9l.1-.1-48.4-48.4S42.3 49.2 35.8 52.2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-061',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M105.8 71.3H55.1l-7.7 23h66.1zM91.5 30H68.7l-7.8 24.3H100zM131 125.7h-7.2l-4.5-14.4H42l-4.9 14.4h-7.6c-5.1 0-9.4 4-9.4 9.2s4.2 9.3 9.3 9.3h101.4c5.1 0 9.3-4.1 9.3-9.3s-4-9.2-9.1-9.2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-062',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M138.8 61.7l-1.3 1.3L113 87.4l-40.5.1V47L97 22.5l1.3-1.3s-22.1-5.7-40.1 7.2c-18 12.8-21.8 22.5-24.5 33.8C31 73.5 35 88.1 22.3 100.6L0 122.9V160h37.1l22.3-22.3C72 125 86.5 129 97.8 126.2c11.3-2.7 20.9-6.5 33.8-24.5 12.8-18 7.2-40 7.2-40z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-063',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80.5 42.8l45.2 66.6-45.2 14.3V42.8zm-68.1 74.4c.3.2.7.4 1.1.6.2.1.4.2.6.2l53.2 16.3c1.8.5 4.8 1.5 8.1 1.5 3.4 0 5.9-1 7.6-1.6l53-16.2c.2-.1.4-.2.6-.2 2.8-1.1 4.2-4.2 3.1-7-.1-.4-.4-.8-.6-1.1L79.8 22.3c-2-2.6-5.6-3.1-8.2-1.1-.5.4-.9.8-1.2 1.2L11 109.6c-1.7 2.5-1.1 5.9 1.4 7.6 0-.1 0-.1 0 0z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:100},{figure_id:'free-064',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 26.6v-5C91.2 30.3 32.2 64.1 0 99.7V160h46.7c4.7-19.7 12.3-38.6 22.8-56v41.4c0 1.9 2.7 3.4 5.4 3.4s5.1-1.5 5.1-3.4V85.2c3.2-3.9 16.7-16.1 20.2-19.7v47.6c0 1.9 1.9 3.2 4.8 3.2s4.9-1.3 4.9-3.2V55.7c3.3-2.7 12-9.9 20.9-14.7v38.3c0 1.9 2.2 4 4.5 4s5.1-2.1 4.7-4V35.8c7.2-3.7 12.8-6.5 20-9.2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-065',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M69.2 45.9c1.6 3.7 2.8 7.6 3.6 11.5.8-.3 1.6-.5 2.4-.7 14.5-3.6 29.1 5.2 32.7 19.6 1.2-1 4.2-3.4 8.8-7.4 6.9-6.1 11.4-18.5 9-31-1.9-9.9-11.3-25.8-31-27.5-19.7-1.7-32.6 2.1-37 7-4.4 4.9-.5 9.5-.5 9.5s8.5 10.9 12 19zM54.7 82.9c0-7.1 2.8-14 7.9-19.1-1.8-.7-5.1-1.8-9.9-3.4C44 57.6 31 60 21.5 68.5c-7.6 6.7-16.5 22.8-8 40.6s18.3 26.9 24.7 28.2c6.4 1.3 8.4-4.4 8.4-4.4s5.1-12.8 10.3-20c2.4-3.2 5.1-6.2 8.1-8.9-6.6-5.1-10.3-12.9-10.3-21.1z M99.7 82.6c0-10.1-8.2-18.2-18.2-18.2-10.1 0-18.2 8.2-18.2 18.2 0 10.1 8.2 18.2 18.2 18.2 10 .1 18.2-8.1 18.2-18.2z M149.9 105.6c-1-6.4-7-6.5-7-6.5s-13.8-.4-22.3-2.9c-4.6-1.3-9-3.3-13.1-5.8-.2.5-.3 1-.5 1.5-5 14-20.5 21.3-34.5 16.3 0 2 0 5.3.2 9.7.3 9.2 7 20.6 18.2 26.7 8.9 4.9 27 7.8 40.9-6.2 13.8-14 19.1-26.4 18.1-32.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-066',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M129 22.3C113.4 6.7 88.9 5.8 74.3 20.4l-.9.9-1.5 1.5c-11.3 11.9-12.5 30-4.3 44.5L10 124.9l32 32 13.4-13.4-15.6-15.6 7.8-7.8 15.6 15.6 13.4-13.4L61 106.7l23-23.1c14.5 8.1 32.5 6.9 44.5-4.3l1.5-1.5.9-.9c14.5-14.6 13.7-39-1.9-54.6zm-11.1 42.3l-.5.5-.8.8c-8 7.6-21.2 6.8-29.6-1.6-8.4-8.4-9.2-21.6-1.6-29.6l.8-.8.5-.5c8-8 21.5-7.5 30.1 1.2s9.1 22 1.1 30z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-067',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M121.8 123H78.4c-5.9 0-8.3-2.9-8.3-2.9L56.5 106l25.8-5.4v-.1c2.5-.4 4.4-2.5 4.4-5.1 0-2.8-2.3-5.1-5.1-5.1H0V123h22.4s7.5 6.8 16.6 14.6c9.1 7.8 15.6 7.3 15.6 7.3h20c4.4 0 8.8-.5 13.2-1.5l36.5-9.2v-.1c1.1-.3 4.1-2.1 3.9-6.2-.4-5.1-6.4-4.9-6.4-4.9z M132 48.5V19.3h-17.5v12.6L91.1 10l-59 55h18.1v15.1h27.7V65h26.8v47.8h27.8V65H150z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-068',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M73.6 128.3c0-1.5-1.2-2.7-2.7-2.7H55.2c-1.5 0-2.7 1.2-2.7 2.7v31.1h21.1v-31.1z M140 10H58.3c-5 0-9 4-9 8.9v61.8L29 87.3c-5 1.6-9 6.9-9 11.9v60.1h13.5V99.2L92.1 80v79.3h13.5V71.1c0-4.9-4-7.6-9-6L62.8 76.3V23.4h72.6v136H149V18.9c0-4.9-4.1-8.9-9-8.9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-069',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 0C35.8 0 0 35.8 0 80s35.8 80 80 80 80-35.8 80-80S124.2 0 80 0zm0 144c-35.3 0-64-28.7-64-64s28.7-64 64-64 64 28.7 64 64-28.7 64-64 64z M123.3 48.8c-1-1.4-3-1.8-4.5-.8L83.6 72.9c-1.1-.6-2.3-.9-3.6-.9-.6 0-1.2.1-1.8.2L53.1 50.8c-1.3-1.1-3.4-1-4.5.4l-2.1 2.4c-1.1 1.3-1 3.4.4 4.5L72 79.5v.5c0 4 3 7.4 6.9 7.9v45.4H81V87.9c4-.5 7-3.9 7-7.9 0-.3 0-.7-.1-1l35.2-24.8c1.4-1 1.8-3 .8-4.5l-.6-.9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-070',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M134 138H26c-1.7 0-3-1.3-3-3v-18h114v18c0 1.7-1.3 3-3 3zm-17-67.8l20-13.7V111h-20V70.2zM26 44h-3V26c0-1.7 1.3-3 3-3h108c1.7 0 3 1.3 3 3v18H26zm-2.8 67l89.2-61h24l-89.2 61h-24zM43 90l-20 13.7V50h20v40z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-071',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M119.4 57.9L61.1 24.1 80 13l58 34-18.6 10.9zm-19 11.1L80 81 22 47l20.2-11.8L100.4 69zm1.6 19.2v14L121 91V77l17-10v45.8L80 147l-58-34.2V67l58 34.2 22-13z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-072',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M140 46.5L113 75V54.1H86V39.9h27V19l27 27.5zM91 86h11v13h22V86h11c2.8 0 5 2.2 5 5v44c0 2.8-2.2 5-5 5H91c-2.8 0-5-2.2-5-5V91c0-2.8 2.2-5 5-5zm-22 54H25c-2.8 0-5-2.2-5-5V91c0-2.8 2.2-5 5-5h11v13h22V86h11c2.8 0 5 2.2 5 5v44c0 2.8-2.2 5-5 5zm0-66H25c-2.8 0-5-2.2-5-5V25c0-2.8 2.2-5 5-5h11v13h22V20h11c2.8 0 5 2.2 5 5v44c0 2.8-2.2 5-5 5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-073',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M136.7 87.3L125 124.9c-1 .1-2 .1-3 .1-9 0-16.9-3.5-21-8.8-4.1 5.2-12 8.8-21 8.8-9.4 0-17.6-3.8-21.5-9.4-3.9 5.6-12.1 9.4-21.5 9.4-.7 0-1.3 0-2-.1v.1c-.3 0-.6.1-.9.2L22.3 87.3c-.9-3.3.6-6.9 3.6-8.6l50.3-26.8c2.1-1.1 4.6-1.1 6.8 0l50.3 26.8c2.9 1.7 4.3 5.2 3.4 8.6zM108 30.1H80V30H52v23.7l-13 7V24c0-3.3 2.7-6 6-6h70c3.3 0 6 2.7 6 6v37l-13-7.1V30.1zM35 136h2c9.4 0 17.6-3.8 21.5-9.4 3.9 5.6 12.1 9.4 21.5 9.4 9 0 16.9-3.5 21-8.8 4.1 5.2 12 8.8 21 8.8 1 0 2-.1 3-.1v.2c2.8.3 5 3.1 5 6.5 0 3.6-2.5 6.5-5.5 6.5-.2 0-.5 0-.7-.1-.6 0-1.2.1-1.8.1-9 0-16.9-3.5-21-8.8-4.1 5.2-12 8.8-21 8.8-9.4 0-17.6-3.8-21.5-9.4-3.9 5.6-12.1 9.4-21.5 9.4h-1.5c-3 0-5.5-2.9-5.5-6.5 0-3.5 2.2-6.3 5-6.6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-074',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M103,123a13,13 0 1,0 26,0a13,13 0 1,0 -26,0 M34,123a13,13 0 1,0 26,0a13,13 0 1,0 -26,0 M144.6 80c-.1-.3-.3-.7-.5-1l-20.4-31c-1.5-2.2-4.4-4-6.6-4h-16v-8c0-2.2-1.8-4-4-4H20c-2.2 0-4 1.8-4 4v83c0 2.2 1.8 4 4 4h6c0-11.6 9.4-21 21-21s21 9.4 21 21h27c0-11.6 9.4-21 21-21s21 9.4 21 21h4c2.2 0 4-1.8 4-4V80h-.4zM101 77V51h12.2a7 7 0 0 1 5.2 3.1L133.8 77H101z" /></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-075',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M109.5 122h12c2.7 0 4.5-2.3 4.5-5V57l8.2-.1c2.7 0 4.8-2.2 4.8-4.8 0-.8-.2-1.7-.6-2.4l-18.7-32.3c-1.3-2.3-4.3-3.1-6.6-1.8-.7.4-1.3 1-1.8 1.8L92.6 49.7c-1.3 2.3-.5 5.2 1.8 6.6.7.4 1.6.6 2.4.6l8.2.1v60c0 2.7 1.8 5 4.5 5zm-70 0h12c2.7 0 4.5-2.3 4.5-5V57l8.2-.1c2.7 0 4.8-2.2 4.8-4.8 0-.8-.2-1.7-.6-2.4L49.7 17.4c-1.3-2.3-4.3-3.1-6.6-1.8-.7.4-1.3 1-1.8 1.8L22.6 49.7c-1.3 2.3-.5 5.2 1.8 6.6.7.4 1.6.6 2.4.6l8.2.1v60c0 2.7 1.8 5 4.5 5zM147 135.4v7.2c0 1.3-1 2.4-2.3 2.4H15.3c-1.3 0-2.4-1.1-2.3-2.4v-7.2c0-1.3 1-2.4 2.3-2.4h129.3c1.4 0 2.4 1.1 2.4 2.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-076',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 72.6L113 93l31 25-57.1 42H13.2l30.1-14.5C34 123.9 16 117.6 12.5 97.9 9.1 78.3 22.7 59 42.7 57.2 61.3 55.3 78 68.9 79.8 87.6c.1 1.1.2 2.2.2 3.3 0 24.3-19.1 30.1-29.9 51.4L109 114 85 95l38.6-16.8C116.9 62.5 104 58 101.4 43.7s7.3-28.2 21.7-29.6c13.5-1.3 25.5 8.6 26.8 22.1.1.8.1 1.6.1 2.4 0 17.8-13.9 21.9-21.6 37.5L160 62.4v10.2zM63.9 90.9c0-9.9-8-18-17.9-18-9.9 0-18 8-18 17.9 0 9.9 8 18 17.9 18h.1c9.9 0 17.9-8 17.9-17.9zm74.5-52.3c0-7.1-5.8-12.9-13-12.9-7.1 0-12.9 5.8-12.9 13 0 7.1 5.8 12.9 12.9 12.9 7.2 0 13-5.8 13-13z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-077',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M145.6 122.1h-4.4c-.6-19.4-16.9-34.7-36.3-34.1-18.6.6-33.5 15.5-34.1 34.1H41.3c-1.3 0-2.6-.6-3.4-1.6-.8-1-1.2-2.3-.9-3.6l17.9-92.4c.4-2.1 2.2-3.6 4.3-3.6h45.2c1.8 0 3.5 1.2 4.1 2.9l16.2 44.8c.6 1.7 2.3 2.9 4.1 2.9h4.1c9.5.1 17.1 7.8 17.1 17.3v28.8c0 2.6-2 4.5-4.4 4.5zm-36.4-66.3L102.5 33c-.3-1.1-1.3-1.8-2.4-1.8h-35c-1.2 0-2.3.9-2.5 2.1l-3.8 22.8c-.2 1.4.7 2.7 2.1 2.9h45.9c1.4 0 2.5-1.1 2.5-2.5 0-.3 0-.5-.1-.7zM30.4 52H0V39h30.4c3.6-.1 6.6 2.7 6.8 6.2S34.5 51.8 31 52h-.6zM0 91h16.4c3.6 0 6.5 2.9 6.5 6.5S20 104 16.4 104H0V91zm0-26h23.4c3.6 0 6.5 2.9 6.5 6.5S27 78 23.4 78H0V65zm106 32.9c14.1 0 25.6 11.4 25.6 25.5S120.2 149 106.1 149s-25.6-11.4-25.6-25.5v-.1c0-14.1 11.4-25.5 25.5-25.5zm0 38c6.9 0 12.4-5.5 12.5-12.4 0-6.9-5.5-12.4-12.4-12.5s-12.4 5.5-12.5 12.4c0 6.9 5.5 12.5 12.4 12.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-078',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M131.8 57.6c-.2.3-.5.4-.8.4H86.1c-.6 0-1.1-.5-1.1-1.1V18.1c0-.6.5-1.1 1.1-1.1h37c.5 0 .9.4 1 .9l7.9 38.8c.1.3 0 .6-.2.9zm-57.9.4H29c-.3 0-.6-.1-.8-.4-.2-.3-.3-.6-.2-.9l7.9-38.8c.1-.5.5-.9 1-.9h37c.6 0 1.1.5 1.1 1.1v38.8c0 .6-.5 1.1-1.1 1.1zM29.1 68H131c.6 0 1.1.5 1.1 1.1V142c0 .6-.5 1.1-1.1 1.1h-24v-22h6c1.5 0 2.8-1.2 2.8-2.8 0-.6-.2-1.1-.5-1.6l-11.6-20.1c-.8-1.4-2.6-1.9-4.1-1.1-.5.3-.8.6-1.1 1.1l-11.5 20c-1.1 2-.3 4.4 2 4.4h6v22H64v-22h6c1.5 0 2.8-1.2 2.8-2.8 0-.6-.2-1.1-.5-1.6L60.7 96.5c-.8-1.4-2.6-1.9-4.1-1.1-.5.3-.8.6-1.1 1.1L44 116.6c-1.1 2-.3 4.4 2 4.4h6v22H29.1c-.6 0-1.1-.5-1.1-1.1V69.1c0-.6.5-1.1 1.1-1.1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-079',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M135 88h-9V59h9c1.1 0 2 .9 2 2v25c0 1.1-.9 2-2 2zm-5 27v10c0 2.8-2.2 5-5 5h-3v9c0 2.8-2.2 5-5 5h-9c-2.8 0-5-2.2-5-5v-9H56v9c0 2.8-2.2 5-5 5h-9c-2.8 0-5-2.2-5-5v-9h-3c-2.8 0-5-2.2-5-5v-10c0-2.8 2.2-5 5-5h4V21c0-2.8 2.2-5 5-5h74c2.8 0 5 2.2 5 5v89h3c2.8 0 5 2.2 5 5zm-25 1c4.4 0 8-3.6 8-8s-3.6-8-8-8-8 3.6-8 8 3.6 8 8 8zm-50 0c4.4 0 8-3.6 8-8s-3.6-8-8-8-8 3.6-8 8 3.6 8 8 8zM44 74c0 1.1.9 2 2 2h67c1.1 0 2-.9 2-2V52c0-1.1-.9-2-2-2H46c-1.1 0-2 .9-2 2v22zM23 86V61c0-1.1.9-2 2-2h9v29h-9c-1.1 0-2-.9-2-2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-080',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M145.8 51.1l-.8 1.6-42-19.4.8-1.6c3.1-6.5 10.7-9.4 17.4-6.6l2.5-5.3 18.5 8.5-2.5 5.3c6.4 3.2 9.1 11 6.1 17.5zm-9 19.1l-2.7 5.8-42-19.4 2.7-5.8 2.7-5.8 2.7-5.8 42 19.4-2.7 5.8-2.7 5.8zm-7.1 15.3c-1.2 2.5-4.2 3.6-6.7 2.4l-.6-.3-6.4 4.5-24.6-11.3-.7-7.7-.6-.3c-2.5-1.2-3.6-4.1-2.5-6.7l1.7-3.7 42 19.4-1.6 3.7zm-11.7 32l-14.5 15.4h-6.3v2.7l-10 5.4H72.8l-10-5.4v-2.7h-6.3L42 117.5v-17.2l38-18 38 18v17.2zm-38-16.7c-7 0-12.6 5.7-12.5 12.7 0 7 5.7 12.6 12.7 12.5 6.9 0 12.5-5.7 12.5-12.6 0-6.9-5.7-12.6-12.7-12.6zm-10.2-28l-.6.3-.7 7.7L44 92.2l-6.4-4.5-.6.3c-2.5 1.2-5.5.1-6.7-2.4l-1.7-3.7 42-19.4 1.7 3.7c1.2 2.5.1 5.5-2.5 6.6zM62.4 45l-2.7-5.8-42 19.4 2.7 5.8 2.7 5.8 2.7 5.8 42-19.4-2.7-5.8-2.7-5.8zm-48.2 6.1c-3-6.5-.3-14.3 6.1-17.5l-2.5-5.3 18.5-8.5 2.5 5.3c6.6-2.8 14.3.1 17.4 6.6l.8 1.6-42 19.4-.8-1.6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-081',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M148.9 60c-.7 2.9-5.9 3.7-7.2 3.7s-2 .6-1.5 2.6 2.5 2.4 4.2 11.4S146 129 146 129c-.3 2.7-2.2 5-5 5h-18c-2.8 0-5-2.2-5-5v-14.1c-11.1 1-24 1.3-32.9 1.4v.1H74.8v-.1c-8.8-.1-21.8-.5-32.9-1.4V129c0 2.8-2.2 5-5 5H19c-2.8 0-4.7-2.3-5-5 0 0-.1-42.3 1.6-51.3s3.8-9.4 4.2-11.4-.3-2.6-1.5-2.6-6.5-.9-7.2-3.7 2.4-5.6 7.5-7.7 5.1 4.4 5 5.6-.2 3.4 1 2.2 4.1-7.4 5.5-9.9S40 31.3 45.4 28.3s7-2.2 8.7-2.2h52c1.6 0 3.3-.7 8.7 2.2s14 19.5 15.3 21.9 4.3 8.6 5.5 9.9 1.1-.9 1-2.2-.1-7.7 5-5.6 8 4.8 7.3 7.7zM21.7 73.4c-1.1 6 2 8.5 2 8.5 3 2.8 7.5 3.1 12 3.3 4.5.1 14.4-1.3 18.8.4-5.5-4.7-11.3-9.1-17.4-13-5.5-3.6-14.3-5.2-15.4.8zm97.8-19.5l-9.8-17.4s-1.3-2.5-5.2-2.5h-48c-3.9 0-5.2 2.5-5.2 2.5l-9.8 17.4c-2 3.6-1.6 5.1-1 6s3.6 1.2 8.3 1.5c16.9 2.2 47.2 1.8 63.4 0 4.7-.4 7.7-.6 8.3-1.5s1.1-2.3-1-6zm19 19.5c-1.1-6-9.9-4.3-15.2-.9-6.1 3.9-11.9 8.2-17.4 13 4.3-1.7 14.3-.3 18.7-.4s9-.4 12-3.2c-.1 0 3-2.5 1.9-8.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-082',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M136.4 119.1c1.2-8.3-4.2-32.2-28-33.4S82.2 102.4 57.2 103c-25.5.6-43.3-24.4-54.7-44-.9-1.5-1.7-3-2.5-4.5V23.9c9.8 5.4 19.3 15 27.4 30.9 17.9 35.1 44.7 19.7 44.7 19.7s-22.6-1.3-33.4-22c-12.4-24-25.3-32.4-25.3-32.4S24.6 21.3 47.6 41c26.2 22.5 59 10.1 84 29.2s4.8 48.9 4.8 48.9zM0 78.6c1.7 2.5 3.4 4.9 5.2 7.4 22.9 32.1 62.7 27.9 62.7 27.9-21.8 7.6-44.8 11-67.9 10V78.6zM105.7 93c13 0 23.6 10.6 23.6 23.6 0 13-10.6 23.6-23.6 23.6s-23.6-10.6-23.6-23.6c0-13.1 10.5-23.6 23.6-23.6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-083',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M44.2 146.4c-4.4-15-16.3-26.7-31.4-30.8l59.1-46.4C66.2 64.9 37.3 45 0 47.9V0h35c24.5 6.8 43.2 19.3 55 28 9.2 6.8 14.2 11.1 16.9 13.8l50.5-39.6L44.2 146.4zM36 159.5v.5H0v-36h.5c19.6 0 35.5 15.9 35.5 35.5zm99.4-77.6l-23.9 18.3c-2.2-4-4.7-7.9-7.2-11.6l20.4-26c4 6.2 7.6 12.6 10.7 19.3zm13.5 46.8l-23.3 6.5c-2.3-8.6-5.3-17-9-25l23.3-17.8c4.2 11.7 7.3 23.9 9 36.3zm1.3 31.3h-19.9c-.6-4.8-1.3-9.5-2.2-14.1l21.9-6.2c.5 6.8.6 13.6.2 20.3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-084',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M19 53s19.6-25 49-30 69-5 69-5-2.5 35-118 35zm141 8.8V100c-9 4.2-18.4 7.7-28 10.5-5.8 14.9-22.6 22.4-37.5 16.6-3.6-1.4-6.8-3.5-9.6-6.1-4.7 18.5-23.4 29.7-41.9 25-10-2.5-18.4-9.4-22.8-18.8-6.4.3-13.2.6-20.2.8v-26.8c16.5-12.7 39.4-26 66.6-30.6 30.3-5.2 66.3-7.7 93.4-8.8zM105 115c8.3 0 15-6.7 15-15s-6.7-15-15-15-15 6.7-15 15 6.7 15 15 15zM52 93c-11 0-20 9-20 20s9 20 20 20 20-9 20-20-9-20-20-20z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-085',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 49.8c-15.4.2-47.4-2.9-70-6.8v-.6c10.5-7.8 26.9-20.7 38-21.8 7.2-.7 19.9-.4 32 .4v28.8zm-17.7 4.9c5.8 1 11.8 1.5 17.7 1.7v36.8c-.6-2.8-1.5-5-3-6.3-6.8-6-18.3 1.3-25.5 15.8s-7.2 33.7-12.7 33.2S92 144 72.5 141s-48-10.7-53.9-20-.8-7.7-.8-7.7c16 10.2 57.2 18.7 64.4 17.5s3-6-2.1-6.4-31-4.7-48.8-11.1-20.7-11.9-21.2-20c-.4-6.3 1.6-7.9 1.6-7.9.1-.1.1-.2.2-.4.2-.3.3-.7.5-1 .2-.4 1-3.3 1.7-2.8l1 1 .1.1.2.2c.1.1.3.3.5.4l.1.1c.2.1.3.3.5.4l.2.2c.2.1.4.2.6.4.1 0 .1.1.2.1l.9.6c1.2.7 2.4 1.2 3.7 1.4.8 0 1.6-.1 2.4-.2.8-.1 1.4-.6 1.7-1.3.4-.6.6-1.4.4-2.1v-.1c0-.3-.1-.5-.2-.8 0-.1-.1-.1-.1-.2-.1-.2-.2-.5-.3-.7-.1-.1-.2-.2-.2-.3-.1-.2-.2-.4-.4-.6s-.3-.4-.5-.7c-.1-.1-.2-.2-.3-.4-.3-.4-.7-.7-1.1-1.1L19.9 74c-.4-.3-.6-.7-.8-1.1 0-.3.1-.7.3-.9 12.3-10.4 33.3-14.3 50.7-19.7 2.8-.7 5.5-1.6 8.2-2.7 0 0 3.1-1.4 8.9-.8 8.8 1 22.7 3.6 35.8 4.8 7.5.7 14.7 1 19.3 1.1zm-37.6 35.4c-9.3.6-16.3-.6-27.6 3.2-11.9 3.9-.8 7.7-.8 7.7s19.5 7.7 37.4-2.1c0-.1.4-9.5-9-8.8zm26.7 36.5c3.2-12.6 6.6-25.9 16.1-35.1.6-.4 1.2-.8 1.8-1.1l.8-.4c2.5-.9 7.3-2.5 9.9 5.3v31.1c-.7 3.2-1.7 6.3-2.7 9.5-4.8 9.2-11.4 11.3-20.3 11.1-3.6-.2-12.3-1-15.7-8 .4-.1.8-.2 1.2-.2 3.2-.2 5.7.4 8.9-12.2zm21.3 9.3c2.2.2 4.9-8.1 5.9-18.5s.1-19.1-2.1-19.3-4.9 8.1-5.9 18.5-.2 19.1 2.1 19.3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-086',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M130.5 87.5l15.5 7.8-8 18.7-1.2 2.9-16.4-5.8c-2.7 3.4-5.8 6.5-9.2 9.2l5.8 16.4-3 1.3-18.7 8-7.8-15.5c-5 .7-10.1.7-15.1 0L64.6 146 43 136.8l5.8-16.4c-1.7-1.3-3.4-2.8-4.9-4.3-1.5-1.5-3-3.2-4.3-4.9L23.2 117 14 95.4l15.5-7.8c-.7-5-.7-10.1 0-15.1L14 64.6 23.2 43l16.4 5.8c1.3-1.7 2.8-3.4 4.3-4.9 1.5-1.5 3.2-3 4.9-4.3L43 23.2 64.6 14l7.8 15.5c5-.7 10.1-.7 15.1 0L95.4 14l21.6 9.2-5.8 16.4c1.7 1.3 3.3 2.8 4.9 4.3 1.5 1.5 3 3.2 4.3 4.9l16.4-5.8 9.2 21.6-15.5 7.8c.7 4.8-1.8 10 0 15.1zM80.5 55C66.4 55 55 66.4 55 80.5S66.4 106 80.5 106 106 94.6 106 80.5 94.6 55 80.5 55z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-087',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M96.7 82.1l32-22.7c1.7 17.7-6.7 36.8-18 53.1-15.2-4.1-50.7-14.7-76.2-29-1.2-3.6-2.2-7.3-2.9-11.1-4.6-26.7 13.2-52 39.9-56.7 10.6-1.8 21.5-.1 31.1 4.8l-33 23.4L72 70.4l24.7 11.7zm13.5 31.1c-6 8.5-12.8 16.3-20.4 23.5-10.3 9.7-9.3 9.8-19.7-.1-11.3-10.9-20.8-23.3-28.4-37.1 21.9 5.5 45.6 10.3 68.5 13.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-088',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M12.5 11.4C26.9 42.2 37.7 51 47.3 58.1S80.1 66 83 56.2 69.7 27.3 38.3 19.9c15.8-.1 44.9 10.5 66.9 34.5 22.8 24.9 21.9 43.9 22.7 54.8 1.3 17.8 5.7 26.4 17.4 31 5.2 2.2 11.2.7 14.7-3.7V160H97.4c-5.3-7.6-8.7-16.4-10.1-25.6 6.9 8.1 24.4 4.7 17.5-15.2s-30.4-2.7-62-14.9c-19.2-7.2-34.7-22-42.8-41V0h4.9c3.1 3.4 5.6 7.3 7.6 11.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-089',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 17c-35.1-.1-64.1 27.2-64 62.9.1 35.1 28.8 64.2 64 64.1 35.4-.1 64-28.8 64-64.2v-.3C143.9 44.1 115.3 17 80 17zm-9.8 105.5c-3.7 3.8-8.7 2.7-13 1.4-9.6-3-19.7-16.5-20.1-26.1-.3-8.3 5.3-17.4 13-13.8 9.3 4.4 16.1 16.6 20.7 25.6 2.2 4.3 3.1 9-.6 12.9zm20.7-13c4.6-8.9 11.4-21.2 20.7-25.6 7.7-3.6 13.3 5.5 13 13.8-.3 9.7-10.5 23.2-20.1 26.1-4.3 1.3-9.3 2.4-13-1.4-3.8-3.8-2.9-8.5-.6-12.9zm-11-18c-6.1-.1-10.9-5.1-10.8-11.1.1-6.1 5.1-10.9 11.1-10.8h.1c6.1.2 10.8 5.3 10.5 11.4-.2 5.9-5 10.5-10.9 10.5zm43.4-20.1c-28.3-19.6-53.6-19.2-87.5.3-3.7 1.1-4.1-.6-3.7-3.6C35 46.8 56.9 31.7 79.2 31.7s45.5 16.3 48.6 35.8c.7 2.5.6 7.4-4.5 3.9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-090',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M139 83.2c0 33-26.8 59.8-59.8 59.8C48.3 143 23 119.1 20 89h9c3 25.1 24.4 44.9 50.2 44.9 27.9 0 50.6-22.6 50.7-50.5C130 57.6 110.6 35.9 85 33v-9c30.6 2.8 54 28.5 54 59.2zM79 47c.1 0 .1-29 0-29-35.9.1-64.9 29.1-65 65h29c0-19.9 16.1-36 36-36-.1 0 0 0 0 0zM67.1 29.4c2.5 0 4.6 2 4.6 4.6 0 2.5-2 4.6-4.6 4.6-2.5 0-4.6-2-4.6-4.6 0-2.5 2-4.6 4.6-4.6zM30 74.9c-2.5 0-4.6-2-4.6-4.6 0-2.5 2-4.6 4.5-4.6s4.6 2 4.6 4.5c.1 2.7-2 4.7-4.5 4.7zM79 110c-14.9 0-27-12.1-27-27s12.1-27 27-27 27 12.1 27 27-12.1 27-27 27zm0-36c-5 0-9 4-9 9s4 9 9 9 9-4 9-9-4-9-9-9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-091',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80 8C40.2 8 8 40.3 8 80s32.2 72 72 72 72-32.2 72-72S119.7 8 80 8zm50.4 50.5c1.3 3 2.2 6 3 9.2l-17.3 4.1-11.2.8-.4-1.2 9.5-6 16.4-6.9zm-39-32.1c15.2 3.2 28.3 12.8 36.1 26.2l-16.2 4.9-8.3 3.4-7.9-1.5-4.1-7 .7-9-.3-17zM97 87.6c-1.6 1.1-3.7.8-4.8-.8-1.1-1.6-.8-3.7.8-4.8 1.5-1.1 3.7-.8 4.8.8 1.1 1.5.7 3.7-.8 4.8zM88.1 64c1.8-.6 3.8.4 4.4 2.2.6 1.8-.4 3.8-2.2 4.4-1.8.6-3.8-.4-4.4-2.2s.4-3.8 2.2-4.4zM80 25.2c1.6 0 3.2.1 4.8.2l-1.4 17.7L80.7 54h-1.3l-2.7-10.9-1.4-17.7c1.5-.1 3.1-.2 4.7-.2zM80 72c4.4 0 8 3.6 8 8s-3.6 8-8 8-8-3.6-8-8 3.6-8 8-8zm2.8 25.7c-1.1 1.6-3.3 1.9-4.9.8-1.6-1.1-1.9-3.3-.8-4.8 1.1-1.6 3.3-1.9 4.8-.8 1.7 1.1 2.1 3.3.9 4.8zm-8.6-30.4c0 1.9-1.6 3.5-3.5 3.5s-3.5-1.6-3.5-3.5 1.6-3.5 3.5-3.5 3.5 1.6 3.5 3.5zm-5.8 18.6c-.6 1.8-2.6 2.8-4.4 2.2-1.8-.6-2.8-2.6-2.2-4.4.6-1.8 2.6-2.8 4.4-2.2 1.8.7 2.8 2.6 2.2 4.4zm.2-59.5l-.3 17 .7 9-3.9 7.1-8 1.5-8.4-3.4-16.2-4.9c7.8-13.5 20.9-23.1 36.1-26.3zm-39 32.2L46 65.4l9.5 6-.4 1.2-11.2-.8-17.3-4.1c.7-3.1 1.7-6.2 3-9.1zM25.2 80c0-1.9.1-3.8.3-5.7l16.1 5.6 8.8 2.1 5.5 5.9-1 8-5.9 6.9-9.7 13.9C30.2 106.6 25.2 93.5 25.2 80zM44 121.3l11.5-13.4 8.6-7.2 1.1.8-4.2 10.4-9.2 15.1c-2.7-1.7-5.3-3.6-7.8-5.7zm36 13.5c-7.7 0-15.3-1.6-22.3-4.8l10.2-13.6 4.7-7.7 7.3-3.4 7.3 3.4 4.8 7.7 10.2 13.5c-6.9 3.3-14.5 4.9-22.2 4.9zm28.2-7.8L99 111.8l-4.2-10.4 1.1-.8 8.6 7.2 11.6 13.4c-2.6 2.2-5.2 4.1-7.9 5.8zm12.5-10.3l-9.7-13.9-5.8-6.9-1-8 5.5-5.9 8.8-2.1 16-5.5c.2 1.9.3 3.8.3 5.7 0 13.4-5 26.5-14.1 36.6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-092',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#000" fill-rule="evenodd" d="M79.078 0c-11.18 8.226-59.431 49.054 0 103.333h1.844c59.431-54.28 11.18-95.107 0-103.333h-1.844zM.385 105.663c-.867-10.381 0-15.286 0-15.286S80 80.654 80 159.99c-21.146.494-75.916-17.048-79.615-54.327zm159.23 0c.867-10.381 0-15.286 0-15.286S80 80.654 80 159.99c21.146.494 75.916-17.048 79.615-54.327z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-093',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80,0C35.8,0,0,35.8,0,80s35.8,80,80,80s80-35.8,80-80S124.2,0,80,0z M100,125H60l13.6-52.4C65.7,70,60,62.8,60,54.3C60,43.6,69,35,80,35s20,8.6,20,19.3c0,8.5-5.7,15.7-13.6,18.3L100,125z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-094',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#000" fill-opacity=".98" fill-rule="evenodd" d="M34.098 82.523c5.501-38.51 43.02-27.508 43.02-49.514 0-22.006 11.995-22.006 11.995-22.006L94.614 0s0 11.003 5.502 11.003c5.501 0 22.006 5.502 22.006 16.505S111.119 38.51 111.119 38.51s5.501 27.507-5.502 38.51c-11.003 11.003-11.003 33.01 0 38.51 11.003 5.502-.66 14.208-.66 14.208H42.66c-.872 2.07-1.433 4.045-1.618 5.85-.989 9.6 32.177-2.034 38.915 4.411 6.737 6.445-5 10-15 10s-36.765 2.959-34.86-15.538c.451-4.386 2.058-8.817 4.475-13.227-3.224-7.605-3.167-19.864-.474-38.712z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-095',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#000" fill-rule="evenodd" d="M48.151 128.159s-5.326-32.04 15.978-48.06c21.305-16.02 26.631-10.68 37.283-37.38C112.065 16.02 117.391 0 117.391 0l5.326 10.68 10.652-5.34s-5.326 10.68 5.326 16.02C149.348 26.7 160 26.7 160 37.38s-26.63 10.68-26.63 10.68 5.325 26.7 0 42.72C128.042 106.798 140 149.517 150 150c-10.652-.482-15 0-15 0s-12.283-11.161-17.61-32.521C112.066 96.119 105 130 105 130s-5.652 8.839 5 8.839c10.652 0 12.717 11.161 12.717 11.161H69.456s-10.653-16.501-21.305-5.821c-10.652 10.68-31.957 5.34-42.61-5.34-10.651-10.68-5.325-26.7 10.653-10.68 15.979 16.02 31.957 0 31.957 0z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-096',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#000" fill-rule="evenodd" d="M153.634 20.555h-11.326V6.6c0-3.655-2.862-6.6-6.367-6.6H24.08c-3.526 0-6.388 2.945-6.388 6.6v13.955H6.366C2.841 20.555 0 23.5 0 27.155V49.13c0 3.655 2.84 6.605 6.366 6.605s6.367-2.95 6.367-6.605V33.755h4.96v102.762c0 3.655 2.861 6.606 6.387 6.606h1.306V153.4c0 3.633 2.862 6.6 6.388 6.6h13.173c3.526 0 6.367-2.967 6.367-6.6v-10.277h57.372V153.4c0 3.633 2.84 6.6 6.367 6.6h13.19c3.504 0 6.37-2.967 6.37-6.6v-10.277h1.328c3.505 0 6.367-2.951 6.367-6.606V33.755h4.954V49.13c0 3.655 2.846 6.605 6.372 6.605 3.525 0 6.366-2.95 6.366-6.605V27.155c0-3.655-2.84-6.6-6.366-6.6zM43.87 130.67c-6.101 0-11.055-5.142-11.055-11.46 0-6.342 4.954-11.462 11.055-11.462 6.116 0 11.055 5.12 11.055 11.461 0 6.32-4.939 11.46-11.055 11.46zm72.218 0c-6.117 0-11.055-5.142-11.055-11.46 0-6.342 4.938-11.462 11.055-11.462 6.101 0 11.055 5.12 11.055 11.461 0 6.32-4.954 11.46-11.055 11.46zm13.46-103.516v58.658H30.446V13.2h99.102v13.955z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-097',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M89 145.2v-11.3l45 2.5v11.4l-45-2.6zm0-35.1l45 4.6V125l-45-3.4v-11.5zm0-22.8l45 5.7v10.3l-45-4.6V87.3zm0-22.7l45 7.9v10.3L89 76V64.6zm0-23.1l45 9.4v10.3l-45-8.3V41.5zM80 25v135H19V37.9L32 35l48-10zM26 147.8l45-2.6v-11.3l-45 2.5v11.4zm0-22.8l45-3.4v-11.4l-45 4.6V125zm0-21.7l45-4.6V87.4l-45 5.7v10.2zm0-20.5L71 76V64.7l-45 7.9v10.2zm0-31.9v10.3l45-8.3V41.5l-45 9.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-098',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 160h-10v-43.2c0-.7-.4-1.3-1-1.5l-9.3-4c-.5-.2-1.1-.2-1.6.1-.6.4-1 1-1.1 1.6v47h-6v-52c0-.7-.6-.9-1.2-1.1l-10.4-4.5c-.5-.2-1.1-.2-1.6.1-.5.4-.8.9-.8 1.5v56h-8V99c-.2-.8-.8-1.5-1.6-1.9l-12.6-5.5C93.7 91.1 92 90 92 93v67H68V93c0-3-1.7-1.9-2.9-1.4l-12.6 5.5c-.8.4-1.3 1.1-1.6 1.9v61h-8v-56c0-.6-.3-1.2-.8-1.5-.5-.3-1.1-.4-1.6-.1l-10.4 4.5c-.6.3-1.2.5-1.2 1.1v52h-6v-47c-.1-.7-.5-1.3-1.1-1.6-.5-.3-1.1-.4-1.6-.1l-9.3 4c-.6.3-1 .9-1 1.5V160H0v-58.4c.3-.2.7-.4 1-.6l6-2V85c-.1-1.8.7-3.5 2.2-4.5L48 59V47c.1-1.5.6-3 1.6-4.2.5-.5 10.8-11.4 24.4-13.8V14c0-2.8 2.7-6 5.5-6 .3.1.7.1 1 0 2.8 0 5.5 3.2 5.5 6v15c13.6 2.4 23.9 13.3 24.4 13.8 1 1.2 1.5 2.6 1.6 4.2v12l38.8 21.5c1.5 1 2.4 2.7 2.2 4.5v14l6 2c.3.2.7.4 1 .6V160z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-099',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M72 132H41v-31h31v31zm88 27.1L56.3 56 0 112.2v-32L56.7 23 99 38v17l12 13V20l23 8v25l26 25.9v80.2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-100',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M73.3 62.8c-10.8 0-19.5 8.7-19.5 19.5s8.7 19.5 19.5 19.5 19.5-8.7 19.5-19.5c0-10.7-8.7-19.5-19.5-19.5zM133 24c0-1.9-1.1-4-3-4h-19c-1.9 0-3 2.1-3 4v1l25 17V24z M152 67L84.9 19.4c-2.7-1.8-6.2-1.8-8.8 0L9 67v18h11v53c0 2.1 1.6 3.8 3.7 4h113.6c2 0 3.6-1.6 3.6-3.6L141 85h11V67zm-33 61c-4 4-10.5 4-14.5 0l-16-16c-16.4 8.4-36.5 1.9-44.8-14.5-8.4-16.4-1.9-36.5 14.5-44.9C62.9 50.2 68 49 73.3 49c18.4 0 33.3 14.9 33.3 33.3 0 5.3-1.3 10.5-3.7 15.2l16 16.1c4.1 3.9 4.1 10.4.1 14.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-101',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M91 97V66H69v31l-51 51V74.9l8.5-8.5L75 18.1c2.8-2.7 7.2-2.7 10 0l5.9 5.9 42.6 42.5L142 75v73L91 97z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-102',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M93 51c4.8-3.9 8.8-8.6 12-13.8 7.1-12.2 8.1-24.8 2.3-28.3-1-.6-2.2-.9-3.3-.9-5.9 0-14.1 6.6-20 16.7-1.8 3.2-3.3 6.6-4.4 10.1-1.1-3.5-2.6-6.9-4.4-10.1C69.2 14.6 61 8 55.1 8c-1.2 0-2.3.3-3.4.9C46 12.3 47 25 54.1 37.2 57.3 42.8 64.8 48.6 68 51H29v35h43V55h17v31h42V51H93zM71 41c-1.6-.2-6.3-3.7-9.7-9.7-3.5-6.2-3.6-11.1-3-12.3 1.5.1 5.5 2.8 8.9 8.8 2.2 4 3.6 8.6 3.8 13.2zm15 3c.2-3.4.9-6.8 2-10-2.2 6.3 5.2-15.1 14-16 .7 1.5 0 7.4-4.3 15-4.2 7.4-10 10.8-11.7 11zm3 93H72V96H29v47h102V95.9H89V137z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-103',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M126 31c-6.5 0-7.3 3.5-6 6 7.1 10 12.4 21.3 15.4 33.2 4.1 15.5-2.1 25.5-10.2 31.2-6 4.2-4.6 1.1-5.1 4.3-3.1 21.5-34.7 24.6-39 24.9-3.6.2-4.8 18.9-8.1 22.8l-1.2 6.6h-7.5l2.5-19c-3.1-2.9-4.8-9.9-5-11.4-.2-2-.8-3.7-5-3.8-12.6.1-18-20-20.7-15.6-17.1 28.7-21 16-21.1 7.8-8.9 5.9-9.6-1.5-6-8-7.9.5-5.7-4.9 1-8-11.1-15.3 18.4-13.6 25.2-5.7 2.7.1 5.5-6.9 8.1-10.5 8.9-13.7 21.6-17.2 34.8-15.7 21.4 2.4 18.4 17.7 33 17.8 4.7 0 10.9-3.6 8.3-16.2-2.5-12.6-13.8-41.2-14.1-46.6s1.8-14.5 13-14.1 8.7 5.8 15.6 9.8c6.9 4 13.4 4.7 13 7.6S132.5 31 126 31z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-104',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 127c-13.8 11-33.9 8.8-45-5-4.5-5.7-7-12.7-7-20 0-10.2 4.9-19.7 13.2-25.5l-4.4-9.7-28.3 28.5c.5 1.1.9 2.3 1.1 3.5 1.9 9.2-4 18.2-13.2 20.1h-.1C68.1 120.6 60 115.5 57 108h-5c-3.3 15.1-16.5 25.8-31.9 26-7.3 0-14.4-2.5-20.1-7v-24.2C.1 113.4 9.9 122 20.6 122c8.6 0 13.8-6.1 16.4-14H18c-2.3 0-2.9-.9-4-3-1.1-1.9-1-4.3.3-6.1l10.4-15.2c-1.7-.4-3.4-.7-5.1-.7C8.9 83 .2 91.5 0 102.2V77.6c9.2-7.3 21.7-9.1 32.6-4.5l12.1-17.5-5.9-13.4h-6.4c-3.3.2-6.2-2.4-6.3-5.8-.2-3.3 2.4-6.2 5.8-6.3H55.8c3.3-.2 6.2 2.4 6.3 5.8.2 3.3-2.4 6.2-5.8 6.3h-3.6l3.3 7.9h53.2L104 38h-8c-3.3 0-6-2.7-6-6s2.7-6 6-6h11.9c2.5 0 4.7 1.4 5.7 3.7l19 41.7c2.3-.5 5.8-1.5 8.3-1.4 6.9.2 13.6 2.6 19 7l.1 50zM35.2 90.8L32 96h6c-.7-1.9-1.6-3.6-2.8-5.2zm15.5-22L43 80.1c4.5 4.3 7.6 9.9 9 15.9h5c.8-2.1 2-4 3.6-5.6l-9.9-21.6zM62 62l10.1 23.4c2.5-.1 5.1.3 7.5 1.3L104 62H62zm78.5 21c-.6 0-1.2.1-1.8.2l7.5 16.7c1.4 3.2.6 6.3-2.2 8.1-.9.5-1.9.8-3 1-2.6-.1-5-1.6-6.2-3.9l-7.6-16.8c-7.8 7.4-8.1 19.7-.7 27.5 7.4 7.8 19.7 8.1 27.5.7 7.8-7.4 8.1-19.7.7-27.5-3.7-3.8-8.8-6-14.2-6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-105',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M47 38.8c-7.1-1-13 .8-17.4 4.2-.8.6-1.9.4-2.5-.4-.3-.4-.4-.9-.3-1.4.6-2.6 1.7-5 3.2-7.1 4.4-6 11.6-9.6 18.9-8.5 4.7.7 11.2 6 14.1 9.4-1.9-8.2-5-15-10-18-10.9-6.5-19.7-5.5-32.1-4.6-1 .2-1.9-.5-2.1-1.4-.1-.5 0-.9.3-1.3C22.3 5.3 26.5 2 31.4 0H46c8.7 2.6 18 8.3 23.5 12.8 2.7 2.2 5.1 4.9 6.9 7.9 0-.5.1-1 .1-1.5-.5-7.4-4.4-14-9.4-19.2h21c.7 1.4 1.4 2.9 1.9 4.5 1.3 4 1.7 8.3 1.4 12.5 4-1.3 8.2-1.8 12.3-1.5 12 1 21.8 9.5 26.2 20.7 1.7 4.3 2.4 8.9 2 13.5-.2 2.1-3.5 3.1-4.3 1.1-5-14.2-24.3-24.4-38.5-19.4-.3 0-.7 0-1-.1 3.2 1.1 11 3.4 13.8 5.6 8.8 6.9 22 17.4 19.4 34-.7 5.5-2.9 10.7-6.4 15-.7.8-1.9.9-2.7.2-.4-.4-.7-.9-.7-1.5-.1-9.4-4.2-20.6-11.5-30.6-4.8-6.6-15.7-7.3-21-7 3.9 2.1 11.8 9.2 13.5 13.7 2.7 6.9.9 14.8-3.9 20.5-1.7 2-3.8 3.7-6.2 4.8-.9.4-1.9 0-2.3-.9-.2-.5-.2-1 0-1.4 2.4-5.1 2.8-11.3.2-18.1-1.6-4.6-4.7-8.6-8.7-11.4 0 .1-26.9 30.5-33.8 105.9H8.4C22.8 88.3 60.1 45.8 60.6 45.4c-3.7-3.7-8.5-6-13.6-6.6zM64 141h12v-14H63c-.9.1-1.8-.6-1.9-1.5-.1-.8.3-1.5 1-1.8l28.7-15.9 4.7-22c.2-1.1 1.2-1.7 2.3-1.5.3.1.5.2.7.3l54.6 39.1c.8.5 1.1 1.7.5 2.5-.4.6-1 .9-1.7.8h-6v33H76v-11h-9c-.5.1-.9.5-1 1v10h-8v-13c-.1-3.2 2.5-5.9 5.7-6h.3zm44 5.2c0 1.5 1.3 2.8 2.8 2.8h18.4c1.5 0 2.8-1.2 2.8-2.8v-14.4c0-1.5-1.3-2.8-2.8-2.8h-18.4c-1.5 0-2.8 1.2-2.8 2.8v14.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-106',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M137 56.7c-2 3.9-7.4 6.2-11.9 5.2l-16.4-3s15 41.7 5.7 62l1.9 8.1c1 4.3-1.6 8.6-5.9 9.7-.1 0-.3.1-.4.1l-9.6 1.9c-4.6.9-8.6-2.1-9.5-6.6-1.6-7.4-4.8-24.1-10.9-24.6-6.2.5-9.4 17.2-10.9 24.6-1 4.5-5 7.6-9.5 6.6l-9.6-1.9c-4.3-.8-7.2-5-6.4-9.3 0-.1.1-.3.1-.4l1.9-8.1c-9.2-20.3 4.7-62 4.7-62l-15.4 3c-4.5 1-9.9-1.3-11.9-5.2-2-4.3-.9-9.4 2.7-12.5C40.8 32 53.7 27.6 60 26.1c2.3-.5 4.9 1 6.4 2.8 6.3 7.6 17.5 8.6 25.1 2.3.8-.7 1.6-1.5 2.3-2.3 1.5-1.8 4.1-3.3 6.4-2.8 6.3 1.5 19.2 5.9 34.3 18.1 3.4 3.1 4.5 8.2 2.5 12.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-107',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M135.2 44.2C128 31.8 116.9 24 109.8 19.9c-3.6-2.1-8-.3-10.2 3.3-3.8 6.4-10.7 15-19.7 15s-15.8-8.6-19.7-15c-2.1-3.6-6.6-5.4-10.2-3.3-6.9 4-18 11.9-25.2 24.3-1.3 2.7-.9 5.9 1 8.2l6.4 7.4c1.8 2.1 4.8 3 6.6 1.9 1.9-1 3.4-1.9 3.4-1.9l-7 44.2c-.3 4.7 1.2 9.3 4.2 12.9L58 136.5c3.5 3.3 8 5.2 12.8 5.5h18.5c4.8-.3 9.3-2.2 12.8-5.5l18.6-19.6c3.1-3.6 4.6-8.2 4.2-12.9l-7-44.2 3.4 1.9c1.9 1 4.8.2 6.6-1.9l6.4-7.4c1.8-2.3 2.2-5.5.9-8.2zM67 132c-3.9 0-7-3.1-7-7s3.1-7 7-7 7 3.1 7 7-3.1 7-7 7zm27 0c-3.9 0-7-3.1-7-7s3.1-7 7-7 7 3.1 7 7-3.1 7-7 7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-108',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" id="free-108" width="160" height="160" viewBox="0 0 160 160"><path d="M77.4 77.4zM71 83.7c3.5 0 6.3-2.9 6.3-6.4 0-3.5-2.9-6.3-6.4-6.3-3.5 0-6.3 2.9-6.3 6.4.1 3.5 2.9 6.4 6.4 6.3zm53 21.2c3.6 0 7.2.7 10.6 2.1 5.5-9 8.4-19.4 8.4-29.9 0-27.8-19.8-51-46.3-56.7l.1-.4v-.1c.7-3.6-1.6-7.1-5.2-7.8-3.6-.8-7.2 1.5-8 5.1L73.8 63c7 1.3 12.1 7.5 12 14.6 0 8.2-6.7 14.8-14.9 14.8s-14.8-6.7-14.8-14.9v-.1H23.9c-3.8 0-6.8 3.1-6.8 6.9 0 3.8 3.1 6.8 6.9 6.8h2.6c1.4 5.6 3.6 10.9 6.7 15.8 10.4-4.1 22.3-1.4 29.9 6.9 2.7 2.7 4.7 6 5.8 9.7 1 2.9 1.5 5.9 1.5 8.9 0 .5 0 .9-.1 1.4 4.4 1 9 1.6 13.5 1.6 4.3 0 8.6-.5 12.8-1.4 0-.5-.1-1.1-.1-1.6 0-15.2 12.3-27.5 27.4-27.5zm0 10.7c-9.2 0-16.7 7.5-16.6 16.7 0 9.2 7.5 16.7 16.7 16.6 9.2 0 16.7-7.5 16.6-16.7 0-9.1-7.5-16.6-16.7-16.6zm-80.8 0c-9.2 0-16.7 7.5-16.6 16.7 0 9.2 7.5 16.7 16.7 16.6 9.2 0 16.7-7.5 16.6-16.7-.1-9.1-7.5-16.6-16.7-16.6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-109',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M148.7 116.5c-.2 1.6-1.3 2-2.6 1-5.5-4.2-30.1-9.1-55.9-1.5C41.5 130.6 11 100.3 11 100.3c5.3-37.7 40.4-63.9 78.3-58.6 37 5.1 63 38.3 59.4 74.8zM30.2 98.3s17.6 15.2 44.6 11.4C57.5 106.2 46.4 89.4 50 72.1c1.3-6.2 4.4-11.9 8.9-16.3-16.5 8-27.5 24.2-28.7 42.5zm72-43.3c13 11.9 13.9 32.1 2 45.1-.8.9-1.7 1.7-2.6 2.5 13.9-2.6 25.8-.6 29.2 1.6 1 .7 1.8.3 1.9-.9.6-20.8-11.5-39.9-30.5-48.3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-110',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M147.9 42.3l-7.8-1.9c-10.3-1.4-11.4-6.8-11.4-6.8-1.8-8.5-9.4-14.6-18.1-14.6-12.2 0-32.2 9.4-26.6 49 0 0 1.2 11.1-7.7 11.1-7.1.2-14 1.4-20.7 3.8-10.4 3.7-29 12.2-44.1 5.7-1.3-.6-2.9-.2-3.7 1-.9 1.2-1 2.8-.3 4.1 6.8 11.9 18.8 27.7 34.2 38.2 10.7 7 23.3 10.6 36.1 10.2 22.4-.6 39.9-11.7 44.9-25.3 3-8.2 2.3-25.1-12.1-44.8-3.3-4.5-2-11.1 9.6-17.5 3.6-2 8.8-4.9 27.6-6.8 2.7-.3 5.6-3.4.1-5.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-111',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M151.9 77.4c1 2.4-6.4 14.1-14.9 12.6-2.4 0-11.3-.7-19 4-5.5 3.7-11.1 8.9-13.1 18 0 0-1.4 7.4 3.4 12H97.1c-1.6-2.1-8.2-9.3-3.1-21 1.8-3.9.9-5.7-3-3-3.9 2.6-20.1 3.6-32-3-3.2 3.3-10.6 12 2 27H47.2c-3.3-4.4-11.3-20.6-7.5-31-6.9-4.7-10.1-16.9-6.8-27-2.1-.3-8.8 1.5-10.3 3.4 2.4.5 3.6 2.9 3.8 3.4s1.4 4.3-3.3 6.7c-2.6 1.5-6 .6-7.5-2-.1-.2-.3-.5-.4-.8-.7-1.6-.4-3.4.7-4.7-8.3.4-9.8 4.7-10.9 3.6s6.5-6.9 13.3-6.5C23 63.3 33.2 59 35.2 58.3c5.4-4.7 12.5-7 19.7-6.3 11.6 1.1 19.5 5.5 29 1 12.6-4.8 25.1-8.1 38-3 1.7-4.3 12.8-8.4 7 3 12.5 5.1 10.4 20.5 16 24 3.1.1 7.1-5 7 .4zM20 72s-2.1 1.9-1.8 3.4c.3 1.6 1.8 2.5 3.9 1.4s2.7-2.6 1.8-3.6C22.9 72.1 20 72 20 72z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-112',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M21.8 117.1c10.5 12.6 28.4 1.4 30.2 3.9s-1.3 4.8-4 8c-7.7 3.4-4.7 9.4 3 5-8.8 16.2 9.6 8.8 31.5-8l.8 13-3.3 2c-1.7 0-3 1.3-3 3s1.3 3 3 3h26c1.7 0 3-1.3 3-3s-1.3-3-3-3l-12.7-2-1-16 .5.1c32.6-1.3 38.1-22.5 38.2-34.1.1-11.9-3.9-35.3-6.1-45s17.5-3.2 17.1-7c-.8-8-16.7-11.2-18.6-12.9S118.3 14 109 14c-18.8 0-10 21.2-6.9 30.5 7.3 18.2 6.9 24.8 4.5 24.8l-.5-.2C79.3 52.3 66.5 55.9 62 61c-3.4-26.8-18.7-31.3-19-16-20.3-27-45.7-13.8-23 7 7.2 6.9 22.6 17.6 23.3 31.6C3.3 61 8 103.3 36.6 106.9c1.2-2.1-20.7.8-14.8 10.2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-113',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M128.2 16.5c-8.4 1.4-15.8 12.4-15.8 12.4s-8.1-4.2-15.8-4.1c-7.6-.1-18.2 4.1-18.2 4.1S73.9 18 64.8 16.5 52.9 10 52.9 10c.3 4.5 2.5 8.7 6.1 11.4 6 4.5 9.7 13.1 7.9 16.4s-3.4 5.8-3.3 9.3c.1 1.9-1.4 5.7 8.4 13.9-13.2-.9-37.2 17.3-40 68-2.6 2.7-18.4 23.1-19.8 31h11.3c5.5-3.5 13.3-9.4 24.1-18.7 16.8 3.6 59.7-7.2 74.4-38.9 6.9-15.2 4.9-28.6-6-39.4 7.1-2.1 12.1-8.5 12.5-15.9.1-3.5-.9-6.8-2.9-10.6s2.5-10.9 8-15c3.3-2.6 5.6-6.3 6.4-10.4 0 0-3.5 4-11.8 5.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-114',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M152.5 51.9c-10.8-8.4-12.2-12.6-16.9-15.9s-6.6-3.6-6.7-5c-.5.1 3.2-7.9-2-10-1.1-.6-6.5 7.5-6 8 .3.3-21.7-3.7-26 26.6-.7 5.1-7.7 4.3-17.7 3.8-12.7-.6-18-8.8-39.1-.2-1.4.8-1.9.7-3.2-.2-1.3-.8-4.1-1.2-6-1-7.3.8-16.5 8.7-16.7 20.3-.2 14.7-3 19.7-9.3 25C9 104.2 25.6 99 26 75c0-3.4 4.8-9.1 7.8-9.6-6.4 7.7-1.1 19.5-1.8 21.7s-5.3 10.2-6.2 15.8 2 36 2 36h7s2.2-37 5.4-37.2 7 37.2 7 37.2h7.6s-1.9-33.8-1.1-37.4c.8-3.5 3.5-6.2 6.9-7.2 2.9-.6 23.6 3.7 25.6 5.3s4 1.4 3.9 6.9-3.2 32.5-3.2 32.5h7.4s3.4-39.6 7.8-39.7 4.6 39.7 4.6 39.7h6.6s-1.6-35.9.1-49.8 12.7-28.5 13.6-29.9c2.1-3.4 2.8-2.1 8.5-1.2 2.4.4 7.8-.8 11.3.7 2 .6 4.1.1 5.5-1.4.6-.6 1.1-1.3 1.5-2.1 0 0 .9-1.7-1.3-3.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-115',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M126.7 41.4l-11.5 6.9c-1.3 3-3.3 5.6-5.9 7.6 14.8 16.5 13.4 41.9-3.1 56.8-1.3 1.2-2.7 2.2-4.1 3.2l9.8 17.9h7.4c2 0 3.6 1.6 3.6 3.6s-1.6 3.6-3.6 3.6h-8.9c-1.6-.3-3.1-1.2-4.1-2.4l-10.4-19.1c-2.8 1.3-5.7 2.2-8.8 2.8l-3.5.5 6.1 11.1h7.4c2 0 3.6 1.6 3.6 3.6s-1.6 3.6-3.6 3.6h-8.9c-1.6-.3-3.1-1.2-4.1-2.4L75.5 123l-3.7-.4c-4.4-.8-8.7-2.3-12.6-4.5l-11.3 15.2c-.4.6-1.1.9-1.8.9H20.2c-.8 0-1.6-.4-1.9-1.2-.4-.7-.3-1.6.1-2.2L79 44.2c-.2-1.1-.3-2.1-.3-3.2 0-10.5 8.6-19 19.1-19 7.6 0 14.5 4.6 17.5 11.6l11.5 6.9c.2.1.3.3.3.5-.1.2-.2.3-.4.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-116',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M141.2 80c-6.7-2-14.4-2.4-22.2 5-8.7 8.3-23.2 20.2-21.9 27.3 2 9.3 4.6 31.2 5.8 47.7H86.8c-.5-4-3.1-24.5-6.4-30.7-7.4-14.3-12.7-17.1-20.6-17.8-5.3-.6-11.6-1.2-14.1-.5-6.9 2.9-16 13.8-2.5 49H25.4c-1.5-4.4-7.5-22-8.4-27.8-.5-2.8.9-17.7 2.4-22.5 1.6-9.1-3.6-15.2-2-23.8-4.1 4-13.3-6.5 2.8-12 4.5-5.7 2.7-10 33.8-11.1 27.9-1 39.8-3.4 42-3.8 7-1.3 12.2-4.4 14.8-11.2.8-2.1 1.2-4.3 1.2-6.5-.1-8.3-6.7-15-15-15.3-1.9-.1-3.1 1-3.1 2.6.1 2.9 12.8 3 11.1 12.4-4.2 23.1-32.2 9.4-31-4.5C75.2 23.2 83.1 13 100.2 13c17.5 0 30.4 14.3 29 28.2 0 0 24.5 21.6 20.6 37.1-1.9 3.2-1.9 3.7-8.6 1.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-117',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M125 50c1.3.5 2.7-5.5 6-7 7.2-3.3 13.3 2 17 0 1.8-1 3-2.9 3-5 .2-1.2 2.1-1.7 2 1s.4 11-12 11c-4-.1-5.7-.5-6 1-.6 2.8 1.5 4.3 3 5s4.7 3.7 5 9c.3 1.8 5.4 8.7 6.7 10.3s3.4 4.2.6 6.4c-.7.6-1.6 1-2.5 1.2-.7.7-2.3 7.4-8.4-.9-2.5 1-7.8 4.1-14.8-3.1-1-.7-4.9-1.6-13.6 8.2-1.7 1.9-2.5 5.2-5.4 9-2.9 3.7-6.1 3.4-6.7 4.6-2 4.2-.8 9-1.3 11-.6 2.4-3.6 6.6-2.7 10.6s1.9 9.6 6.2 11.8H86.6s-3.5-6.6-2.3-12.2-.8-19.4-2-21.1-4-1.6-14.7-2.4-14.6-7.6-21-7.2c-1.7.1-5.2 1.2-9.8 9.1-2.4 4.4-6.5 5.7-6.9 9.8s-1.6 18 5.7 23.9c-7.2.2-14.1 0-14.1 0-1.4-5.3-1.8-10.8-1.3-16.2.9-8.8-2.2-12.8-1.7-16.4s4.1-6.4 3.4-12.7c-.7-6.3-7.8-10.9-8.3-20.7-1.4 1.2-1.2 10.1-1.6 20 1.5 4.6 6.3 5.5-1 21.9.1-4.3-5.1-6.6-5-12.3.2-5.7 2.9-7.7 3-10.6.3-2.4 0-23 0-23s.4-6.8 5.2-11.2c5.1-4.2 15.9-10 27.1-9.8 11.2.2 15.4 3 22.7 2.1 6.9-.9 11.7-5.7 27-8.1 12.8-1.3 18.4 6.8 34 13z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-118',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M107.2 37.7S101.1 27.8 81 22s-51.6-6.4-53.8.1 20.1 11.7 33 15.1S94.8 43 95 44c.6.8-1.9 2.8-3 5-2.5 4.6-.6 9.7-2 11-1.4 1.3-5.9 4.1-20.8 4s-43 7-43.2 40c0 2.8.9 3.9-1.4 4.2s-8.9 1.5-8.6 9.3 6.4 9.7 10 9.5c3.6-.2 9.8-4.7 11.2-3.8s2.1 4 1.1 6.8-3 6.3-1.9 8.3 1.5 3.6 6.7 3.6h54.6s3.2-.8 3.2-5.3-2.1-9.3-30-8.5c17.5-1.9 24.3-14.2 23.2-23.2 0-2.2 1.5-2.2 3 2s18.3 28.7 18.3 28.7 4.2 6.2 8.6 6.2c4.6 0 15 .8 15-4.9s-5.2-7.4-11.9-7.1c-4 .2-5-6-5-6s-2.9-9.6-1-41c.2-1.5.5-1 3-1 3.1 0 16.6-3.1 19.2-8.8s-1.9-16.1-10.1-24.8-14.2-12.5-26-10.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-119',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M119.5 43.5C105 30.8 98.9 25.4 98.9 25.4c-1.6-1.9-4.5-3.4-6.4-3.4h-27c-1.9 0-3.5 2.9-3.5 6.4l2.9 20.1c0 3.5 1.9 2.5-5.6 10.8S47 79 46.7 79.2c-2.1 2.8-4.4-3.2-5.5-7.4l-3.8-12.6c-1.3-4.2-4.4-8.4-7-9.3L18 45.2c-2.6-1-3.7 1.7-2.6 5.9l8.7 31.3c2.2 6.8 1.3 11.2.2 15.5L16 131c-1.1 4.3.2 7 2.8 5.6l9.4-5c2.5-1.4 6-5.4 7.7-9l4.7-9.8c1.7-3.6 5.7-9.2 7.5-7.8 1.4 1.1 12.5 10.5 12.5 10.5 1.7 1.4.1 5.5-.5 9.5 0 0-2.7 8.9-2.9 10.3-.8 3.1.7 4.7 2.9 3.1 0 0 7.3-4.1 12.1-7.4s6-5.1 7.9-4.5c0 0 11.8 5.5 20.1 5.5 27.5 0 46.2-36 47-42 .6-4.5 2-20.5-27.7-46.5zM115 64c5.5 0 10 4.5 10 10s-4.5 10-10 10-10-4.5-10-10 4.5-10 10-10z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-120',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M143.9 48.3c-4.1.2-7.6-2.9-7.9-7.1-.2-4.1 2.9-7.6 7.1-7.9 4.1-.2 7.6 2.9 7.9 7.1v.4c.1 4.1-3.1 7.4-7.1 7.5zM127 81.8c-13.6 10.2-11.5 27.5-16.3 41.5S93.4 136 93.4 136h-76c-3.1-.1-5.5-2.7-5.4-5.8 0-3.7 8-14.4 14.8-21.8C32 110.1 37.5 111 43 111c20.6 0 37.9-11.8 43.3-27.9C78.2 93.3 64.5 100 49 100c-10.5.1-20.7-3.1-29.2-9.2-1.2-2.8-2.1-5.8-2.6-8.8-3.3-21 12-41.2 34.3-45.2s43 9.8 46.3 30.8c.6 3.6.6 7.2.1 10.8 3.4-5.7 7.4-14.6 15.1-23 7.7-8.4 20.9-3.6 22.8 2.3s4.8 13.9-8.8 24.1zM123.1 39c-3.9.2-7.2-2.8-7.4-6.6s2.8-7.2 6.6-7.4 7.2 2.8 7.4 6.6v.4c.2 3.8-2.8 6.9-6.6 7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-121',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M35.5 53h90c2.3 0 4.2-1.7 4.5-4 .3-2.5-1.5-4.7-4-5-3.5-4.9-16.1-9.4-32-11 .5-1 .8-2 1-3-.1-7.8-6.5-14.1-14.4-14C72.8 16 66 22.2 66 30c.2 1 .5 2 1 3-15.9 1.7-28 6.1-31.8 11-2.4.1-4.2 2.1-4.2 4.5 0 2.5 2 4.5 4.5 4.5zm45.1-28c2.9 0 5.4 2.9 5.4 6 0 .8-.4 1.5-1 2h-9c-.3-.6-1-1.1-1-2 0-2.9 2.5-6 5.6-6zM141 78.5c0-4.7-3.8-8.5-8.5-8.5H126l-1-5H36l-1 5h-6.5c-4.7 0-8.5 3.8-8.5 8.5s3.8 8.5 8.5 8.5H33l-5 41.7c0 6.9 5.9 12.3 13.3 12.3h78.3c7.5 0 13.3-5.4 13.3-12.3L128 87h4.5c4.7 0 8.5-3.8 8.5-8.5zm-82.9 2l-5 40c-.4 3.1-3 5.4-6 5.5-.3 0-.6 0-.9-.1-2.5-.5-4.2-2.9-3.8-5.4l5-40c.4-3.1 3-5.4 6-5.5.3 0 .6 0 .9.1 2.6.4 4.3 2.9 3.8 5.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-122',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M51.1 65.6l30.7 23.3c1.3 5.4 6 9.1 12.2 9.1h39c8.3 0 15-6.7 15-15V43c0-8.3-6.7-15-15-15h-26.5c-8.3 0-16.2 6.7-17.7 15l-5.7 31.8-28.4-21.5c-.2-1.1-.6-2.3-1.1-3.3C50.3 43 42 40 35 43.3S25 55 28.4 62c-5.2 6.4-21 27.1-21.4 43-.4 19 30 18.4 33 16s3-5.3 0-9-12.1-9.9-12-31c2.3-3.5 5.6-8 8.4-11.8 5.2 1.8 11 .4 14.7-3.6zm50.4-17.3c.8-4.1 4.3-7.1 8.5-7.3h12v22H99l2.5-14.7zM41 50c3.3 0 6 2.7 6 6s-2.7 6-6 6-6-2.7-6-6 2.7-6 6-6zm98 57H80c-8.3 0-15 6.7-15 15v4c0 8.3 6.7 15 15 15h59c8.3 0 15-6.7 15-15v-4c0-8.3-6.7-15-15-15zm-50.5 23c-3 0-5.5-2.5-5.5-5.5s2.5-5.5 5.5-5.5 5.5 2.5 5.5 5.5-2.5 5.5-5.5 5.5zm21 0c-3 0-5.5-2.5-5.5-5.5s2.5-5.5 5.5-5.5 5.5 2.5 5.5 5.5-2.5 5.5-5.5 5.5zm21 0c-3 0-5.5-2.5-5.5-5.5s2.5-5.5 5.5-5.5 5.5 2.5 5.5 5.5-2.5 5.5-5.5 5.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-123',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M149 82l-35-63-5 4v10l31 49zm-.1 3h-8c.3 26.3-32 13.9-32.9 15.1 3.4 7.6 5.9 12.7 13.8 17.7 41.3 24.4 26.9-32.6 27.1-32.8zM92 84L82 69H58v14H44v-3H25v2h-7v9h26v4H18v11h74V84zm-5 7H63V74h18l6 9v8zm5.5 22h-75C11.7 113 7 117.7 7 123.5S11.7 134 17.5 134h75c5.8 0 10.5-4.7 10.5-10.5S98.3 113 92.5 113zM63 63h18V52l25-19v-9L75.2 41.3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-124',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M69 143H50v9l-10 8h39l-10-8zm74-102s.7-9.9-9-10h-22.3c-.4-.4-.8-.7-1.3-.9l-.6-.2c-.1-.1-.3-.2-.5-.2l-1-.3-42-13.4c-.7-1.5-2-2.8-3.5-3.4-3.5-1.5-7.6.1-9.2 3.7L24.7 31H18c-5 0-9 4-9 9s4 9 9 9h20v29h9v60h25V78l21-37h22.1l1.9 55c-4.1 1.3-6 5.2-6 9.5-.1 5 3.3 9.4 8.2 10.5l-3.3 2.1c.1 1.5.9 2.9 2.2 3.8l6.7 4c1.6 1.7 1.4 4.4-.3 6-1.8 1.7-4.7 1.7-6.6 0-1.6-1.5-4.1-1.5-5.8 0l-.2.2c-1.4 1.5-1.4 3.9.2 5.4 5.1 4.8 13 4.8 18.1 0 .2-.2.4-.3.5-.5 4.5-4.8 4.3-12.3-.5-16.8-.2-.2-.5-.4-.7-.6l-4.9-3-.9-.5c4.9-1.1 8.3-5.5 8.2-10.5 0-4.2-2.9-8.9-7-9.5l2-55H143zM37.8 31L54 22.8V31H37.8zm28.7 35H54V49h23L66.5 66zM66 31v-8.5c.1-.1.1-.2.2-.3L93.5 31H66z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-125',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M146.1 124.6l-4.3-2.6-.8-3c5.3-1.2 9.1-6 9-11.5 0-2.4-.7-4.6-2.1-6.6-.7-1.7-2.1-3-3.9-3.5-.9-.5-2-.9-3-1.1V12.5c0-1-.6-1.9-1.6-2.3 0 0-.1 0-.1-.1H139h-.1H138.6c-.6 0-1.2.2-1.7.6 0 0-113.7 44-115.1 44.5-.9.3-1.7.9-2.1 1.8-.5.5-.7 1.3-.7 2v44H7v16h95s16.9-10.6.1-32c0 0-18-7.4-28.5 0-2 5.2-3.4 10.6-4.4 16H51.1l30.3-30.3 15.3-15.3 19.4-20.3 9.1-9.5L136 16.3v80c-5.3 1.2-9 5.8-9 11.2-.1 5.5 3.7 10.3 9 11.5l-1.8 4.4c.1 1.3.8 2.5 1.9 3.2l5.8 3.4c.6.7 1 1.5 1 2.5s-.4 2-1.2 2.7c-1.6 1.5-4.1 1.5-5.7 0-1.4-1.3-3.6-1.3-5 0l-.2.2c-1.2 1.3-1.1 3.3.2 4.6 4.4 4.1 11.3 4.1 15.7 0 2.1-1.9 3.2-4.6 3.3-7.4 0-2.8-1.2-5.5-3.3-7.4-.2-.3-.4-.4-.6-.6zM24 103V67l17 36H24zm50.9-47.2L47.3 103h-2.2l-11-24 42.4-26.1-1.6 2.9zm28-23l-13.8 8.9-9.4 6-46.8 28.8-7.8-17 89.5-34.2-11.7 7.5zm29.1 74.7c0-3.6 2.9-6.5 6.5-6.5s6.5 2.9 6.5 6.5-2.9 6.5-6.5 6.5-6.5-2.9-6.5-6.5zM105 124H18c-6.1 0-11.2 4.6-11.9 10.6-.8 6.6 4 12.5 10.5 13.3v.1H105c6.6 0 12-5.4 12-12s-5.4-12-12-12zm-78 16c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4zm17 0c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4zm17 0c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4zm17 0c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4zm17 0c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-126',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M149.8 63.1c-1.5.4-3-.5-3.4-2V61l-.7-3.3-33.9 31-3.3-.4L80 84 69.7 57.4l-1.5-4.2v-.7l28-25.6 43.7 6.6-.7-2.8c-.4-1.5.6-3 2.1-3.4s3 .6 3.4 2.1l7.1 30.2c.5 1.6-.4 3.1-2 3.5zM74 97h68v27c0 1.7-1.3 3-3 3h-5c-.3-9.7-8.3-17.3-18-17-9.3.3-16.7 7.7-17 17H60c-.3-9.7-8.3-17.3-18-17-9.3.3-16.7 7.7-17 17h-8c-1.7 0-3-1.3-3-3v-24c0-1.7 1.3-3 3-3v-5l22-31h22v36h13zm-31.5 20c5.8 0 10.5 4.7 10.5 10.5S48.3 138 42.5 138 32 133.3 32 127.5 36.7 117 42.5 117zm74 0c5.8 0 10.5 4.7 10.5 10.5s-4.7 10.5-10.5 10.5-10.5-4.7-10.5-10.5 4.7-10.5 10.5-10.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-127',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M141.5 146H75.9c-5.4 0-10.9-4.5-10.9-9.9v-9.7c0-5.3 5.6-8.5 10.9-8.5h65.6c5.4 0 8.5 3.1 8.5 8.5v9.7c0 5.3-3.1 9.9-8.5 9.9zm-.5-18H75v8h66v-8zm-11-15H84v-6H67V87h7L56.3 51.5l10.5-11.4S78.8 75.9 82 87h13l20-27h32v47h-17v6zm5-26V73h-12l-9 14h21zM62.9 34.8l-7.8 11.1-.8 1.1-.8 1.1-25.4 36.4C29.9 91.8 37 121 37 121l9 12.8-3.8 5.2-13.1-7.2-.4-.1c-.2 0-19.6-3.5-19.7-24.9-.1-22.2 8.5-24.6 12.1-24.5l22.2-58.9 8.6-4.9 1.3-.8 1.8-1 2-1.1 1-.6 5 2.9v.9l-.1 16z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-128',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M137.5 148H86.2c-8.2 0-12.1-3-12.1-8.9v-11.5c0-5.7 4.1-9.6 12.1-9.6h51.4c6 0 9.4 3.5 9.4 9.6v8.9c0 7.5-3.5 11.5-9.5 11.5zm-.5-19H84v8h53v-8zm-10-16H84v-5H74L41 42v20h4l-2 19h-5v8c0 1.3-.5 1.8-1.8 2h-.1-.1c-2.2 0-3 1.6-3 3.5s.8 3.5 3 3.5h.3c.3 0 .6.2.9-.1 1.6-.3 2.7-1.7 2.8-3.3 0-.6-.2-1.1-.5-1.6.9-1.2 2.6-1.4 3.8-.4.6.5 1 1.3 1 2.1 0 2.3-.3 4.1-1.4 5.4l15.8 13h-4.2L40 102c-.9.6-1.9 1-3 1-2.5 0-2.8-.5-4-1l-13 11h-5l15-13c-1.6-1.4-2-3.1-2-6-.1-3.3 1.9-6.4 5-7.6V81h-3l-2-19h5V27.1l-3.8-6.6L41.7 13 99 92h6l-4-10V57h45v51h-19v5zM48 45.8l4.8 8.9 3.1-14-7.9 5.1zm11.2-.6l-2.9 14 8.8-5.6-5.9-8.4zm-.9 20.5l4.2 8.2L68.1 59l-9.8 6.7zm19.1 4.8L72 63.2l-5.7 14.5 11.1-7.2zM60 121h-6v8h6v5H14v-5h6v-8h-6v-5h46v5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-129',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M141.8 118c-1.4-9.6-10.2-16.2-19.8-14.8-7.7 1.1-13.7 7.1-14.8 14.8H84.8c-1.4-9.6-10.2-16.2-19.8-14.8-5.2.7-9.8 3.8-12.5 8.3-5-8.3-15.7-11-24-6-4.5 2.7-7.6 7.3-8.3 12.5H15V96h91V43l25.7-.1c3.5-.1 6.9.9 9.7 2.9 4.2 3.2 6.6 8.1 6.6 13.4V118h-6.2zM86.7 86h-32l-1.1-.1c-24.7-4.1-42.5-24.7-42.5-24.7-4.5-22.6 6.4-30.4 6.4-30.4 45.1-14.9 74.9 9.8 74.9 9.8C96.2 46 96 53.9 96 53.9 95.7 73.4 86.7 86 86.7 86zm-49.2 22c6.9 0 12.5 5.6 12.5 12.5S44.4 133 37.5 133 25 127.4 25 120.5 30.6 108 37.5 108zm30 0c6.9 0 12.5 5.6 12.5 12.5S74.4 133 67.5 133 55 127.4 55 120.5 60.6 108 67.5 108zm57 0c6.9 0 12.5 5.6 12.5 12.5s-5.6 12.5-12.5 12.5-12.5-5.6-12.5-12.5 5.6-12.5 12.5-12.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-130',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M110 33h40l-63 68.1V127h26c3.6 0 6 2.9 6 6.5s-2.4 6.5-6 6.5H48c-3.6 0-6-2.9-6-6.5s2.4-6.5 6-6.5h25v-25.9L11 33h87.5l13.3-23.8c1.3-2.4 4.3-3.4 6.8-2.1s3.4 4.3 2.1 6.8c0 .1-.1.1-.1.2L110 33zm-79 7l11.1 13h45.2l7.3-13H31zm67.8 13H119l11-13h-23.9l-7.3 13z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-131',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M143 94.9l-1 41.9c-.1 2.5-2.1 4.6-4.6 4.8 0 0-11.4.3-11.5-4.1L124.4 95c-.1-2.5-.5-4.9-1.1-7.3l-8.2-26.4-2 32.4c-.1 2.5.1 4.9.6 7.3l2.3 21.4c.4 2.1.9 5.5 1.2 7.7l1 7.2c.2 1.2-.1 2.4-.8 3.4-.7.9-1.7 1.4-2.8 1.4H45.7c-1.1 0-2.2-.5-2.8-1.4-.7-1-1-2.2-.8-3.4l1-7.2c.3-2.1.8-5.6 1.2-7.7l3.3-21.4c.4-2.4.6-4.9.6-7.3l-2-32.4L38 87.7c-.6 2.4-1 4.8-1.1 7.3l-1.5 42.5c-.2 4.4-11.5 4.1-11.5 4.1-2.5-.2-4.5-2.2-4.6-4.8l-1-41.9c0-2.6.3-5.2.8-7.7l12.5-55c.7-2.5 2.5-4.6 4.9-5.6l19.7-7.3c-1.8.7 4-2.3 5.9 2.7l18.1 57.8c.1.4.3.7.6 1 .3-.2.5-.6.6-1L99.2 22c1.9-5 7.7-2.1 5.9-2.7l19.7 7.3c2.4 1 4.2 3.1 4.9 5.6l12.5 55c.6 2.5.8 5.1.8 7.7zM81 93c-1.7 0-3 1.3-3 3s1.3 3 3 3 3-1.3 3-3-1.3-3-3-3zm0 15c-1.7 0-3 1.3-3 3s1.3 3 3 3 3-1.3 3-3-1.3-3-3-3zm0 15c-1.7 0-3 1.3-3 3s1.3 3 3 3 3-1.3 3-3-1.3-3-3-3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-132',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M141.6 84.8l-8.2 38.3c-.3 1.8-1.7 3.1-3.5 3.1-.5 0-1-.1-1.5-.3l-6.7-2.9c-.1-.1-.2-.1-.3-.2l1.6 16.6c.1 1.2-.2 2.3-.9 3.3-.7.9-1.8 1.4-2.9 1.4H94.5c-2.4-.2-4.4-1.9-5-4.3l-6-12.6-6 12.6c-.5 2.4-2.5 4.1-5 4.3H47.7c-1.1 0-2.2-.5-2.9-1.4-.7-.9-1.1-2.1-.9-3.3l1.6-16.6c-.1.1-.2.1-.3.2l-6.7 2.9c-.5.2-1 .3-1.5.3-1.8-.1-3.3-1.4-3.5-3.1l-8.2-38.3c-.4-2.6-.4-5.2.2-7.7l11.1-42c.7-2.4 2.2-4.5 4.2-6l18.6-12.3c.8-.5 1.8-.8 2.8-.8 1.4 0 2.7.5 3.7 1.4l5 4.7c1.8 1.8 3 4.1 3.7 6.6l9 50.8 8.8-47.7c.7-2.5 1.8-4.8 3.3-6.8l5.7-7.1c1-1.2 2.4-1.9 3.9-1.9.8 0 1.6.2 2.3.6L129 29.2c2.1 1.4 3.6 3.6 4.2 6l8.6 41.9c.3 2.5.3 5.1-.2 7.7zM50 55.1l-7 22.5c-.6 2.2-.7 4.6-.4 6.9l4.3 24.8 5.6-17.2c.2-2.1.4-5.4.4-7.4L50 55.1zM83.5 92c-1.9 0-3.5 1.6-3.5 3.5s1.6 3.5 3.5 3.5 3.5-1.6 3.5-3.5-1.6-3.5-3.5-3.5zm0 16c-1.9 0-3.5 1.6-3.5 3.5s1.6 3.5 3.5 3.5 3.5-1.6 3.5-3.5-1.6-3.5-3.5-3.5zM124 77.6l-7-22.5-1.8 29.5c.1 2.1.3 5.4.4 7.4l4.5 17.2 4.3-24.8c.3-2.2.2-4.5-.4-6.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-133',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M125.5 138.3c-2.9 1.6-10.6 5.3-19 5.3-6.3.1-12.3-2.3-16.6-6.8-5-5.1-8.4-9.5-9.9-13.6-3.1-8.1-6.6-32.6 13.7-33.1 1 0 1.9-.1 2.7-.1 1.2-.1 2.4-.2 3.6-.4 1-1 1.9-2.1 2.7-3.2.4-.5.8-1.1 1.3-1.8 2.7-3.7 8.5-5.7 13.9-5.7 2.4 0 4.8.4 7 1.4 6.2 2.9 15.5 6.5 19.6 27.8 3.4 17.6-14 27.7-19 30.2zm-3.1-44.6c-3.4-2.6-7.6-2.2-9.5.7s-.7 7.4 2.7 9.9 7.6 2.2 9.5-.7.7-7.3-2.7-9.9zm-13.5-78.1c-.1.1-.2.3-.3.4-19.2 17.5-14.9 39.6-6.6 62-1.2 1.5-2.5 2.8-4 4-2 .2-3.3 1-6 1-4.4-16.7-8.2-38.5.5-57.3-19.1 15.6-30.3 37-34.6 62.6.5-.1 1-.2 1.6-.4 4-1.1 11.5 2.2 15.5 5.1-8.5 14.4-5.8 29.8 1 39-8.7 15-27.5 13.4-32.8 12.2-5.5-1-26.2-8.9-27.9-26.8-2-21.6 6.2-25.6 11.4-30.2 5.3-3.1 14-5.8 19.3-1.7 1 .8 1.9 1.4 2.7 2 5.5-34 25-61.7 55.5-78.4.8-.6 8.1 5.3 4.7 6.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-134',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 160H80.6c20.6-27.9 2.4-50 2.4-50-8.7-10.2-26 8.6-32.3 9.1S44.4 112 43 112s-10.1-2.1-16.3-10.4 6.7-5.4 9.1-26.8 25-25.4 19.2-28.3C33 20.8 44 20 44 20l27 23c-2.9-4.1-10.1-35.9 0-34s25 35 25 35c36.1 13.4 55.3 53.5 64 79.8V160z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-135',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M48 49.9c-3.6 19.2 2.4 31.4 5.3 34.8s6.8 8.7 3.7 17.3c-4.1 1.6-3.4 4.9-2 6-.4 2.2 1.8 2.4 3 2 .5 1.3 5.7 3.3 8-1 2.4 2.7 12 7.1 37 4 0 32.5-40.9 28.9-42.5 23.2 1.9-.7 6.4-13.2-5.1-13.9-10.9.9-9.9 22.5 3.2 26.2 19.8 8.7 38.8.7 50.5-14.2 8.7-15.3 3-27.4 2.8-29.3.4-1.9 8.7-6.8 4.1-30.9-5.3-25.5-26.3-20.6-33.5-22.8s-4.1-20-3.6-21.7 2.5-13 .6-13.1-5.1 2.9-5.7 2.9-2.7-1.7-2.7-1.7V8l-3.6 6.5c-7.2-3.4-14.2.1-16.4 1.1s-4.1.3-5.3.4-1.8.9-2 2.3c-1.4.8-2 2.6-2.1 6.1-2.3 2.2 1.5 7.1 1.5 7.1S51 32.8 48 49.9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-136',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M148.8 50.5c-1.1 5.5 0 33.8-8.8 42.5-12.3 14.5-37.2 10.1-34.2 41 1.6 4.7 1.7 5 2.7 8.4 6.1 7.5-14.1 14.8-15.4-1.3-.7-9.1 3.9-27-4-30.2-4.1-1.6-18.3-.1-18.3 9s-2.3 15.6 7.2 17.2 8.8 8.8 2.1 8.8c-6.1 0-6.5 1.6-14.9-4.4-2.5-3.2-5.9-9.3-8.2-13-3.3-5.3 2.4-14.6 3.1-20.6s-10.3 14.8-11.5 18.4c-.9 2.6 7.4 12.2 11.3 15.6 0 .1.1.1.1.2.8 1.2 1.2 5.9-6.8 5.9-10.1 0-27.6-25-21.6-28.8C27.9 112 15 92.7 21 78c2.1-4.8-6.2-6.3-11-15-7.7-13.7-7.5-45.5 23-43 20.9 1.7 32.5 8.2 44 1 18.2-11.5 23.5 4.5-2 13-14.6 4.9-20 1.9-31-.4-14.2-3.1-20.1-.7-22 6.4-2.2 8.1 5.4 22.1 17.8 15.5 17.1-9 34.5-9.7 56.2 7.5 9.1-2.9 6.2-17.8 6.1-21.2 0-3.3 1.5-14.9 5.2-15.8s9.7 17 9.7 17c-.8-3.4 14.2-4 18 2 6.1-6.7 9.8-15.3 13-14.2s1.8 14.2.8 19.7zm-37.9 77.1c0-.2.1-.4.1-.6 0 0 0 .2-.1.6zm4.1 7.4c5.4 2.5 10 3 8 8s-8.1 2.1-11-2c-2.5-3.5-1.4-11.3-1.1-13.4-.5 3.1 1.2 6.2 4.1 7.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-137',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M62 64c5.5-11 18.8-18.2 30.1-21.8C84.2 23.4 68 11.3 51.6 11c8.9 11.4 8.1 28.4 8.5 44 0 3.1.7 6.1 1.9 9zM47.1 53.6c1.1-26.6-5-33.4-11.2-38.5C19 24.2 10.8 47.9 17.1 71.5 22.2 89.8 34 102.7 48 108c-.3-6.9-.3-20.2 4-27-1.9-8.5-4.4-11.8-4.9-27.4zm83.4 5.3c-7 4-16.2 14.1-19.6 39.9-3.2 23.6-11.8 39.2-21.9 49.5 1.1.1 2.3.5 3.4.6 17.7 1.6 37-10.8 46.8-31.2 10.3-22.3 6.4-46.8-8.7-58.8zm-15-6.5c-.9-.1-1.7-.2-2.9-.3-17.7-1.6-36.9 10.5-46.8 31.2-10.6 22.3-6.4 46.8 8.7 58.8 9.7-8.3 18.9-21.9 21.8-44.9 3.6-23.8 11.1-37.2 19.2-44.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-138',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M94.4 24.3C66.1 37.8 79.8 47 88 47.3s12.5-2.9 17.1.9c-1.4 2.3-3.4 7.1-10.8 9.3-7.4 2.2-21.1-9.6-35.1-1-4.1 2.3 0 1.9 0 1.9s20.2 1 26.1 8.6c1.6 3 1.3 5.1-5.9 4.5-7.5-.6-27.2-3.7-32.2 5.5 0 0 21-2.1 25.4 4 0 2.2-6.3 10.1-10.7 11.5C57.5 93.7 27 88.9 13 108c1.6 10.6 29.9 6.4 37 .9-8.4 5.7-10.7 37.6 0 36 20.2-14.3 14.7-38.9 16.1-43.4C67.5 97 79.4 88 79.4 88c6.3 4.5 3.5 27.2 3.5 27.2 9.1-5.3 6.9-24.3 5.7-31.7-1.2-7.3 3-7.4 6-5 5.1 6.9 7.4 25.7 7.4 25.7s-.4 4.2 2 0c9.2-15.9-3.3-28.2-1.1-35.8 2.2-7.6 10.5-12.5 10.7-12.6 3.9 7 .1 13.3.9 19 .8 5.7 6.6 19.1 22.9-7.7 20.8-36.6-3.9-61.4-43-42.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-139',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M133 40h-22V17c0-2.2-1.8-4-4-4H55c-2.2 0-4 1.8-4 4v23H28c-4.4 0-8 3.6-8 8v84c0 4.4 3.6 8 8 8h105c4.4 0 8-3.6 8-8V48c0-4.4-3.6-8-8-8zM63 26h36v14H63V26zm54 73H90v27H72V99H45V81h27V54h18v27h27v18z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:90},{figure_id:'free-140',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M144.2 79.5c-4.6 2.6-9.4 9.5-14.6 17.7-30.1 47.2-69 51.8-106.3-9.5-2.8-4.7-5.9-9.5-6.6-10-.5-.4-.7-.9-.7-1.5s.3-1.1.8-1.4c3-1.5 7.3-8.3 12-15.6C37.2 46 47.7 32 58 32c13.6 0 20.4 15.7 23 20 2.9-3.9 10-20 21-20 8.7 0 19.6 15.4 28.9 28.6 5.4 7.6 10.5 14.9 13.2 16 .5.3.9.8.9 1.4 0 .6-.2 1.2-.8 1.5zM102 68c-7.7 0-14.6 5.7-22 6-8.7.4-8.7-6.9-20-7-4.2 0-10.4 3.4-15.1 6.5-4.1 2.7-7.6 4-12.9 5.5 7.9 5.6 27.6 18 50 18 24.3 0 39-14.2 45-19-5.7-1.1-15.3-9.5-25-10z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-141',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M120.2 99.7c11-3.2 17.2-4.3 21.5.7s3.7 14.5.5 22.3c-4 9.6-21.9 18.4-42.1 17.2s-6.3-15.4-34.3-41.6S36.2 78 40 138H29s5.5-19.8-3.4-55.4S26.9 26.8 36 19c0 0 6.5 4.3 14 15 10.2 14.6 23.6 38 38.7 51.5 11.3 10.1 22.5 16.5 31.5 14.2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-142',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M35.7 106.4c-.4 2-.9 4.4-1.4 7.4-.8 5.9-.1 8.4.5 9.4.1.1.1.2.2.3.6.4 1.3.5 2 .5H37.3c13.4 2.4 88 3.9 94.8-3.1-.8-7.6-5.6-10.3-12.7-14.1-2.1-1.1-4.5-2.4-7-4C91.6 89.8 80 86 80 86s11.9-23.4 12-64c-2.7-.7-11.3-1-13-1-18.2 0-19.9 3.4-20.9 6.1s-3 7.9-3 7.9c-.5-2.7-1.2-5.3-2.2-7.8C51.3 23.7 47.2 22 35 22c-3.3.2-6.7.5-10 1 .8 19.9 17.5 51.2 10.7 83.4zm101 24.1c-.4-1.1-1.2-2-2.2-2.5-.1-2-5.4 5.3-50.2 5-53.1-.3-51.1-1.9-51.4-3.3-1.1.9-1.8 2.2-1.9 3.6-.2 2.6 1.5 7.5 4 8.7s25.4 2 50 2c19.6 0 40.4-1.7 49-5 2.4-.9 3.6-6 2.7-8.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-143',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M132 54c.2-5.5-1.1-9.1-3-11 20.3-12.4 5.2-24.6-3-18 2.1-6.8-1.5-10.2-6-11-9.5-1.7-12.9 4.6-12 11-5.9-12.9-31.3-4.6-6.3 17.5-3.9 7.4-7.2 15.1-9.7 23-1.8 5.7-8 18.9-25.9 18.9-13.4 0-30.1-7.5-49.7-22.2-.1-.1-.4-.2-.7-.2h-.3c-.4.1-.7.3-.8.7C13.8 65.9 20.4 81 36 93c-6.9-.2-17.4-12.7-18-5 .2 7.1 17.5 19.1 22 23-8.8.2-17.3-9.6-17-6-.9 2.3 2.4 6.5 6 12 27 41.7 69.8 28.3 85 16.4 9.1-7.1 13.9-17.3 13.9-29.2-.1-5.2-.8-10.4-2-15.4-3.4-16 2.1-19.8 7-19.7s5.8 1.1 9 3c.3.2.6.3 1 .3.3 0 .6-.1.9-.2.6-.3 1-.8 1.1-1.5.1-.5-1.5-10.6-12.9-16.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-144',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" id="free-148" width="160" height="160" viewBox="0 0 160 160"><path d="M99.2 44.1c.6-.1 1.2-.1 1.8-.1h.4c-6.2-4.6-13.7-7-21.4-7-10.1 0-19.3 4.2-25.8 11 8.3-4.5 17.5-7 26.9-7 6.1 0 12.2 1.1 18.1 3.1zm52.9 31.5C137.4 46.2 110.2 28 81 28c-29.2 0-56.4 18.2-71 47.6l-2 3.9 1.9 3.9C24.6 112.8 51.8 131 81 131s56.4-18.2 71.1-47.6l1.9-3.9-1.9-3.9zM135.5 83c-11.2 22.2-32.1 36-54.5 36s-43.3-13.8-54.5-36L25 80l1.5-3C33 64.2 42.7 54.1 54.1 48l.3-.3.1.1c-.1.1-.2.1-.3.2C47.8 54.4 44 63.3 44 73c0 19.9 16.1 36 36 36s36-16.1 36-36v-1c-3.3 5-9 8-15 8-9.9 0-18-8.1-18-18 0-9.3 7.1-17 16.2-17.9-.1 0-.1 0-.2-.1h.5-.3c15.1 5.2 28.2 16.9 36.3 32.9l1.5 3-1.5 3.1z" class="st0"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-145',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80.5 38h-1.6c-36 .9-64.8 30.3-64.9 66.3 0 3.5 2.9 6.4 6.4 6.4 3.5 0 6.4-2.9 6.4-6.4 0-3.7.4-7.5 1.2-11.1 3.4-16.7 14.7-30.7 30.4-37.5-.6.5-1.2 1.1-1.7 1.6-13.1 13.5-12.8 35 .7 48.1 13.5 13.1 35 12.8 48.1-.7 13.1-13.5 12.8-35-.7-48.1 14.9 7.3 25.5 21.2 28.5 37.5.7 3.4 1 6.8 1 10.3 0 3.5 2.9 6.4 6.4 6.4 3.5 0 6.4-2.9 6.4-6.4-.2-36.7-29.9-66.4-66.6-66.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-146',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M79.5 35C46 35 18.7 52.9 3 79.5 18.7 106.1 46 123 79.5 123c33.6 0 61.8-16.9 77.5-43.5C141.3 52.9 113.1 35 79.5 35zM20.2 80.1c10.6-18 27.7-30.9 49.1-34.1-11 3.6-19.5 12.4-22.8 23.5-5.5 18.7 5.1 38.3 23.8 43.8-21.9-2.7-39.4-14.9-50.1-33.2zm75.2 32.1c9.5-3.9 16.8-11.6 20.2-21.3L81.3 79.5 116 69.1c-3.1-9.6-10.1-17.5-19.3-21.7 18.2 4.7 33.7 16.4 43.1 32.7-9.6 16.5-25.7 28.1-44.4 32.1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-147',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M132 63c-.8.1-1.6.3-2.3.6-1.8 5.3-5.4 9.8-10.1 12.8-11.3 7-26 3.5-33-7.8-.4-.3-.7-.6-1-.9.1 0 .2-.1.3-.2-.2-.3-.3-.6-.4-.9 10-4.4 16.5-14.3 16.5-25.2C102 26.3 89.7 14 74.5 14H73.6c-3.4 0-6.7.6-9.9 1.8-14.6 5.5-21.9 21.7-16.4 36.3 0 0 4 19.5-13 35.4-9.6 9-8.5 24.5-8.5 24.5 0 18.2 25.3 33 56.5 33s52.9-15.2 56.5-33c7.5-36.2.1-49.5-6.8-49zM66 45c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm-37.7 4.7c-4.8 0-2.9 9.1 9 7.5 2.2-.3 4.5-.4 6.7-.3 0-1-.1-2-.3-3.1-2.8-7.6-2.5-16 .7-23.4-1.2.5-2.4 1.2-3.5 2-2.9 2.4-9.3-2-13.5-4.1s-9.3 1.1-4.5 9.6c4.8 8.7 10.1 11.8 5.4 11.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-148',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M132 44.4c3-3 3.8-7.4 2.3-11.3-1.5-3.8-5.2-6.2-9.2-6.2h-8l7.4-6.9c1.6-1.6 1.6-4.2 0-5.8-1.6-1.6-4.2-1.6-5.8 0L105 27l-69.7-.2c-2.7 0-5.3 1.1-7.2 3-4.1 4-4.1 10.5-.1 14.6L73 90v42H51c-3.8 0-6.6 3.3-6.6 7.1s3.1 6.9 6.9 6.9h57.5c3.7-.1 6.7-3 6.9-6.6.2-3.9-2.7-7.2-6.6-7.4H87V90l45-45.6zM106 38h17l-18.6 19H94c.5-2.1.3-4.3-.4-6.4L106 38zM74 48c-2.6 2.4-4.4 5.6-5.2 9H55.6L37 38h57l-6.2 6.8C83 43.1 77.6 44.4 74 48z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-149',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M97 133c0 4.1 4 7 8.2 7h39.4c3.7-.2 6.5-3.3 6.4-7v-15H97v15zM9 45.7v.3h22v-9H9zM33 36v11l7.6 8H58V28H40.6zm102 67V39.9l15-4.9 1-8H60v31l2 1 4 2 46.2 4.8 1.8.2v37l-12 NaN 1 NaN 4 NaN 9 NaNvNaNl-8.9 NaN-4.1 NaNzm-26-32.4L98 69v13.3l11 5.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-150',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M103.6 81c-2.7-4.4-3.8-8.2-3.4-11.4 1.9-13.7 3.3-22.1 5.8-22.1.4 0 .8.1 1.1.3 1.2.7 2.5 1.1 3.9 1.3.4 0 .9-.1 1.2-.5.1-.1.2-.2.2-.4 8.9-10.6 2.9-22 0-27.5-.4-.8-.8-1.5-1.1-2.3-.9-2.8-3.6-3.1-6-3.4-1.2-.1-2.5-.4-3.6-.8-.3-.1-.6-.2-.9-.2-2.2 0-3.6 3.3-5 6.7-.8 2-1.6 4.1-2.5 4.9C91 27.8 82.1 38 79.6 40.8c0 0 0-.1-.1-.1C72 32.1 67.4 27 66 25.6c-.8-.8-1.7-2.9-2.5-4.9-1.4-3.5-2.7-6.7-5-6.7-.3 0-.6.1-.9.2-1.2.4-2.4.7-3.6.8-2.4.3-5.1.7-6 3.4-.3.8-.7 1.6-1.1 2.4-2.9 5.5-8.8 16.9 0 27.5.1.1.1.2.2.4.3.3.7.5 1.2.5 1.4-.2 2.7-.6 3.9-1.3.4-.2.7-.3 1.1-.3 2.6 0 4 7.4 5.8 22.1.4 3.1-.7 6.6-3.4 11.4-6.1 10.8-19.6 44.6-10.7 61.2 1.7 3.1 4.1 4.7 7.1 4.7h55.3c3.3 0 5.9-1.8 7.7-5.4 8.4-16.9-3-47-11.5-60.6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-151',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M106.6 78.4c1.4 2.2 2.5 4.5 3.3 7l18.8 46c.7 2.5.1 5.2-1.6 7.2L123 143c-1 1.2-2.4 1.9-4 2-1-.1-2-.4-2.9-.9l-5.8-3.2c-1-.5-2.1-.9-3.3-.9-1.1.1-2.1.4-3 1l-5.4 3.1c-2.3 1.1-5 1.1-7.4 0l-5.8-3.2c-3.5-1.2-7.3-1.2-10.8 0l-5.8 3.2c-2.3 1.1-5 1.1-7.4 0L56 141c-.9-.6-1.9-.9-3-1-1.2.1-2.3.4-3.3.9l-5.8 3.2c-.9.5-1.9.8-2.9.9-1.5-.1-3-.8-4-1.9l-4.2-4.5c-1.7-2-2.3-4.7-1.6-7.2l18.8-46c.8-2.4 1.9-4.8 3.3-7l4-4.7c.9-1.8.9-3.9 0-5.8-.1-.3-3.5-6.3-4.2-9.7-.7-3.4-1.1-6.8-1.2-10.3l-3.6 15.3C48 65.8 46.5 68 44 68h-6c-1 .1-1.9-.4-2.4-1.2-.8-1-1.3-2.2-1.1-3.5l5.3-36.6c.5-2.6 2.1-4.8 4.3-6.1l7.9-4.1c2.3-1.1 5-.3 6.3 1.9 0 .1 8.6 12.6 21.7 12.6s21.7-12.5 21.8-12.6c1.3-2.2 4-3 6.3-1.9l7.9 4.1c2.2 1.3 3.8 3.5 4.3 6.1l5.3 36.6c.1 1.3-.3 2.5-1.1 3.5-.5.8-1.4 1.3-2.4 1.2h-6c-2.5 0-4-2.2-4.4-4.7L108 48c-.1 3.4-.6 6.9-1.2 10.3-.7 3.4-4.1 9.4-4.2 9.7-.9 1.8-.9 3.9 0 5.8l4 4.6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-152',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M50.3 92.9l20.3 19.5c1.4 1.5 3.3 2.4 5.4 2.6h27l26.8 9.5c.9.3 1.8.5 2.7.5 3.1 0 6-1.9 7.1-4.9 1.5-3.9-.5-8.2-4.4-9.7l-22-8c-1-.4-7.2-3.4-8.1-3.4H79L60.8 82.1c-3-2.9-7.8-2.8-10.7.2-2.9 3-2.8 7.7.2 10.6zM40 81c7.7 0 14-6.3 14-14s-6.3-14-14-14-14 6.3-14 14 6.3 14 14 14zm105.2 56.4L106 124.3c-1-.3-2-.4-3-.3H70L17.5 72.6c-3.4-3.3-8.8-3.2-12.2.1l-.1.1c-3.2 3.4-3.2 8.7.2 12L61 138.5c1.6 1.6 3.7 2.5 6 2.5h4v19h24v-19h7l37.7 12.5c.9.3 1.8.4 2.7.4 3.7 0 7-2.3 8.2-5.8v-.1c1.5-4.3-.9-9.1-5.4-10.6zM117 58V15c0-.4-.1-.8-.3-1.1l-.3-.6s0-.1-.1-.1c-.1-.2-.2-.3-.4-.5l-.1-.1c-.1-.2-.3-.3-.5-.5l-.1-.1c-.2-.2-.4-.3-.6-.4-.5-.4-1-.6-1.6-.6H80.3c-1.2.2-2.3.9-3 2l-3.7 9.7c-3-1.3-6.3-2-9.6-2-5.1 0-10.1 1.5-14.5 4.2-.1.1-.3.2-.3.3-.4.6-.2 1.3.4 1.7l33.8 21.9c.2.1.4.2.7.2.1 0 .3 0 .4-.1.4-.1.6-.4.7-.8 2.3-6.8 1.1-14.3-3.1-20.1l2.8-8H108v62.5c0 2.5 2 4.5 4.5 4.5s4.5-2 4.5-4.5V78h43V58h-43z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:90},{figure_id:'free-153',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M27.4 77c3.6 0 6.6-2.9 6.6-6.5S31 64 27.4 64H0v13h27.4zm0-26h.5c3.6-.1 6.4-3.2 6.2-6.8-.1-3.6-3.1-6.4-6.7-6.2H0v13h27.4zm1 39H0v13h28.4c3.6 0 6.6-2.9 6.6-6.5S32 90 28.4 90zm78.6 6.9c-14.1 0-25.5 11.5-25.5 25.6v.1c0 14.1 11.5 25.5 25.6 25.5 14.1 0 25.5-11.5 25.5-25.6 0-14.2-11.5-25.6-25.6-25.6zm0 38c-6.9 0-12.4-5.6-12.4-12.4 0-6.9 5.6-12.4 12.5-12.4s12.4 5.6 12.4 12.5c-.1 6.7-5.6 12.3-12.5 12.3zm26.9-64.3h-4.1c-1.8 0-3.5-1.2-4.1-2.9l-16.2-44.8c-.6-1.7-2.3-2.9-4.1-2.9H48c-1.7 0-3 1.3-3 3v95c0 1.7 1.3 3 3 3h24c.6-18.5 15.5-33.4 34.1-34 19.4-.6 35.5 14.7 36.1 34.1h4.4c2.4 0 4.4-2 4.4-4.4V87.9c0-9.5-7.6-17.2-17.1-17.3zM107.8 58H73c-1.6-.2-2.8-1.4-3-3V33c.1-1.8.8-2.8 3-3l28.1.1c1.1 0 2.1.7 2.4 1.8l6.7 22.8c.1.2.1.5.1.7 0 1.5-1.1 2.6-2.5 2.6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-154',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M102.1 160l5-34h-3.7c-9.7 0-15.9-10.9-14-23.3l12.3-79.4c.8-5.3 6.1-9.3 11.8-9.3h4.1c5.7 0 10.4 4.1 10.4 9.3V160h-25.9zM64 87h-1l2.7 73H37.3L40 87c-8.3 0-15-6.7-15-15V21c0-2.8 2.2-5 5-5s5 2.2 5 5v34c0 3.3 2.7 6 6 6s6-2.7 6-6V21c0-2.8 2.2-5 5-5s5 2.2 5 5v34c0 3.3 2.7 6 6 6s6-2.7 6-6V21c0-2.8 2.2-5 5-5s5 2.2 5 5v51c0 8.3-6.7 15-15 15z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-155',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M77.5 106h2c11.6 0 22.4-5.6 29-15.1h.1c14 3.9 28.4-4.3 32.3-18.2 4.1-14-3.7-28.7-17.5-32.7-3.3-.9-6.7-1.2-10-.8-2.6-5-7.7-8.2-13.4-8.2H55c-8.3 0-15 6.7-15 15v22.5C40 89.2 56.8 106 77.5 106zM115 70.5V54c1.4-.1 2.8 0 4.2.4 5.3 1.7 8.7 6.9 8 12.4-.8 6.3-6.5 10.9-12.8 10.1.4-2.1.6-4.2.6-6.4zm33.5 32.6c-16.9 6.1-41.6 9.9-69 9.9-27 0-51.2-3.7-68.1-9.6-.2 1-.4 2-.4 3.1 0 16.3 30.9 29.5 69 29.5s69-13.2 69-29.5c0-1.1-.2-2.3-.5-3.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-156',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M118.6 129.9c-2.9-.5-5.8.7-8.5 2.5 5.8 8.9 11 18.1 15.5 27.7h-5.2c-4.2-8.4-8.9-16.6-14-24.5-5.3 5.2-8.5 11.5-7 7.9 1.4-3.2.6-7.9-.4-11.4-16.5-.4-52.2-15.6-62.8-43.5-12.2-31.9-1.6-65.4 23.6-75 25-9.6 55.3 8.5 67.5 40.4 10.2 26.7-4.5 59.8-16.3 72.4 2.1 1.9 4.8 3.1 7.6 3.5zm-7-51.7s14.3-35-31-56.5l-8.7 8.7s38.7 12.3 39.7 47.8zm0 76.6c.2 0 .3.1.3.1-.2-.1-.3-.1-.3-.1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-157',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M31.4 68.7c.1-5.4 7-20.6 18.1-9.2 0 0 3-9.9 2-8.4-4.5 8-27.6-7.8-27.8 14.4l7.7 3.2zM24 99.5c5.3 6 14.8-18 20.1-18.4 2.9-.3-22.9-15.8-23.6-9.9 5.5 8-.8 18.5 3.5 28.3zm21-33.6c4.9-1.9 2.1-3.6-2.1-3s-7.3 6.2-7.3 6.2l7.3 4.2c0-.1-2.8-5.5 2.1-7.4zm97-24.5c4.1 17.9-7.6 26.9-12.9 30.1.8-1.9 1.4-3.7 1.9-5.7.4-.2.8-.5 1.1-.8 4.4-12.4 5.1-32.3 5.1-32.3C134 30.4 102 41 122.4 61c-12.5-4.6-24-18.5-24.8-36.9 7.2-20 33.6.7 24.7 10l8.1-4c-6.9-25.5-20-30-32.7-18-3.2 2.9-5 7.2-4.6 11.5-9.1-3.3-6.2 14.6 5.5 25.1C71.6 38 87.8 13.4 91 11.6c-19.1 4.9-15.3 34-10.6 45.3-1.5-.5-11-3.6-9.3-15.5.7-4.9-2.9-2.1-3.2 10.6-.2 11.6 5.2 16 10.7 15.4 1.5 5.7 10 7.2 11.5 3.5.4 3.8-8.6 13.1-9.3 16.2-.2-.1-.3-.1-.5-.1.2-3-.6-7.3-4-8.8 0 .2-8.2 6.1-12.8-4.4-3.3-11.6-4.3-16.3-4-21.3.7-3.4-11.7 13.8-12.3 39.6-4.9-3.5-10.2 12.3-22.2 11.7-2.3-.2 3.9 7.6 13.2 14.6-10.5 1.3-25.6-13-23.7-27.7-1.5 7.7-5.2 37.8 30.4 34.5l-.4-.4c2.7.6 5.5.5 8.1-.2 0 0 .8-.2 2.2-.6 3-1.5 6.5-.5 6.3 4.1-.1 1.2 2.9 7.4 4.8 15.3 0 .4 1.1 10.8 1.7 16.7h7.8c-.2-6.4-1.1-15-1.1-15 1.4-4.6 3.8-12.7 4-14.5.3-2.4-4.4 3.3-6.5 7.7l-5.9-19.4c13.4-1.5 17.7-11 17.7-31.3 0-2 3.3-3.6 3-5.5 2.7-1.1 6.3-.3 6.5 1.7l-5 28-.1-.1c-.3 2.3-.6 6.3-.9 8 .7-2.7-3.4 18.7-3.4 18.7l-1.2 4.9c-.2.7-2.3 10.9-3.6 16.7h7.7l2.7-16s0-.2.1-.5c.2-1.3.6-4.8.6-4.8s1.8.8 3.1-11.8c1.3.5 2.6.9 4 1.2l3.1.6c1.4.2 2.9.3 4.4.3 1.3 0 2.7-.1 4-.3l.9.1-.3-.2c2.6-.4 5.2-1.2 7.6-2.3 3.9-1.8 7.3-4.4 10.1-7.6 3.5-4 6-8.9 7.3-14.1-23-11.9-37.4 10-39.7 13.2 1.3-11.1 2.2-20.2 2.4-21.3.5-2.9 2.4-9.3 2.2-12.2.9.3 1.8.9 2.4 1.7 2.9.4 4.6 3.1 6.8 2.3 0 0-3.4-6.5-2.9-6.6 48.2-.8 39.1-40 36.6-40.3zm-31.7-16.6c-7.6-.4-5.5 19-2.5 13.5s12.9-4.2 12.9-4.2-5.7-9-10.4-9.3zM91.1 11.7c.1 0 .2-.1.4-.1-.2 0-.3 0-.4.1zm0 0z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-158',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M43.1 61.4C41.3 50.1 43 40.9 48.3 34c-4.7-3.7-10.5-5.8-16.5-5.9-.7 0-1.5 0-2.2.1C21 29.1 15 32 11.2 37c-3.8 5-5 11.8-3.6 20.2 3.1 19.1 36.1 49 41.9 54.1l-5.7 9.3 5.2-1.1V160h7v-40.6l5.6 1.2-5.6-9.2c1.6-1.4 5.8-5.2 11-10.4-11.1-12.7-21.9-27.6-23.9-39.6zm104.7-26.3c-4.7-6.3-12.1-9.8-22.3-10.9-.9-.1-1.8-.1-2.7-.1-8.1.1-15.9 3.2-21.8 8.8-6-5.7-13.8-8.8-22-8.9-.9 0-1.8 0-2.7.1-10.3 1.2-17.6 4.7-22.3 11-4.7 6.2-6.3 14.4-4.6 24.5 3.7 22.6 41.8 56.2 46.2 60 .1.1.3.2.4.3l-5 8.1 6-1.3V160h6v-33.3l5.9 1.3-4.5-7.4h.5c.6-.3 1.2-.7 1.7-1.1 4.3-3.7 42.1-37.3 45.8-59.9 1.6-10.1.1-18.3-4.6-24.5zm-6.6 30.5c-3.7-13.6-12.6-25.3-24.8-32.4 1-.1 2.1-.2 3.1-.2 3.1 0 6.2.6 9.1 1.8 12 5.1 17.6 18.8 12.6 30.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-159',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M108.9 119.6c-11.7-7-7.9-17.3-10.8-52-1-12.6-.8-39-.1-67.6H51.2c2.6 16.5 4.1 33.1 4.4 49.8 0 0-34.6 25.8-11.8 41.1V143h7.9c0-22.9 1.9-36.1 3.7-42.7C72.5 121.6 69.6 143 69.6 143h59.8c6.6-12.7-8.8-16.4-20.5-23.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-160',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M133.3 29.6c-14.3-14.2-37.7-14.1-52.2.3-9.5 9.4-13.2 23.2-9.5 36l-7.4 7.4.8.8-52 51.5L25.6 138l51.9-51.5 1.6 1.6-51.9 51.5 3.4 3.4 12.1-.1.1-14 13.2-.1.1-13.1 12.3-.1.1-12.2 14.2-.1 5.9-5.9.8.8 7.4-7.4c12.9 3.6 26.8 0 36.3-9.5l.3-.3c14.1-14.1 14.1-37.2-.1-51.4zm-20.9 34.5c-8 0-14.5-6.4-14.5-14.4s6.4-14.5 14.4-14.5 14.5 6.5 14.5 14.5c0 7.9-6.4 14.4-14.4 14.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-161',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80.5 11.3c-27.2 0-49.3 16.3-49.3 36.5 0 16.1 14.2 29.8 33.8 34.6v57.2l8 6.1V85h6v65.1l2.5 1.9L98 139.5V81.8c18.6-5.2 31.8-18.5 31.8-34 0-20.2-22.1-36.5-49.3-36.5zm0 31c-6.6 0-12-5.1-12-11.3s5.4-11.3 12-11.3 12 5.1 12 11.3-5.4 11.3-12 11.3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-162',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M115.9 148.1c-3-14.2-10.8-21.2-11-21.4 2.4-.9 5.1-1.2 7.6-.6 3 .4 5.7 2.1 7.5 4.5.1.2.3.3.5.3.5.2 1-.1 1.2-.6.2-1.2.1-2.3-.3-3.5-1.1-3.3-4-5.8-7.5-6.5-2.3-.4-4.6-.1-6.8.8 2.1-1.5 4.5-2.7 7-3.3 6.1-1.7 11.3-.9 15.5 1.4.2.1.4.2.6.1.5-.1.8-.5.7-1-.8-2.5-2.4-4.7-4.6-6.2-4.4-3.4-10.1-4.6-15.5-3.1-1.7.5-5.2 3.1-6.6 4-3.6 4.1 1.7-7.8 15.6-8.1.3 0 .7-.1.9-.4.3-.4.3-1-.2-1.4-1.9-1.4-4.1-2.3-6.4-2.7-6-1.1-12.3.5-16.1 4.6-1.3 1.4-2.3 3.1-2.9 4.9-1.7-1.2-3.6-2.1-5.6-2.5-5.8-1.4-11.9.3-16.1 4.4-1.6 1.4-2.7 3.2-3.3 5.3 0 .3 0 .6.2.8.4.5 1.1.7 1.6.3 10.7-6.3 22.9-2.3 20.2-1.5-1.7-.1-8.6-.2-10.3.2-5.1 1.4-9.1 5.3-10.5 10.5-.7 2.4-.6 4.9.4 7.2.1.2.2.3.4.4.5.3 1.1.1 1.4-.4 1.9-3.9 5.6-7.2 11.5-8.9 2.8-.8 7.4-1.9 9.8-1.7-2.9.5-5.6 1.8-8 3.6-2.4 2.4-3.1 6-1.8 9 .5 1.1 1.2 2.2 2.1 3 .1.1.3.2.5.2.5 0 .9-.3 1-.8-.2-2.8 1-5.6 3.1-7.5 1.6-1.7 3.8-2.9 6.2-3.3 2.4 5.7 3.7 11.8 3.9 18-5.7-.5-11.6-.8-17.6-.8-13.9 0-27.8 1.5-41.4 4.5 2.6-50 37.8-83.1 37.9-83.3 4.3 2.5 9.3 5.9 11.7 11.3 3.1 7 1.3 13.8-1.5 19-.8 1.5 1.1 3.1 2.8 2.4 2.8-1.1 5.3-2.8 7.3-5 5.7-5.8 7.8-13.9 4.6-21-2.1-4.6-6.9-10.4-11.6-12.6 5.9-.9 18.2 3.1 23.2 7.3 11.3 9.7 10.7 20.2 11.1 30 .1 1.8 2.7 2.7 4 1.2 4.1-4.2 6.7-9.6 7.5-15.4 1.9-11.8-3.2-23.7-13.2-30.4-3.4-2.3-14.2-5.4-18.7-6 .4 0 7-3.3 15-2.9 10.7.6 18.5 6.5 25.1 17.7 1.2 2 4.8 1 5-1.2.5-4.3-1.1-7.9-3.4-12.9-5.7-12.2-17.6-20.4-31.1-21.3-4.9-.4-9.9.1-14.6 1.5.5-4.3-.1-8.7-1.6-12.8-2.5-6.8-7.5-12.2-14-16h-33c16.8 3 24.7 9.7 27 15.6s-.9 11.2-.7 11.5c-2.1-3-6.8-8.9-10.1-11.3C61.2 8.1 47 6.9 34.6 11c-7.3 2.4-12.3 6.1-15.8 10.3-1.1 1.4.2 3.2 2.1 2.9 11.2-2 26.8-4.9 39.1 2.1 9.9 5.7 11.1 14.1 10.7 18-3.5-3.5-10.7-6.7-16.3-7.4-8.6-1.1-18.9 2-24.2 8.1-2.2 2.5-3.5 6.7-3 9 .1.3.2.5.3.8.8 1.3 2.4 1.7 3.7 1 5.2-3.5 12.1-5.4 20.6-4.4 7 .9 12.3 3.4 16.1 6.8-.6.4-39.4 25.7-67.1 101.8H160v-1.7c-14.3-4.8-29.1-8.2-44.1-10.2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-163',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M143 64l-34-47c-.3-.4-.6-.6-1.1-.8-.5-.2-1-.2-1.5-.1L51 30c-.9.3-1.7.8-2.3 1.4L14 64c-1.2 1-1.6 2.6-1 4 .4.7 1.2 1 2 1h7v46c-.1.8.3 1.6 1 2l49 28c1.4.4 2.8.7 4.2 1 1.3-.2 2.6-.6 3.8-1l53.6-27.1c.3-.2.6-.4.8-.8 1-.7 1.5-1.9 1.5-3.1V67h4s2.2.3 3-1c1-1.5.1-2 .1-2zm-73 69.1L30 113V69h40v64.1zM133 63h-2c-.1 0-.1.1-.2.2-1.7.5-2.8 2.1-2.8 3.8v44c0 .3 0 .6.1.9L117 117V74c-7.6 1.7-9.5 2.2-18 4v47l-17 9V66c0-1.3-1.5-2-2.8-2L72 63l33-38 29 38h-1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-164',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M109 20l-37 8v-7l-4.2-1-9.8 2v8l-11.9 1.8L16 72.2c29.7-.5 55.1-2.2 55.1-2.2l36.6-43.5L143.9 70l8.1 1-43-51zM76 78l-51 1v62l47 6 26-4V96l21-1v44l18-2V76l-29.5-35.2L76 78zm-28 38l-12-1V97h12v19zm20 2l-13-1V97h13v21z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-165',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M112 17H44.5L17 59l60.3 12.9 29.9-51 32.6 40 8.2-.1zM79.4 82.5L23 70v49l33 14.4V89.9L73 94v47l7.3 2.9v.1l56.7-25V68l-29.6-34.1-28 48.6zM109 113l-14 5v-11l14-5v11zm5-30l13-4v11l-13 4V83zm0 17l13-4v10l-13 5v-11zm-5-4l-14 5V89l14-4v11z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:50},{figure_id:'free-166',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M116 148c-5.5 0-11-.4-16.4-1.1L80 88c14.8-4.8 30-7.9 45.4-9.4 1.9-.2 3.7-1.4 4.6-3.1.9-1.8.9-3.8 0-5.6-12.7-25-41-38.6-68-31.9 0 0-.3.1-.7.2l-2.7-7.3c-1.1-3.1-4.6-4.7-7.7-3.6-3.1 1.1-4.7 4.5-3.6 7.6l2.7 7.5c-24.5 12.1-37.9 40.1-32.8 67.2.4 2 1.7 3.6 3.5 4.4 1.8.8 3.9.6 5.5-.5C39.7 104.8 54 97.6 69 92l17.8 51.3C75.4 138.1 60.4 135 44 135c-17 0-32.5 3.4-44 8.9V160h160v-20.9c-11.5 5.5-27 8.9-44 8.9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-167',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M149.4 119.5C132 105.4 114 97.7 89 96.2v-6.4c13.5-3.7 23.3-15.2 24.8-29.1 2-18.7-11.5-35.4-30.1-37.5-18.7-2-35.4 11.5-37.5 30.1l-.2.2v6c0 4.7 3.8 8.5 8.5 8.5s8.5-3.8 8.5-8.5V56c.5-9 8-16 17-16 9.4 0 17 7.6 17 17s-7.6 17-17 17c-4.5.3-8 4-8 8.5v13.6c-25.4 1.4-42.8 9.1-60.4 23.4-4.2 3.4-4.8 9.6-1.5 13.8 2.3 2.9 6 4.2 9.5 3.5.4.1.9.2 1.3.2h123c.7 0 1.3-.1 1.9-.4 1.9-.6 3.6-1.7 4.9-3.3 3.5-4.2 2.9-10.4-1.3-13.8zM35.5 127c27.1-14.9 62.9-14.9 90 0h-90z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-168',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M37 99c-8.8 0-16 3.2-16 7.2 0 1-.9 1.5 2.6 3.9C28.4 115.3 31 122 31 129v31h12v-31c0-7 2.6-13.7 7.4-18.9 2.7-1.8 2.6-3.6 2.6-3.9 0-4-7.1-7.2-16-7.2zm63.7-46l-9.5-9c-4.3-4.1 1.8-12.4 5.5-16.3 5.9-6.2 14-8 19.2-9.3 5.2-1.3 3-8.7-3.3-9.3-6-.6-27.9.2-41.5 14.6l-.6.6-16.2 17.2 4.1 3.9-7.9 8.3-4.7-4.5-14 14.8 21.9 20.8 14-14.8-4.7-4.5 7.9-8.3 16.6 15.7 16.3-17.1-3.1-2.8zm9.1 8.2L93.3 78.6 160 148v-43.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-169',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M64 93l-5.6 67H99l-5.6-67zm78-41.4C137.5 45.7 118.3 27 94 27H64v7H50v-8H25v37h25v-8h14v28h29V62c0-7.4 12.5-8.9 19.1-8.9 10.5 0 18.9 5.7 24.4 9.2 5.6 3.6 10.2-4.7 5.5-10.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-170',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M93 134H68c-1.7 0-3 1.3-3 3v23h31v-23c0-1.7-1.3-3-3-3zm38.4-13.8l-20.2-30h6.6c.7 0 1.4-.2 1.9-.6 1.2-.9 1.4-2.7.4-3.8l-20.8-30h7.4c.6 0 1.3-.2 1.8-.6 1-.9 1.2-2.5.3-3.5l-26-35.5c-.2-.3-.4-.5-.7-.7-1.3-.9-3-.6-3.9.7l-26 35.5c-.4.5-.6 1.1-.6 1.8.1 1.4 1.3 2.4 2.7 2.3h7.4l-20.8 30c-.7.9-.8 2-.3 3 .5.9 1.5 1.5 2.6 1.4h6.6l-20.2 30c-.7.9-.8 2.2-.3 3.2.6 1 1.7 1.6 2.8 1.5h96.7c1.2.1 2.2-.5 2.8-1.6.6-.9.5-2.2-.2-3.1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-171',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M124.3 63.9c-.1 0-.1 0 0 0 2.5-3.6 4-7.9 4-12.2 0-11.3-9.1-20.5-20.4-20.6-1.1 0-2.3.1-3.4.3-3.6-5.8-9.2-10-15.7-12.1-15.3-4.8-31.6 3.7-36.4 18.9-.8-.1-1.6-.2-2.4-.2-9.9 0-18 8.5-18 19 0 3.1.7 6.1 2.1 8.9C30.2 71 28 77.2 28 83.6c0 16 12.9 29.1 29 29.1.6 0 1.3-.1 1.9-.3l11 17.1-5.7 30.5h33.5l-6.8-31 10.7-16.6c1.5.2-.1.3 1.4.3 7.3 0 14.3-2.8 19.6-7.7 11.9-10.9 12.6-29.3 1.7-41.1zm-44.6 55.8l-7.3-11.4c2.9-1.9 5.5-4.2 7.6-7 2 2.6 4.4 4.9 7.2 6.7l-7.5 11.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-172',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M99 25.4C93 18.5 86.8 15 80.5 15c-6.2 0-12.4 3.5-18.4 10.4-15.9 18.2-25.7 54.4-14 66.5 6.4 6.6 18.8 9 25.2 9.8L72 130H57c-1.7 0-3 1.3-3 3v9c0 1.7 1.3 3 3 3h47c1.7 0 3-1.3 3-3v-9c0-1.7-1.3-3-3-3H89l-1.3-28.3c8.6-1.2 20-4.5 25.2-9.8 11.7-12.1 1.9-48.3-13.9-66.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-173',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M130.2 60.8c-1.2 2.4-5.2 5-9 5 2.5.8 5.2 4.1 5.1 5.8-.4 8.8-9.2 8.9-19.6 4.4 7.5 3.6 7.7 8.9 7 11-2 6.8-8.7 10.1-15.9 10.1-2.8 0-5.1-1.8-6.8-3.9V128h18c1.7 0 3 1.3 3 3v10c0 1.7-1.3 3-3 3H57c-1.7 0-3-1.3-3-3v-10c0-1.7 1.3-3 3-3h18V93.7c-2.4 2.7-6.1 3.6-9.5 2.5-4.9-1.5-6.7-6.1-2.9-16.3.4-2.4-.9 6.9-8.5 8-1.9.1-3.8-.3-5.5-1.3-5.3-2.7-7-13.1 1.5-18.9C41.8 71.8 36 67 34.7 63c-1.3-4.1-1-8.6 1-12.5 1.1-2.2 4.9-4.3 13.5-3.4-10.2-1.4-9.9-7.4-9.9-8.9.4-10.9 12-7.4 18-1.8C53.2 29.7 50.1 12.5 70 13c4.6.1 12.7 2.2 13.5 16.1 2.7-19.5 25.9-13.8 20.7 0 16.5-24.8 34.1 4.8 15.3 12.5 5.4-.3 10.5 2.6 11.8 6.7 1.2 4.2.9 8.7-1.1 12.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-174',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M89 135H76c-2.8 0-5 2.2-5 5v20h23v-20c0-2.8-2.2-5-5-5zm37.6-40.9h-1.4c1.4-2.6 2.1-5.5 2.1-8.5 0-8.3-5.4-15.1-12.2-15.8 1.6-2.8 2.4-5.9 2.4-9.1.1-4-1.3-7.9-3.8-11-2.3-2.9-5.8-4.6-9.6-4.7h-2.6c.6-2 .9-4 .9-6.1 0-11.1-9-20-20-20s-20 9-20 20c0 2.1.3 4.1.9 6.1h-2.6c-3.7 0-7.2 1.8-9.6 4.7-2.5 3.1-3.9 7-3.8 11 0 3.2.8 6.3 2.4 9.1-6.8.7-12.2 7.6-12.2 15.8 0 3 .7 5.9 2.1 8.5h-1.4c-7.4 0-13.4 7.2-13.4 16.1S30.6 126 38 126h89c7.4 0 13-6.9 13-15.8s-6-16.1-13.4-16.1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-175',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M38 40c-1.6-6.3 2.2-13.6 7.9-18 5.3-4.1-.2-13.1-5.6-8.9C30.1 20.3 23.1 33.5 27.1 47c2.3-3.2 5.4-6.3 10.9-7zm82.5 83.2c-7.5-5.5-41.8-30.7-54.8-63-4.4-11-11.7-15.3-19-15.3-2.7 0-5.4.5-7.9 1.5-2.7 1.1-5.2 2.5-7.4 4.4-7 5.7-11.2 14.5-8.4 22.3 0 0 7 53.6 79.2 64.6 15.1 2.3 25.1 3.3 31.2 3.3 23.2 0-7-13.4-12.9-17.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-176',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M86 60.9c-3.8 3.5-22.6 17.2-33.3 17.2C40.2 78.1 40 88 40 88c0 17.8 8.4 6 32.4 19.1 33.7 24 84.5-17.2 73-30.9C116 41.3 90.6 56.8 86 60.9zm5.8-37.6c-15.8 3.8-38.1 35.2-35 47.1.6 5.2 26-13.9 32.3-18.4 4.7-3.5 16-7.5 25-3 4.2.4 3.7-5 1.8-8.4-4.5-7.9-13.3-19.9-24.1-17.3zM82 133c9.6 3.7 23.1-5 23-9.3-.3-9.3-13.8 6.5-37.4-13.5-2.8-1.7.9 8.8 2.4 11.8 1.9 3.6 6.5 9 12 11zm-43-32c-2.7-3-4.1-7-4-11 .1-5.4 1.2-10.2 5-13 3.8-2.8 2-6 0-8-6.2-6.1-7.2-13.8-16.7-9.1-12.8 6.4-17.3 45.2 0 55.5 7 4.4 9.1-2.1 15.6-7.4 1.9-1.6 2.2-4.6.5-6.5 0-.2-.2-.3-.4-.5zm76.5-32c6.9 0 12.5 5.6 12.5 12.5S122.4 94 115.5 94 103 88.4 103 81.5 108.6 69 115.5 69z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-177',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M150 81c-13.7-51.9-60.4-56.6-95.8-20.5-2.7 3-6 4.9-9.2 2.5L20.5 44.4c-3.2-2.4-4.9-1.2-3.8 2.6L28 74c1.3 3.8.4 8.9-1.2 12.9s-14 28.1-14 28.1c-1.5 3.7.2 5.2 3.8 3.4L47 101c3.6-1.9 7.7 1.3 10.7 4 14.6 12.8 56.9 31.9 86.5-9.6 2.3-3.3 6.8-10.5 5.8-14.4zm-32 2c-6.1 0-11-4.9-11-11s4.9-11 11-11 11 4.9 11 11-4.9 11-11 11z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-178',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M145 64.4l-21.2-28.2c-1.6-1.9-3.8-3-6.3-3.1h-13c-1.5-.1-2.9.7-3.4 2.1C97.6 46.9 89 52.9 80.5 53c-8.5-.1-17.1-6-20.6-17.9-.5-1.4-1.9-2.3-3.4-2.1h-13c-2.4.1-4.7 1.3-6.3 3.1L16 64.4c-1.4 2-1.3 4.6.1 6.6l11.7 15c.2.3.4.5.7.7 1.5 1.2 3.7.9 5-.6l10.2-10.9c-.2.2-.1.2.5-.5l-.1.1.2-.3c0 .1-.1.1-.1.1 1.2-1.2 3.9-3.1 3.9 1.2l-4 57v.5c0 1.9 16.3 3.5 36.5 3.5s36.5-1.6 36.5-3.5v-.3l-4-57c0-4.4 2.7-2.4 3.9-1.2 0-.1-.1-.1-.1-.1l.2.3-.1-.1c.6.7.7.7.5.5l10.2 10.9c.2.3.5.5.7.7 1.6 1.1 3.8.8 4.9-.8l11.7-15c1.3-2.2 1.4-4.8 0-6.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-179',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M136.8 53.2c-17.3-4.8-25.5-15.5-32-23.8C97.7 20.1 93.8 15 80 15s-17.7 5.1-24.9 14.4c-6.4 8.4-14.7 19.1-32 23.8-4.1 1.1-6.7 4.7-6.2 8.5 6.7 50.6 41.9 73.9 58.6 82.3 2.7 1.3 5.9 1.3 8.6 0 16.7-8.4 51.9-31.7 58.6-82.3.7-3.8-1.9-7.4-5.9-8.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-180',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M146 97c0-7.1-2-13.4-10.9-16.6L123.6 45c-1-2.8-3.6-4.8-6.6-5H21c-2.8 0-5 2.2-5 5v67c0 1.7 1.3 3 3 3h5.3c1.3 7.6 7.2 13.5 14.8 14.8 9.8 1.6 19.1-5 20.7-14.8h40.5c1.3 7.6 7.2 13.5 14.8 14.8 9.8 1.6 19.1-5 20.7-14.8h7.3c1.7 0 3-1.3 3-3V97.3v-.1c-.1-.1-.1-.1-.1-.2zM42 121c-5 0-9-4-9-9s4-9 9-9 9 4 9 9-4 9-9 9zm37-40H26V50h53v31zm10 0V50h25l9.6 31H89zm29 40c-5 0-9-4-9-9s4-9 9-9 9 4 9 9-4 9-9 9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-181',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M84.7 132.5c18.1 2.2 50-3.9 51.8-5.1 1.2-.9 6.8-13.8 8.8-20.4-8.1 2.8-20.8 9-49.1 9-5.4 0-10.3-1.5-13.7-2.4l-.7-.2-.3-.5c-.2-.4-19.6-34.9-49.3-40.2-6.1-1.1-10.5-3.3-13.4-6.4 1 6.4 4.8 14.9 8.9 26.9 8.3 24.2 12.5 37.7 12.5 37.7s26.4-.5 44.5 1.6zM18.5 51.3c1.5 6 6.3 9.9 14.5 11.6 17.2 3.4 31 16.4 39.5 26.7 8 9.6 12.8 15.6 14.1 18 3.1.9 9.5 1.3 14.4 1.3 17.4 0 36.3-5.2 42.3-7.5.5-.2 1-.4 1.5-.7.9-1.6 3.5-3.3 1.5-7.4-1.6-3.4-6.1-5.8-13.2-7-24.2-4.2-26.4-27.8-27.3-36.6-1-10.9-2.4-12.5-3.1-12.5-.2 0-.4.1-.6.2-.6.3-1.1.6-1.6.9-.8.6-1.8 1-2.9 1-1.4 0-3.3-.5-8.2-1.8-1.6-.4-3.2-.6-4.8-.6-7.9 0-15.3 4.4-15.3 4.4l-1.6.9-.7-1.7C65.6 37.6 41.9 22 31.1 18c-4.2 3.8-15.3 20.5-12.8 32.8.1.2.2.3.2.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-182',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M141.1 121.2L118 96h9c1.3.1 2.4-.7 2.8-1.9.5-1.1.2-2.4-.7-3.2L106 65h9c2 0 2.6-.9 2.8-1.4.4-1.1.1-2.4-.8-3.2L95 38l7.9.1c1.2.1 2.4-.6 2.9-1.7.4-1.2.1-2.5-.8-3.3L83.9 11.2c-.8-.7-1.8-1.2-2.9-1.2-1.1 0-2.1.4-2.9 1.2L57 33.1c-.9.8-1.3 2.1-.8 3.3.5 1.1 1.6 1.7 2.8 1.6h8L45 60.5c-.9.8-1.3 2.1-.8 3.2.3.6.9 1.4 2.8 1.4h10L33 90.8c-.9.8-1.2 2.1-.7 3.3.4 1.2 1.5 2 2.8 1.9h8L21 121.2c-.9.9-1.2 2.2-.7 3.3.5 1 1.6 1.6 2.8 1.5h47v34h20v-34h49c1.4 0 2.3-.4 2.8-1.4.3-1.2.1-2.5-.8-3.4zM79 41c3.9 0 7 3.1 7 7s-3.1 7-7 7-7-3.1-7-7 3.1-7 7-7zm-24.5 75c-4.1 0-7.5-3.3-7.5-7.5 0-4.1 3.4-7.5 7.5-7.5s7.5 3.4 7.5 7.5-3.3 7.5-7.5 7.5zm15.3-30.2c-2.9 2.9-7.6 3-10.6.1s-3-7.6-.1-10.6c2.9-2.9 7.6-3 10.6-.1s3 7.6.1 10.6zM92 97.5c0 4.1-3.4 7.5-7.5 7.5s-7.5-3.4-7.5-7.5 3.4-7.5 7.5-7.5 7.5 3.4 7.5 7.5zm.5-19.5c-4.1 0-7.5-3.4-7.5-7.5s3.4-7.5 7.5-7.5 7.5 3.4 7.5 7.5c0 4.2-3.4 7.5-7.5 7.5zm23.3 31.2c0 4.6-3.8 8.4-8.4 8.4s-8.4-3.8-8.4-8.4c0-4.6 3.8-8.4 8.4-8.4 4.6 0 8.4 3.7 8.4 8.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-183',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M132.1 24H27.9c-4.4 0-7.9 3.5-7.9 7.9v96.2c0 4.4 3.6 7.9 7.9 7.9h104.2c4.4 0 7.9-3.5 7.9-7.9V31.9c0-4.4-3.6-7.9-7.9-7.9zM121 94H94v27c0 1.7-1.3 3-3 3H70c-1.7 0-3-1.3-3-3V94H40c-1.7 0-3-1.3-3-3V70c0-1.7 1.3-3 3-3h27V40c0-1.7 1.3-3 3-3h21c1.7 0 3 1.3 3 3v27h27c1.7 0 3 1.3 3 3v21c0 1.7-1.3 3-3 3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:90},{figure_id:'free-184',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M59.2 44.6H65c2-.1 3.7-1.4 4.5-3.2 1.7-4 5.8-10.4 14.3-10.4 8.2 0 11.5 6.3 12.8 10.3.6 1.9 2.3 3.2 4.2 3.3h7.4c1.6-.2 2.8-1.7 2.6-3.4-1-7.4-5.3-24.2-27.4-24.2C61.8 17 57.1 33.8 56 41.2v.5c.1 1.7 1.5 3 3.2 2.9zm15.9 51.2c3.3.1 6.3-2 7.3-5.2L91 61.4c.2-.5.3-1 .3-1.5 0-2.4-2-4.3-4.3-4.2l-62.4-3.2c-3.3-.1-6.2 2.1-7 5.3l-6.5 28.9c-.1.3-.1.7-.2 1.1 0 2.6 2 4.7 4.6 4.7l59.6 3.3zm8.5 16c-1.2-3.1-4-5.4-7.4-5.8l-59.1-4.3c-3.1-.2-4.9 2-3.9 4.9l8.4 26.3c1.2 3.1 4 5.4 7.4 5.8l59 4.3c3.1.2 4.9-2 3.9-4.9l-8.3-26.3zm63.6-34.3L137 53.6c-1.4-3.1-4.8-4.7-8.1-4L108.6 55c-3.5 1.1-6.1 3.9-7.2 7.4l-8.6 35.7c-.8 3.8-.7 7.8.2 11.6l8.1 28.4c.1.3.2.5.3.8 1.2 2.6 4.2 3.8 6.9 2.7l31.2-12.9c3.3-1.6 5.6-4.6 6.1-8.2l3.2-31.5c.4-3.9-.2-7.8-1.6-11.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:90},{figure_id:'free-185',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M55.4 142.3c16.8 6.9 34.3 3.2 41.3-13.8s-1.3-37-17.7-43.1c-14.5-5.4-36 1.1-43.1 18.1s2.7 31.9 19.5 38.8zM42 76.7C46.3 66.3 45.2 56 39.8 53c1.2-5.9 3.1-13.1 5.5-15.2 0 0-9 2.4-14.7 16.3-4 2.5-7.9 7.4-10.4 13.6-4.5 10.8-3.2 21.5 2.8 24s14.5-4.2 19-15zm22-3.8c6.8 2.8 16.3-4.8 21.3-16.9s3.6-24.2-3.2-27c0 0-.1 0-.1-.1 1.1-6.2 3.2-15.7 6.1-18.1 0 0-10.6 2.8-16.1 20.1-4.3 2.9-8.4 8.2-11.2 14.9-5 12.1-3.6 24.2 3.2 27.1zm29.2-13.7c-5 12.1-3.6 24.2 3.2 27s16.3-4.7 21.3-16.9c4-9.7 3.9-19.4.2-24.3 5.5-13.6.9-21.5.9-21.5.4 4.1-5.9 13.5-9.5 18.5-5.8 1.4-12.3 8-16.1 17.2zm40.7 12.1c.2 2.8-2.4 7.8-5.3 12.4-5.8-.6-13.1 5.8-17.1 15.5-4.5 10.8-3.2 21.6 2.8 24s14.5-4.2 19-15c3.2-7.6 3.4-15.3 1.2-19.9 2.9-10.9-.6-17-.6-17z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-186',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M127.6 138.7c-.2.1-23.5 5.3-43.5 5.3h-7.2c-20 0-43.3-5.2-43.5-5.3-.9-.2-1.5-1-1.3-1.9 6.2-24.5 5.3-23.6 9.5-35.2 4.4-12.2 13-19.1 17-23.1 4.1-4.1 4.9-8.6 4.4-11.3l-5.1-8.8c-.2-1-.6-2.2-1-3.5-.9-2.4-1.5-4.8-1.7-7.3 0-1.1.1-2.1.2-3.1H55c-3.2 0-5.7-1-6.8-2.9-.8-1.5-.8-3.3.1-4.7 1.8-4 1.8-8.5 0-12.5-1.1-2-.7-3.4-.2-4.2.8-1.3 2.6-2.1 5-2.1.8 0 1.6.1 2.5.2 5.5.9 13.7 13.3 18.2 15.2 2.4 1 4.6 2.6 6.4 4.6 1.7-2 3.9-3.6 6.4-4.6 4.6-1.9 12.7-14.2 18.2-15.2.8-.1 1.6-.2 2.5-.2 2.4 0 4.1.7 5 2.1.5.8.8 2.2-.2 4.2-1.8 4-1.8 8.5 0 12.5.9 1.4.9 3.3.1 4.7-1.1 1.8-3.6 2.9-6.8 2.9h-.4c.2 1 .2 2.1.2 3.1-.2 2.5-.8 5-1.7 7.3-.4 1.3-.8 2.5-1 3.5l-5.1 8.8c-.5 2.8.3 7.2 4.4 11.3 4 4.1 12.7 11 17 23.1 4.2 11.6 4.3 10.8 10.4 35.2-.1.9-.7 1.7-1.6 1.9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-187',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M109 104H51c-1.7 0-3 1.3-3 3v9c0 1.7 1.3 3 3 3h3.6l3.9 21.4c.3 2.7 2.6 4.7 5.3 4.6H96c2.7.1 5-1.9 5.3-4.6l3.9-21.4h3.8c1.7 0 3-1.3 3-3v-9c0-1.7-1.3-3-3-3zm25.3-62c3.7-6.9-9.4-23.9-26.7-14.9.2-3.8-3.1-17.7-26.1-17-11.7.4-20.3 7.7-22.3 19-15-3.5-23.1 4.1-23.1 13 0 3.5 1.7 6.7 3.8 9.4-7 2.6-11.9 8.6-11.9 15.6 0 9.4 8.8 17 19.6 17 3.9 0 11.2-3.4 13.4-6.1l8.4 18h18.5L106 73c3.2 6.2 13.5 8 18.9 8 13 0 23.1-9.4 23.1-20.6 0-8.2-5.6-15.2-13.7-18.4zM76 84L64.9 73c1.2-1 2.3-4.2 2.3-5.8 2.1.9 8.7 2.3 11 2.8L76 84zm8.7 1l-1.2-14c6.4-.6 12.6-2.5 18.2-5.7.2.6 1 3.1 1.3 3.7L84.7 85z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-188',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M59 106h9v41c.1.4.5 4 7 4 6.8 0 7.9-3.6 8-4v-41h8v-7H59v7zm84.6-74.9c-1.3-1.6-2.9-3.1-5.6-3.1H122.2c-.5-3.5-1.2-6.8-1.5-8H31c-1.2 2.5-2.1 5.2-2.5 8H14v15h14.6c.5 3.1 1.3 6.1 2.4 9.1h89.7c.8-3 1.4-6 1.8-9.1H133v24H79c-6.9-.3-9.9 2.6-10 8v22h13V79h56c.4 0 4.2-1 5.3-2.2 1.2-1.3 1.8-3 1.7-4.8V37c0-.1.5-3.6-1.4-5.9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-189',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M122 28.4S121.6 14 110.4 14C99.3 14 98 21 98 21H83c-1.7-.1-3.3-.1-5 0L18.9 35.4c-1.2.2-2 1.3-1.9 2.5.8 5.5 4.5 20.6 20.2 32.8 1 .7 2.3.6 3.2-.2l39.4-37.2c1-.9 2.3-1.4 3.7-1.4L99 32v21h-6c-8.3 0-15 6.7-15 15v63c0 8.3 6.7 15 15 15h27c8.3 0 15-6.7 15-15V68c0-8.3-6.7-15-15-15h-5V36s5.7 1.5 8.9 2.1-1 3.7.9 5.7 19.1 12.2 19.3 8.4C143.2 32 122 28.4 122 28.4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-190',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M143.8 58.8l-42.6-42.6c-6.1-6-15.9-5.9-21.9.1L53.1 53c-5.4 5.4-3.4 11 .7 17l6.8 9-9.2 9.2 3.5 3.5-43.1 43.1L26 148.9l43.1-43.1 3.5 3.5 9.2-9.2 8.3 6.1c6 4.1 11.6 6 17 .7l36.6-26.2c6-6 6.1-15.8.1-21.9zM30.9 139.7c-2 2-5.1 2-7.1 0s-2-5.1 0-7.1 5.1-2 7.1 0 2 5.1 0 7.1zm10.6-10.6c-2 2-5.1 2-7.1 0s-2-5.1 0-7.1 5.1-2 7.1 0c1.9 2 2 5.1 0 7.1zm10.6-10.6c-2 2-5.1 2-7.1 0s-2-5.1 0-7.1 5.1-2 7.1 0c2 1.9 2 5.1 0 7.1zm10.6-10.6c-2 2-5.1 2-7.1 0s-2-5.1 0-7.1 5.1-2 7.1 0 2 5.1 0 7.1zm55.9-27.6L81.1 42.8l11.3-11.3L129.9 69l-11.3 11.3z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-191',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M18.9 113c.2 1.7.7 3.4 1.3 5 4.6-.7 9.2-1.1 13.8-1 1.6 0 3.2-.1 5 0 7.4.4 14.8 1.2 22.2 2.3 2.9.4 5.9.9 9 1.4 3.9.7 8 1.5 12.3 2.5 8.7 1.9 17.6 2.8 26.5 2.8 23.3 0 37-7 37-7-.2-11.2-9.9-14.2-20-15-1.1-.1-1.9 0-3 0h-7c-3.8 0-7.1-.5-10.3-2.5l-8.9 7.7c-1.7 1.4-4.2 1.3-5.6-.4-1.4-1.7-1.3-4.2.4-5.6l8.4-7.3c-1-.8-1.6-2-2.9-2.9-.5-.7-1-1.3-1.6-2l-10.6 9.2c-1.7 1.4-4.2 1.3-5.6-.4-1.4-1.7-1.3-4.2.4-5.6l10-8.7c-.7-.7-1.7-1.8-2.6-2.5-.7-.6-1.3-1.1-1.9-1.5l-11.3 9.8c-1.7 1.4-4.2 1.3-5.6-.4-1.4-1.7-1.3-4.2.4-5.6l11.4-9.8c-.1-1 0-2.6 0-4.4H63c-2.2 0-4-1.8-4-4s1.8-4 4-4h16.8c-.1-1.9-.3-3.9-.5-6H63c-2.2 0-4-1.8-4-4s1.8-4 4-4h14.9c-1.2-8.4-2-16.8-2.1-20.7-.2-7-5.6-3.3-33.4-3.3-12.8 0-20.1 6.3-20.1 6.3S36.6 61.6 26 84.1c-7 14.8-7.7 23.8-7.1 28.9zm130.5 11.1c-.6-.9-1.4-1.6-2.4-2.1-.6.3-15.3 9-39 9-8.9 0-17.8-1.9-27-4-9.6-2.1-19.4-3.6-29.2-4.5-7.8-.8-13.9-1.5-18.8-1.5-16.7 0-15.7 1.3-16 2l-.6 2.5c-.6 4.3-.6 5.8.6 8.4 6.3 2.6 29.5 2 36 2 3.2 0 4.7-3.2 5.3-6 5.7.5 11.2 1.7 16.6 3.6 10 3.6 20.5 5.4 31 5.4 16.7 0 33.1-3.2 42-8 2.3-1.1 2.7-4.7 1.5-6.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-192',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M119.5 63.8l-15.1-24.4c-1.5-2.7-4.3-4.4-7.4-4.4H33.7c-4.9.1-8.8 4.1-8.7 9v64.3c.1 4.9 4.1 8.8 9 8.7h.5c1.6 6.6 6.9 11.6 13.5 12.7 9.2 1.6 18.1-4.5 19.7-13.7h29.6c1.2 6.6 6.2 11.9 12.7 13.5 9.1 2.2 18.3-3.4 20.5-12.5h2.5c5.1 0 9-4.6 9-9.7v-7.7c0-12.9-9.9-34.6-22.5-35.8zM51 121c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zM37 73V46h57l16 27H37zm77 48c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-193',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M147.6 65.5c-2.6-2.3-4-6.6-4-6.6-5-10.6-7.5-16.8-16.7-16.8-3.4 0-10 1.6-11 5-1.1-2.4-6.3-8.8-9-8-5.3 2.2-8.9 7.7-4 10 2 1 6.4 1.6 7 2 .5 1.8.2 2.4-.8 4.5-2.7 7.3-9.3 11.1-13.5 12.8 3.2-2.6 5.7-6.1 7.2-10 1.2-3.1 1.2-5.3 1.1-5.3-1.4-.3-2.7-.8-4-1.4-3.5-1.5-3-4.4-2.7-6.2.7-3.5 3.3-6.5 8.8-10.5.9-.6 1.9-1 3-1 2.6 0 5.4 1.7 8 6 1.9-2.5 10.1-4 14-4 6.2 0 10 2.8 11 6l8-9.8-.3-.5c-.2-.4-1.1-8.7-17.7-8.7h-.4c-16.8.1-27.4 6-37.7 21-5.9 8.6-8.7 19.1-10.1 26.2-8-.2-16.6-2.3-24.3-2.3-8.9.1-13.1 3-16.9 8-.5-2.5-2.5-16.7-15.6-13.9-11.1 2.4-6.3 15.5-5 20s-1 7.9-6 8c-1.5-.1-3-.7-4.3-1.6-2-1.1-2.6.6-.1 3.9 2.3 2.9 5.7 4.6 9.4 4.7 10.3-.1 9-6.1 9-10 0-4.9 1.8-10.9 8-2.7-2.8 5.1-4.2 10.9-4 16.7.1 5.3 1.4 15.2 2.1 21.1-9.7-1.6-14.4-3.4-14.5-3.4s-.2-.1-.3-.1c-3.2-1-6.6.8-7.5 4-1.2 3.3.4 7 3.6 8.5.7.3 17.4 6.8 54.7 7h.6c37.6 0 58-13.5 58.8-14.1 2.9-2.1 3.7-6 1.9-9.1-.1-.2-.2-.3-.3-.5-1.8-2.7-5.5-3.4-8.2-1.6-.1 0-1.2.8-3.3 1.8-.3-10.4-2.1-12.7-6.6-22-4.8-10.1 3.2-18 9.2-18 6 0 7.3 6.9 7.3 6.9-.1 3.1 2.3 5.6 5.3 5.7 2.2 0 4.2-1.5 4.9-3.6 1 .4 2 .6 3 .6 4.4 0 8-3.8 8-8.6 1-5.1-2.5-7.8-5.1-10.1zM98 122c-8.3 1.7-16.8 2.7-25.3 2.8h-.6c-6.4 0-12-.5-17.1-.8l-.1-6.7c0-10.5 8-19 17.9-19h6.7c9.9 0 17.9 8.2 18.5 18.7.1 1.8 0 3.4 0 5zm32.5-60c-2.5 0-4.5-2-4.5-4.5s2-4.5 4.5-4.5 4.5 2 4.5 4.5-2 4.5-4.5 4.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-194',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M48.9 82c-.8-2.8-1.5-5.9-2.2-8.5h-.1c-.6 2.3-1.3 5.1-2.1 7.4l-3.3 9.6 11.1 2.9L48.9 82zm86-46l-47.3-9.4c-4.8-.8-9.8-.8-14.6.1l-46 9.6c-4 .8-4.1 2.3-.1 3.3L80.3 53 135 39.3c4-1 4-2.5-.1-3.3zM16.3 47.8c-.2.7-.3 1.4-.3 2v63.7c.2 4.3 3 8 7.1 9.2l47.7 12.1c2.9.9 5.9-.6 6.9-3.5.2-.7.3-1.4.3-2.1V57.8L23.2 44.2c-2.9-.9-6 .7-6.9 3.6zm25.3 19.1l10 2.6 13.9 45.8L57 113l-3.9-13-13.5-3.6-3.7 11-8.1-2.1 13.8-38.4zM139.9 44c-.7 0-1.4 0-2 .2L83 57.8v71.5c-.2 3 2.1 5.6 5.1 5.8.7 0 1.4 0 2.1-.3l47.7-12.1c4.1-1.2 7-4.9 7.1-9.2V49.8c.2-3-2.1-5.6-5.1-5.8zm-12 59.7c-3.2 3.6-8.4 6.4-16.5 8.6-3.3.9-6.6 1.6-9.9 2.1V70.5c3.8-1.7 7.8-3.1 11.8-4.2 5.9-1.6 9.7-1.8 12.6-.6 2.8.9 4.6 3.3 4.6 7.2 0 4.1-2.6 8.5-7.4 11.6v.2c4.7-.1 9 2.5 9 8.6-.1 3.8-1.6 7.5-4.2 10.4zm-5.7-28.5c0-4.3-3.2-5.4-8.4-4-1.6.4-3.2.9-4.7 1.6v12.4l4.2-1.1c5.7-1.5 8.9-5 8.9-8.9zm-9 14.9l-4.1 1.1V106c1.5-.2 2.9-.5 4.3-1 5.3-1.4 10-4.6 10-10.2 0-5.3-4.6-6.2-10.2-4.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-195',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M106.9 124.5c-7.8-6.6-20.7-37.9-15.6-78.1 2-16 5.1-31.4 5.5-46.4H45.7c1.5 19.9 4.1 23.2 9.3 37 7 18.6 5 22.3-3 35.1-7 11.3-9.6 25-3.8 29.5l2.3 40.3h9.4l.9-36c7 3.4 9.6 1.4 12.7 14.9C77.4 137.5 71 142 91.4 142h33.1c11.8-6.6-9.7-10.9-17.6-17.5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-196',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M115.4 42.4c-28.1 20.9-6.7 6.7-37.4.6-32.2-5.5-41.6-8.8-58.5-17.6-.7-.4-3.2-1.6-4.2-1.3-1 .3-1.3 1.8-1.2 2.6.8 8.1 4.2 26.8 18 35.6-3.1.9-6.4 1.1-9.6.8-.4-.1-.7.1-.9.4-.2.3-.2.7 0 1 5 6.8 10.9 31.7 52 26.4-10.7 17.5-22.1 32.3-38.1 41.9-.5.3-.9.9-.9 1.5 0 1 .8 1.8 1.7 1.8 31 .6 71.3-16.6 87-49.4 4.7-9.8 1.4-20.3 22.1-35.7 4-6.3-15.3-20.1-30-8.6zM127 53c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:40},{figure_id:'free-197',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M48.6 64.8l15 15 17-16.9-15.4-15.4c1.2-4.6 1.1-9.5-.3-14.1C60.6 20.2 46.6 13 33.4 17.2l15.4 15.4-1.2 15.1-15.1 1.2-15.3-15.5c-1.6 5-1.6 10.3 0 15.2 4.2 13.2 18.3 20.5 31.4 16.2zm94.3 45.7c-4-13.1-17.9-20.4-31-16.3l-10.8-10.8-17 16.9 11 11c-1.4 4.8-1.3 9.9.2 14.6 4.3 13 18.2 20.1 31.2 15.8l-15.3-15.3 1.2-15 15-1.2 15.3 15.3c1.7-4.8 1.7-10.1.2-15zm-18.5-61.2c2 .8 4.2.3 5.7-1.2l12-12c2.1-2.1 2.1-5.4 0-7.5l-6-6c-2.1-2.1-5.4-2.1-7.5 0l-12 12c-1.5 1.5-2 3.7-1.2 5.7l-54 53c-2.1-2.1-5.4-2.1-7.5 0l-1.5 1.5c-2.1-2.1-5.4-2.1-7.5 0l-26.4 25.5c-2.1 2.1-2.1 5.4 0 7.5l15.7 15.7c2.1 2.1 5.4 2.1 7.5 0L68.2 118c1.8-1.8 2.1-4.6.7-6.7l1.6-1.6c2.1-2.1 2.1-5.4 0-7.5l53.9-52.9zm-80.9 81.2c-3.3 3.3-8.7 3.3-12 0-3.3-3.3-3.3-8.7 0-12 3.3-3.3 8.7-3.3 12 0 3.3 3.3 3.3 8.7 0 12z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-198',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M150.8 77.9c-4.3-1.5-8.9-.9-12.8 1.4V78c0-6.1-1-12.1-2.8-17.9 1.1-.6 2.2-1.4 3.1-2.3 6-5.8 6.2-15.4.3-21.5-3.9 1-7.2 3.6-9.2 7.1-.4-3.9-1.9-7.5-4.4-10.5-4.3-5.3-11.2-7.8-17.9-6.5-2.3 6.6-.9 13.9 3.5 19.2 1.6 2 3.6 3.6 5.9 4.8-3.8.1-7.4 1.6-10.1 4.3.1.5.3 1 .4 1.4 2.8 7.8 11.5 11.8 19.2 8.9 1.3 4.4 2 8.9 2 13.5v1.6c-3.5-4.1-8.9-6-14.2-5-.3.7-.5 1.5-.6 2.3-1.5 8.1 3.9 15.9 12 17.4-1.5 4.1-3.6 8.1-6.2 11.6 0-.1 0-.3-.1-.4-1-5.3-4.7-9.6-9.8-11.4-4.1 3.5-6 8.9-5 14.1.6 3.1 2.1 6 4.4 8.1-4.8 3.5-10.1 6.1-15.9 7.6-1.3-3.4-4-6.2-7.4-7.6-6.9-2.9-14.9.4-17.8 7.3-5.7-1.6-11.1-4.3-15.8-8 .3-.3.6-.6.8-.9 5.4-6.3 4.6-15.7-1.7-21.1-4.9 1.7-8.5 5.9-9.6 10.9-2.3-3.4-4.1-7-5.5-10.9 3-.7 5.7-2.4 7.7-4.8 3.5-4.1 4.5-9.7 2.7-14.8-4.7-.9-9.6.6-13.1 4v-.1c0-4.6.7-9.2 2-13.6 2.6.8 5.4.8 8 0 5.2-1.5 9.1-5.5 10.5-10.7-2.5-2.5-5.8-3.9-9.3-4.2 2-1.1 3.8-2.6 5.3-4.4 4.4-5.4 5.7-12.7 3.5-19.3-6.7-1.3-13.6 1.3-17.9 6.5-2.4 3-3.9 6.6-4.4 10.4-2-3.6-5.3-6.2-9.3-7.3-.9 1-1.7 2-2.4 3.2-4.1 7.4-1.4 16.6 6 20.7C23 65.7 22 71.8 22 78v.9c-3.8-2.4-8.5-2.9-12.8-1.4-.9 5.3 1 10.7 5.1 14.2 2.9 2.5 6.5 3.8 10.3 3.6 1.6 5.1 3.9 10 6.9 14.5-4.4 0-8.5 1.9-11.3 5.2.4 1.2 1 2.3 1.7 3.3 4.6 7 14.1 8.8 21 4.2a58 58 0 0 0 24.5 12c1.4 3.3 4 6 7.3 7.3 6.9 2.9 14.9-.4 17.8-7.3 8.9-2 17.2-6 24.2-11.8.7 1 1.6 1.8 2.7 2.4 4.1 2.4 9.4 1 11.9-3.1s1-9.4-3.1-11.9c3-4.5 5.4-9.4 7-14.5 3.8.1 7.5-1.1 10.4-3.6 4.2-3.4 6.1-8.8 5.2-14.1z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-199',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M80.5 13C43.2 13 13 43.2 13 80.5S43.2 148 80.5 148 148 117.8 148 80.5 117.8 13 80.5 13zm-5.1 12.2h.6V76H51.9C53 54.1 62.2 35.2 75.4 25.2zm-20.4 6C47.5 43.5 42.8 59 42.1 76H25.2C26.7 56.9 38 40 55 31.2zm0 98.6c-16.6-8.6-27.8-25.1-29.7-43.8h16.9c.8 16.6 5.5 31.8 12.8 43.8zm21 6h-.5C62.5 126 53.3 107.6 52 86h24v49.8zM107.5 32c16.2 9 26.8 25.5 28.3 44h-15.9c-.7-16.6-5.2-31.9-12.4-44zM86 25.3c.2 0 .5 0 .7.1 13.1 10 22.3 28.8 23.4 50.6H86V25.3zm.7 110.3c-.2 0-.5 0-.7.1V86h24c-1.3 21.5-10.4 39.8-23.3 49.6zm20.8-6.6c7-11.9 11.5-26.7 12.3-43h15.9c-1.8 18.1-12.3 34.1-28.2 43z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:80},{figure_id:'free-200',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M106 21h17c1.1 0 2-.9 2-2v-7c0-1.1-.9-2-2-2h-17c-1.1 0-2 .9-2 2v7c0 1.1.9 2 2 2zm20.3 39.6L122.8 27h-16.7l-3.4 32.9C94.8 64.4 89.9 72.9 90 82v68h48V82.1c.1-8.7-4.3-16.8-11.7-21.5zm.7 69.4h-27V78h27v52zM23.3 49c-.5 5.6-.3 11.2.4 16.7 2.9 28.1 13.5 44.9 24.3 48.6V142h-8.5c-2.5 0-4.5 2-4.5 4.5s2 4.5 4.5 4.5h26c2.5 0 4.5-2 4.5-4.5s-2-4.5-4.5-4.5H57v-27.8c10.8-3.7 21.4-20.4 24.3-48.6.7-5.5.9-11.1.4-16.7H23.3zm29.2 54c-7.6 0-15.8-10.1-18.6-29h37.2c-2.8 18.9-11 29-18.6 29z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:70},{figure_id:'free-201',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M81.6 79.5L75 69.3c2-2.9 3.4-6.1 4.2-9.6L91 57.3v-7.7l-11.6-2.4c-.7-3.4-2-6.6-3.9-9.6l7-10.6-5.4-5.5-10.5 7.1c-2.7-1.7-5.7-3-8.8-3.8L55.2 12h-7.6l-2.5 12.6c-3.1.7-6 1.8-8.8 3.4l-11-7.4-5.4 5.5L27 36.9c-1.8 2.7-3.1 5.7-3.9 8.8l-13 2.6V56l12.6 2.5c.6 3.2 1.8 6.3 3.5 9.1l-7.1 10.9 5.4 5.5 10.4-7c2.7 1.8 5.7 3.2 8.9 4l2.6 13H54l2.5-12.5c3.3-.6 6.4-1.8 9.3-3.5l10.5 7 5.3-5.5zM50.5 68C41.9 68 35 61.1 35 52.5S41.9 37 50.5 37 66 43.9 66 52.5 59.1 68 50.5 68zm89.6 41c.2-3.5-.3-6.9-1.4-10.2l9.4-8.6-3.9-6.6-11.9 4.3c-2.2-2.4-4.8-4.3-7.6-5.8l.7-13.1-7.4-1.9-5.6 11.6a29 29 0 0 0-9.3 1.2L94.3 70l-6.6 4 4.1 12c-2.4 2.2-4.4 4.7-6 7.5l-13.2-.6-1.9 7.5 11.5 5.6c-.2 3.3.2 6.6 1.1 9.7l-9.6 8.8 3.9 6.6 11.8-4.2c2.2 2.5 4.8 4.5 7.7 6.1l-.7 13.2 7.4 1.9 5.5-11.5c3.3.2 6.7-.2 9.9-1.1l8.5 9.4 6.6-4-4-11.5c2.6-2.3 4.8-5.1 6.5-8.2l12.1.5 1.9-7.5-10.7-5.2zm-14.3 1.8c-2.1 8.3-10.5 13.3-18.8 11.2-8.3-2.1-13.3-10.5-11.2-18.8 2.1-8.3 10.5-13.3 18.8-11.2 8.3 2.1 13.3 10.5 11.2 18.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-202',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M106.3 54.8c-22.6-8.9-32.1-43.9-40.9-16.4-8.7 27.5-5.4 82.1 17.3 91s56-31.3 64.7-58.8c8.6-27.6-18.5-6.9-41.1-15.8zm-33.6.7c2.8-2.6 9.2-.4 14.3 5.1 5.1 5.4 6.9 12 4.1 14.6s-9.2.4-14.3-5.1-7-12-4.1-14.6zm28.5 57.7c-.8 3.1-6.9 3.8-13.6 1.5S76.2 108.1 77 105s5.3 2.2 12 4.5c6.6 2.2 13 .6 12.2 3.7zM118.5 87c-7.5 0-13.5-3.1-13.5-7s6-7 13.5-7 13.5 3.1 13.5 7-6 7-13.5 7zM60 118.2h-.9c-7.6 0-13.7-2.8-13.7-6.3 0-3.2 5.3-.1 12.1.3C51 94.2 50 69 53.1 49.3c-23.2-4-41.1-28.7-41.1.2C12 80.9 33.1 135 59.1 135c4-.1 7.9-1.3 11.3-3.4-4.2-3-7.7-7.7-10.4-13.4zM31.9 73.6C25.4 70.8 21 66 22.2 62.7s7.4-3.7 13.9-.9 10.9 7.6 9.7 10.9c-1.1 3.2-7.4 3.6-13.9.9z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-203',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M141 130h-4c0-11.6-9.4-21-21-21s-21 9.4-21 21H65c0-11.6-9.4-21-21-21s-21 9.4-21 21h-4c-2.2 0-4-1.8-4-4v-24h86V51h16c2.2 0 5.2 1.8 6.6 4L144 86c.2.3.4.7.5 1h.4v39c.1 2.2-1.7 4-3.9 4zm-97-13c7.2 0 13 5.8 13 13s-5.8 13-13 13-13-5.8-13-13 5.8-13 13-13zm72 0c7.2 0 13 5.8 13 13s-5.8 13-13 13-13-5.8-13-13 5.8-13 13-13zM0 22h91v70H0V22z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-204',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M41 96c-10.5 0-19 8.5-19 19s8.5 19 19 19 19-8.5 19-19v-.8C59.6 104 51.2 96 41 96zm0 27c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm52-76h30.3l7.7-10H82l-8 16H10v10h8l-.2 15.7S65.7 76 68 108h9.7c1.9-8.5 7.5-15.6 15.3-19.3V47zm55 50V75l-11-20h-36v31.3c10.1-1.5 20.2 2.7 26.3 10.8.5-.1 1.1-.1 1.7-.1h19zm-44.7 0c-10.2.7-17.9 9.5-17.2 19.7.7 10.2 9.5 17.9 19.7 17.2 9.9-.7 17.5-9 17.2-19v-.8c-.7-10-9.6-17.7-19.7-17.1zm.7 26c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm44.3-21h-18c1.6 3.4 2.5 7.2 2.7 11h15.4c1.5 0 2.7-1.3 2.7-2.8v-5.5c-.1-1.4-1.3-2.7-2.8-2.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:30},{figure_id:'free-205',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M140.9 57c-6.4 18-25 32.9-42.9 34.8-.9.9-1.9 1.7-3 2.4-.1 4.9-2.7 9.5-7 12V128h1.5c11.8 0 21.9 8.4 24.1 20H49.4c2.1-11.4 12-19.7 23.6-20v-22.5c-3.7-2.6-5.9-6.8-6-11.3-1-.6-1.9-1.4-2.8-2.2-18.8-.6-39.1-16-45.8-35-6.4-18.2 1.9-33.1 18.7-34.8C37 20.1 37 18 37 16h86c0 2 0 4.1-.1 6.3 16.3 2 24.3 16.8 18 34.7zM38.4 34c-.1-.8-.2-1.6-.4-2.4-9.5 3.7-13.7 13.4-9.3 24.9C33.5 68.9 46.6 79.3 60 82.2c0-.5.1-.9.2-1.4-10.1-10-18.5-27.2-21.8-46.8zm83.5-2.2c-.1.7-.2 1.4-.3 2.2-3.1 18.6-10.9 35.1-20.3 45.2.3.8.5 1.5.6 2.3 12.4-3.6 24.2-13.4 28.6-25.1 4.3-11.2.5-20.7-8.6-24.6z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-206',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M142.7 36.4l-31.9 22.8c-4.9 3.5-11.5 3.7-16.6.6L89 63.4V95c-.1 1.8-.9 3.6-2.2 4.8l-10.4 7.5 27.6 14.6L12 151l35.5-59 19.1 10.1 12.4-9V61c0-1.3.5-2.6 1.5-3.6.3-.3.6-.6.9-.8l6.5-4.7c-2.2-6.3 0-13.4 5.5-17.3l31.9-22.8c6.8-4.8 16.2-3.2 21 3.6s3.2 16.2-3.6 21z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20},{figure_id:'free-207',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M122 20.6c-17.4-15.4-41.7 1.2-45.1 3.7-12.9-6.4-30.2-11.3-42.3.2-8.7 8.2-13.1 18.1-13.1 29.2 0 16.7 10.4 31.7 15.4 36.3 2.5 2.3 4.9 15 6.6 24.2 3.6 19.7 6.7 36.7 17.4 37.5 2.6.3 5.2-.5 7.2-2.2 5.2-4.3 5.8-13.7 6.6-24.5 3.1-43.7 17.3-12.7 17.3 1 0 11.9 0 22.2 8.2 23.5.9.1 1.8.1 2.7 0 2-.3 3.9-1.1 5.4-2.3 11.3-8.6 15.2-42.6 16.9-59.7 8.7-8.3 13.7-19.8 13.9-31.8-.1-9.1-3.1-22.6-17.1-35.1zm6.3 35.1c0 10-8.5 19.7-16.3 26.7-.8.7-1.3 1.7-1.4 2.8-2.1 24.4-1.2 50.4-7.7 55.3-.3.2-.6.4-1 .6-1.3-2.1-1.2-10.2-1.2-15.2.1-36.6-15.7-34.5-19.2-34.1C68.2 93.5 67 110.7 66 124.6c-.5 7-1.2 16.6-3.5 18.6-.2.2-.5.2-.8.2-4.1-.3-5-21.6-6.7-30.6C52.2 97.6 53.3 88 48.9 84c-3.4-3.1-17.7-16.1-17.7-30.3 0-8.7 2.5-10.5 9.4-17.1 15.3-14.6 47.2 7.7 47.5 8 1.9 1.5 4.6 1.2 6.1-.6 1.5-1.7 1.3-4.3-.4-5.8l-.1-.1c-.4-.3-.6-.9-5.5-3.9 6.5-3.9 19.1-9.9 28.9-1.2 9.3 8.1 11.2 12.1 11.2 22.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:90},{figure_id:'free-208',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M79.5 87.2c-9.2-.1-12.7 35.1-17.6 51.7-1.4 4.8-8.3 5.6-10.5 1.2-5.2-10-9.3-27.8-9.3-38.3 0-14.3-4.5-23.3-4.5-23.3-6.3-12.7-6.9-31.3-6.4-40.1.5-5.1 2.4-10 5.5-14.1 2.5-2.9 7.2-5.6 10.4-6.1 4.9-.5 9.9-.4 14.8.3L79.5 21l17.6-2.4c4.9-.7 9.9-.8 14.8-.3 3.2.5 7.9 3.2 10.4 6.1 3.1 4.1 5 9 5.5 14.1.5 8.7-.1 27.4-6.4 40.1 0 0-4.5 8.9-4.5 23.3 0 10.5-4 28.2-9.3 38.3-2.3 4.4-9.2 3.6-10.5-1.2-4.9-16.7-8.3-51.9-17.6-51.8z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:90},{figure_id:'free-209',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M149.9 25.2l-27.6 24.9c.2.4.3.9.4 1.3l.1.4c1 11.8.1 12.5-.8 13.4l-57.1 52c-1.9 1.7-4.8 1.6-6.5-.3l-2.4-2.6-20.8 18.4 1.2 1.3c3.9 4.3 4.7 9.3 1.9 11.9s-7.7 1.2-11.6-3.1l-14.8-16.4c-3.9-4.3-4.7-9.3-1.9-11.9s7.7-1.2 11.6 3.1l1.2 1.3 20.8-18.4-2.6-2.9c-1.7-1.9-1.5-4.8.3-6.5L98.5 39c2.8-2.5 13.6.6 13.7.7.6.2 1.1.4 1.7.7l27.5-24.8c2.6-2.3 6.6-2.1 8.9.4l.1.1c2.3 2.7 2.1 6.7-.5 9.1zM80.3 88.8L70.5 78c-1.1-1.2-2.9-1.3-4.1-.2L51 92c-1.2 1.1-1.3 2.9-.2 4.1l9.8 10.9c1.1 1.2 2.9 1.3 4.1.2L80 93c1.2-1.1 1.3-2.9.3-4.2z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:90},{figure_id:'free-210',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M124.5 121H21c-5.5 0-10-4.5-10-10v-5.3c1.5.9-.2 5.3 13 5.3h101c12.1.1 21.7-5.4 25-15 .1.6 6.3 25-25.5 25zM146 90.3c-.1.1-.2.3-.2.4-4.4 7.6-12.5 12.3-21.2 12.3H21c-5.5 0-10-4.5-10-10V72.5v-.1-.4c.1-6.3 2.7-12.2 7.3-16.5 6 5.6 14 8.6 22.2 8.5 4.5 0 15.8-.9 19.7-2.4l-3.9-1.7c-4.5-2-6.5-7.2-4.5-11.6 2-4.5 7.2-6.5 11.6-4.5L77.8 50l1.3-2.5c1.2-2.3 3.9-3.2 6.3-2.2 2.1 1 2.9 3.5 1.9 5.6 0 .1-.1.2-.1.2L86 53.7l8.3 3.6 1.3-2.4c1.2-2.2 3.6-3.5 5.8-2.4 2.3 1.2 3.2 4 2.2 6.3l-1 2.1 8.3 3.6.8-1.6c1.1-2.2 3.9-3.7 6.2-2.5 2.3 1.4 3.1 4.2 1.9 6.6l-.6 1.2 22.6 9.9c3.8 1.7 5.9 5.7 5.1 9.8.1 0 .2.1.3.1-.5.8-.8 1.6-1.2 2.3zM77.4 65.6L63.9 93h11l11.6-23.8-9.1-3.6zm18.4 7.3L85.9 93h11l8-16.4-9.1-3.7z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-211',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M68.1 74.4c-2.3 2.4-2.3 6.2.1 8.5 2.3 2.3 6.1 2.3 8.4 0l14.7-14.7c3 1.8 6 3.4 8.4 4.6L87.1 85.4c-2.3 2.4-2.3 6.2.1 8.5 2.3 2.3 6.1 2.3 8.4 0l16.1-16.1c4.1 1.5 8.7 3.2 10.7 3.7C145 87.4 145 96 145 107.8c0 2.4-1.9 4.3-4.3 4.3L97.1 115c-.9 0-1.7 0-2.6-.1-.2 0-.4 0-.5.1H21c-2.8 0-5-2.2-5-5V64.4c0-1.6.8-3 2.2-3.8 1.4-.8 3-.7 4.3 0 5.9 3.5 8.3 5.3 15 5.3 13.1 0 17.8-7.2 25.5-19 .8-1.2 2.1-1.9 3.5-2h.1c1.4 0 2.7.7 3.5 1.8 3.7 5.1 5.8 10 11.2 14.4L68.1 74.4zm23.2-6.2c.1 0 .1.1 0 0z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:60},{figure_id:'free-212',parent:'',svg:'<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path d="M160 42h-7c-2.8 0-5-2.2-5-5V24c0-2.8 2.2-5 5-5h7v23zm-28 0H91c-2.8 0-5-2.2-5-5V24c0-2.8 2.2-5 5-5h41c2.8 0 5 2.2 5 5v13c0 2.8-2.2 5-5 5zm-62 0H29c-2.8 0-5-2.2-5-5V24c0-2.8 2.2-5 5-5h41c2.8 0 5 2.2 5 5v13c0 2.8-2.2 5-5 5zM8 42H0V19h8c2.8 0 5 2.2 5 5v13c0 2.8-2.2 5-5 5zm-8 76h39c2.8 0 5 2.2 5 5v13c0 2.8-2.2 5-5 5H0v-23zm60 0h41c2.8 0 5 2.2 5 5v13c0 2.8-2.2 5-5 5H60c-2.8 0-5-2.2-5-5v-13c0-2.8 2.2-5 5-5zm62 0h38v23h-38c-2.8 0-5-2.2-5-5v-13c0-2.8 2.2-5 5-5zm26-15V90c0-2.8 2.2-5 5-5h7v23h-7c-2.8 0-5-2.2-5-5zm-26-51h38v23h-38c-2.8 0-5-2.2-5-5V57c0-2.8 2.2-5 5-5zm15 38v13c0 2.8-2.2 5-5 5H91c-2.8 0-5-2.2-5-5V90c0-2.8 2.2-5 5-5h41c2.8 0 5 2.2 5 5zM60 52h41c2.8 0 5 2.2 5 5v13c0 2.8-2.2 5-5 5H60c-2.8 0-5-2.2-5-5V57c0-2.8 2.2-5 5-5zm15 38v13c0 2.8-2.2 5-5 5H29c-2.8 0-5-2.2-5-5V90c0-2.8 2.2-5 5-5h41c2.8 0 5 2.2 5 5zM44 57v13c0 2.8-2.2 5-5 5H0V52h39c2.8 0 5 2.2 5 5zM13 90v13c0 2.8-2.2 5-5 5H0V85h8c2.8 0 5 2.2 5 5z"/></svg>',rotate:'',scale:'',is_form:false,is_figure:false,is_free:true,category_id:20}];this.examples=function(){return{'001':{"layer_1":{"el":{"0":{"0":{"raphael":true,"raphaelid":3},"id":3,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"fill":"none","stroke":"none","path":[["M",80,0],["L",160,40],["V",120],["L",80,160],["L",0,120],["V",40],["L",80,0]],"stroke-width":0,"gradient":"270-#ffa600-#ff7300"},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"path","gradient":{}},"items":[null],"length":1,"type":"set"},"fill":"#ffa600","fill_enabled":false,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"gradient","last_fill":"#ffa600","stroke":"#000000","stroke-width":10,"is_hidden":false,"gradient":{"is_enabled":true,"start":"#ffa600","end":"#ff7300","angle":90},"current_figure":{"figure_id":"003","parent":"","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\"><path d=\"M80 0l80 40v80l-80 40-80-40V40L80 0\"/></svg>","form_bg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"55\" height=\"55\" viewBox=\"0 0 160 160\"><path d=\"M80 0l80 40v80l-80 40-80-40V40L80 0\" stroke=\"#e2e2e2\" stroke-width=\"2\" fill=\"#ffffff\"/></svg>","rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},"transform":{"val":""},"draggable":false},"layer_2":{"el":{"0":{"0":{"raphael":true,"raphaelid":8},"id":8,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"fill":"#ffffff","stroke":"none","path":[["M",80,0],["L",160,40],["L",80,80],["L",0,40],["L",80,0]],"stroke-width":0,"cursor":"move"},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"path","_drag":{},"events":[{"name":"mousedown"}]},"items":[null],"length":1,"type":"set"},"fill":"#ffffff","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#ffffff","stroke":"#dedede","stroke-width":2,"is_hidden":true,"gradient":{"is_enabled":false,"start":"#ffffff","end":"#000000","angle":90},"current_figure":{"figure_id":"003-013","parent":"003","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\">  <path d=\"M80 0l80 40-80 40L0 40 80 0\"/></svg>","rotate":"","scale":"","is_form":false,"is_figure":true,"is_free":false},"transform":{"val":""},"draggable":true},"text":{"el":{"0":{"raphael":true,"raphaelid":2},"id":2,"matrix":{"a":0.9559,"b":0,"c":0,"d":0.9559,"e":161,"f":262.818359375},"realPath":[["M",-83.16329956054688,-311.14544677734375],["l",166.32659912109375,0],["l",0,430.1549987792969],["l",-166.32659912109375,0],["z"]],"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":1,"_viewBox":[0,0,320,320,true]},"attrs":{"x":0,"y":0,"text-anchor":"middle","text":"$","font-family":"arimo_bold","font-size":300,"stroke":"none","fill":"#ffffff","cursor":"move","opacity":1,"stroke-width":1},"_":{"transform":"t161,262.818359375s0.9559,0.9559,0,0","sx":0.9559,"sy":0.9559,"deg":0,"dx":161,"dy":262.818359375,"dirty":0,"dirtyT":1,"bboxwt":{"x":-83.16329956054688,"y":-311.14544677734375,"x2":83.16329956054688,"y2":119.00955200195312,"width":166.32659912109375,"height":430.1549987792969,"cx":0,"cy":-96.06794738769531}},"prev":null,"next":null,"type":"text","_drag":{},"events":[{"name":"mousedown"}],"ox":0,"oy":0},"size":300,"min_size":140,"max_size":300,"fill":"#ffffff","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#ffffff","stroke":"#dedede","stroke-width":2,"is_hidden":false,"font":"arimo_bold","caption":"$","style":"bold","text-anchor":"middle","is_regular":true,"is_italic_enabled":false,"is_bold_enabled":true,"pos":{"x":38,"y":264},"gradient":{"is_enabled":false,"start":"#ffffff","end":"#000000","angle":90},"transform":{"val":"t161,262.818359375s0.9559,0.9559,0,0"},"draggable":true}},'002':{"layer_1":{"el":{"0":{"0":{"raphael":true,"raphaelid":126},"id":126,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"fill":"#ff4040","stroke":"#000","path":[["M",120.038,0],["H",39.962],["C",17.892,0,0,17.888,0,39.962],["V",120.038],["C",0,142.108,17.888,160,39.962,160],["H",120.038],["C",142.108,160,160,142.112,160,120.038],["V",39.962],["C",160,17.892,142.112,0,120.038,0],["Z"]],"stroke-width":0},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"path"},"items":[null],"length":1,"type":"set"},"fill":"#ff4040","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#ff4040","stroke":"#000000","stroke-width":10,"is_hidden":false,"gradient":{"is_enabled":false,"start":"#ff4040","end":"#f2182a","angle":90},"url":"/my/s3/images/logo_generator/layer_1/001.svg","current_figure":{"figure_id":"007","parent":"","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\"><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M120.038 0H39.962C17.892 0 0 17.888 0 39.962v80.076C0 142.108 17.888 160 39.962 160h80.076c22.07 0 39.962-17.888 39.962-39.962V39.962C160 17.892 142.112 0 120.038 0z\"/></svg>","form_bg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"55\" height=\"55\" viewBox=\"0 0 160 160\"><path stroke=\"#e2e2e2\" stroke-width=\"2\" fill=\"#ffffff\" fill-rule=\"evenodd\" d=\"M120.038 0H39.962C17.892 0 0 17.888 0 39.962v80.076C0 142.108 17.888 160 39.962 160h80.076c22.07 0 39.962-17.888 39.962-39.962V39.962C160 17.892 142.112 0 120.038 0z\"/></svg>","rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},"transform":{"val":""},"draggable":false},"layer_2":{"el":{"0":{"0":{"raphael":true,"raphaelid":127},"id":127,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"fill":"#ffffff","stroke":"#000","path":[["M",119.4201,90],["H",158.77575000000002],["C",158.79687,89.83075,158.82012,89.66223,158.8402,89.49261],["L",79.4201,20],["L",0,89.4926],["C",0.0201,89.66223,0.04333,89.83075,0.06445,90],["H",39.4201],["V",149.27080999999998],["A",79.92753,79.92753,0,0,0,119.42009999999999,149.27080999999998],["V",90],["Z"]],"stroke-width":0,"cursor":"move"},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"path","_drag":{},"events":[{"name":"mousedown"}]},"items":[null],"length":1,"type":"set"},"fill":"#ffffff","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#ffffff","stroke":"#dedede","stroke-width":2,"is_hidden":true,"gradient":{"is_enabled":false,"start":"#ffffff","end":"#000000","angle":90},"url":"/my/s3/images/logo_generator/layer_2/001-010.svg","current_figure":{"figure_id":"002-001","parent":"002","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\">  <path d=\"M119.4201 90h39.35565c.02112-.16925.04437-.33777.06445-.50739L79.4201 20 0 89.4926c.0201.16963.04333.33815.06445.5074H39.4201v59.27081a79.92753 79.92753 0 0 0 80 0V90z\"/></svg>","rotate":"","scale":"","is_form":false,"is_figure":true,"is_free":false},"transform":{"val":""},"draggable":true},"text":{"el":{"0":{"raphael":true,"raphaelid":2},"id":2,"matrix":{"a":0.7493717820812,"b":-0.43265,"c":0.43265,"d":0.7493717820812,"e":191.25792100750164,"f":236.56486059310467},"realPath":[["M",-141.77828979492188,-295.5943603515625],["l",283.55657958984375,0],["l",0,387.8840026855469],["l",-283.55657958984375,0],["z"]],"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":1,"_viewBox":[0,0,320,320,true]},"attrs":{"x":0,"y":0,"text-anchor":"middle","text":"Aj","font-family":"caviar_bold","font-size":300,"stroke":"none","fill":"#ffffff","cursor":"move","opacity":1,"stroke-width":2},"_":{"transform":"t191.25792100750164,236.56486059310467s0.8653,0.8653,0,0r-30,0,0","sx":0.8653,"sy":0.8653,"deg":-30,"dx":191.25792100750164,"dy":236.56486059310467,"dirty":0,"dirtyT":1,"bboxwt":{"x":-141.77828979492188,"y":-295.5943603515625,"x2":141.77828979492188,"y2":92.28964233398438,"width":283.55657958984375,"height":387.8840026855469,"cx":0,"cy":-101.65235900878906},"bbox":{"x":32.83669539733583,"y":17.978280137227927,"x2":325.2907075958179,"y2":324.39840994518374,"width":292.454012198482,"height":306.42012980795585,"cx":179.06370149657684,"cy":171.18834504120585}},"prev":null,"next":null,"type":"text","_drag":{},"events":[{"name":"mousedown"}],"ox":5,"oy":0},"size":300,"min_size":140,"max_size":300,"fill":"#ffffff","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#ffffff","stroke":"#dedede","stroke-width":2,"is_hidden":false,"font":"caviar_bold","caption":"Aj","style":"bold","text-anchor":"middle","is_regular":true,"is_italic_enabled":false,"is_bold_enabled":true,"pos":{"x":38,"y":264},"gradient":{"is_enabled":false,"start":"#ffffff","end":"#000000","angle":90},"transform":{"val":"t191.25792100750164,236.56486059310467s0.8653,0.8653,0,0r-30,0,0"},"draggable":true}},'003':{"layer_1":{"el":{"0":{"0":{"raphael":true,"raphaelid":488},"id":488,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":-0.5,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"fill":"#000000","stroke":"none","path":[["M",120.038,0],["H",39.962],["C",17.892,0,0,17.888,0,39.962],["V",120.038],["C",0,142.108,17.888,160,39.962,160],["H",120.038],["C",142.108,160,160,142.112,160,120.038],["V",39.962],["C",160,17.892,142.112,0,120.038,0],["Z"]],"stroke-width":0},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"path"},"items":[null],"length":1,"type":"set"},"fill":"#000000","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#000000","stroke":"#000000","stroke-width":10,"is_hidden":false,"gradient":{"is_enabled":false,"start":"#000000","end":"#000000","angle":90},"current_figure":{"figure_id":"007","parent":"","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\"><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M120.038 0H39.962C17.892 0 0 17.888 0 39.962v80.076C0 142.108 17.888 160 39.962 160h80.076c22.07 0 39.962-17.888 39.962-39.962V39.962C160 17.892 142.112 0 120.038 0z\"/></svg>","form_bg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"55\" height=\"55\" viewBox=\"0 0 160 160\"><path stroke=\"#e2e2e2\" stroke-width=\"2\" fill=\"#ffffff\" fill-rule=\"evenodd\" d=\"M120.038 0H39.962C17.892 0 0 17.888 0 39.962v80.076C0 142.108 17.888 160 39.962 160h80.076c22.07 0 39.962-17.888 39.962-39.962V39.962C160 17.892 142.112 0 120.038 0z\"/></svg>","rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},"transform":{"val":""},"draggable":false},"layer_2":{"el":{"0":{"0":{"raphael":true,"raphaelid":489},"id":489,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":-0.5,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"fill":"#4dd1bf","stroke":"none","path":[["M",20,90],["H",0],["V",160],["H",70],["V",140],["H",20],["Z"],["M",0,0],["V",70],["H",20],["V",20],["H",70],["V",0],["H",10],["Z"],["M",140,140],["H",90],["V",160],["H",160],["V",90],["H",140],["Z"],["M",150,0],["H",90],["V",20],["H",140],["V",70],["H",160],["V",0],["Z"]],"stroke-width":0,"cursor":"move"},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"path","_drag":{},"events":[{"name":"mousedown"}]},"items":[null],"length":1,"type":"set"},"fill":"#4dd1bf","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#4dd1bf","stroke":"#000000","stroke-width":2,"is_hidden":true,"gradient":{"is_enabled":false,"start":"#4dd1bf","end":"#000000","angle":90},"current_figure":{"figure_id":"free-014","parent":"","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\"><path d=\"M20 90H0v70h70v-20H20zM0 0v70h20V20h50V0H10zM140 140H90v20h70V90h-20zM150 0H90v20h50v50h20V0z\"/></svg>","rotate":"","scale":"","is_form":false,"is_figure":false,"is_free":true,"category_id":10},"transform":{"val":""},"draggable":true},"text":{"el":{"0":{"raphael":true,"raphaelid":487},"id":487,"matrix":{"a":0.9998,"b":0,"c":0,"d":0.9998,"e":160,"f":245.6640625},"realPath":[["M",17.300003051757812,12.300006866455078],["l",147.39999389648438,0],["l",0,283.79998779296875],["l",-147.39999389648438,0],["z"]],"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":1,"_viewBox":[0,0,320,320,true]},"attrs":{"x":0,"y":0,"text-anchor":"middle","text":"М","font-family":"open_sans_bold","font-size":240,"stroke":"none","fill":"#ffffff","cursor":"move","opacity":1,"stroke-width":1},"_":{"transform":"t160,245.6640625s0.9998,0.9998,0,0","sx":0.9998,"sy":0.9998,"deg":0,"dx":160,"dy":245.6640625,"dirty":1,"dirtyT":1,"bboxwt":{"x":17.300003051757812,"y":12.300006866455078,"x2":164.6999969482422,"y2":296.0999946594238,"width":147.39999389648438,"height":283.79998779296875,"cx":91,"cy":154.20000076293945}},"prev":null,"next":null,"type":"text","_drag":{},"events":[{"name":"mousedown"}]},"size":240,"min_size":140,"max_size":300,"fill":"#ffffff","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#ffffff","stroke":"#000000","stroke-width":2,"is_hidden":false,"font":"open_sans_bold","caption":"М","style":"bold","text-anchor":"middle","is_regular":false,"is_italic_enabled":false,"is_bold_enabled":true,"pos":{"x":91,"y":229},"gradient":{"is_enabled":false,"start":"#ffffff","end":"#000000","angle":90},"transform":{"val":"t160,245.6640625s0.9998,0.9998,0,0"},"draggable":true}},'004':{"layer_1":{"el":{"0":{"0":{"raphael":true,"raphaelid":3},"id":3,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0.5,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"x":0,"y":0,"width":"160","height":"160","rx":0,"ry":0,"fill":"#3b75cc","stroke":"none","stroke-width":0},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"rect"},"items":[null],"length":1,"type":"set"},"fill":"#3b75cc","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#3b75cc","stroke":"#000000","stroke-width":10,"is_hidden":true,"gradient":{"is_enabled":false,"start":"#3b75cc","end":"#000000","angle":90},"current_figure":{"figure_id":"001","parent":"","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\">  <rect width=\"160\" height=\"160\"/></svg>","form_bg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"55\" height=\"55\" viewBox=\"0 0 55 55\"><rect width=\"55\" height=\"55\" stroke=\"#e2e2e2\" stroke-width=\"2\" fill=\"#ffffff\"/></svg>","rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},"transform":{"val":""},"draggable":false},"layer_2":{"el":{"0":{"0":{"raphael":true,"raphaelid":4},"id":4,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0.5,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"fill":"none","stroke":"none","path":[["M",160,10],["H",20],["V",0],["H",0],["V",160],["H",20],["V",110],["H",160],["L",130,60],["Z"]],"stroke-width":2,"cursor":"move","gradient":"270-#0e65e8-#00e1ff"},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"path","_drag":{},"events":[{"name":"mousedown"}],"gradient":{}},"items":[null],"length":1,"type":"set"},"fill":"#0e65e8","fill_enabled":false,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"gradient","last_fill":"#0e65e8","stroke":"#000000","stroke-width":2,"is_hidden":false,"gradient":{"is_enabled":true,"start":"#0e65e8","end":"#00e1ff","angle":90},"current_figure":{"figure_id":"free-025","parent":"","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\"><path d=\"M160 10H20V0H0v160h20v-50h140l-30-50z\"/></svg>","rotate":"","scale":"","is_form":false,"is_figure":false,"is_free":true,"category_id":20},"transform":{"val":""},"draggable":true},"text":{"el":{"0":{"raphael":true,"raphaelid":2},"id":2,"matrix":{"a":0.7781,"b":0,"c":0,"d":0.7781,"e":137.3250289012066,"f":174.27540504413352},"realPath":[["M",-153.57923889160156,-227.47718811035156],["l",321.29547119140625,0],["l",0,314.8695373535156],["l",-321.29547119140625,0],["z"]],"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":1,"_viewBox":[0,0,320,320,true]},"attrs":{"x":0,"y":0,"text-anchor":"middle","text":"ФК","font-family":"arimo_bold_italic","font-size":220,"stroke":"none","fill":"#ffffff","cursor":"move","opacity":1,"stroke-width":2},"_":{"transform":"t137.3250289012066,174.27540504413352s0.7781,0.7781,0,0","sx":0.7781,"sy":0.7781,"deg":0,"dx":137.3250289012066,"dy":174.27540504413352,"dirty":0,"dirtyT":1,"bboxwt":{"x":-153.57923889160156,"y":-227.47718811035156,"x2":167.7162322998047,"y2":87.39234924316406,"width":321.29547119140625,"height":314.8695373535156,"cx":7.0684967041015625,"cy":-70.04241943359375}},"prev":null,"next":null,"type":"text","_drag":{},"events":[{"name":"mousedown"}]},"size":220,"min_size":140,"max_size":300,"fill":"#ffffff","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#ffffff","stroke":"#000000","stroke-width":2,"is_hidden":false,"font":"arimo_bold_italic","caption":"ФК","style":"bold_italic","text-anchor":"middle","is_regular":true,"is_italic_enabled":true,"is_bold_enabled":true,"pos":{"x":91,"y":229},"gradient":{"is_enabled":false,"start":"#ffffff","end":"#000000","angle":90},"transform":{"val":"t137.3250289012066,174.27540504413352s0.7781,0.7781,0,0"},"draggable":true}},'005':{"layer_1":{"el":{"0":{"0":{"raphael":true,"raphaelid":19},"id":19,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"x":0,"y":0,"width":"160","height":"160","rx":0,"ry":0,"fill":"#b655d4","stroke":"none","stroke-width":0},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"rect"},"items":[null],"length":1,"type":"set"},"fill":"#b655d4","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#b655d4","stroke":"#000000","stroke-width":10,"is_hidden":false,"gradient":{"is_enabled":false,"start":"#b655d4","end":"#000000","angle":90},"current_figure":{"figure_id":"001","parent":"","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\">  <rect width=\"160\" height=\"160\"/></svg>","form_bg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"55\" height=\"55\" viewBox=\"0 0 55 55\"><rect width=\"55\" height=\"55\" stroke=\"#e2e2e2\" stroke-width=\"2\" fill=\"#ffffff\"/></svg>","rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},"transform":{"val":""},"draggable":false},"layer_2":{"el":{"0":{"0":{"raphael":true,"raphaelid":20},"id":20,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"fill":"#ffffff","stroke":"none","path":[["M",160,90],["L",80,20],["L",0,90],["H",40],["V",160],["H",120],["V",90],["H",160]],"stroke-width":0,"cursor":"move"},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"path","_drag":{},"events":[{"name":"mousedown"}]},"items":[null],"length":1,"type":"set"},"fill":"#ffffff","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#ffffff","stroke":"#dedede","stroke-width":2,"is_hidden":false,"gradient":{"is_enabled":false,"start":"#ffffff","end":"#000000","angle":90},"current_figure":{"figure_id":"001-001","parent":"001","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\"><path d=\"M160 90L80 20 0 90h40v70h80V90h40\"/></svg>","rotate":"","scale":"","is_form":false,"is_figure":true,"is_free":false},"transform":{"val":""},"draggable":true},"text":{"el":{"0":{"raphael":true,"raphaelid":2},"id":2,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":160,"f":210.89000000000001},"realPath":[["M",-103.5,-131],["l",207,0],["l",0,169],["l",-207,0],["z"]],"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":1,"_viewBox":[0,0,320,320,true]},"attrs":{"x":0,"y":0,"text-anchor":"middle","text":"","font-family":"adonis","font-size":140,"stroke":"none","fill":"#ffffff","cursor":"move","opacity":1,"stroke-width":1},"_":{"transform":"t160,210.89000000000001","sx":1,"sy":1,"deg":0,"dx":160,"dy":210.89000000000001,"dirty":1,"dirtyT":1,"bboxwt":{"x":-103.5,"y":-131,"x2":103.5,"y2":38,"width":207,"height":169,"cx":0,"cy":-46.5}},"prev":null,"next":null,"type":"text","_drag":{},"events":[{"name":"mousedown"}],"ox":0,"oy":0},"size":140,"min_size":140,"max_size":300,"fill":"#ffffff","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#ffffff","stroke":"#dedede","stroke-width":2,"is_hidden":true,"font":"adonis","caption":"","style":"","text-anchor":"middle","is_regular":true,"is_italic_enabled":false,"is_bold_enabled":false,"pos":{"x":3,"y":68},"gradient":{"is_enabled":false,"start":"#ffffff","end":"#000000","angle":90},"transform":{"val":"t160,210.89000000000001"},"draggable":true}},'006':{"layer_1":{"el":{"0":{"0":{"raphael":true,"raphaelid":45},"id":45,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"x":0,"y":0,"width":"160","height":"160","rx":0,"ry":0,"fill":"none","stroke":"none","stroke-width":0,"gradient":"270-#C8D3FF-#FFDEE8"},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"rect","gradient":{}},"items":[null],"length":1,"type":"set"},"fill":"#31c292","fill_enabled":false,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"gradient","last_fill":"#31c292","stroke":"#000000","stroke-width":10,"is_hidden":true,"gradient":{"is_enabled":true,"start":"#C8D3FF","end":"#FFDEE8","angle":90},"current_figure":{"figure_id":"001","parent":"","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\">  <rect width=\"160\" height=\"160\"/></svg>","form_bg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"55\" height=\"55\" viewBox=\"0 0 55 55\"><rect width=\"55\" height=\"55\" stroke=\"#e2e2e2\" stroke-width=\"2\" fill=\"#ffffff\"/></svg>","rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},"transform":{"val":""},"draggable":false},"layer_2":{"el":{"0":{"0":{"raphael":true,"raphaelid":46},"id":46,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":1,"f":-1},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"fill":"none","stroke":"none","path":[["M",137.087,22.92],["A",9.995,9.995,0,0,0,122.91799999999999,22.969],["L",94.725,51.16],["L",24.12,37.04],["L",17.060000000000002,44.1],["L",66.482,79.4],["L",45.302,100.58000000000001],["H",17.06],["L",10,107.64],["L",38.242000000000004,121.76],["L",52.362,150],["L",59.422000000000004,142.94],["V",114.7],["L",80.605,93.52000000000001],["L",115.906,142.94],["L",122.96600000000001,135.88],["L",108.846,65.28],["L",137.03900000000002,37.089],["A",10.013,10.013,0,0,0,137.08700000000002,22.919999999999998],["Z"]],"stroke-width":0,"gradient":"232-#3521a6-#f01a1a","cursor":"move"},"_":{"transform":"t1,-1","sx":1,"sy":1,"deg":0,"dx":1,"dy":-1,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"path","gradient":{},"_drag":{},"events":[{"name":"mousedown"}]},"items":[null],"length":1,"type":"set"},"fill":"#3521a6","fill_enabled":false,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"gradient","last_fill":"#3521a6","stroke":"#000000","stroke-width":2,"is_hidden":false,"gradient":{"is_enabled":true,"start":"#3521a6","end":"#f01a1a","angle":128},"current_figure":{"figure_id":"001-016","parent":"001","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\"><path d=\"M137.087 22.92a9.995 9.995 0 0 0-14.169.049L94.725 51.16 24.12 37.04l-7.06 7.06 49.422 35.3-21.18 21.18H17.06L10 107.64l28.242 14.12L52.362 150l7.06-7.06V114.7l21.183-21.18 35.301 49.42 7.06-7.06-14.12-70.6 28.193-28.191a10.013 10.013 0 0 0 .048-14.169z\"/></svg>","rotate":"","scale":"","is_form":false,"is_figure":true,"is_free":false},"transform":{"val":"t1,-1"},"draggable":true},"text":{"el":{"0":{"raphael":true,"raphaelid":2},"id":2,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":160,"f":245.9375},"realPath":[["M",9.60000228881836,24.400005340576172],["l",163.89999389648438,0],["l",0,257.3999938964844],["l",-163.89999389648438,0],["z"]],"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":1,"_viewBox":[0,0,320,320,true]},"attrs":{"x":0,"y":0,"text-anchor":"middle","text":"","font-family":"adonis_bold","font-size":220,"stroke":"none","fill":"#7A73E2","cursor":"move","opacity":1,"stroke-width":1},"_":{"transform":"t160,245.9375","sx":1,"sy":1,"deg":0,"dx":160,"dy":245.9375,"dirty":1,"dirtyT":1,"bboxwt":{"x":9.60000228881836,"y":24.400005340576172,"x2":173.49999618530273,"y2":281.79999923706055,"width":163.89999389648438,"height":257.3999938964844,"cx":91.54999923706055,"cy":153.10000228881836}},"prev":null,"next":null,"type":"text","_drag":{},"events":[{"name":"mousedown"}]},"size":220,"min_size":140,"max_size":300,"fill":"#7A73E2","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#7A73E2","stroke":"#000000","stroke-width":2,"is_hidden":false,"font":"adonis_bold","caption":"","style":"bold","text-anchor":"middle","is_regular":false,"is_italic_enabled":false,"is_bold_enabled":true,"pos":{"x":91,"y":229},"gradient":{"is_enabled":false,"start":"#7A73E2","end":"#000000","angle":90},"transform":{"val":"t160,245.9375"},"draggable":true}},'007':{"layer_1":{"el":{"0":{"0":{"raphael":true,"raphaelid":145},"id":145,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"x":0,"y":0,"width":"160","height":"160","rx":0,"ry":0,"fill":"none","stroke":"#000000","stroke-width":10},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"next":null,"type":"rect"},"items":[null],"length":1,"type":"set"},"fill":"none","fill_enabled":false,"shadow_enabled":false,"stroke_enabled":true,"fill_type":"none","last_fill":"#31c292","stroke":"#000000","stroke-width":10,"is_hidden":false,"gradient":{"is_enabled":false,"start":"#D1C5EA","end":"#B9DEFC","angle":90},"current_figure":{"figure_id":"001","parent":"","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\">  <rect width=\"160\" height=\"160\"/></svg>","form_bg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"55\" height=\"55\" viewBox=\"0 0 55 55\"><rect width=\"55\" height=\"55\" stroke=\"#e2e2e2\" stroke-width=\"2\" fill=\"#ffffff\"/></svg>","rotate":"","scale":"","is_form":true,"is_figure":false,"is_free":false},"transform":{"val":""},"draggable":false},"layer_2":{"el":{"0":{"0":{"raphael":true,"raphaelid":154},"id":154,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"top":{"0":{"raphael":true,"raphaelid":155},"id":155,"matrix":{"a":1,"b":0,"c":0,"d":1,"e":0,"f":0},"realPath":null,"attrs":{"fill":"none","stroke":"#000000","path":[["M",160,90],["V",70],["H",139.2],["C",137.7,60.9,134.1,52.5,128.89999999999998,45.2],["L",143.59999999999997,30.500000000000004],["L",129.49999999999997,16.400000000000006],["L",114.79999999999997,31.100000000000005],["C",107.6,26,99.2,22.4,90,20.8],["V",0],["H",70],["V",20.8],["C",60.9,22.3,52.5,25.9,45.2,31.1],["L",30.5,16.4],["L",16.4,30.5],["L",31.099999999999998,45.2],["C",26,52.4,22.4,60.8,20.8,70],["H",0],["V",90],["H",20.8],["C",22.3,99.1,25.9,107.5,31.1,114.8],["L",16.400000000000002,129.5],["L",30.5,143.6],["L",45.2,128.9],["C",52.400000000000006,134,60.800000000000004,137.6,70,139.20000000000002],["V",160],["H",90],["V",139.2],["C",99.1,137.7,107.5,134.1,114.8,128.89999999999998],["L",129.5,143.59999999999997],["L",143.6,129.49999999999997],["L",128.9,114.79999999999997],["C",134,107.59999999999997,137.6,99.19999999999997,139.20000000000002,89.99999999999997],["H",160],["Z"],["M",80,120],["C",57.9,120,40,102.1,40,80],["S",57.9,40,80,40],["S",120,57.9,120,80],["S",102.1,120,80,120],["Z"]],"stroke-width":2,"cursor":"move"},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"next":null,"type":"path","_drag":{},"events":[{"name":"mousedown"}]},"defs":{},"_top":0,"_left":0,"_vbSize":null,"_viewBox":["0","0","160","160",true]},"attrs":{"cx":80,"cy":80,"rx":"20","ry":"20","fill":"none","stroke":"#000000","stroke-width":2,"r":"20","cursor":"move"},"_":{"transform":"","sx":1,"sy":1,"deg":0,"dx":0,"dy":0,"dirty":1,"dirtyT":1},"prev":null,"type":"ellipse","_drag":{},"events":[{"name":"mousedown"}]},"items":[null,null],"length":2,"type":"set"},"fill":"none","fill_enabled":false,"shadow_enabled":false,"stroke_enabled":true,"fill_type":"none","last_fill":"#ffffff","stroke":"#000000","stroke-width":2,"is_hidden":false,"gradient":{"is_enabled":false,"start":"#ffffff","end":"#000000","angle":90},"current_figure":{"figure_id":"free-023","parent":"","svg":"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\"><circle cx=\"80\" cy=\"80\" r=\"20\"/><path d=\"M160 90V70h-20.8c-1.5-9.1-5.1-17.5-10.3-24.8l14.7-14.7-14.1-14.1-14.7 14.7C107.6 26 99.2 22.4 90 20.8V0H70v20.8c-9.1 1.5-17.5 5.1-24.8 10.3L30.5 16.4 16.4 30.5l14.7 14.7C26 52.4 22.4 60.8 20.8 70H0v20h20.8c1.5 9.1 5.1 17.5 10.3 24.8l-14.7 14.7 14.1 14.1 14.7-14.7c7.2 5.1 15.6 8.7 24.8 10.3V160h20v-20.8c9.1-1.5 17.5-5.1 24.8-10.3l14.7 14.7 14.1-14.1-14.7-14.7c5.1-7.2 8.7-15.6 10.3-24.8H160zm-80 30c-22.1 0-40-17.9-40-40s17.9-40 40-40 40 17.9 40 40-17.9 40-40 40z\"/></svg>","rotate":"","scale":"","is_form":false,"is_figure":false,"is_free":true,"category_id":10},"transform":{"val":""},"draggable":true},"text":{"el":{"0":{"raphael":true,"raphaelid":28},"id":28,"matrix":{"a":1.3177,"b":0,"c":0,"d":1.3177,"e":163,"f":271.078225469513},"realPath":[["M",-61.80000305175781,-223.20001220703125],["l",123.60000610351562,0],["l",0,286.8000183105469],["l",-123.60000610351562,0],["z"]],"paper":{"customAttributes":{},"width":320,"height":320,"canvas":{},"defs":{},"_top":0,"_left":0,"_vbSize":1,"_viewBox":[0,0,320,320,true]},"attrs":{"x":0,"y":0,"text-anchor":"middle","text":"К","font-family":"blogger_bold","font-size":240,"stroke":"none","fill":"#000000","cursor":"move","opacity":1,"stroke-width":1},"_":{"transform":"t163,271.078225469513s1.3177,1.3177,0,0","sx":1.3177,"sy":1.3177,"deg":0,"dx":163,"dy":271.078225469513,"dirty":1,"dirtyT":1,"bboxwt":{"x":-61.80000305175781,"y":-223.20001220703125,"x2":61.80000305175781,"y2":63.600006103515625,"width":123.60000610351562,"height":286.8000183105469,"cx":0,"cy":-79.80000305175781},"bbox":{"x":127.88100592041013,"y":236.17087193725595,"x2":256.11899407958987,"y2":325.7202975231935,"width":288.23798815917974,"height":334.27598808593757,"cx":112,"cy":158.58230348022474}},"prev":null,"next":null,"type":"text","_drag":{},"events":[{"name":"mousedown"}],"ox":3,"oy":1},"size":240,"min_size":140,"max_size":300,"fill":"#000000","fill_enabled":true,"shadow_enabled":false,"stroke_enabled":false,"fill_type":"color","last_fill":"#000000","stroke":"#000000","stroke-width":2,"is_hidden":false,"font":"blogger_bold","caption":"К","style":"bold","text-anchor":"middle","is_regular":true,"is_italic_enabled":false,"is_bold_enabled":true,"pos":{"x":91,"y":229},"gradient":{"is_enabled":false,"start":"#000000","end":"#000000","angle":90},"transform":{"val":"t163,271.078225469513s1.3177,1.3177,0,0"},"draggable":true}}}};this.favicon_count=0;this.color_sets={0:{0:{fill:'#FFCED2'},1:{fill:'#F9BCD1'},2:{fill:'#E2BFE8'},3:{fill:'#D1C5EA'},4:{fill:'#C4CBEA'},5:{fill:'#B9DEFC'},6:{fill:'#B1E5FD'},7:{fill:'#B0EBF2'},8:{fill:'#B0DFDB'},9:{fill:'#C7E5C8'},10:{fill:'#DCECC6'},11:{fill:'#F0F3C1'},12:{fill:'#FFF8C1'},13:{fill:'#FFEBB0'},14:{fill:'#FFE0B0'},15:{fill:'#FFCCBB'},16:{fill:'#D7CCC8'},17:{fill:'#EEEEEE'},18:{fill:'#CFD8DC'},19:{gradient:{start:'#FFCED2',end:'#E2BFE8'}},20:{gradient:{start:'#D1C5EA',end:'#B9DEFC'}},21:{gradient:{start:'#B0EBF2',end:'#DCECC6'}},22:{gradient:{start:'#F0F3C1',end:'#FFE0B0'}},23:{gradient:{start:'#FFEBB0',end:'#FFCCBB'}},24:{gradient:{start:'#FFD2C2',end:'#FFE0E0'}},25:{gradient:{start:'#FDE6DD',end:'#CFD8DC'}},26:{gradient:{start:'#8CD1FF',end:'#FFBBE8'}},27:{gradient:{start:'#8DD4FF',end:'#FFEEB2'}},28:{gradient:{start:'#C8D3FF',end:'#FFDEE8'}},29:{gradient:{start:'#FFF1BC',end:'#EBC5FF'}},30:{gradient:{start:'#D7FFCA',end:'#FF8F8F'}},31:{gradient:{start:'#8E84EB',end:'#D9FF96'}}},1:{0:{gradient:{start:'#FFCED2',end:'#78272E'}},1:{gradient:{start:'#F9BCD1',end:'#700A2D'}},2:{gradient:{start:'#E2BFE8',end:'#581164'}},3:{gradient:{start:'#D1C5EA',end:'#371F67'}},4:{gradient:{start:'#C4CBEA',end:'#2D3B79'}},5:{gradient:{start:'#B9DEFC',end:'#013660'}},6:{gradient:{start:'#B1E5FD',end:'#00507B'}},7:{gradient:{start:'#B0EBF2',end:'#00555D'}},8:{gradient:{start:'#B0DFDB',end:'#005E53'}},9:{gradient:{start:'#C7E5C8',end:'#095C0A'}},10:{gradient:{start:'#DCECC6',end:'#2B5202'}},11:{gradient:{start:'#F0F3C1',end:'#585900'}},12:{gradient:{start:'#FFF8C1',end:'#A27700'}},13:{gradient:{start:'#FFEBB0',end:'#AE6D00'}},14:{gradient:{start:'#FFE0B0',end:'#B15900'}},15:{gradient:{start:'#FFCCBB',end:'#B02D00'}},16:{gradient:{start:'#D7CCC8',end:'#502316'}},17:{gradient:{start:'#EEEEEE',end:'#4A4A4A'}},18:{gradient:{start:'#CFD8DC',end:'#152E3B'}},19:{gradient:{start:'#FFCED2',end:'#74004E'}},20:{gradient:{start:'#D1C5EA',end:'#002C83'}},21:{gradient:{start:'#B0EBF2',end:'#005667'}},22:{gradient:{start:'#0A4B04',end:'#F1F6A0'}},23:{gradient:{start:'#FFEBB0',end:'#762800'}},24:{gradient:{start:'#FFD2C2',end:'#B31700'}},25:{gradient:{start:'#FDE6DD',end:'#170073'}},26:{gradient:{start:'#8CD1FF',end:'#6A0047'}},27:{gradient:{start:'#004C7A',end:'#FFEEB2'}},28:{gradient:{start:'#00156A',end:'#FFDEE8'}},29:{gradient:{start:'#FFF1BC',end:'#3E005F'}},30:{gradient:{start:'#165A00',end:'#FF8F8F'}},31:{gradient:{start:'#06003B',end:'#D9FF96'}}},2:{0:{fill:'#F44336'},1:{fill:'#EC2965'},2:{fill:'#9D31B3'},3:{fill:'#6740BA'},4:{fill:'#3C54B8'},5:{fill:'#0298F6'},6:{fill:'#00AAF6'},7:{fill:'#00BCD5'},8:{fill:'#009587'},9:{fill:'#48AD49'},10:{fill:'#8AC13F'},11:{fill:'#CEDA20'},12:{fill:'#FFE91E'},13:{fill:'#FFC000'},14:{fill:'#FF9800'},15:{fill:'#FF5A20'},16:{fill:'#7A5547'},17:{fill:'#9E9E9E'},18:{fill:'#5F7D8C'},19:{gradient:{start:'#FF3B2C',end:'#9D31B3'}},20:{gradient:{start:'#6740BA',end:'#0298F6'}},21:{gradient:{start:'#00AAF6',end:'#009587'}},22:{gradient:{start:'#48AD49',end:'#CEDA20'}},23:{gradient:{start:'#FFE91E',end:'#FF9800'}},24:{gradient:{start:'#FF5A20',end:'#7A5547'}},25:{gradient:{start:'#5F7D8C',end:'#FFB7B7'}},26:{gradient:{start:'#009AFF',end:'#DB36A4'}},27:{gradient:{start:'#2191D4',end:'#FFCE24'}},28:{gradient:{start:'#204AF5',end:'#FFB0C8'}},29:{gradient:{start:'#FFDB58',end:'#9125CA'}},30:{gradient:{start:'#78CA5D',end:'#FF4646'}},31:{gradient:{start:'#2B15FF',end:'#B4EC51'}}},3:{0:{fill:'#FFCED2','text_fill':'#D63330'},1:{fill:'#F9BCD1','text_fill':'#C4215D'},2:{fill:'#E2BFE8','text_fill':'#7C29A5'},3:{fill:'#D1C5EA','text_fill':'#5033AB'},4:{fill:'#C4CBEA','text_fill':'#2D42A1'},5:{fill:'#B9DEFC','text_fill':'#0178D5'},6:{fill:'#B1E5FD','text_fill':'#0089D3'},7:{fill:'#B0EBF2','text_fill':'#0097A7'},8:{fill:'#B0DFDB','text_fill':'#00786A'},9:{fill:'#C7E5C8','text_fill':'#348D35'},10:{fill:'#DCECC6','text_fill':'#679D2E'},11:{fill:'#F0F3C1','text_fill':'#B0B214'},12:{fill:'#FFF8C1','text_fill':'#FDBF14'},13:{fill:'#FFEBB0','text_fill':'#FFA000'},14:{fill:'#FFE0B0','text_fill':'#F87D00'},15:{fill:'#FFCCBB','text_fill':'#E94D17'},16:{fill:'#D7CCC8','text_fill':'#5E4037'},17:{fill:'#EEEEEE','text_fill':'#616161'},18:{fill:'#CFD8DC','text_fill':'#455A64'},19:{gradient:{start:'#FFCED2',end:'#E2BFE8'},'text_fill':'#B8348D'},20:{gradient:{start:'#D1C5EA',end:'#B9DEFC'},'text_fill':'#4B77CE'},21:{gradient:{start:'#B0EBF2',end:'#DCECC6'},'text_fill':'#42B2C8'},22:{gradient:{start:'#ACE9AE',end:'#F1F6A0'},'text_fill':'#5DA956'},23:{gradient:{start:'#FFEBB0',end:'#FFCCBB'},'text_fill':'#C68666'},24:{gradient:{start:'#FFD2C2',end:'#FFE0E0'},'text_fill':'#C07469'},25:{gradient:{start:'#FDE6DD',end:'#CFD8DC'},'text_fill':'#8A84A2'},26:{gradient:{start:'#8CD1FF',end:'#FFBBE8'},'text_fill':'#7464CE'},27:{gradient:{start:'#8DD4FF',end:'#FFEEB2'},'text_fill':'#439092'},28:{gradient:{start:'#C8D3FF',end:'#FFDEE8'},'text_fill':'#7A73E2'},29:{gradient:{start:'#FFF1BC',end:'#EBC5FF'},'text_fill':'#BA699F'},30:{gradient:{start:'#D7FFCA',end:'#FF8F8F'},'text_fill':'#D67269'},31:{gradient:{start:'#8E84EB',end:'#D9FF96'},'text_fill':'#6269A1'}}};this.ps_timeout=undefined;this.$logo_color_fill=undefined;this.$logo_color_fill_input=undefined;this.$layer_1=undefined;this.$layer_2=undefined;this.$logo_gradient_start=undefined;this.$logo_gradient_end=undefined;this.$logo_gradient_start_input=undefined;this.$logo_gradient_end_input=undefined;this.$logo_stroke_color=undefined;this.$toggle_gradient=undefined;this.$font_family=undefined;this.$eff_fill=undefined;this.$toggle_fill=undefined;this.$toggle_shadow=undefined;this.$toggle_stroke=undefined;this.$layer_icons=undefined;this.$layer_icons_wrapper=undefined;this.$gradient_angle_toggle=undefined;this.$eff_gradient=undefined;this.$eff_drop_shadow=undefined;this.$logo_text=undefined;this.loadScriptsThenInit()}$.extend(Plugin.prototype,{loadScriptsThenInit:function(){var self=this;$.require.clear('js');$.require('/my/s3/js/raphael.js').done(function(){$.require({files:['/my/s3/js/raphael-svg-import.js','/my/s3/js/raphael.dropshadow.filter.js','/my/s3/js/raphael.dropshadow.js','/my/s3/js/opentype.min.js'],async:true}).done(function(){self.init()})})},extendRaphael:function(){Raphael.fn.getTransformString=function(el){var bottom=false;var transformString='';do{if(el.type=='set'){el=el[0]}else{transformString=el.matrix;bottom=true}}while(!bottom);return transformString.toTransformString()};Raphael.fn.print_center=function(x,y,string,font,size,letter_spacing){size=parseInt(size);var path=this.print(x,y,string,font,size,'baseline',letter_spacing);var bb=path.getBBox();var dx=(x-bb.x)/2;var dy=(y-bb.y)/2;return path.transform("t"+dx+","+dy)};Raphael.el.is=function(type){return this.type==(''+type).toLowerCase()};Raphael.el.x=function(){return this.is('circle')?this.attr('cx'):this.attr('x')};Raphael.el.y=function(){return this.is('circle')?this.attr('cy'):this.attr('y')};Raphael.el.o=function(){this.ox=this.x();this.oy=this.y();return this};Raphael.el.draggable=function(){var start=function(){this.ox=0;this.oy=0},move=function(dx,dy){var x=dx-this.ox,y=dy-this.oy;var layer=this.data('layer');if(layer!='text'){x/=2;y/=2}this.transform("...T"+x+","+y);logo.setTransform(layer);this.ox=dx;this.oy=dy},end=function(){logo.afterRender()};if(!this.data('draggable_initialized')){this.drag(move,start,end);this.data('draggable_initialized',true)}return this};Raphael.st.draggable=function(){for(var i in this.items){this.items[i].draggable()}}},init:function(){$(document).data('favicon_fonts_loaded',true);var self=this;self.extendRaphael();self.extendRaphael=$.noop;self.$logo_color_fill=$('#logo_color_fill');self.$logo_color_fill_input=$('#logo_color_input');self.$layer_1=$('#layer_1');self.$layer_2=$('#layer_2');self.$logo_gradient_start=$('#logo_gradient_start');self.$logo_gradient_start_input=$('#logo_gradient_start_input');self.$logo_gradient_end=$('#logo_gradient_end');self.$logo_gradient_end_input=$('#logo_gradient_end_input');self.$logo_stroke_color=$('#logo_stroke_color');self.$font_family=$('.font-family');self.$eff_fill=$('.eff-fill');self.$toggle_fill=$('#toggle_fill');self.$toggle_shadow=$('#toggle_shadow');self.$toggle_stroke=$('#toggle_stroke');self.$layer_icons=$('#layer_icons');self.$layer_icons_wrapper=$('#layer_icons_wrapper');self.$gradient_angle_toggle=$('#gradient_angle_toggle');self.$eff_gradient=$('.eff-gradient');self.$eff_drop_shadow=$('#effect_drop_shadow');self.$logo_text=$('#logo_text');self.middle_x=Math.ceil(this.settings.width/2);self.middle_y=Math.ceil(this.settings.height/2);self.layers.text.caption=self.$logo_text.val();$('#gradient_angle').roundSlider({value:self.layers[self.current_layer].gradient.angle,radius:50,min:0,max:360,sliderType:'default',handleShape:"dot",handleSize:'+8',change:function(slider){self.changeGradientAngle(slider.value)}});$('#gradient_angle_value').text(self.layers[self.current_layer].gradient.angle);self.$logo_gradient_start.spectrum({'color':self.$logo_gradient_start_input.val(),'showInput':true,'preferredFormat':"hex",'move':function(color){var hex=color.toHexString();self.$logo_gradient_start.css('backgroundColor',hex);self.changeGradient('gradient_start',hex,self.current_layer);self.$logo_gradient_start_input.val(hex);self.afterRender()},'beforeShow':function(){$('.sp-cancel').hide();$('.sp-choose').addClass('s3-btn white-gray without-margin small').html('<span class="s3-ico i-save-svg"></span> OK');self.$logo_gradient_start.spectrum("set",self.layers[self.current_layer].gradient.start)}});self.$logo_gradient_end.spectrum({'color':self.$logo_gradient_end_input.val(),'showInput':true,'preferredFormat':"hex",'move':function(color){var hex=color.toHexString();self.$logo_gradient_end.css('backgroundColor',hex);self.changeGradient('gradient_end',hex,self.current_layer);self.$logo_gradient_end_input.val(hex);self.afterRender()},'beforeShow':function(){$('.sp-cancel').hide();$('.sp-choose').addClass('s3-btn white-gray without-margin small').html('<span class="s3-ico i-save-svg"></span> OK');self.$logo_gradient_end.spectrum("set",self.layers[self.current_layer].gradient.end)}});self.$logo_color_fill.spectrum({'color':self.$logo_color_fill_input.val(),'showInput':true,'preferredFormat':"hex",'move':function(color){var hex=color.toHexString();self.$logo_color_fill.css('backgroundColor',hex);self.changeFill(hex,self.current_layer);self.afterRender()},'beforeShow':function(){$('.sp-cancel').hide();$('.sp-choose').addClass('s3-btn white-gray without-margin small').html('<span class="s3-ico i-save-svg"></span> OK');self.$logo_color_fill.spectrum("set",self.layers[self.current_layer].fill)}});self.$logo_stroke_color.spectrum({'color':$('#logo_stroke_input').val(),'showInput':true,'preferredFormat':"hex",'move':function(color){var hex=color.toHexString();self.$logo_stroke_color.css('backgroundColor',hex);self.changeStroke(hex,self.current_layer);self.afterRender()},'beforeShow':function(){$('.sp-cancel').hide();$('.sp-choose').addClass('s3-btn white-gray without-margin small').html('<span class="s3-ico i-save-svg"></span> OK');self.$logo_stroke_color.spectrum("set",self.layers[self.current_layer].stroke)}});var canvas_el=$(this.element).attr('id');self.logo=Raphael(canvas_el,this.settings.width,this.settings.height);self.logo.setViewBox(0,0,this.settings.width,this.settings.height,true);self.logo.canvas.setAttribute('id','main_svg');self.generateFavicon();$(document).off('.favicon');self.$logo_text.on('paste.favicon, keyup.favicon, input.favicon',function(){var logoText=$(this).val();self.changeText(logoText)});$('#fill_type').on('change.favicon',function(){var fill_type=$(this).val();self.setFillType(fill_type,self.current_layer,true);self.afterRender()});self.$font_family.on('change.favicon',function(){var font=$(this).val();if(self.layers.text.is_bold_enabled){font+='_bold'}if(self.layers.text.is_italic_enabled){font+='_italic'}self.changeFont(font)});$('.control-layer.active .layer-panel').slideDown();$(document).on('click.favicon',function(e){var $target=$(e.target);if($target.closest('.layer-icon').get(0)){self.onFigureClick($target.closest('.layer-icon'));return}if($target.closest('.icon-wrapper').get(0)){self.onFigureClick($target.find('.layer-icon'));return}if($target.closest('.favicon-category-wrapper').get(0)){var category_id=$target.data('category-id');self.showCategory(category_id);return}if($target.closest('#layer_icons_wrapper').get(0)){return false}if($target.closest('#layer_icons').get(0)){return false}if($target.closest('.figure').get(0)){return false}if($target.closest('.choose-figure').get(0)){return false}if($target.closest('#gradient_angle_toggle').get(0)){return false}if($target.closest('#gradient_angle_toggle_button').get(0)){self.$gradient_angle_toggle.toggle();return false}self.$gradient_angle_toggle.hide();if($target.closest('.layer-panel-header').get(0)){$('.control-layer').removeClass('active');self.current_layer=$target.closest('.control-layer').data('layer');$('#effects').appendTo('#'+self.current_layer+' .effects');$.each(self.layers,function(key){if(key=='svg'){return}var $layer=$('#'+key),$panel=$layer.find('.layer-panel');if(key==self.current_layer){if(key=='layer_1'){self.$eff_drop_shadow.hide()}else{self.$eff_drop_shadow.show()}if($panel.css('display')=='none'){$panel.slideDown("fast");$layer.addClass('active')}else{$panel.slideUp("fast")}}else{$panel.slideUp("fast")}});self.setFillType(self.getFillType(self.current_layer),self.current_layer,true);self.updateEffects(self.current_layer)}self.$layer_icons_wrapper.hide()});$('.control-move').mousedown(function(){var direction=$(this).data('direction');self.move(direction)});$(document).mouseup(function(){clearTimeout(self.move_timeout)});self.$toggle_fill.change(function(){var is_enabled=$(this).prop('checked');if(is_enabled){self.revealFill(self.current_layer)}else{self.removeFill()}});self.$toggle_shadow.change(function(){var is_enabled=$(this).prop('checked');if(is_enabled){self.addShadow(self.current_layer)}else{self.removeShadow(self.current_layer)}});self.$toggle_stroke.change(function(){var is_enabled=$(this).prop('checked');if(is_enabled){self.$logo_stroke_color.show();self.changeStroke(self.layers[self.current_layer].stroke,self.current_layer,self.current_layer)}else{self.removeStroke(self.current_layer);self.$logo_stroke_color.hide()}});self.$layer_icons.scrollbar();$(window).on('resize.favicon',function(){self.positionIconWrapper()});var faviconKeys=function(event){if($('.s3-input-text').is(':focus')){return}switch(event.which){case 40:case 38:if($('.chzn-container-active').css('display')=="inline-block"){var sel=$('.chzn-container-active');var el=sel.prev();if(el.hasClass('font-family')){el.data('chosen').result_select(event);el.data('chosen').results_show()}return}break}switch(event.which){case 39:event.preventDefault();self.move('right');break;case 37:event.preventDefault();self.move('left');break;case 40:event.preventDefault();self.move('down');break;case 38:event.preventDefault();self.move('up');break}};$(document).off('keydown.favicon');$(document).on('keydown.favicon',faviconKeys);self.afterRender()},placeSVG:function(url,layer){var self=this;return $.ajax({type:"GET",url:url,dataType:"xml",success:function(svgXML){var temp=$(svgXML);var viewBox=temp.find('svg').attr('viewBox');viewBox=viewBox.split(' ');self.import_svg=undefined;$('#imported_svg_'+layer).remove();if(self.import_svg==undefined){self.import_svg=Raphael(document.getElementById("main_svg"),self.settings.width,self.settings.height);self.import_svg.setViewBox(viewBox[0],viewBox[1],viewBox[2],viewBox[3],true);self.import_svg.canvas.setAttribute('id','imported_svg_'+layer)}self.layers[layer]['el']=self.import_svg.set();self.import_svg.importSVG(svgXML);self.layers[layer]['el'].push(self.import_svg);self.layers[layer]['el'].attr({"fill":self.getLayerFill(layer)});self.layers[layer]['el'].data('layer',layer);if(self.layers[layer].is_hidden){self.layers[layer]['el'].hide()}if(layer=='layer_2'){$('#imported_svg_layer_1').insertBefore('#imported_svg_layer_2')}}})},placeSvgPlain:function(svg,layer){var self=this;var $svg=$(svg).appendTo($('<div>'));var svg_xml=$.parseXML(svg);var viewBox=$svg[0].getAttribute('viewBox');viewBox=viewBox.split(' ');self.import_svg=undefined;$('#imported_svg_'+layer).remove();if(self.import_svg==undefined){self.import_svg=Raphael(document.getElementById("main_svg"),self.settings.width,self.settings.height);self.import_svg.setViewBox(viewBox[0],viewBox[1],viewBox[2],viewBox[3],true);self.import_svg.canvas.setAttribute('id','imported_svg_'+layer)}self.layers[layer].el=self.import_svg.importSVG(svg_xml);self.layers[layer].el.attr({"fill":self.getLayerFill(layer)});self.layers[layer].el.data('layer',layer);if(self.layers[layer].is_hidden){self.layers[layer].el.hide()}if(layer=='layer_2'){$('#imported_svg_layer_1').insertBefore('#imported_svg_layer_2')}},onFigureClick:function($el){var self=this;var layer=$el.data('layer');var figure_id=String($el.data('figure'));self.resetTransformations();$.each(self.icons,function(key,figure){if(figure.figure_id==figure_id){self.layers[layer].current_figure=figure;if(figure.category_id!==undefined){self.current_category=figure.category_id}else{self.current_category=10}return false}});if(self.current_layer=='layer_1'&&!self.layers.layer_2.current_figure.is_free){var layer_2_figure_id=self.layers.layer_1.current_figure.figure_id+'-001';$.each(this.icons,function(key,figure){if(figure.figure_id==layer_2_figure_id){self.layers.layer_2.current_figure=figure;return false}});self.loadFigureLayer('layer_2',self.layers.layer_2.current_figure,self.layers.layer_2.is_hidden,true)}self.loadFigureLayer(layer,self.layers[layer].current_figure,false,true);self.$layer_icons_wrapper.hide()},resetTransformations:function(layer){var self=this;if(layer==undefined){layer=self.current_layer}if(layer=='text'){self.layers[layer].el.transform('');self.centerElement('text')}else{self.layers.layer_2.el.transform('');self.setTransform('layer_2')}self.layers[layer].el.attr({'stroke-width':self.layers[layer]['stroke-width']});self.setTransform(layer);self.afterRender()},loadFaviconsList:function(){return $.get('/-/cms/v1/logo/?act=list&'+access,function(dom_nodes){$('#saved_favicons').html(dom_nodes)})},getFillType:function(layer){if(this.layers[layer].fill_enabled){return'color'}if(this.layers[layer].gradient.is_enabled){return'gradient'}return'none'},updateGradientPickers:function(layer){var self=this;self.$logo_gradient_start.css('backgroundColor','#'+self.layers[layer].gradient.start);self.$logo_gradient_start_input.val('#'+self.layers[layer].gradient.start);self.$logo_gradient_end.css('backgroundColor','#'+self.layers[layer].gradient.end);self.$logo_gradient_end_input.val('#'+self.layers[layer].gradient.end)},updateColorPickers:function(layer){var self=this;self.$logo_color_fill.css('backgroundColor','#'+self.layers[layer].fill)},setFillType:function(fill_type,layer,redraw_interface){var self=this;if(layer===undefined){layer=self.current_layer}self.layers[layer].fill_type=fill_type;if(redraw_interface){$('#fill_type').val(fill_type).trigger("liszt:updated")}switch(fill_type){case'color':self.revealFill(layer);if(redraw_interface){self.$eff_fill.show();self.$eff_gradient.hide();self.updateColorPickers(layer)}break;case'gradient':self.layers[layer]['fill_enabled']=false;self.layers[layer].gradient.is_enabled=true;var fill=(360-self.layers[layer].gradient.angle)+'-'+self.layers[layer].gradient.start+'-'+self.layers[layer].gradient.end;self.layers[layer].el.attr({'fill':fill});if(redraw_interface){self.updateGradientPickers(layer);self.$eff_gradient.show();self.$eff_fill.hide()}break;case'none':self.layers[layer].gradient.is_enabled=false;self.layers[layer]['fill']='none';self.layers[layer]['el'].attr('fill','none');self.layers[layer]['fill_enabled']=false;if(redraw_interface){self.$eff_gradient.hide();self.$eff_fill.hide()}break}},updateEffects:function(layer){var self=this;if(self.layers[layer].stroke_enabled){self.changeStroke(self.layers[layer].stroke,layer);self.$toggle_stroke.prop('checked',true);self.$toggle_stroke.parent('label').S3changeCheckboxAndRadio();self.$logo_stroke_color.show()}else{self.removeStroke(layer);self.$toggle_stroke.prop('checked',false);self.$toggle_stroke.parent('label').S3changeCheckboxAndRadio();self.$logo_stroke_color.hide()}self.$logo_stroke_color.css('backgroundColor','#'+self.layers[layer].stroke);$('#logo_stroke_color_input').val(self.layers[layer].stroke);if(self.layers[layer].gradient.is_enabled){self.updateGradientPickers(layer)}$('#gradient_angle_value').text(self.layers[layer].gradient.angle);if(self.current_layer=='layer_1'){self.$eff_drop_shadow.hide();$('#favicon-transform-effects').hide()}else{self.$eff_drop_shadow.show();$('#favicon-transform-effects').show()}if(self.layers[layer]['shadow_enabled']){self.addShadow(layer);self.$toggle_shadow.prop('checked',true);self.$toggle_shadow.parent('label').S3changeCheckboxAndRadio()}else{self.removeShadow(layer);self.$toggle_shadow.prop('checked',false);self.$toggle_shadow.parent('label').S3changeCheckboxAndRadio()}},changeFont:function(font){this.layers.text.font=font;this.layers.text.el.attr('font-family',font);this.afterRender()},addGradient:function(){var object=this.layers[this.current_layer]['el'];this.layers[this.current_layer].gradient.is_enabled=true;object.attr({'fill':360-this.layers[this.current_layer].gradient.angle+'-'+this.layers[this.current_layer].gradient.start+'-'+this.layers[this.current_layer].gradient.end});$('.gradient-add-button').hide();$('.gradient-edit-inputs').show();this.afterRender()},centerElement:function(layer){var self=this;if(this.layers[layer]['el']!==undefined){var object=this.layers[layer]['el'];var type=object.node.localName}else{type='text'}switch(type){case'text':$.when(this.measureText()).done(function(res){var height=res.height,width=res.width;var x=self.settings.width/2,y=self.settings.height/2+height/2,transforms=self.getTransforms(object);if(transforms.dx||transforms.dy){x=x-transforms.dx;y=y-transforms.dy}if(transforms.noRotation==false||transforms.scalex>1){var bbox=self.layers.text.el.getBBox();var bx=bbox.x,by=bbox.y;x=(self.settings.width/2-bbox.width/2)-bbox.x;y=(self.settings.height/2-bbox.height/2)-bbox.y}object.transform('...T'+x+','+y);self.setTransform(layer);object.attr({'x':0,'y':0,'opacity':1});self.afterRender()});break;case'rect':object.animate({'x':this.middle_x,'y':this.middle_y},100,function(){self.afterRender()});break;case'circle':object.animate({'cx':this.middle_x,'cy':this.middle_y},100,function(){self.afterRender()});break}},getTransforms:function(el){if(el.matrix===undefined){return el.transform()}return el.matrix.split()},getMiddleTextPos:function(){var bbox=this.layers.text.el.getBBox();return{x:this.middle_x,y:this.middle_y+bbox.height/2}},measureText:function(){var self=this,text_x=-this.layers.text.el.getBBox(1).width/2,text_string=this.layers.text['el'][0]['textContent'];var size=String(this.layers.text.el.attr('font-size'));size=parseInt(size.replace('px'));var font_folder=self.getRegularFontName(self.layers.text.font);var dfd=$.Deferred();opentype.load('/g/s3/favicon/fonts/'+font_folder+'/'+self.layers.text.font+'.ttf',function(err,font){if(err){dfd.reject('Font is not loaded');alert('Could not load font: '+err)}else{var canvas=document.getElementById('canvas');var ctx=canvas.getContext('2d');ctx.clearRect(0,0,canvas.width,canvas.height);var tmp_path=font.getPath(text_string,10,300,size);tmp_path.draw(ctx);var ascent=0;var descent=0;var width=0;var scale=1/font.unitsPerEm*size;var glyphs=font.stringToGlyphs(text_string);for(var i=0;i<glyphs.length;i++){var glyph=glyphs[i];if(glyph.advanceWidth){width+=glyph.advanceWidth*scale}if(i<glyphs.length-1){var kerningValue=font.getKerningValue(glyph,glyphs[i+1]);width+=kerningValue*scale}ascent=Math.max(ascent,glyph.yMax);descent=Math.min(descent,glyph.yMin)}return dfd.resolve({width:width,height:ascent*scale,actualBoundingBoxDescent:descent*scale,fontBoundingBoxAscent:font.ascender*scale,fontBoundingBoxDescent:font.descender*scale})}});return dfd.promise()},changeGradient:function(id,color,layer){var object=this.layers[layer]['el'];if(id=='gradient_start'){this.layers[layer].fill=color;this.layers[layer].last_fill=color;this.layers[layer].gradient.start=color;object.attr({'fill':360-this.layers[layer].gradient.angle+'-'+color+'-'+this.layers[layer].gradient.end})}else{this.layers[layer].gradient.end=color;object.attr({'fill':360-this.layers[layer].gradient.angle+'-'+this.layers[layer].gradient.start+'-'+color})}},changeGradientAngle:function(angle){var object=this.layers[this.current_layer]['el'];this.layers[this.current_layer].gradient.angle=angle;$('#gradient_angle_value').text(angle);angle=360-angle;object.attr({'fill':angle+'-'+this.layers[this.current_layer].gradient.start+'-'+this.layers[this.current_layer].gradient.end});this.afterRender()},addShadow:function(layer){this.layers[layer]['shadow_enabled']=true;this.layers[layer]['el'].dropShadow(this.shadow[0],this.shadow[1],this.shadow[2],this.shadow[3]);this.afterRender()},removeShadow:function(layer){this.layers[layer]['shadow_enabled']=false;this.layers[layer]['el'].dropShadow('none');this.afterRender()},hideLayer:function(layer){$('#'+layer+' .layer-panel-header').css({'opacity':0.4});$('#toggle_'+layer).prop('checked',false);$('#toggle_'+layer).parent('label').S3changeCheckboxAndRadio();if(this.layers[layer].el){this.layers[layer].el.hide()}this.layers[layer].is_hidden=true;this.afterRender()},showLayer:function(layer,do_not_expand){if(do_not_expand===undefined){var panels=$('.layer-panel')}$('#'+layer+' .layer-panel-header').css({'opacity':1});$('#toggle_'+layer).prop('checked',true);$('#toggle_'+layer).parent('label').S3changeCheckboxAndRadio();this.layers[layer].el.show();this.layers[layer].is_hidden=false;this.afterRender()},toggleLayer:function(layer){this.$layer_icons_wrapper.hide();var is_hidden=this.layers[layer].is_hidden;if(is_hidden){this.showLayer(layer)}else{this.hideLayer(layer)}},resizeText:function(zoomIn){this.current_layer='text';var text=this.layers.text.el;var size=parseInt(text.attr('font-size'));if(zoomIn){size+=10}else{size-=10}if(size<this.layers.text.min_size||size>this.layers.text.max_size){return}this.layers.text.size=size;text.attr({'font-size':size+'px'});this.afterRender()},saveFavicon:function(is_silent){var self=this;var defer=$.Deferred();if($('#favicon_save_button').data('disabled')){return defer.reject("Uninitialized interface!")}var seen=[];var params=JSON.stringify(this.layers,function(key,val){if(val!=null&&typeof val=="object"){if(seen.indexOf(val)>=0){return}seen.push(val)}return val});$.when(this.convertTextToPathAndGetSvg()).done(function(svg_data){$.post('/-/cms/v1/logo/?act=save&'+access,{'params':params,'svg_data':svg_data,'favicon_id':self.getFaviconId()}).done(function(favicon_id){favicon_id=parseInt(favicon_id);if(favicon_id>0){if(self.layers.text.is_hidden==false){self.layers.text['el'].show()}self.favicon_id=favicon_id;if(is_silent===undefined){$.when(self.loadFaviconsList()).done(function(){$('.favicon_item').removeClass('active');$('#s3_favicon_module_title').text('#'+favicon_id);$('#favicon_'+favicon_id).addClass('active');util.msg(JS_FAVICON_IS_SAVED)})}else{$('.favicon_item').removeClass('active');$('#s3_favicon_module_title').text('#'+favicon_id);$('#favicon_'+favicon_id).addClass('active')}defer.resolve()}else{defer.reject('Favicon is not saved')}})});return defer.promise()},getFaviconId:function(){return this.favicon_id},saveLogo:function(type){if(type===undefined){type='png'}var svg_content=this.convertTextToPathAndGetSvg();var blob=new Blob([svg_content],{type:"image/svg+xml;charset=utf-8"});switch(type){case'svg':saveAs(blob,"logo.svg");break;case'png':case'ico':$.post('save.php',{type:type,data:svg_content},function(result){var newWin=window.open('http://d3.artshevtsov.test/result/'+result,result,"width=800,height=800,resizable=yes,scrollbars=yes,status=yes");newWin.focus()});break}},downloadFavicon:function(event){if(!event.target){console.q('target not found');return}const parent=event.target.closest('.favicon_item');const svg=parent.querySelector('div > svg');if(svg){const href='data:image/svg+xml;base64,'+btoa(svg.parentNode.innerHTML);const link=document.createElement('a');link.setAttribute('href',href);link.setAttribute('download',`favicon-${Date.now()}.svg`);link.click()}else console.error('svg not found')},deleteFavicon:function(favicon_id){var self=this;s3.confirm(JS_DELETE+' '+JS_FAVICON+' #'+favicon_id+'?',function(){return $.post('/-/cms/v1/logo/?act=delete&'+access,{'favicon_id':favicon_id},function(result){if(result.length){$.when(self.loadFaviconsList()).then(function(){popupController.closeLastPopup();if(self.favicon_id==favicon_id){self.favicon_id=0;$('#s3_favicon_module_title').text(JS_LOGO_GENERATOR_CREATE_NEW)}util.msg('Фавикон #'+favicon_id+' удален.')})}else{util.msg('Фавикон нельзя удалить. Была попытка оплаты.');popupController.closeLastPopup();self.loadFaviconsList()}})})},placeOnSite:function(favicon_id){var self=this;if(favicon_id===undefined){favicon_id=self.favicon_id}if(self.checkAllHidden()){util.msg("Отобразите хотя бы 1 слой чтобы продолжить.");return}if(favicon_id==0){$.when(self.saveFavicon(true)).done(function(){self.loadFaviconsList();s3.openModalPopup('/-/cms/v1/logo/?act=place_on_site&favicon_id='+self.favicon_id+'&'+access,true)})}else{$.when(self.saveFavicon(true),self.checkPsStatus()).then(function(){self.loadFaviconsList();if(self.is_paid){$.post('/-/cms/v1/logo/?act=place_on_site&favicon_id='+favicon_id+'&'+access,{},function(result){if(result){util.msg(JS_FAVICON_IS_PLACED_ON_SITE)}else{util.msg(JS_ERROR)}})}else{s3.openModalPopup('/-/cms/v1/logo/?act=place_on_site&favicon_id='+favicon_id+'&'+access,true)}})}},psPopupTracker:function(){var self=this;clearTimeout(self.ps_timeout);self.ps_timeout=setTimeout((function(){$.when(self.checkPsStatus()).done(function(){if(self.is_paid){popupController.closeLastPopup();self.loadFaviconsList();clearTimeout(self.ps_timeout)}else{self.psPopupTracker()}})}),3000)},openPsPopup:function(){var self=this;self.psPopupTracker();$.post('/-/cms/v1/logo/?act=ps_init&'+access,{"favicon_id":self.favicon_id},function(){self.loadFaviconsList();var url='/-/cms/v1/payment/?'+access+'&service_group=s3_custom_favicon&order_params=object_id='+self.favicon_id;s3.openModalPopup(url)})},checkPsStatus:function(){var self=this;return $.get('/-/cms/v1/logo/?act=status&favicon_id='+self.favicon_id+'&'+access,function(status){self.is_paid=false;if(status=='paid'){self.is_paid=true}})},markAsPaid:function(favicon_id){favicon_id=parseInt(favicon_id);var self=this;$.post('/-/cms/v1/logo/?act=mark_as_paid&'+access,{"favicon_id":favicon_id},function(){self.loadFaviconsList();util.msg("Фавикон помечен оплаченным")})},showExamples:function(){s3.openModalPopup('/-/cms/v1/logo/?act=examples&'+access)},convertTextToPathAndGetSvg:function(){var self=this;var path_text=undefined;var dfd=$.Deferred();if(!this.layers.text.is_hidden){var text_x=-this.layers.text.el.getBBox(1).width/2,text_y=this.layers.text['el'].attr('y'),text_string=this.layers.text['el'][0]['textContent'];var size=String(this.layers.text.el.attr('font-size'));size=parseInt(size.replace('px'));var font_folder=self.getRegularFontName(self.layers.text.font);opentype.load('/g/s3/favicon/fonts/'+font_folder+'/'+self.layers.text.font+'.ttf',function(err,font){if(err){dfd.reject('Font is not loaded');alert('Could not load font: '+err)}else{var path=font.getPath(text_string,text_x,0,size);path_text=path.toPathData();path_text=self.logo.path(path_text);path_text.attr({fill:self.getLayerFill('text'),stroke:'none'});if(self.layers.text.stroke_enabled){path_text.attr({stroke:self.getLayerStroke('text'),'stroke-width':self.getLayerStrokeWidth('text')})}if(self.layers.text.shadow_enabled){path_text.dropShadow(self.shadow[0],self.shadow[1],self.shadow[2],self.shadow[3])}if(self.layers.text.transform.val.length){path_text.transform(self.layers.text.transform.val)}path_text.insertAfter(self.layers.text['el']);self.layers.text['el'].hide();var svg_content=$(self.element).clone();svg_content.find('text').remove();var gradients=svg_content.find('linearGradient');var filters=svg_content.find('filter');svg_content=svg_content.html();if(gradients.length){$.each(gradients,function(key,gradient){var id=$(gradient).attr('id');var new_id=self.generateQuickGuId();svg_content=svg_content.replace(new RegExp(id,'g'),'gradient_'+new_id)})}if(filters.length){$.each(filters,function(key,filter){var id=$(filter).attr('id');var new_id=self.generateQuickGuId();svg_content=svg_content.replace(new RegExp(id,'g'),'filter_'+new_id)})}path_text.remove();self.layers.text['el'].show();dfd.resolve(svg_content)}})}else{var svg_content=$(self.element).clone();var gradients=svg_content.find('linearGradient');var filters=svg_content.find('filter');svg_content=svg_content.html();if(gradients.length){$.each(gradients,function(key,gradient){var id=$(gradient).attr('id');var new_id=self.generateQuickGuId();svg_content=svg_content.replace(new RegExp(id,'g'),'gradient_'+new_id)})}if(filters.length){$.each(filters,function(key,filter){var id=$(filter).attr('id');var new_id=self.generateQuickGuId();svg_content=svg_content.replace(new RegExp(id,'g'),'filter_'+new_id)})}dfd.resolve(svg_content)}return dfd.promise()},generateQuickGuId:function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},editFavicon:function(favicon_id){var self=this;$('.favicon_item').removeClass('active');$('#s3_favicon_module_title').text('#'+favicon_id);$('#favicon_'+favicon_id).addClass('active');$.post('/-/cms/v1/logo/?act=edit&'+access,{'favicon_id':favicon_id},function(params){self.favicon_id=favicon_id;params=JSON.parse(params);params=$.parseJSON(params);self.loadState(params)})},loadExample:function(example_id){var self=this;self.favicon_id=0;$('.favicon_item').removeClass('active');var examples=self.examples();self.loadState(examples[example_id]);$('#s3_favicon_module_title').text(JS_LOGO_GENERATOR_CREATE_NEW)},loadState:function(params){var self=this;$.each(params,function(layer,options){self.layers[layer].stroke_enabled=options.stroke_enabled;self.layers[layer].shadow_enabled=options.shadow_enabled;self.layers[layer].fill_enabled=options.fill_enabled;self.layers[layer].fill_type=options.fill_type;self.layers[layer].stroke=options.stroke;self.layers[layer].fill=options.fill;self.layers[layer].last_fill=options.last_fill;self.layers[layer].gradient=options.gradient;self.layers[layer].is_hidden=options.is_hidden;if(options.transform!==undefined&&options.transform.val!=''){self.layers[layer].transform=options.transform}else{self.layers[layer].transform.val=''}if(layer=='text'){if(options['text-anchor']==undefined){self.layers.text['fix-text-pos']=true}else{self.layers.text['fix-text-pos']=undefined}}if(options.current_figure!==undefined&&typeof(options.current_figure)=='string'){options.current_figure=options.current_figure.replace('.svg','');$.each(self.icons,function(key,figure){if(figure.figure_id==options.current_figure){options.current_figure=figure;return false}})}switch(layer){case'text':self.loadTextLayer('text',options.size,options.font,options.style,options.is_regular,options.is_bold_enabled,options.is_italic_enabled,options.pos,options.caption,options.is_hidden,false);break;case'layer_1':self.loadFigureLayer(layer,options.current_figure,options.is_hidden,true);break;case'layer_2':self.current_category=10;$.each(self.icons,function(key,figure){if(figure.figure_id==options.current_figure.figure_id){if(figure.category_id!==undefined){self.current_category=figure.category_id}return false}});self.loadFigureLayer(layer,options.current_figure,options.is_hidden,false);break}$('.layer-panel').slideUp("fast");$('.control-layer').removeClass('active')})},loadTextLayer:function(layer,size,font,style,is_regular,is_bold_enabled,is_italic_enabled,pos,caption,is_hidden,redraw_interface){var self=this;self.layers.text.size=size;self.layers.text.font=font;self.layers.text.style=style;self.layers.text.is_regular=is_regular;self.layers.text.is_bold_enabled=is_bold_enabled;self.layers.text.is_italic_enabled=is_italic_enabled;self.layers.text.pos=pos;if(self.layers.text.el==undefined){self.layers.text.el=self.logo.text(pos.x,pos.y,caption);self.layers.text.el.data('layer',layer)}self.changeInputText(caption);self.changeText(caption,{'x':pos.x,'y':pos.y});self.layers.text.el.hide();var font_regular=self.getRegularFontName(font);self.$font_family.val(font_regular).trigger("liszt:updated");self.loadStyle(self.getCurrentFontType());self.onAfterLayerLoaded(layer,is_hidden,redraw_interface)},loadFigureLayer:function(layer,current_figure,is_hidden,redraw_interface){var self=this;self.layers[layer].current_figure=current_figure;self.placeSvgPlain(current_figure.svg,layer);self.onAfterLayerLoaded(layer,is_hidden,redraw_interface);var $figure_18=$('<div>').append(current_figure.svg);var $figure_48=$('<div>').append(current_figure.svg);var $figure_18=$figure_18.find('svg').attr({'width':18,'height':18});var $figure_48=$figure_48.find('svg').attr({'width':48,'height':48});$('#'+layer+' .figure').html($figure_48);$('#'+layer+' .layer-panel-figure-small').html($figure_18)},onAfterLayerLoaded:function(layer,is_hidden,redraw_interface){var self=this;self.applyTransform(layer);self.setFillType(self.layers[layer].fill_type,layer,redraw_interface);if(is_hidden){self.hideLayer(layer)}else{self.showLayer(layer,true)}if(self.layers[layer].draggable){self.layers[layer].el.draggable({margin:10});self.layers[layer].el.attr({'cursor':'move'})}self.updateEffects(layer)},applyRandomColorSet:function(){var self=this,layer='layer_1';var set_id=self.getRandomInt(0,3);var color_id=self.getRandomInt(0,31);var rc=self.getRandomColor();var color=this.color_sets[set_id][color_id];if(color.fill!==undefined){self.layers[layer].fill=color.fill;self.layers[layer].last_fill=color.fill;self.layers[layer].fill_enabled=true;self.layers[layer].fill_type='color'}if(color.gradient!==undefined){self.layers[layer].fill_type='gradient';self.layers[layer].fill_enabled=false;self.layers[layer].gradient.start=color.gradient.start;self.layers[layer].gradient.end=color.gradient.end;self.layers[layer].gradient.is_enabled=true}else{self.layers[layer].gradient.start=rc;self.layers[layer].gradient.end='#333333'}if(color.text_fill!==undefined){self.layers.text.fill=color.text_fill;self.layers.text.last_fill=color.text_fill}else{self.layers.text.fill=rc;self.layers.text.last_fill=rc}},getRegularFontName:function(font){font=font.replace('_bold','');return font.replace('_italic','')},getCurrentFontType:function(){if(this.layers.text.is_bold_enabled&&this.layers.text.is_italic_enabled){return'bold_italic'}if(this.layers.text.is_bold_enabled){return'bold'}if(this.layers.text.is_italic_enabled){return'italic'}},placeFigure:function(name,layer,callback){var self=this;if(layer=='layer_1'){if($('#imported_svg_layer_1').length>0){$('#imported_svg_layer_1').remove();this.import_svg=undefined}if($('.cloned_masked_object').length>0){$('.cloned_masked_object, #masked_object, #loaded_mask').remove()}}if(this.layers.svg!==undefined){this.layers.svg.remove()}if(this.layers[layer]['el']!==undefined){this.layers[layer]['el'].remove()}$.when(self.placeSVG(name,layer)).done(function(){self.afterRender()}).then(callback).fail(function(){console.info("Cant't place figure.")})},clearLayer:function(layer){if(this.layers[layer]['el']!==undefined){this.layers[layer]['el'].remove();this.afterRender()}},changeInputText:function(text){text=text.replace(/\s+/," ");text=text.trim();this.$logo_text.val(text)},changeText:function(text,options){text=text.replace(/\s+/," ");text=text.trim();this.layers.text.caption=text;$('#layer_text_caption').text(text);this.layers.text.el.attr({'text':text,'font-size':this.layers.text.size,'id':'text','cursor':'move','text-anchor':'middle'});if(options!==undefined){}this.afterRender()},changeFill:function(hex,layer){if(this.layers[layer]['gradient']['is_enabled']){this.layers[layer]['gradient']['is_enabled']=false}else{this.layers[layer]['last_fill']=hex}this.layers[layer]['fill']=hex;this.layers[layer].gradient.start=hex;this.layers[layer]['el'].attr('fill',hex);this.afterRender()},removeFill:function(){if(this.layers[this.current_layer]['gradient']['is_enabled']){var current_fill_color=self.$logo_color_fill_input.val();this.layers[this.current_layer]['fill']=current_fill_color;this.layers[this.current_layer]['gradient']['is_enabled']=false;this.layers[this.current_layer]['el'].attr('fill',current_fill_color)}else{this.layers[this.current_layer]['fill']='none';this.layers[this.current_layer]['el'].attr('fill','none');this.layers[this.current_layer]['fill_enabled']=false}this.afterRender()},revealFill:function(layer){this.changeFill(this.layers[layer].last_fill,layer);this.layers[layer].fill_enabled=true},changeStroke:function(hex,layer){this.layers[layer].stroke_enabled=true;this.layers[layer]['stroke']=hex;this.layers[layer]['el'].attr({'stroke':hex,'stroke-width':this.layers[layer]['stroke-width']});this.afterRender()},removeStroke:function(layer){this.layers[layer].stroke_enabled=false;this.layers[layer]['el'].attr('stroke','none');this.afterRender()},getLayerFill:function(layer){var current_fill='';if(this.layers[layer].gradient.is_enabled){current_fill=360-this.layers[layer].gradient.angle+'-'+this.layers[layer].gradient.start+'-'+this.layers[layer].gradient.end}else{current_fill=this.layers[layer].fill}return current_fill},getLayerStroke:function(layer){return this.layers[layer]['stroke']},getLayerStrokeWidth:function(layer){return this.layers[layer]['stroke-width']},changeStyle:function(type){var current_font=this.layers.text.font;var current_style=this.layers.text.style;switch(type){case'bold':if(this.layers.text.is_bold_enabled==false){$('#logo_bold_button').addClass('active');this.layers.text.is_bold_enabled=true;current_style='_bold'}else{if(this.layers.text.is_italic_enabled){current_style='_italic'}else{current_style=''}$('#logo_bold_button').removeClass('active');this.layers.text.is_bold_enabled=false}break;case'italic':if(this.layers.text.is_italic_enabled==false){this.layers.text.is_italic_enabled=true;current_style='_italic';$('#logo_italic_button').addClass('active')}else{if(this.layers.text.is_bold_enabled){current_style='_bold'}else{current_style=''}this.layers.text.is_italic_enabled=false;$('#logo_italic_button').removeClass('active')}break}if(this.layers.text.is_italic_enabled&&this.layers.text.is_bold_enabled){this.layers.text.style='_bold_italic';current_style='_bold_italic'}current_font=this.$font_family.val()+current_style;this.layers.text.style=current_style.replace('_','');this.changeFont(current_font)},loadStyle:function(){var current_font=this.layers.text.font;var current_style=this.layers.text.style;if(this.layers.text.is_bold_enabled==true){$('#logo_bold_button').addClass('active')}else{$('#logo_bold_button').removeClass('active')}if(this.layers.text.is_italic_enabled==true){$('#logo_italic_button').addClass('active')}else{$('#logo_italic_button').removeClass('active')}this.changeFont(current_font)},removeText:function(){this.$logo_text.val('');this.layers.text.el.attr('text','');this.layers.text.caption='';this.afterRender()},move:function(direction){var self=this;if(self.current_layer=='layer_1'||self.layers[self.current_layer].is_hidden){return}var object=this.layers[this.current_layer]['el'];var x=0;var y=0;var step=5;switch(direction){case'up':y-=step;break;case'down':y+=step;break;case'left':x-=step;break;case'right':x+=step;break}object.transform("...T"+x+','+y);self.setTransform(self.current_layer);self.afterRender()},getRandomInt:function(min,max){return Math.floor(Math.random()*(max-min+1))+min},getRandomColor:function(){var number=this.getRandomInt(0,this.rand_colors.length-1);this.random_color_generated=this.rand_colors[number];return this.random_color_generated},showFigures:function(layer){var self=this;$('.icon-wrapper').removeClass('active');self.$layer_icons.html('').show();if(layer=='layer_1'){$('#favicon_categories').hide();self.$layer_icons_wrapper.css({'top':'135px'});$.each(self.icons,function(key,figure){if(figure.is_form){var active='';if(self.layers[layer].current_figure.figure_id==figure.figure_id){active=' active'}var menu_item="<div class='icon-wrapper"+active+"'>";menu_item+='<div class="layer-icon" data-layer="'+layer+'" data-figure="'+figure.figure_id+'">';var $figure=$('<div>').append(figure.svg);$figure=$figure.find('svg').attr({"width":56,"height":56});menu_item+=$figure.parent().html();menu_item+="</div>";menu_item+="</div>";self.$layer_icons.append(menu_item)}})}if(layer=='layer_2'){$('#favicon_categories').show();self.$layer_icons_wrapper.css({'top':'179px'});var bg=self.layers.layer_1.current_figure.form_bg;var b64=btoa(bg);self.appendCategories();$.each(self.icons,function(key,figure){if(10!=self.current_category){return true}if(!figure.is_form&&(figure.parent==self.layers.layer_1.current_figure.figure_id)){var active='';if(self.layers[layer].current_figure.figure_id==figure.figure_id){active=' active'}var menu_item="<div class='icon-wrapper"+active+"'>";menu_item+="<div class=\"icon-figure\" style=\"background:url('data:image/svg+xml;base64,"+b64+"') no-repeat;\">";menu_item+='<div class="layer-icon" data-layer="'+layer+'" data-figure="'+figure.figure_id+'">';var $figure=$('<div>').append(figure.svg);$figure=$figure.find('svg').attr({"width":54,"height":54});menu_item+=$figure.parent().html();menu_item+="</div>";menu_item+="</div>";menu_item+="</div>";self.$layer_icons.append(menu_item)}});$.each(self.icons,function(key,figure){if(figure.category_id!=self.current_category){return true}if(!figure.is_form&&(figure.parent==''||figure.parent==0)){var active='';if(self.layers[layer].current_figure.figure_id==figure.figure_id){active=' active'}var menu_item="<div class='icon-wrapper"+active+"'>";menu_item+="<div class=\"icon-figure\" style=\"background:url('data:image/svg+xml;base64,"+b64+"') no-repeat;\">";menu_item+='<div class="layer-icon" data-layer="'+layer+'" data-figure="'+figure.figure_id+'">';var $figure=$('<div>').append(figure.svg);$figure=$figure.find('svg').attr({"width":54,"height":54});menu_item+=$figure.parent().html();menu_item+="</div>";menu_item+="</div>";menu_item+="</div>";self.$layer_icons.append(menu_item)}})}self.$layer_icons_wrapper.toggle();self.positionIconWrapper()},appendCategories:function(){var self=this;$('#favicon_categories').html('');var wh_size=24;$.each(self.categories,function(key,category){var $tmpi=$(category.icon).get(0);$tmpi.setAttribute('width',wh_size);$tmpi.setAttribute('height',wh_size);var icon=$tmpi.outerHTML;var cat_icon_b64=btoa(icon);$('#favicon_categories').append($('<div>').data('category-id',key).attr({class:'favicon-category-wrapper s3-tooltip small',title:category.name,}).append($("<div>").attr({id:'favicon_category_'+key,class:"icon-category",style:"background:url('data:image/svg+xml;base64,"+cat_icon_b64+"') no-repeat;"}).data('category-id',key)));if(self.current_category==key){$('#favicon_category_'+key).parent().addClass('active')}});$('#favicon_categories').S3ChangeControls()},showCategory:function(category_id){var self=this;var bg=self.layers.layer_1.current_figure.form_bg;var b64=btoa(bg);self.$layer_icons.html('');$('.favicon-category-wrapper').removeClass('active');$('#favicon_category_'+category_id).parent().addClass('active');$.each(self.icons,function(key,figure){if(10!=category_id){return true}if(!figure.is_form&&(figure.parent==self.layers.layer_1.current_figure.figure_id)){var active='';if(self.layers[self.current_layer].current_figure.figure_id==figure.figure_id){active=' active'}var menu_item="<div class='icon-wrapper"+active+"'>";menu_item+="<div class=\"icon-figure\" style=\"background:url('data:image/svg+xml;base64,"+b64+"') no-repeat;\">";menu_item+='<div class="layer-icon" data-layer="'+self.current_layer+'" data-figure="'+figure.figure_id+'">';var $figure=$('<div>').append(figure.svg);$figure=$figure.find('svg').attr({"width":54,"height":54});menu_item+=$figure.parent().html();menu_item+="</div>";menu_item+="</div>";menu_item+="</div>";self.$layer_icons.append(menu_item)}});$.each(self.icons,function(key,figure){if(figure.category_id!=category_id){return true}if(!figure.is_form&&(figure.parent==''||figure.parent==0)){var active='';if(self.layers[self.current_layer].current_figure.figure_id==figure.figure_id){active=' active'}var menu_item="<div class='icon-wrapper"+active+"'>";menu_item+="<div class=\"icon-figure\" style=\"background:url('data:image/svg+xml;base64,"+b64+"') no-repeat;\">";menu_item+='<div class="layer-icon" data-layer="'+self.current_layer+'" data-figure="'+figure.figure_id+'">';var $figure=$('<div>').append(figure.svg);$figure=$figure.find('svg').attr({"width":54,"height":54});menu_item+=$figure.parent().html();menu_item+="</div>";menu_item+="</div>";menu_item+="</div>";self.$layer_icons.append(menu_item)}})},positionIconWrapper:function(){var self=this;var mp=$('#favicon_generator_content').position();if(mp===undefined){mp={top:0}}var $wrp=self.$layer_icons_wrapper;var wh=$(window).height();var ww=$(window).width();var iw_left=$wrp.offset().left;var iw_top=$wrp.position().top+mp.top;var iw_height=$wrp.height();var iw_width=$wrp.width();var nw=ww-iw_left*2;if(nw>520){$wrp.css('width',nw+'px')}var default_top=$wrp.data('top')-63;var nh=iw_height+iw_top;if(nh>wh){var needed_top=(wh-iw_height)/2-100;$wrp.css('top',needed_top+'px')}if((iw_height+default_top)<wh){$wrp.css('top',default_top+'px')}},rotate:function(angle){this.layers[this.current_layer].el.transform('...R'+angle);this.setTransform(this.current_layer);this.afterRender()},scale:function(amount){this.layers[this.current_layer].el.transform('...S'+amount);this.setTransform(this.current_layer);this.afterRender()},flip:function(direction){var self=this;var obj=self.layers[self.current_layer].el;var ct=self.getTransforms(obj);var layer=self.current_layer;if(ct[0]!==undefined){var m=ct[0].matrix;m="m1,0,0,-1,"+m.e+","+160;obj.transform(m)}else{$.when(this.measureText()).done(function(res){var height=res.height,width=res.width;obj.transform("m1,0,0,-1,"+ct.dx+","+ct.dy);self.setTransform(layer);self.afterRender()})}self.setTransform(self.current_layer);self.afterRender()},setTransform:function(layer){var t=this.layers[layer].el.transform();if(typeof t=='object'){t=this.logo.getTransformString(this.layers[layer].el)}this.layers[layer].transform.val=t},applyTransform:function(layer){if(this.layers[layer].transform!==undefined&&this.layers[layer].transform.val!==undefined){this.layers[layer].el.transform(this.layers[layer].transform.val)}else{this.layers[layer].el.attr('transform','')}if(layer=='text'&&this.layers.text['fix-text-pos']!==undefined){var text_x=this.layers.text.pos.x,text_y=this.layers.text.pos.y;if(text_x&&text_y){var bbox=this.layers.text.el.getBBox(1);var mid_width=bbox.width/2;var fixed_x=mid_width+text_x;this.layers.text.el.transform('t'+fixed_x+','+text_y);this.layers.text.transform.val=this.layers.text.el.transform();this.layers.text['fix-text-pos']=undefined}}},afterRender:function(){if(this.layers.layer_1.el!==undefined){this.layers.layer_1.el.toBack()}var main_svg=$('#main_svg');var $svg=main_svg.clone();$svg.attr('id','swg_wrap_16').css({'width':'16px','height':'16px'});$svg.find('text').css('cursor','default');$('#logo_16').html($svg);var $svg_1=main_svg.clone();$svg_1.attr('id','swg_wrap_28').css({'width':'28px','height':'28px'});$svg_1.find('text').css('cursor','default');$('#favicon_preview_smartphone').html($svg_1);var $svg_2=main_svg.clone();$svg_2.attr('id','swg_wrap_22').css({'width':'22px','height':'22px'});$svg_2.find('text').css('cursor','default');$('#favicon_preview_cp_desktop').html($svg_2);var $svg_3=main_svg.clone();$svg_3.attr('id','swg_wrap_54').css({'width':'54px','height':'54px'});$svg_3.find('text').css('cursor','default');$('#favicon_start_screen_grid').html($svg_3)},createNew:function(){s3.confirm("Создать новый фавикон?<br/> Несохраненные изменения пропадут.",function(){popupController.closeLastPopup();s3.reloadVisibleContent('/-/cms/v1/logo/?act=index&'+access)},null)},offEvents:function(){$(document).off('.favicon')},checkAllHidden:function(){var self=this;var all_hidden=true;$.each(self.layers,function(key,layer){if(layer!==undefined&&layer.is_hidden==false){all_hidden=false;return false}});return all_hidden},generateFavicon:function(){var self=this;self.applyRandomColorSet();var figure_index=self.getRandomInt(1,3);if(figure_index==1||figure_index==2){self.layers.text.size=240}else{self.layers.text.size=220}var demo_figure='001';figure_index='00'+figure_index;$.each(this.icons,function(key,figure){if(figure.is_form&&figure.figure_id==figure_index){demo_figure=figure;return false}});figure_index=figure_index+'-001';self.loadFigureLayer('layer_1',demo_figure,false,false);$.each(this.icons,function(key,figure){if(figure.figure_id==figure_index){demo_figure=figure;return false}});self.loadFigureLayer('layer_2',demo_figure,true,false);self.$logo_text.val(self.layers.text.caption);var font_family_options=self.$font_family.find('option');var random_font_index=self.getRandomInt(0,font_family_options.length-1);if(random_font_index==5){random_font_index=0}self.layers.text.font=$(font_family_options[random_font_index]).val();var demo_text={is_regular:true,is_bold_enabled:false,is_italic_enabled:false};var text_font_style='';var text_style_rand=self.getRandomInt(0,1);if(text_style_rand){text_font_style='_bold';demo_text.is_regular=false;demo_text.is_bold_enabled=true;demo_text.is_italic_enabled=false}self.loadTextLayer('text',self.layers.text.size,self.layers.text.font,text_font_style,demo_text.is_regular,demo_text.is_bold_enabled,demo_text.is_italic_enabled,self.layers.text.pos,self.layers.text.caption,self.layers.text.is_hidden,true);self.layers.text.el.attr('opacity',0);self.changeStyle();window.setTimeout(function(){this.centerElement('text');$('#favicon_save_button').data('disabled',false).removeClass('disabled')}.bind(self),100)},updateFontSizeInput:function(){var self=this;var timeout=window.setTimeout(function(){self.$font_family.trigger("liszt:updated")},300)}});$.fn[pluginName]=function(options){var self=this;var plugin=this.data(dataKey);if(plugin instanceof Plugin){if(typeof options!=='undefined'){plugin.init(options)}}else{plugin=new Plugin(this,options);self.data(dataKey,plugin)}return plugin}})(jQuery,window,document);(function($,window,document,undefined){"use strict";var pluginName="logotizer",defaults={logo:"generator",width:873,height:624},dataKey="plugin_"+pluginName;function Plugin(element,options){this.element=element;this.settings=$.extend({},defaults,options);this.max_layers=15;this._defaults=defaults;this.logo_id=0;this.example_id=0;this.example_editing=false;this.middle_x=0;this.middle_y=0;this._name=pluginName;this.logo=undefined;this.import_svg=undefined;this.current_layer=1;this.rand_colors=['#ffbf00','#6E95D4','#62dec9','#b3a983','#b383b1','#f088ab','#31c292','#8b8c8f'];this.random_color_generated='';this.getRandomColor();this.shadow=[2,3,3,0.5];this.is_paid=0;this.free_transform=undefined;this.type_shape='shape';this.type_figure='figure';this.type_line='line';this.type_text='text';this.defaults={"layer_1":{type:this.type_shape,el:undefined,fill:this.random_color_generated,'fill_enabled':true,'shadow_enabled':false,'stroke_enabled':false,'fill_type':'color','last_fill':this.random_color_generated,stroke:'#000000','stroke-width':10,'is_hidden':false,gradient:{is_enabled:false,start:this.random_color_generated,end:'#000000',angle:90,start_percent:0,end_percent:100},'current_figure':'001',transform:{'val':'t0,10'},draggable:false},"figure":{type:this.type_figure,el:undefined,fill:'#ffffff','fill_enabled':true,'shadow_enabled':false,'stroke_enabled':false,'fill_type':'color','last_fill':'#ffffff',stroke:'#000000','stroke-width':2,'is_hidden':false,gradient:{is_enabled:false,start:'#ffffff',end:'#000000',angle:90,start_percent:10,end_percent:80},current_figure:'001-010',transform:{'val':''},draggable:true},"text":{type:this.type_text,el:undefined,size:48,min_size:140,max_size:300,fill:'#333','fill_enabled':true,'shadow_enabled':false,'stroke_enabled':false,'fill_type':'color','last_fill':'#333','stroke':'#000000','stroke-width':2,'is_hidden':false,'font':'adonis','caption':'Ваша компания','style':'','text-anchor':'middle','is_regular':false,'is_italic_enabled':false,'is_bold_enabled':false,'pos':{x:91,y:229},gradient:{is_enabled:false,start:'#ffffff',end:'#000000',angle:90,start_percent:44,end_percent:91},transform:{'val':''},draggable:true}};this.layers=[];this.current_category=5;this.figures_width=160;this.history=[];this.history_key=0;this.categories=this.settings.categories;this.icons=[];this.sel={"start":{"x":0,"y":0},"end":{"x":0,"y":0},"el":undefined};this.sel_group=undefined;this.sel_box=undefined;this.selected_layers=[];this.ver='';this.color_sets={0:{0:{fill:'#FFCED2'},1:{fill:'#F9BCD1'},2:{fill:'#E2BFE8'},3:{fill:'#D1C5EA'},4:{fill:'#C4CBEA'},5:{fill:'#B9DEFC'},6:{fill:'#B1E5FD'},7:{fill:'#B0EBF2'},8:{fill:'#B0DFDB'},9:{fill:'#C7E5C8'},10:{fill:'#DCECC6'},11:{fill:'#F0F3C1'},12:{fill:'#FFF8C1'},13:{fill:'#FFEBB0'},14:{fill:'#FFE0B0'},15:{fill:'#FFCCBB'},16:{fill:'#D7CCC8'},17:{fill:'#EEEEEE'},18:{fill:'#CFD8DC'},19:{gradient:{start:'#FFCED2',end:'#E2BFE8'}},20:{gradient:{start:'#D1C5EA',end:'#B9DEFC'}},21:{gradient:{start:'#B0EBF2',end:'#DCECC6'}},22:{gradient:{start:'#F0F3C1',end:'#FFE0B0'}},23:{gradient:{start:'#FFEBB0',end:'#FFCCBB'}},24:{gradient:{start:'#FFD2C2',end:'#FFE0E0'}},25:{gradient:{start:'#FDE6DD',end:'#CFD8DC'}},26:{gradient:{start:'#8CD1FF',end:'#FFBBE8'}},27:{gradient:{start:'#8DD4FF',end:'#FFEEB2'}},28:{gradient:{start:'#C8D3FF',end:'#FFDEE8'}},29:{gradient:{start:'#FFF1BC',end:'#EBC5FF'}},30:{gradient:{start:'#D7FFCA',end:'#FF8F8F'}},31:{gradient:{start:'#8E84EB',end:'#D9FF96'}}},1:{0:{gradient:{start:'#FFCED2',end:'#78272E'}},1:{gradient:{start:'#F9BCD1',end:'#700A2D'}},2:{gradient:{start:'#E2BFE8',end:'#581164'}},3:{gradient:{start:'#D1C5EA',end:'#371F67'}},4:{gradient:{start:'#C4CBEA',end:'#2D3B79'}},5:{gradient:{start:'#B9DEFC',end:'#013660'}},6:{gradient:{start:'#B1E5FD',end:'#00507B'}},7:{gradient:{start:'#B0EBF2',end:'#00555D'}},8:{gradient:{start:'#B0DFDB',end:'#005E53'}},9:{gradient:{start:'#C7E5C8',end:'#095C0A'}},10:{gradient:{start:'#DCECC6',end:'#2B5202'}},11:{gradient:{start:'#F0F3C1',end:'#585900'}},12:{gradient:{start:'#FFF8C1',end:'#A27700'}},13:{gradient:{start:'#FFEBB0',end:'#AE6D00'}},14:{gradient:{start:'#FFE0B0',end:'#B15900'}},15:{gradient:{start:'#FFCCBB',end:'#B02D00'}},16:{gradient:{start:'#D7CCC8',end:'#502316'}},17:{gradient:{start:'#EEEEEE',end:'#4A4A4A'}},18:{gradient:{start:'#CFD8DC',end:'#152E3B'}},19:{gradient:{start:'#FFCED2',end:'#74004E'}},20:{gradient:{start:'#D1C5EA',end:'#002C83'}},21:{gradient:{start:'#B0EBF2',end:'#005667'}},22:{gradient:{start:'#0A4B04',end:'#F1F6A0'}},23:{gradient:{start:'#FFEBB0',end:'#762800'}},24:{gradient:{start:'#FFD2C2',end:'#B31700'}},25:{gradient:{start:'#FDE6DD',end:'#170073'}},26:{gradient:{start:'#8CD1FF',end:'#6A0047'}},27:{gradient:{start:'#004C7A',end:'#FFEEB2'}},28:{gradient:{start:'#00156A',end:'#FFDEE8'}},29:{gradient:{start:'#FFF1BC',end:'#3E005F'}},30:{gradient:{start:'#165A00',end:'#FF8F8F'}},31:{gradient:{start:'#06003B',end:'#D9FF96'}}},2:{0:{fill:'#F44336'},1:{fill:'#EC2965'},2:{fill:'#9D31B3'},3:{fill:'#6740BA'},4:{fill:'#3C54B8'},5:{fill:'#0298F6'},6:{fill:'#00AAF6'},7:{fill:'#00BCD5'},8:{fill:'#009587'},9:{fill:'#48AD49'},10:{fill:'#8AC13F'},11:{fill:'#CEDA20'},12:{fill:'#FFE91E'},13:{fill:'#FFC000'},14:{fill:'#FF9800'},15:{fill:'#FF5A20'},16:{fill:'#7A5547'},17:{fill:'#9E9E9E'},18:{fill:'#5F7D8C'},19:{gradient:{start:'#FF3B2C',end:'#9D31B3'}},20:{gradient:{start:'#6740BA',end:'#0298F6'}},21:{gradient:{start:'#00AAF6',end:'#009587'}},22:{gradient:{start:'#48AD49',end:'#CEDA20'}},23:{gradient:{start:'#FFE91E',end:'#FF9800'}},24:{gradient:{start:'#FF5A20',end:'#7A5547'}},25:{gradient:{start:'#5F7D8C',end:'#FFB7B7'}},26:{gradient:{start:'#009AFF',end:'#DB36A4'}},27:{gradient:{start:'#2191D4',end:'#FFCE24'}},28:{gradient:{start:'#204AF5',end:'#FFB0C8'}},29:{gradient:{start:'#FFDB58',end:'#9125CA'}},30:{gradient:{start:'#78CA5D',end:'#FF4646'}},31:{gradient:{start:'#2B15FF',end:'#B4EC51'}}},3:{0:{fill:'#FFCED2','text_fill':'#D63330'},1:{fill:'#F9BCD1','text_fill':'#C4215D'},2:{fill:'#E2BFE8','text_fill':'#7C29A5'},3:{fill:'#D1C5EA','text_fill':'#5033AB'},4:{fill:'#C4CBEA','text_fill':'#2D42A1'},5:{fill:'#B9DEFC','text_fill':'#0178D5'},6:{fill:'#B1E5FD','text_fill':'#0089D3'},7:{fill:'#B0EBF2','text_fill':'#0097A7'},8:{fill:'#B0DFDB','text_fill':'#00786A'},9:{fill:'#C7E5C8','text_fill':'#348D35'},10:{fill:'#DCECC6','text_fill':'#679D2E'},11:{fill:'#F0F3C1','text_fill':'#B0B214'},12:{fill:'#FFF8C1','text_fill':'#FDBF14'},13:{fill:'#FFEBB0','text_fill':'#FFA000'},14:{fill:'#FFE0B0','text_fill':'#F87D00'},15:{fill:'#FFCCBB','text_fill':'#E94D17'},16:{fill:'#D7CCC8','text_fill':'#5E4037'},17:{fill:'#EEEEEE','text_fill':'#616161'},18:{fill:'#CFD8DC','text_fill':'#455A64'},19:{gradient:{start:'#FFCED2',end:'#E2BFE8'},'text_fill':'#B8348D'},20:{gradient:{start:'#D1C5EA',end:'#B9DEFC'},'text_fill':'#4B77CE'},21:{gradient:{start:'#B0EBF2',end:'#DCECC6'},'text_fill':'#42B2C8'},22:{gradient:{start:'#ACE9AE',end:'#F1F6A0'},'text_fill':'#5DA956'},23:{gradient:{start:'#FFEBB0',end:'#FFCCBB'},'text_fill':'#C68666'},24:{gradient:{start:'#FFD2C2',end:'#FFE0E0'},'text_fill':'#C07469'},25:{gradient:{start:'#FDE6DD',end:'#CFD8DC'},'text_fill':'#8A84A2'},26:{gradient:{start:'#8CD1FF',end:'#FFBBE8'},'text_fill':'#7464CE'},27:{gradient:{start:'#8DD4FF',end:'#FFEEB2'},'text_fill':'#439092'},28:{gradient:{start:'#C8D3FF',end:'#FFDEE8'},'text_fill':'#7A73E2'},29:{gradient:{start:'#FFF1BC',end:'#EBC5FF'},'text_fill':'#BA699F'},30:{gradient:{start:'#D7FFCA',end:'#FF8F8F'},'text_fill':'#D67269'},31:{gradient:{start:'#8E84EB',end:'#D9FF96'},'text_fill':'#6269A1'}}};this.ps_timeout=undefined;this.$logo_color_fill=undefined;this.$logo_color_fill_input=undefined;this.$layer_1=undefined;this.$layer_2=undefined;this.$logo_gradient_start=undefined;this.$logo_gradient_end=undefined;this.$logo_gradient_start_input=undefined;this.$logo_gradient_end_input=undefined;this.$logo_stroke_color=undefined;this.$logo_stroke_color_input=undefined;this.$toggle_gradient=undefined;this.$font_family=undefined;this.$eff_fill=undefined;this.$toggle_fill=undefined;this.$toggle_shadow=undefined;this.$toggle_stroke=undefined;this.$layer_icons=undefined;this.$layer_icons_wrapper=undefined;this.$gradient_angle_toggle=undefined;this.$eff_gradient=undefined;this.$eff_drop_shadow=undefined;this.$logo_text=undefined;this.loadScriptsThenInit()}$.extend(Plugin.prototype,{loadScriptsThenInit:function(){var self=this;self.ver=self.getRandomInt(0,100)+'_'+self.getRandomInt(0,9999);$.require.clear('js');$.require('/my/s3/js/logotizer/raphael2.2.0.js').done(function(){$.require({files:['/my/s3/js/logotizer/raphael-svg-import.js','/my/s3/js/opentype.min.js','/shared/s3/js/mustache.min.js'],async:true}).done(function(){self.init()})})},extendRaphael:function(){Raphael.fn.getTransformString=function(el){var bottom=false;var transformString='';do{if(el.type=='set'){el=el[0]}else{transformString=el.matrix;bottom=true}}while(!bottom);return transformString.toTransformString()};Raphael.fn.print_center=function(x,y,string,font,size,letter_spacing){size=parseInt(size);var path=this.print(x,y,string,font,size,'baseline',letter_spacing);var bb=path.getBBox();var dx=(x-bb.x)/2;var dy=(y-bb.y)/2;return path.transform("t"+dx+","+dy)};Raphael.el.is=function(type){return this.type==(''+type).toLowerCase()};Raphael.el.x=function(){return this.is('circle')?this.attr('cx'):this.attr('x')};Raphael.el.y=function(){return this.is('circle')?this.attr('cy'):this.attr('y')};Raphael.el.o=function(){this.ox=this.x();this.oy=this.y();return this};Raphael.el.draggable=function(){var canMove=function(){return logotizer.sel.el===undefined};var start=function(){if(!canMove()){return}this.ox=0;this.oy=0;this.canvas_width=this.paper.width;this.canvas_height=this.paper.height;this.bbb={};$.extend(this.bbb,this.data('el').getBBox())},move=function(dx,dy){if(!canMove()){return}var layer=this.data('layer');var x=dx-this.ox,y=dy-this.oy;if((this.bbb.x+dx<0&&dx<0)||(this.bbb.x2+dx>this.canvas_width&&dx>0)){x=0}if((this.bbb.y+dy<0&&dy<0)||(this.bbb.y2+dy>this.canvas_height&&dy>0)){y=0}this.data('el').transform("...T"+x+","+y);logotizer.setTransform(layer);if(x!=0){this.ox=dx}if(y!=0){this.oy=dy}},end=function(){if(!canMove()){return}};this.drag(move,start,end);this.data('el',this);return this};Raphael.st.draggable=function(){var canMove=function(){return logotizer.sel.el===undefined};var start=function(){if(!canMove()){return}this.ox=0;this.oy=0;this.canvas_width=this.paper.width;this.canvas_height=this.paper.height;this.bbb={};$.extend(this.bbb,this.data('set').getBBox())},move=function(dx,dy){if(!canMove()){return}var layer=this.data('layer');var x=dx-this.ox,y=dy-this.oy;if((this.bbb.x+dx<0&&dx<0)||(this.bbb.x2+dx>this.canvas_width&&dx>0)){x=0}if((this.bbb.y+dy<0&&dy<0)||(this.bbb.y2+dy>this.canvas_height&&dy>0)){y=0}this.data('set').transform("...T"+x+","+y);if(layer!==undefined){logotizer.setTransform(layer)}if(x!=0){this.ox=dx}if(y!=0){this.oy=dy}},end=function(){if(!canMove()){return}};this.drag(move,start,end);this.data('set',this);if(logotizer.sel_group!==undefined){this.data('set',logotizer.sel_group)}this.data('draggable_initialized',true)}},init:function(){$(document).data('logotizer_fonts_loaded',true);var self=this;self.extendRaphael();self.extendRaphael=$.noop;self.middle_x=Math.ceil(this.settings.width/2);self.middle_y=Math.ceil(this.settings.height/2);self.addLayer(self.type_figure,true);self.addLayer(self.type_text,true);self.$logo_color_fill=$('#logo_color_fill');self.$logo_color_fill_input=$('#logo_color_fill_input');self.$layer_1=$('#layer_0');self.$text=$('#layer_1');self.$logo_gradient_start=$('#logo_gradient_start');self.$logo_gradient_start_input=$('#logo_gradient_start_input');self.$logo_gradient_end=$('#logo_gradient_end');self.$logo_gradient_end_input=$('#logo_gradient_end_input');self.$logo_stroke_color=$('#logo_stroke_color');self.$logo_stroke_color_input=$('#logo_stroke_color_input');self.$font_family=$('#font_family');self.$eff_fill=$('.eff-fill');self.$toggle_fill=$('#toggle_fill');self.$toggle_shadow=$('#toggle_shadow');self.$toggle_stroke=$('#toggle_stroke');self.$layer_icons=$('#layer_icons');self.$layer_icons_wrapper=$('#layer_icons_wrapper');self.$gradient_angle_toggle=$('#gradient_angle_toggle');self.$eff_gradient=$('.eff-gradient');self.$eff_drop_shadow=$('#effect_drop_shadow');self.$logo_text=$('#layer_1 .logo_text');self.initPlugins();self.initPlugins=$.noop;var canvas_el=$(this.element).attr('id');if(self.logo===undefined){$('.logo-generator-canvas').css({'height':this.settings.height,'width':this.settings.width});$('.logo-generator-body, #logotizer_effects').css('height',this.settings.height);self.logo=Raphael(canvas_el,this.settings.width,this.settings.height);self.logo.setViewBox(0,0,this.settings.width,this.settings.height,true);self.logo.canvas.setAttribute('id','main_svg')}self.applyRandomColorSetOnInit();$.getJSON('/my/s3/js/logotizer/figures.min.json?ver='+self.ver).done(function(data){self.icons=data;self.bindEvents();self.loadDemoLogo();$('#favicon_save_button').data('disabled',false).removeClass('disabled');$('#btn_create_new_logo').data('disabled',false).removeClass('disabled');self.orderLayers();self.afterRender()}).error(function(jqXHR,textStatus,errorThrown){console.warn("Error loading figures:",textStatus,errorThrown)})},bindEvents:function(){var self=this;$(document).off('.logotizer');$(document).off('.logotizer');$('#logotizer_generator_content').on('paste.logotizer, keyup.logotizer, input.logotizer','.logo_text',function(e){var logoText=$(this).val();self.current_layer=parseInt($(this).data('layer'));self.changeText(self.current_layer,logoText);self.saveHistoryState()});$('#logotizer_generator_content').on('change.logotizer','#fill_type',function(){var fill_type=$(this).val();self.setFillType(fill_type,self.current_layer,true);self.afterRender();self.saveHistoryState()});$('#logotizer_generator_content').on('change.logotizer','.font_family',function(){var font=$(this).val(),layer=parseInt($(this).data('layer'));if(self.layers[layer].is_bold_enabled){font+='_bold'}if(self.layers[layer].is_italic_enabled){font+='_italic'}self.changeFont(layer,font);self.saveHistoryState()});var logotizerKeys=function(event){var target=event.target;var ctrl=event.ctrlKey;var step=1;if(ctrl){step=5}if($('.s3-input-text').is(':focus')){return}switch(event.which){case 40:case 38:if($('.chzn-container-active').css('display')=="inline-block"){var sel=$('.chzn-container-active');var prev=sel.prev();if(prev.hasClass('font_family')){prev.data('chosen').result_select(event);prev.data('chosen').results_show()}return}break}switch(event.which){case 27:if(self.sel_group!==undefined){self.removeSelGroup()}if(self.$layer_icons_wrapper.css('display')=="block"){self.$layer_icons_wrapper.hide()}break;case 39:event.preventDefault();self.move('right',step);break;case 37:event.preventDefault();self.move('left',step);break;case 40:event.preventDefault();self.move('down',step);break;case 38:event.preventDefault();self.move('up',step);break;case 46:if(self.current_layer!=-1){event.preventDefault();self.removeLayer(self.current_layer)}if(self.selected_layers.length>1){event.preventDefault();self.removeLayers()}break;case 86:if($(target).is('input:text')){break}if(ctrl&&self.current_layer>=0){self.copyLayer(self.current_layer)}break}return};$(document).off('keydown.logotizer');$(document).on('keydown.logotizer',function(event){logotizerKeys(event)});$('.control-layer.active .layer-panel').slideDown();if($('#logotizer_layers').hasClass('.ui-sortable')){$('#logotizer_layers').sortable("refresh")}else{var userAgent=navigator.userAgent.toLowerCase();$('#logotizer_layers').sortable({tolerance:"pointer",handle:".handle",placeholder:"layer-placeholder",update:function(){self.updateSortableItems()},start:function(event,ui){},stop:function(event,ui){ui.item.css('height','auto')}})}$(document).on('click.logotizer',function(e){var $target=$(e.target);if($target.hasClass('btn-add-text-layer')||$target.hasClass('icon-add-text-layer')){self.addLayer('text',false,true);return}if($target.hasClass('btn-lgtzr-add-example')){self.exampleForm();return}if($target.attr('id')=='close_figures'){self.$layer_icons_wrapper.hide();return}if($target.hasClass('save-example-btn')){self.example_id=0;self.saveLogo(false,true);return}if($target.hasClass('remove-layer')||$target.hasClass('icon-layer-delete')){var l=parseInt($target.data('layer'));self.removeLayer(l);self.saveHistoryState();return}if($target.closest('.layer-icon').get(0)){self.onFigureClick($target.closest('.layer-icon'));self.saveHistoryState();return}if($target.closest('.icon-wrapper').get(0)){self.onFigureClick($target.find('.layer-icon'));return}if($target.closest('.favicon-category-wrapper').get(0)){var category_id=$target.data('category-id');var layer=$target.data('layer');self.showCategory(layer,category_id);return}if($target.closest('#layer_icons_wrapper').get(0)){return false}if($target.closest('#add-figure-layer-menu-item').get(0)){$target.find('.no-close').removeClass('context-button-active');return false}if($target.closest('.btn-add-figure-layer').get(0)){self.addFigureLayerAndChooseFigure();return false}if($target.hasClass('control-move')){var direction=$target.data('direction');self.move(direction);return false}if($target.parent('.control-move').get(0)){var direction=$target.parent('.control-move').data('direction');self.move(direction);return false}if($target.closest('#layer_icons').get(0)){return false}if($target.closest('.icon-layer-visible').get(0)||$target.closest('.icon-layer-hidden').get(0)||$target.closest('.toggle-layer').get(0)){var l_id=parseInt($target.data('layer'));self.toggleLayer(l_id)}if($target.closest('.copy-layer').get(0)||$target.closest('.icon-layer-copy').get(0)){self.copyLayer(parseInt($target.data('layer')));return false}if($target.closest('.choose-figure').get(0)){var layer=parseInt($target.data('layer'));var offset=$target.offset();var main_offset=$('.logotizer').offset();self.showFigures(layer,50,offset.top-main_offset.top);return false}if($target.parents('.figure').get(0)){var layer=parseInt($target.parents('.figure').data('layer'));var offset=$target.parents('.figure').offset();var main_offset=$('.logotizer').offset();self.showFigures(layer,50,offset.top-main_offset.top);return false}if($target.closest('#gradient_angle_toggle').get(0)){return false}if($target.closest('#gradient_angle_toggle_button').get(0)){self.$gradient_angle_toggle.toggle();return false}self.$gradient_angle_toggle.hide();if($target.closest('.layer-panel-header').get(0)){var lr=parseInt($target.closest('.control-layer').data('layer'));self.activateLayer(lr)}self.$layer_icons_wrapper.hide()});$(document).on('change.logotizer','#toggle_fill',function(){var is_enabled=$(this).prop('checked');if(is_enabled){self.revealFill(self.current_layer)}else{self.removeFill()}self.saveHistoryState()});$(document).on('change.logotizer','#toggle_stroke',function(){var is_enabled=$(this).prop('checked');if(is_enabled){self.$logo_stroke_color.show();self.changeStroke(self.layers[self.current_layer].stroke,self.current_layer,self.current_layer)}else{self.removeStroke(self.current_layer);self.$logo_stroke_color.hide()}self.saveHistoryState()});$(self.logo.canvas).on('mousedown.logotizer',function(e){e.preventDefault();if(e.target.nodeName=='svg'){$('*').spectrum('hide');self.removeSelGroup();var x=e.offsetX;var y=e.offsetY;self.sel.start.x=x;self.sel.start.y=y;self.sel.el=self.logo.rect(x,y,0,0);self.sel.canvas_offset=$('#main_svg').offset()}});$(document).on('mouseup.logotizer',function(e){if(self.sel.el!==undefined){var isRectsIntersect=function(r1,r2){if(r1.x<r2.x+r2.width&&r2.x<r1.x+r1.width&&r1.y<r2.y+r2.height)return r2.y<r1.y+r1.height;else return false};var sel_bb=self.sel.el.getBBox();var i=0;self.selected_layers=[];$.each(self.layers,function(key,l){if(l!==undefined){var l_bb=l.el.getBBox();if(isRectsIntersect(l_bb,sel_bb)){self.selected_layers[i]=key;i++}}});if(self.selected_layers.length===1){self.activateLayer(self.selected_layers[0])}if(self.selected_layers.length>1){$('.control-layer').removeClass('active');self.sel_group=self.logo.set();$.each(self.selected_layers,function(si,sv){self.layers[sv].el.undrag();self.layers[sv].el.unmousedown();self.sel_group.push(self.layers[sv].el);$('#layer_'+sv).addClass('active')});self.current_layer=-1;self.disableEffects();var sg_bbox=self.sel_group.getBBox();self.sel_box=self.logo.set();var move_icon=self.logo.path('M3.5 0l-1.5 1.5h1v1.5h-1.5v-1l-1.5 1.5 1.5 1.5v-1h1.5v1.5h-1l1.5 1.5 1.5-1.5h-1v-1.5h1.5v1l1.5-1.5-1.5-1.5v1h-1.5v-1.5h1l-1.5-1.5z');var move_rect=self.logo.rect(sg_bbox.x-10,sg_bbox.y-10,sg_bbox.width+20,sg_bbox.height+20);move_rect.attr({"fill":"#ffffff","cursor":"move","stroke-width":3,"stroke":"#cfd8dc"});move_icon.attr({"fill":"#cfd8dc","stroke":"none","cursor":"move"});var mvx=parseInt(sg_bbox.x+sg_bbox.width)+20;var mvy=parseInt(sg_bbox.y)-20;move_icon.transform('t'+mvx+','+mvy+'s3');move_rect.toBack();move_icon.toFront();self.sel_box.data('sel_box',true);self.sel_box.push(move_icon,move_rect);self.sel_group.push(self.sel_box);self.sel_group.draggable({margin:10});sg_bbox=undefined;move_icon=undefined;move_rect=undefined;mvx=undefined;mvy=undefined}self.sel.el.remove();self.sel.el=undefined}});$(self.logo.canvas).on('mousemove.logotizer',function(e){if(self.sel.el!==undefined){var px=e.pageX;var py=e.pageY;var ox=px-self.sel.canvas_offset.left;var oy=py-self.sel.canvas_offset.top;var w=ox-self.sel.start.x;var h=oy-self.sel.start.y;var x=self.sel.start.x;var y=self.sel.start.y;if(ox<self.sel.start.x){x=ox;w=self.sel.start.x-ox}if(oy<self.sel.start.y){y=oy;h=self.sel.start.y-oy}self.sel.el.attr({"x":x,"y":y,"width":w,"height":h,"opacity":0.3,"stroke":'blue'})}})},loadDemoLogo:function(){var self=this;var free_icons=[];$.each(self.icons,function(key,figure){if(figure.parent==""||(figure.parent==figure.figure_id)){free_icons.push(figure)}});var last_key=free_icons.length-1;var r=self.getRandomInt(0,last_key);var demo_figure='';$.each(free_icons,function(key,figure){if(key==r){demo_figure=figure;return false}});self.loadFigureLayer(0,demo_figure,false,false);self.centerElement(0,true,true);$('.logo_text').val(self.defaults.text.caption);var font_family_options=$('.font_family').find('option');var random_font_index=self.getRandomInt(0,font_family_options.length-1);if(random_font_index==7){random_font_index=0}self.layers[1].font=$(font_family_options[random_font_index]).val();var demo_text={is_regular:true,is_bold_enabled:false,is_italic_enabled:false};var text_font_style='';var text_style_rand=self.getRandomInt(0,1);if(text_style_rand){text_font_style='_bold';demo_text.is_regular=false;demo_text.is_bold_enabled=true;demo_text.is_italic_enabled=false}self.loadTextLayer(1,self.defaults.text.size,self.layers[1].font,text_font_style,demo_text.is_regular,demo_text.is_bold_enabled,demo_text.is_italic_enabled,self.defaults.text.pos,self.defaults.text.caption,self.defaults.text.is_hidden,true);self.layers[1].el.attr('opacity',0);$('#effects').appendTo('.effects').show();self.changeStyle(1);self.activateLayer(1);self.centerElement(1,undefined,true);$('#logotizer_layers').S3ChangeControls()},placeSVG:function(url,layer){var self=this;return $.ajax({type:"GET",url:url,dataType:"xml",success:function(svgXML){var temp=$(svgXML);var viewBox=temp.find('svg').attr('viewBox');viewBox=viewBox.split(' ');self.import_svg=undefined;$('#imported_svg_'+layer).remove();if(self.import_svg==undefined){self.import_svg=Raphael(document.getElementById("main_svg"),self.settings.width,self.settings.height);self.import_svg.setViewBox(viewBox[0],viewBox[1],viewBox[2],viewBox[3],true);self.import_svg.canvas.setAttribute('id','imported_svg_'+layer)}self.layers[layer]['el']=self.import_svg.set();self.import_svg.importSVG2(svgXML);self.layers[layer]['el'].push(self.import_svg);self.layers[layer]['el'].attr({"fill":self.getLayerFill(layer)});self.layers[layer]['el'].data('layer',layer);if(self.layers[layer].is_hidden){self.layers[layer]['el'].hide()}if(layer=='layer_2'){$('#imported_svg_layer_1').insertBefore('#imported_svg_layer_2')}}})},placeSvgPlain:function(svg,layer){var self=this;var $svg=$(svg).appendTo($('<div>'));if(self.layers[layer].el!==undefined){$.each(self.layers[layer].el,function(key){if(self.layers[layer].el[key]!==undefined){self.layers[layer].el[key].remove()}})}self.layers[layer].el=self.logo.set();self.logo.importSVG2(svg,self.layers[layer].el);self.layers[layer].el.attr({"fill":self.getLayerFill(layer)});self.layers[layer].el.data('layer',layer);self.layers[layer].el.attr('opacity',0);if(self.layers[layer].is_hidden){self.layers[layer].el.hide()}self.layers[layer].el.mousedown(function(e){self.activateLayer(this.data('layer'))})},orderLayers:function(){var self=this;var layers_count=self.layers.length-1;var animation=Raphael.animation({"opacity":1},300);var max_pos=0;$.each(self.layers,function(key,val){if(val!==undefined&&val.pos>max_pos){max_pos=val.pos}});for(var pos=max_pos;pos>=0;pos--){var i=0;var anim=0;var prev_el=undefined;$.each(self.layers,function(key){if(self.layers[key]!==undefined&&self.layers[key].pos!==undefined&&self.layers[key].pos==pos){if(self.layers[key].el!==undefined){self.layers[key].el.toFront();if(i==0){anim=self.layers[key].el.animate(animation)}else{self.layers[key].el.animateWith(prev_el,anim,animation)}prev_el=self.layers[key].el;i++}}})}},updateSortableItems:function(){var self=this;var sorted_ids=$('#logotizer_layers').sortable("toArray");$.each(sorted_ids,function(key,old_id){old_id=parseInt(old_id.replace('layer_',''));$.each(self.layers,function(k,l){if(k==old_id){if(self.layers[k]!==undefined){self.layers[k].pos=key}}})});self.orderLayers()},activateLayer:function(l){var self=this;self.removeSelGroup();$('*').spectrum('hide');var $layer=$('#layer_'+l);$('.control-layer').removeClass('active');$layer.addClass('active');var type=self.layers[l].type;self.updateLayerEffectsPanel(l,type);$('#effects').appendTo('#effects_'+l+' .effects').show();self.updateEffects(l);self.current_layer=parseInt(l)},removeSelGroup:function(){$('.control-layer').removeClass('active');var self=this;if(self.sel_group!==undefined){self.sel_box.remove();self.sel_box.clear();self.sel_box=undefined;self.sel_group.undrag();self.sel_group.clear();self.sel_group=undefined;$.each(self.selected_layers,function(index,layer){if(self.layers[layer]!==undefined){self.layers[layer].el.draggable({margin:10});self.layers[layer].el.mousedown(function(e){self.activateLayer(this.data('layer'))});self.setTransform(layer)}});self.selected_layers=[]}},expandLayer:function(l){var self=this;l=parseInt(l);$('#layer_'+l+' .layer-panel').slideDown()},initPlugins:function(){var self=this;$('#gradient_angle').roundSlider({value:self.layers[self.current_layer].gradient.angle,radius:50,min:0,max:360,sliderType:'default',handleShape:"dot",handleSize:'+8',change:function(slider){self.changeGradientAngle(slider.value);self.saveHistoryState()}});$('#gradient_angle_value').text(self.layers[self.current_layer].gradient.angle);self.$logo_gradient_start.spectrum({'color':self.$logo_gradient_start_input.val(),'showInput':true,'preferredFormat':"hex",'move':function(color){var hex=color.toHexString();self.$logo_gradient_start.css('backgroundColor',hex);self.changeGradient('gradient_start',hex,self.current_layer);self.$logo_gradient_start_input.val(hex);self.afterRender()},'beforeShow':function(){$('.sp-cancel').hide();$('.sp-choose').addClass('s3-btn white-gray without-margin small').html('<span class="s3-ico i-save-svg"></span> OK');self.$logo_gradient_start.spectrum("set",self.layers[self.current_layer].gradient.start)}});self.$logo_gradient_end.spectrum({'color':self.$logo_gradient_end_input.val(),'showInput':true,'preferredFormat':"hex",'move':function(color){var hex=color.toHexString();self.$logo_gradient_end.css('backgroundColor',hex);self.changeGradient('gradient_end',hex,self.current_layer);self.$logo_gradient_end_input.val(hex);self.afterRender()},'beforeShow':function(){$('.sp-cancel').hide();$('.sp-choose').addClass('s3-btn white-gray without-margin small').html('<span class="s3-ico i-save-svg"></span> OK');self.$logo_gradient_end.spectrum("set",self.layers[self.current_layer].gradient.end)}});$('#gr_start_persent').slider({min:0,max:100,value:self.layers[self.current_layer].gradient.start_percent,slide:function(event,ui){self.layers[self.current_layer].gradient.start_percent=ui.value;self.saveHistoryState();self.changeGradient('gradient_start',self.layers[self.current_layer].gradient.start,self.current_layer)},create:function(){$(".ui-slider-handle").unbind('keydown')}});$('#gr_end_persent').slider({min:0,max:100,value:self.layers[self.current_layer].gradient.end_percent,slide:function(event,ui){self.layers[self.current_layer].gradient.end_percent=ui.value;self.saveHistoryState();self.changeGradient('gradient_end',self.layers[self.current_layer].gradient.end,self.current_layer)},create:function(){$(".ui-slider-handle").unbind('keydown')}});self.$logo_color_fill.spectrum({'color':self.$logo_color_fill_input.val(),'showInput':true,'preferredFormat':"hex",'move':function(color){var hex=color.toHexString();self.$logo_color_fill.css('backgroundColor',hex);self.changeFill(hex,self.current_layer);self.afterRender()},'beforeShow':function(){$('.sp-cancel').hide();$('.sp-choose').addClass('s3-btn white-gray without-margin small').html('<span class="s3-ico i-save-svg"></span> OK');self.$logo_color_fill.spectrum("set",self.layers[self.current_layer].fill)}});self.$logo_stroke_color.spectrum({'color':self.$logo_stroke_color_input.val(),'showInput':true,'preferredFormat':"hex",'move':function(color){var hex=color.toHexString();self.$logo_stroke_color.css('backgroundColor',hex);self.changeStroke(hex,self.current_layer);self.afterRender()},'beforeShow':function(){$('.sp-cancel').hide();$('.sp-choose').addClass('s3-btn white-gray without-margin small').html('<span class="s3-ico i-save-svg"></span> OK');self.$logo_stroke_color.spectrum("set",self.layers[self.current_layer].stroke)}});self.$layer_icons.scrollbar();$(window).on('resize.logotizer',function(){self.positionIconWrapper()})},positionIconWrapper:function(){var self=this;var $wrp=self.$layer_icons_wrapper;var wh=$(window).height();var wrp_h=$wrp.height();var needle_height=wh-200;if(needle_height<400){needle_height=400}$wrp.find('.scroll-wrapper').css('maxHeight',needle_height-125);$wrp.css('height',needle_height);var ww=$(window).width();var iw_left=$wrp.offset().left;var nw=ww-iw_left*2;if(nw>500){$wrp.css('width',nw+'px')}wrp_h=$wrp.height();var new_top=(wh-wrp_h)/2;if(new_top<108){new_top=108}$wrp.css('top',new_top+'px');self.$layer_icons.scrollbar()},onFigureClick:function($el){var self=this;var layer=parseInt($el.data('layer'));var figure_id=String($el.data('figure'));var current_figure="";$.each(self.icons,function(key,figure){if(figure.figure_id==figure_id){current_figure=figure;if(figure.category_id!==undefined){self.current_category=figure.category_id}else{self.current_category=10}return false}});var place_near=true;var place_direct={};if(typeof(current_figure.parent)!="undefined"&&(current_figure.parent.length)>0&&(current_figure.parent!=current_figure.figure_id)){place_near=false;$.each(self.layers,function(key,l){if(l!==undefined&&l.type==self.type_figure&&l.current_figure.figure_id==current_figure.parent){place_direct=self.getTransforms(self.layers[key].el);return false}})}if(layer==-1){layer=self.addLayer(self.type_figure,false,place_near);self.current_layer=layer}self.layers[layer].current_figure=current_figure;self.loadFigureLayer(layer,current_figure,false,true);if(!place_near){if(place_direct.dx!==undefined){self.layers[layer].el.transform('...T'+place_direct.dx+','+place_direct.dy);self.setTransform(layer)}else{self.placeNear(layer,self.type_figure)}}self.$layer_icons_wrapper.hide();self.saveHistoryState()},resetTransformations:function(layer){var self=this;if(layer===undefined){layer=parseInt(self.current_layer)}layer=parseInt(layer);if(self.layers[layer].type==self.type_text){self.layers[layer].el.transform('');self.centerElement(layer,undefined,true)}if(self.layers[layer].type==self.type_figure){self.layers[layer].el.transform('');self.centerElement(layer,true,true)}self.layers[layer].el.attr({'stroke-width':self.layers[layer]['stroke-width']});self.afterRender()},loadLogotypesList:function(){return $.get('/-/cms/v1/logotizer/?act=list&'+access,function(dom_nodes){$('#saved_favicons').html(dom_nodes)})},getFillType:function(layer){if(this.layers[layer].fill_enabled){return'color'}if(this.layers[layer].gradient.is_enabled){return'gradient'}return'none'},updateGradientPickers:function(layer){var self=this;self.$logo_gradient_start.css('backgroundColor','#'+self.layers[layer].gradient.start);self.$logo_gradient_start_input.val('#'+self.layers[layer].gradient.start);self.$logo_gradient_end.css('backgroundColor','#'+self.layers[layer].gradient.end);self.$logo_gradient_end_input.val('#'+self.layers[layer].gradient.end)},updateColorPickers:function(layer){var self=this;self.$logo_color_fill.css('backgroundColor','#'+self.layers[layer].fill)},setFillType:function(fill_type,layer,redraw_interface){var self=this;if(layer===undefined){layer=self.current_layer}self.layers[layer].fill_type=fill_type;if(redraw_interface){$('#fill_type').val(fill_type).trigger("liszt:updated")}switch(fill_type){case'color':self.revealFill(layer);if(redraw_interface){self.$eff_fill.show();self.$eff_gradient.hide();self.updateColorPickers(layer)}break;case'gradient':self.layers[layer]['fill_enabled']=false;self.layers[layer].gradient.is_enabled=true;self.changeGradient('gradient_start',self.layers[layer].gradient.start,layer);if(redraw_interface){self.updateGradientPickers(layer);self.$eff_gradient.show();self.$eff_fill.hide()}break;case'none':self.layers[layer].gradient.is_enabled=false;self.layers[layer]['fill']='none';self.layers[layer]['el'].attr('fill','none');self.layers[layer]['fill_enabled']=false;if(redraw_interface){self.$eff_gradient.hide();self.$eff_fill.hide()}break}},updateFillTypeControls:function(layer){var self=this;var fill_type=self.layers[layer].fill_type;$('#fill_type').val(fill_type).trigger("liszt:updated");switch(fill_type){case'color':self.$eff_fill.show();self.$eff_gradient.hide();self.updateColorPickers(layer);break;case'gradient':self.$eff_gradient.show();self.$eff_fill.hide();if(self.layers[layer].gradient.is_enabled){self.updateGradientPickers(layer)}break;case'none':self.$eff_gradient.hide();self.$eff_fill.hide();break}},updateEffects:function(layer){layer=parseInt(layer);var self=this;if(self.layers[layer].type==self.type_text){self.changeInputText(layer,self.layers[layer].caption);var font_regular=self.getRegularFontName(self.layers[layer].font);$('#effects_'+layer+' .font_family').val(font_regular).trigger("liszt:updated");$('#effects_'+layer).S3ChangeControls();self.loadStyle(layer)}if(self.layers[layer].type==self.type_figure){var svg=self.layers[layer].current_figure.svg;var $figure_48=$('<div>').append(svg);$figure_48=$figure_48.find('svg').attr({'width':48,'height':48});$('#effects_'+layer+' .figure').html($figure_48)}if(self.layers[layer].stroke_enabled){self.changeStroke(self.layers[layer].stroke,layer);self.$toggle_stroke.prop('checked',true);self.$toggle_stroke.parent('label').S3changeCheckboxAndRadio();self.$logo_stroke_color.show()}else{self.removeStroke(layer);self.$toggle_stroke.prop('checked',false);self.$toggle_stroke.parent('label').S3changeCheckboxAndRadio();self.$logo_stroke_color.hide()}self.$logo_stroke_color.css('backgroundColor','#'+self.layers[layer].stroke);self.$logo_stroke_color_input.val(self.layers[layer].stroke);$('#gradient_angle_value').text(self.layers[layer].gradient.angle);$('#gr_start_persent').slider('value',self.layers[layer].gradient.start_percent);$('#gr_end_persent').slider('value',self.layers[layer].gradient.end_percent);self.updateFillTypeControls(layer);$('#effects').appendTo('.effects').show()},changeFont:function(layer,font){this.layers[layer].font=font;this.layers[layer].el.attr('font-family',font);this.afterRender()},addGradient:function(){var object=this.layers[this.current_layer]['el'];this.layers[this.current_layer].gradient.is_enabled=true;object.attr({'fill':360-this.layers[this.current_layer].gradient.angle+'-'+this.layers[this.current_layer].gradient.start+'-'+this.layers[this.current_layer].gradient.end});$('.gradient-add-button').hide();$('.gradient-edit-inputs').show();this.afterRender()},centerElement:function(layer,center_x,shift){var self=this;if(layer===undefined){layer=self.current_layer}layer=parseInt(layer);var object=undefined;if(self.layers[layer]['el']!==undefined){object=self.layers[layer].el}var y_shift=0;if(shift!==undefined){y_shift=70}switch(self.layers[layer].type){case self.type_text:$.when(self.measureText(layer)).done(function(res){var height=res.height,width=res.width;var x=self.settings.width/2,y=self.settings.height/2+height/2+y_shift,transforms=self.getTransforms(object);if(transforms.dx||transforms.dy){x=x-transforms.dx;y=y-transforms.dy}if(transforms.noRotation==false||transforms.scalex>1){var bbox=self.layers[layer].el.getBBox();var bx=bbox.x,by=bbox.y;x=(self.settings.width/2-bbox.width/2)-bbox.x;y=(self.settings.height/2-bbox.height/2)-bbox.y+y_shift}object.transform('...T'+x+','+y);self.setTransform(layer);object.attr({'x':0,'y':0});self.afterRender();if(self.history.length==0){self.saveHistoryState()}});break;case self.type_figure:if(center_x!==undefined){var y=10+y_shift;var canvas_width=object.paper.width-self.figures_width;self.middle_x=(canvas_width/2).toFixed();object.transform('...T'+self.middle_x+','+y)}else{var bbox=object.getBBox();var current_center_x=bbox.x+bbox.width/2;current_center_x=current_center_x.toFixed();var current_center_y=bbox.y+bbox.height/2;current_center_y=current_center_y.toFixed();var dif_x=object.paper.width/2-current_center_x;var dif_y=object.paper.height/2-current_center_y;object.transform('...T'+dif_x+','+dif_y)}self.setTransform(layer);self.afterRender();break}self.orderLayers()},getTransforms:function(el){if(el.matrix===undefined){return el[0].matrix.split()}return el.matrix.split()},getMiddleTextPos:function(){var bbox=this.layers.text.el.getBBox();return{x:this.middle_x,y:this.middle_y+bbox.height/2}},measureText:function(layer){var self=this,text_x=-this.layers[layer].el.getBBox(1).width/2,text_string=this.layers[layer]['el'][0]['textContent'];var size=String(this.layers[layer].el.attr('font-size'));size=parseInt(size.replace('px'));var font_folder=self.getRegularFontName(self.layers[layer].font);var dfd=$.Deferred();opentype.load('/g/s3/favicon/fonts/'+font_folder+'/'+self.layers[layer].font+'.ttf',function(err,font){if(err){dfd.reject('Font is not loaded');alert('Could not load font: '+err)}else{var canvas=document.getElementById('canvas');var ctx=canvas.getContext('2d');ctx.clearRect(0,0,canvas.width,canvas.height);var tmp_path=font.getPath(text_string,10,300,size);tmp_path.draw(ctx);var ascent=0;var descent=0;var width=0;var scale=1/font.unitsPerEm*size;var glyphs=font.stringToGlyphs(text_string);for(var i=0;i<glyphs.length;i++){var glyph=glyphs[i];if(glyph.advanceWidth){width+=glyph.advanceWidth*scale}if(i<glyphs.length-1){var kerningValue=font.getKerningValue(glyph,glyphs[i+1]);width+=kerningValue*scale}if(glyph.yMax!==undefined){ascent=Math.max(ascent,glyph.yMax)}if(glyph.yMin!==undefined){descent=Math.min(descent,glyph.yMin)}}var height=ascent*scale;return dfd.resolve({width:width,height:height,actualBoundingBoxDescent:descent*scale,fontBoundingBoxAscent:font.ascender*scale,fontBoundingBoxDescent:font.descender*scale})}});return dfd.promise()},changeGradient:function(id,color,layer){var object=this.layers[layer]['el'];if(id=='gradient_start'){this.layers[layer].fill=color;this.layers[layer].last_fill=color;this.layers[layer].gradient.start=color;if(this.layers[layer].gradient.start_percent!==undefined){color+=':'+this.layers[layer].gradient.start_percent}var end_color=this.layers[layer].gradient.end;if(this.layers[layer].gradient.end_percent!==undefined){end_color+=':'+this.layers[layer].gradient.end_percent}object.attr({'fill':360-this.layers[layer].gradient.angle+'-'+color+'-'+end_color})}else{this.layers[layer].gradient.end=color;if(this.layers[layer].gradient.end_percent!==undefined){color+=':'+this.layers[layer].gradient.end_percent}var start_color=this.layers[layer].gradient.start;if(this.layers[layer].gradient.start_percent!==undefined){start_color+=':'+this.layers[layer].gradient.start_percent}object.attr({'fill':360-this.layers[layer].gradient.angle+'-'+start_color+'-'+color})}},changeGradientAngle:function(angle){var object=this.layers[this.current_layer]['el'];this.layers[this.current_layer].gradient.angle=angle;$('#gradient_angle_value').text(angle);angle=360-angle;var start_color=this.layers[this.current_layer].gradient.start;var end_color=this.layers[this.current_layer].gradient.end;if(this.layers[this.current_layer].gradient.start_percent!==undefined){start_color+=':'+this.layers[this.current_layer].gradient.start_percent}if(this.layers[this.current_layer].gradient.end_percent!==undefined){end_color+=':'+this.layers[this.current_layer].gradient.end_percent}object.attr({'fill':angle+'-'+start_color+'-'+end_color});this.afterRender()},hideLayer:function(layer){$('#layer_'+layer+' .layer-panel-header').css({'opacity':0.4});$('#toggle_'+layer+' span').removeClass('icon-layer-visible').addClass('icon-layer-hidden');if(this.layers[layer].el){this.layers[layer].el.hide()}this.layers[layer].is_hidden=true;this.afterRender()},showLayer:function(layer,do_not_expand){if(do_not_expand===undefined){var panels=$('.layer-panel')}$('#layer_'+layer+' .layer-panel-header').css({'opacity':1});$('#toggle_'+layer+' span').removeClass('icon-layer-hidden').addClass('icon-layer-visible');this.layers[layer].el.show();this.layers[layer].is_hidden=false;this.afterRender()},toggleLayer:function(layer){this.$layer_icons_wrapper.hide();var is_hidden=this.layers[layer].is_hidden;if(is_hidden){this.showLayer(layer)}else{this.hideLayer(layer)}},saveLogo:function(is_silent,is_example){var self=this;self.removeSelGroup();if((is_example!==undefined&&isStaffUser)||(self.example_editing&&isStaffUser)){is_example=true}if(self.countLayers()==0){util.msg('Пустой документ, нечего сохранять.');return}var defer=$.Deferred();var promise=$.when();self.showLoader();if($('#favicon_save_button').data('disabled')){return defer.reject("Uninitialized interface!")}var seen=[];var layers_tmp=$.extend(true,[],self.layers);for(var i=0;i<layers_tmp.length;i++){if(layers_tmp[i]===undefined){layers_tmp.splice(i,1);i--}else{layers_tmp[i].el=''}}var params=JSON.stringify(layers_tmp,function(key,val){if(val!==null&&typeof val=="object"){if(seen.indexOf(val)>=0){return}seen.push(val)}return val});var text_paths=[];var count=self.layers.length;var step=Math.ceil(97/count);$.each(self.layers,function(key,layer){if(layer===undefined){return true}if(layer.type==self.type_text){promise=promise.then(function(){return self.convertTextToPathAndGetSvg(key)}).then(function(result){if(result){var path=result.path_text;var layer=result.layer;path=self.logo.path(path);text_paths.push(path);path.attr({fill:self.getLayerFill(layer),stroke:'none'});if(self.layers[layer].stroke_enabled){path.attr({stroke:self.getLayerStroke(layer),'stroke-width':self.getLayerStrokeWidth(layer)})}if(self.layers[layer].shadow_enabled){path.dropShadow(self.shadow[0],self.shadow[1],self.shadow[2],self.shadow[3])}if(self.layers[layer].transform.val.length){path.transform(self.layers[layer].transform.val)}path.insertAfter(self.layers[[layer]].el)}var cur_val=$('#logo_save_progress').progressbar("value");self.updateLoader(cur_val+step)})}});promise.then(function(){self.updateLoader(98);var new_size=self.recalculateViewBox();var svg_content=$(self.element).clone();self.revealViewBox();$.each(text_paths,function(key,path){path.remove()});svg_content.find("svg").attr({'width':new_size.width,'height':new_size.height});svg_content.find("text").remove();svg_content.find('path').css('cursor','');var gradients=svg_content.find('linearGradient');var filters=svg_content.find('filter');svg_content=svg_content.html();if(gradients.length){$.each(gradients,function(key,gradient){var id=$(gradient).attr('id');var new_id=self.generateQuickGuId();svg_content=svg_content.replace(new RegExp(id,'g'),'gradient_'+new_id)})}if(filters.length){$.each(filters,function(key,filter){var id=$(filter).attr('id');var new_id=self.generateQuickGuId();svg_content=svg_content.replace(new RegExp(id,'g'),'filter_'+new_id)})}var data={params:params,svg_data:svg_content};var url='/-/cms/v1/logotizer/?act=save&';if(is_example){data.category_id=$('#example_category_id').val();url='/-/cms/v1/logotizer/?act=save_example&'}else{data.logo_id=self.getLogoId()}data.example_id=self.getExampleId();url+=access;data=JSON.stringify(data);self.updateLoader(99);$.ajax({type:'POST',url:url,processData:false,contentType:'application/json',data:data}).done(function(id){id=parseInt(id);if(id>0){if(is_example){self.example_id=id;popupController.closeLastPopup();util.msg("Пример логотипа сохранен");self.updateLoader(100);window.setTimeout(function(){self.hideLoader()},500);return defer.resolve()}self.logo_id=id;if(is_silent===undefined){$.when(self.loadLogotypesList()).done(function(){$('.favicon_item').removeClass('active');$('#s3_favicon_module_title').text('#'+id);$('#favicon_'+id).addClass('active');util.msg("Логотип сохранен")})}else{$('.favicon_item').removeClass('active');$('#s3_favicon_module_title').text('#'+id);$('#favicon_'+id).addClass('active')}self.updateLoader(100);window.setTimeout(function(){self.hideLoader()},500);defer.resolve()}else{defer.reject('Возникла ошибка, не удалось сохранить.');self.hideLoader();util.msg('Возникла ошибка, не удалось сохранить.')}}).fail(function(){defer.reject('Возникла ошибка, не удалось сохранить.');self.hideLoader();util.msg('Возникла ошибка, не удалось сохранить. Попробуйте обновить страницу и попробовать заново.')})});return defer.promise()},getLogoId:function(){return this.logo_id},getExampleId:function(){return this.example_id},deleteFavicon:function(logo_id){var self=this;s3.confirm(JS_DELETE+' логотип #'+logo_id+'?',function(){return $.post('/-/cms/v1/logotizer/?act=delete&'+access,{'logo_id':logo_id},function(result){if(result.length){$.when(self.loadLogotypesList()).then(function(){popupController.closeLastPopup();if(self.logo_id==logo_id){self.logo_id=0;$('#s3_favicon_module_title').text(JS_LOGO_GENERATOR_CREATE_NEW)}util.msg('Логотип #'+logo_id+' удален.')})}else{util.msg('Логотип нельзя удалить. Была попытка оплаты.');popupController.closeLastPopup();self.loadLogotypesList()}})})},deleteExample:function(example_id){if(!isStaffUser){return false}var self=this;s3.confirm(JS_DELETE+' пример #'+example_id+'?',function(){return $.post('/-/cms/v1/logotizer/?act=delete_example&'+access,{'example_id':example_id},function(result){if(result.length){popupController.closeLastPopup();popupController.reloadLastPopup();if(self.example_id==example_id){self.example_id=0;$('#s3_favicon_module_title').text(JS_LOGO_GENERATOR_CREATE_NEW)}util.msg('Пример #'+example_id+' удален.')}else{util.msg('Пример не удалось удалить.')}})});return},placeOnSite:function(logo_id){var self=this;if(self.countLayers()==0){util.msg("Документ пуст, сначала нарисуйте логотип.");return}if(logo_id===undefined){logo_id=self.logo_id}if(self.checkAllHidden()){util.msg("Отобразите хотя бы 1 слой чтобы продолжить.");return}if(logo_id==0){$.when(self.saveLogo(true)).done(function(){self.loadLogotypesList();s3.openModalPopup('/-/cms/v1/logotizer/?act=place_on_site&logo_id='+self.logo_id+'&'+access,true)})}else{$.when(self.checkPsStatus(),self.saveLogo(true)).then(function(){self.loadLogotypesList();if(self.is_paid){$.post('/-/cms/v1/logotizer/?act=place_on_site&logo_id='+logo_id+'&'+access,{'save':true},function(result){if(result){s3.openModalPopup('/-/cms/v1/logotizer/?act=place_on_site&logo_id='+self.logo_id+'&'+access,true);util.msg("Логотип сохранен в иллюстрации.")}else{util.msg("Возникла ошибка при сохранении логотипа.")}})}else{s3.openModalPopup('/-/cms/v1/logotizer/?act=place_on_site&logo_id='+self.logo_id+'&'+access,true)}})}},checkAllHidden:function(){var self=this;var all_hidden=true;$.each(self.layers,function(key,layer){if(layer!==undefined&&layer.is_hidden==false){all_hidden=false;return false}});return all_hidden},psPopupTracker:function(){var self=this;clearTimeout(self.ps_timeout);self.ps_timeout=setTimeout((function(){$.when(self.checkPsStatus()).done(function(){if(self.is_paid){popupController.reloadLastPopup();self.loadLogotypesList();clearTimeout(self.ps_timeout)}else{self.psPopupTracker()}})}),3000)},openPsPopup:function(){var self=this;self.psPopupTracker();$.post('/-/cms/v1/logotizer/?act=ps_init&'+access,{"logo_id":self.logo_id},function(){self.loadLogotypesList();var url='/-/cms/v1/payment/?'+access+'&service_group=s3_custom_logo_assisted&order_params=object_id='+self.logo_id;s3.openModalPopup(url)})},checkPsStatus:function(){var self=this;return $.get('/-/cms/v1/logotizer/?act=status&logo_id='+self.logo_id+'&'+access,function(status){if(status.length&&status=='paid'){self.is_paid=true}else{self.is_paid=false}})},showExamples:function(){s3.openModalPopup('/-/cms/v1/logotizer/?act=examples&popup=1&'+access)},backToExamples:function(){s3.loadPopupContent('/-/cms/v1/logotizer/?act=examples&popup=1&'+access)},openExampleCategory:function(cat_id){s3.loadPopupContent('/-/cms/v1/logotizer/?act=list_ex_category&popup=1&cat_id='+cat_id+'&'+access)},exampleForm:function(){if(!isStaffUser){return false}s3.openModalPopup('/-/cms/v1/logotizer/?act=save_example_dialog&popup=1&'+access)},convertTextToPathAndGetSvg:function(layer){layer=parseInt(layer);var self=this;var path_text=undefined;var dfd=$.Deferred();if(self.layers[layer]===undefined){dfd.resolve(false);return dfd.promise()}if(!this.layers[layer].is_hidden){var text_x=-this.layers[layer].el.getBBox(1).width/2,text_y=this.layers[layer]['el'].attr('y'),text_string=this.layers[layer].caption;var size=String(this.layers[layer].el.attr('font-size'));size=parseInt(size.replace('px'));var font_folder=self.getRegularFontName(self.layers[layer].font);opentype.load('/g/s3/favicon/fonts/'+font_folder+'/'+self.layers[layer].font+'.ttf',function(err,font){if(err){dfd.reject('Font is not loaded');alert('Could not load font: '+err)}else{var path=font.getPath(text_string,text_x,0,size);path_text=path.toPathData();var res={'path_text':path_text,'layer':layer};dfd.resolve(res)}})}else{dfd.resolve(false)}return dfd.promise()},generateQuickGuId:function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},editFavicon:function(logo_id,editable){var self=this;self.example_editing=false;if(editable==false){s3.alert('Логотип можно редактировать в течение 10 дней после покупки.');return false}$('.favicon_item').removeClass('active');$('#s3_favicon_module_title').text('#'+logo_id);$('#favicon_'+logo_id).addClass('active');$.post('/-/cms/v1/logotizer/?act=edit&'+access,{'logo_id':logo_id},function(params){self.logo_id=logo_id;params=JSON.parse(params);params=$.parseJSON(params);self.loadState(params)})},loadExample:function(example_id){var self=this;self.logo_id=0;self.example_id=example_id;self.example_editing=false;popupController.closeLastPopup();$('.favicon_item').removeClass('active');$.getJSON('/-/cms/v1/logotizer/?act=load_example&popup=1&'+access,{"example_id":example_id}).done(function(params){params=$.parseJSON(params);self.loadState(params);$('#s3_favicon_module_title').text(JS_LOGO_GENERATOR_CREATE_NEW)})},editExample:function(example_id){if(!isStaffUser){return false}var self=this;self.logo_id=0;self.example_id=example_id;self.example_editing=true;popupController.closeLastPopup();popupController.closeLastPopup();$('.favicon_item').removeClass('active');$.getJSON('/-/cms/v1/logotizer/?act=load_example&popup=1&'+access,{"example_id":example_id}).done(function(params){params=$.parseJSON(params);self.loadState(params);$('#s3_favicon_module_title').text("Редактирование примера #"+example_id)})},loadState:function(params){var self=this;self.removeSelGroup();$('#effects').hide().appendTo('body');$('.control-layer').remove();self.logo.clear();$('.layer-panel').slideUp("fast");$('.control-layer').removeClass('active');self.layers=[];params.sort(function(a,b){if(a===null||b===null){return 0}if(a.pos<b.pos){return-1}if(a.pos>b.pos){return 1}return 0});$.each(params,function(layer,options){if(layer===null){return true}if(self.layers[layer]===undefined&&options!==null){self.addLayer(options.type,true)}else{return true}self.layers[layer].pos=options.pos;self.layers[layer].stroke_enabled=options.stroke_enabled;self.layers[layer].shadow_enabled=options.shadow_enabled;self.layers[layer].fill_enabled=options.fill_enabled;self.layers[layer].fill_type=options.fill_type;self.layers[layer].stroke=options.stroke;self.layers[layer].fill=options.fill;self.layers[layer].last_fill=options.last_fill;self.layers[layer].gradient=options.gradient;self.layers[layer].is_hidden=options.is_hidden;if(options.transform!==undefined&&options.transform.val!=''){self.layers[layer].transform=options.transform}else{self.layers[layer].transform.val=''}switch(options.type){case self.type_text:self.loadTextLayer(layer,options.size,options.font,options.style,options.is_regular,options.is_bold_enabled,options.is_italic_enabled,options.pos,options.caption,options.is_hidden,false);break;case self.type_figure:self.current_category=10;$.each(self.icons,function(key,figure){if(figure.figure_id==options.current_figure.figure_id){if(figure.category_id!==undefined){self.current_category=figure.category_id}return false}});self.loadFigureLayer(layer,options.current_figure,options.is_hidden,false);break}});self.orderLayers();self.recountLayers();self.activateLayer(0);$('#logotizer_layers').S3ChangeControls()},loadTextLayer:function(layer,size,font,style,is_regular,is_bold_enabled,is_italic_enabled,pos,caption,is_hidden,redraw_interface){var self=this;self.layers[layer].size=size;self.layers[layer].font=font;self.layers[layer].style=style;self.layers[layer].is_regular=is_regular;self.layers[layer].is_bold_enabled=is_bold_enabled;self.layers[layer].is_italic_enabled=is_italic_enabled;if(self.layers[layer].el==undefined){self.layers[layer].el=self.logo.text(0,0,caption);self.layers[layer].el.data('layer',layer)}self.changeInputText(layer,caption);self.changeText(layer,caption);self.layers[layer].el.hide();self.layers[layer].el.attr('opacity',0);var font_regular=self.getRegularFontName(font);$('#effects_'+layer+' .font_family').val(font_regular).trigger("liszt:updated");self.loadStyle(layer);self.onAfterLayerLoaded(layer,is_hidden,redraw_interface);self.layers[layer].el.mousedown(function(e){self.activateLayer(this.data('layer'))});self.orderLayers()},loadFigureLayer:function(layer,current_figure,is_hidden,redraw_interface){layer=parseInt(layer);var self=this;self.layers[layer].current_figure=current_figure;self.placeSvgPlain(current_figure.svg,layer);self.onAfterLayerLoaded(layer,is_hidden,redraw_interface);var $figure_18=$('<div>').append(current_figure.svg);var $figure_48=$('<div>').append(current_figure.svg);var $figure_18=$figure_18.find('svg').attr({'width':18,'height':18});var $figure_48=$figure_48.find('svg').attr({'width':48,'height':48});$('#effects_'+layer+' .figure').html($figure_48);$('#layer_'+layer+' .layer-panel-figure-small').html($figure_18);self.orderLayers()},onAfterLayerLoaded:function(layer,is_hidden,redraw_interface){var self=this;self.applyTransform(layer);self.setFillType(self.layers[layer].fill_type,layer,redraw_interface);if(is_hidden){self.hideLayer(layer)}else{self.showLayer(layer,true)}if(self.layers[layer].draggable){self.layers[layer].el.draggable({margin:10});self.layers[layer].el.attr({'cursor':'move'})}self.updateEffects(layer)},placeNear:function(layer,type){var self=this;layer=parseInt(layer);var last_text_layer_key=undefined;var needle_key=undefined;$.each(self.layers,function(key,l){if(l!==undefined&&l.type==type){needle_key=last_text_layer_key;last_text_layer_key=key}});if(needle_key===undefined){self.centerElement(layer,true);return true}var obj=self.layers[needle_key].el;var transforms=self.getTransforms(obj);var old_bbox=obj.getBBox();var bbox=self.layers[layer].el.getBBox();var new_x=transforms.dx;var new_y=old_bbox.y2;var new_max_y=new_y+bbox.height;if(type==self.type_text){new_y+=30}if(new_max_y>(obj.paper.height)){new_y=70}self.layers[layer].el.transform('t'+new_x+","+new_y);self.setTransform(layer);return true},applyRandomColorSetOnInit:function(){var self=this,layer=0,set_id=self.getRandomInt(0,3),color_id=self.getRandomInt(0,31),color=this.color_sets[set_id][color_id];if(color.fill!==undefined){self.layers[layer].fill=color.fill;self.layers[layer].last_fill=color.fill;self.layers[layer].fill_enabled=true;self.layers[layer].fill_type='color'}if(color.gradient!==undefined){self.layers[layer].fill_type='gradient';self.layers[layer].fill_enabled=false;self.layers[layer].gradient.start=color.gradient.start;self.layers[layer].gradient.end=color.gradient.end;self.layers[layer].gradient.is_enabled=true}if(color.text_fill!==undefined){if(self.layers[1]!==undefined){self.layers[1].fill=color.text_fill;self.layers[1].last_fill=color.text_fill}}if(set_id==0&&self.layers[1]!==undefined){self.layers[1].fill='#000000';self.layers[1].last_fill='#000000'}},applyRandomColorSet:function(layer){var self=this;if(layer===undefined){layer=0}var set_id=self.getRandomInt(0,3),color_id=self.getRandomInt(0,31),color=this.color_sets[set_id][color_id];if(color.fill!==undefined){self.layers[layer].fill=color.fill;self.layers[layer].last_fill=color.fill;self.layers[layer].fill_enabled=true;self.layers[layer].fill_type='color'}if(color.gradient!==undefined){self.layers[layer].fill=color.gradient.start;self.layers[layer].last_fill=color.gradient.start;self.layers[layer].fill_enabled=true;self.layers[layer].fill_type='color'}},getRegularFontName:function(font){font=font.replace('_bold','');return font.replace('_italic','')},getCurrentFontType:function(layer){if(this.layers[layer].is_bold_enabled&&this.layers[layer].is_italic_enabled){return'bold_italic'}if(this.layers[layer].is_bold_enabled){return'bold'}if(this.layers[layer].is_italic_enabled){return'italic'}},clearLayer:function(layer){if(this.layers[layer]['el']!==undefined){this.layers[layer]['el'].remove();this.afterRender()}},changeInputText:function(layer,text){text=text.replace(/\s+/," ");text=text.trim();layer=parseInt(layer);$('#effects_'+layer).find('.logo_text').val(text)},changeText:function(layer,text){text=text.replace(/\s+/," ");text=text.trim();layer=parseInt(layer);this.layers[layer].caption=text;if(text==''){$('#layer_'+layer+' .layer-text-caption').text('Текст')}else{$('#layer_'+layer+' .layer-text-caption').text(text)}this.layers[layer].el.attr({'text':text,'font-size':this.layers[layer].size,'cursor':'move','text-anchor':'middle'});this.afterRender()},changeFill:function(hex,layer){layer=parseInt(layer);if(this.layers[layer]['gradient']['is_enabled']){this.layers[layer]['gradient']['is_enabled']=false}else{this.layers[layer]['last_fill']=hex}this.layers[layer]['fill']=hex;this.layers[layer].gradient.start=hex;this.layers[layer]['el'].attr('fill',hex);this.afterRender()},removeFill:function(){if(this.layers[this.current_layer]['gradient']['is_enabled']){var current_fill_color=self.$logo_color_fill_input.val();this.layers[this.current_layer]['fill']=current_fill_color;this.layers[this.current_layer]['gradient']['is_enabled']=false;this.layers[this.current_layer]['el'].attr('fill',current_fill_color)}else{this.layers[this.current_layer]['fill']='none';this.layers[this.current_layer]['el'].attr('fill','none');this.layers[this.current_layer]['fill_enabled']=false}this.afterRender()},revealFill:function(layer){layer=parseInt(layer);this.changeFill(this.layers[layer].last_fill,layer);this.layers[layer].fill_enabled=true},changeStroke:function(hex,layer){layer=parseInt(layer);this.layers[layer].stroke_enabled=true;this.layers[layer]['stroke']=hex;this.layers[layer]['el'].attr({'stroke':hex,'stroke-width':this.layers[layer]['stroke-width']});this.afterRender()},removeStroke:function(layer){layer=parseInt(layer);this.layers[layer].stroke_enabled=false;this.layers[layer]['el'].attr('stroke','none');this.afterRender()},getLayerFill:function(layer){layer=parseInt(layer);var current_fill='';if(this.layers[layer].gradient.is_enabled){current_fill=360-this.layers[layer].gradient.angle+'-'+this.layers[layer].gradient.start+':'+this.layers[layer].gradient.start_percent+'-'+this.layers[layer].gradient.end+':'+this.layers[layer].gradient.end_percent}else{current_fill=this.layers[layer].fill}return current_fill},getLayerStroke:function(layer){layer=parseInt(layer);return this.layers[layer]['stroke']},getLayerStrokeWidth:function(layer){layer=parseInt(layer);return this.layers[layer]['stroke-width']},changeStyle:function(layer,type){layer=parseInt(layer);if(this.layers[layer].type!=this.type_text){console.warn('Invalid layer type');return}var current_font=this.layers[layer].font;var current_style=this.layers[layer].style;switch(type){case'bold':if(this.layers[layer].is_bold_enabled==false){$('#effects_'+layer).find('.logo_bold_button').addClass('active');this.layers[layer].is_bold_enabled=true;current_style='_bold'}else{if(this.layers[layer].is_italic_enabled){current_style='_italic'}else{current_style=''}$('#effects_'+layer).find('.logo_bold_button').removeClass('active');this.layers[layer].is_bold_enabled=false}break;case'italic':if(this.layers[layer].is_italic_enabled==false){this.layers[layer].is_italic_enabled=true;current_style='_italic';$('#effects_'+layer).find('.logo_italic_button').addClass('active')}else{if(this.layers[layer].is_bold_enabled){current_style='_bold'}else{current_style=''}this.layers[layer].is_italic_enabled=false;$('#effects_'+layer).find('.logo_italic_button').removeClass('active')}break}if(this.layers[layer].is_italic_enabled&&this.layers[layer].is_bold_enabled){this.layers[layer].style='_bold_italic';current_style='_bold_italic'}current_font=$('#effects_'+layer+' .font_family').val()+current_style;this.layers[layer].style=current_style.replace('_','');this.changeFont(layer,current_font)},loadStyle:function(layer){layer=parseInt(layer);var current_font=this.layers[layer].font;var current_style=this.layers[layer].style;if(this.layers[layer].is_bold_enabled==true){$('#effects_'+layer).find('.logo_bold_button').addClass('active')}else{$('#effects_'+layer).find('.logo_bold_button').removeClass('active')}if(this.layers[layer].is_italic_enabled==true){$('#effects_'+layer).find('.logo_italic_button').addClass('active')}else{$('#effects_'+layer).find('.logo_italic_button').removeClass('active')}this.changeFont(layer,current_font)},removeText:function(){$('#effects_'+this.current_layer+' .logo_text').val('');this.layers[this.current_layer].el.attr('text','');this.layers[this.current_layer].caption='';this.afterRender()},move:function(direction,step){var self=this;if(self.layers[self.current_layer].is_hidden){return}var object=self.layers[self.current_layer].el;var x=0;var y=0;if(step===undefined){step=1}var bbox=object.getBBox();switch(direction){case'up':y-=step;break;case'down':y+=step;break;case'left':x-=step;break;case'right':x+=step;break}if((bbox.x+x<0&&x<0)||(bbox.x2+x>object.paper.width&&x>0)){return}if((bbox.y+y<0&&y<0)||(bbox.y2+y>object.paper.height&&y>0)){return}object.transform("...T"+x+','+y);self.setTransform(self.current_layer);self.saveHistoryState();self.afterRender()},getRandomInt:function(min,max){return Math.floor(Math.random()*(max-min+1))+min},getRandomColor:function(){var number=this.getRandomInt(0,this.rand_colors.length-1);this.random_color_generated=this.rand_colors[number]},showFigures:function(layer,left,top){layer=parseInt(layer);var self=this;$('.icon-wrapper').removeClass('active');self.$layer_icons.html('').show();$('#favicon_categories').show();var $wh=$(window).height();var needle_height=$wh-200;if(needle_height<400){needle_height=400}self.$layer_icons_wrapper.css({'left':left+'px','top':top+'px','height':needle_height}).data('top',top);var $closeButton=$('<span>').css({"position":"absolute","right":"19px","top":"13px","cursor":"pointer"}).attr({"id":"close_figures","class":"s3-ico winclose-thin"});self.appendCategories(layer);$closeButton.appendTo('#favicon_categories');self.showCategory(layer,self.current_category);self.$layer_icons_wrapper.toggle();self.positionIconWrapper()},updateTitle:function(){var self=this;var cat_name=self.categories[self.current_category].name;var title_tmpl=$('#template-icon-wrapper-title').html();Mustache.parse(title_tmpl);title_tmpl=Mustache.render(title_tmpl,{"title":cat_name});self.$layer_icons.prepend(title_tmpl)},appendCategories:function(layer){var self=this;$('#favicon_categories').html('');$.each(self.categories,function(key,category){var $tmpi=$(category.icon).get(0);var icon=$tmpi.outerHTML;var cat_icon_b64=btoa(icon);var data={'category-id':key,'layer':layer};$('#favicon_categories').append($('<div>').data(data).attr({class:'favicon-category-wrapper s3-tooltip small',title:category.name}).append($("<div>").attr({id:'favicon_category_'+key,class:"icon-category",style:"background:url('data:image/svg+xml;base64,"+cat_icon_b64+"') no-repeat;"}).data(data)));if(self.current_category==key){$('#favicon_category_'+key).parent().addClass('active')}});$('#favicon_categories').S3ChangeControls()},showCategory:function(layer,category_id){var self=this;self.$layer_icons.html('');self.current_category=category_id;$('.favicon-category-wrapper').removeClass('active');$('#favicon_category_'+category_id).parent().addClass('active');var $no_group=$('<div>').addClass('no-group');self.$layer_icons.append($no_group);$.each(self.icons,function(key,figure){if(figure.category_id!=category_id){return true}var active='';if(self.layers[layer]!==undefined&&self.layers[layer].current_figure.figure_id==figure.figure_id){active=' active'}var back_style="";if(figure.parent!==undefined&&figure.parent!=''&&figure.parent!=figure.figure_id){var parent_figure={};$.each(self.icons,function(key,f){if(f.figure_id==figure.parent){parent_figure=f;var p=Raphael($('#icon_kitchen').get(0),160,160);var p_set=p.set();p.importSVG2(parent_figure.svg,p_set);p_set.attr('fill','#ebebeb');var p_contents=$('#icon_kitchen').html();p.clear();$('#icon_kitchen').html("");var psvg=btoa(p_contents);back_style="background:url('data:image/svg+xml;base64,"+psvg+"') no-repeat;";return true}})}var menu_item="<div class='icon-wrapper"+active+"'>";menu_item+='<div class="layer-icon" data-layer="'+layer+'" data-figure="'+figure.figure_id+'" style="'+back_style+'">';var $figure=$('<div>').append(figure.svg);$figure=$figure.find('svg').attr({"width":54,"height":54});menu_item+=$figure.parent().html();menu_item+="</div>";menu_item+="</div>";if(figure.parent!==undefined&&figure.parent!=''){var $group=self.$layer_icons.find('.group-'+figure.parent);if($group.length){$group.append(menu_item)}else{self.$layer_icons.prepend($('<div>').addClass('category-group').addClass('group-'+figure.parent));$group=self.$layer_icons.find('.group-'+figure.parent);$group.append(menu_item)}}else{$no_group.append(menu_item)}});self.$layer_icons.scrollbar();self.updateTitle()},rotate:function(angle){this.layers[this.current_layer].el.transform('...R'+angle);this.setTransform(this.current_layer);this.afterRender()},scale:function(cmd){var self=this;var obj=self.layers[self.current_layer].el;var matrix=self.getTransforms(obj);var old_scale=matrix.scalex;var new_scale=0;var max_zoom=5;var step=0.08;if(self.layers[self.current_layer].type==self.type_figure){max_zoom=10;step=0.1}if(cmd=='+'){new_scale=parseFloat(matrix.scalex)+step}else{new_scale=parseFloat(matrix.scalex)-step}new_scale=new_scale/old_scale;if(matrix.scalex>max_zoom&&cmd=="+"){return false}if(matrix.scalex<0.01&&cmd=="-"){return false}this.layers[this.current_layer].el.transform('...S'+new_scale);this.setTransform(this.current_layer);this.afterRender()},flip:function(direction){var self=this;var obj=self.layers[self.current_layer].el;var layer=self.current_layer;if(ct[0]!==undefined){var m=ct[0].matrix;m="m1,0,0,-1,"+m.e+","+160;obj.transform(m)}else{$.when(this.measureText(layer)).done(function(res){var height=res.height,width=res.width;obj.transform("m1,0,0,-1,"+ct.dx+","+ct.dy);self.setTransform(layer);self.afterRender()})}self.setTransform(self.current_layer);self.afterRender()},flipX:function(){var self=this;self.layers[self.current_layer].el.transform("...S-1");self.setTransform(self.current_layer);self.afterRender();self.flipY()},flipY:function(){var self=this;self.layers[self.current_layer].el.transform("...S-1,1");self.setTransform(self.current_layer);self.afterRender()},setTransform:function(layer){var t=this.layers[layer].el.transform();if(typeof t=='object'){t=this.logo.getTransformString(this.layers[layer].el)}this.layers[layer].transform.val=t},applyTransform:function(layer){if(this.layers[layer].el===undefined){return}if(this.layers[layer].transform!==undefined&&this.layers[layer].transform.val!==undefined){this.layers[layer].el.transform(this.layers[layer].transform.val)}else{this.layers[layer].el.attr('transform','')}if(layer=='text'&&this.layers.text['fix-text-pos']!==undefined){var text_x=this.layers.text.pos.x,text_y=this.layers.text.pos.y;if(text_x&&text_y){var bbox=this.layers.text.el.getBBox(1);var mid_width=bbox.width/2;var fixed_x=mid_width+text_x;this.layers.text.el.transform('t'+fixed_x+','+text_y);this.layers.text.transform.val=this.layers.text.el.transform();this.layers.text['fix-text-pos']=undefined}}},afterRender:function(){var self=this},saveHistoryState:function(){},historyBack:function(){var self=this;var len=self.history.length;if(typeof(self.history[self.history_key-1])!=="undefined"){self.history_key-=1;if(self.history_key==0){$('.logotizer-history-back').addClass('disabled');$('.logotizer-history-forward').removeClass('disabled')}if(self.history_key<(self.history.length-1)){$('.logotizer-history-forward').removeClass('disabled')}self.loadState(self.history[self.history_key])}return false},historyForward:function(){var self=this;if(typeof(self.history[self.history_key+1])!=="undefined"){self.history_key+=1;if(self.history_key==(self.history.length-1)){$('.logotizer-history-forward').addClass("disabled");$('.logotizer-history-back').removeClass("disabled")}self.loadState(self.history[self.history_key])}return false},addLayer:function(type,add_params_only,place_near){if(this.countLayers()==this.max_layers){s3.alert("Создано "+this.max_layers+" слоев из "+this.max_layers);return}if(place_near===undefined){place_near=false}if(add_params_only===undefined){add_params_only=false}var self=this,m_id=0,new_id=0,key=self.layers.length;self.updateLayerEffectsPanel(key,type);switch(type){case self.type_figure:var tmpl=$('#template-layer-figure').html();Mustache.parse(tmpl);var r_layer=Mustache.render(tmpl,{"id":key});if(add_params_only==false){$('#logotizer_layers').prepend(r_layer)}else{$('#logotizer_layers').append(r_layer)}self.layers.push({'id':key,'type':this.type_figure,'el':undefined,'fill':'#ffffff','fill_enabled':true,'shadow_enabled':false,'stroke_enabled':false,'fill_type':'color','last_fill':'#ffffff','stroke':'#000000','stroke-width':2,'is_hidden':false,'gradient':{is_enabled:false,start:'#ffffff',end:'#000000',angle:self.defaults.figure.gradient.angle,start_percent:self.defaults.figure.gradient.start_percent,end_percent:self.defaults.figure.gradient.end_percent},'current_figure':'001-010','transform':{'val':''},'draggable':true,'pos':key});if(add_params_only==false){self.applyRandomColorSet(key);var demo_figure=undefined;$.each(self.icons,function(k,figure){if(figure.is_free){demo_figure=figure;return false}});self.loadFigureLayer(key,demo_figure,false,true);if(place_near){self.placeNear(key,self.type_figure)}}break;case self.type_text:var template=$('#template-layer-text').html();Mustache.parse(template);var rendered_layer=Mustache.render(template,{"id":key});if(add_params_only==false){$('#logotizer_layers').prepend(rendered_layer)}else{$('#logotizer_layers').append(rendered_layer)}self.layers.push({'id':key,'type':this.type_text,'el':undefined,'size':220,'min_size':140,'max_size':300,'fill':'#000000','fill_enabled':true,'shadow_enabled':false,'stroke_enabled':false,'fill_type':self.defaults.text.fill_type,'last_fill':self.defaults.text.last_fill,'stroke':self.defaults.text.stroke,'stroke-width':2,'is_hidden':false,'font':self.defaults.text.font,'caption':self.defaults.text.caption,'style':self.defaults.text.style,'text-anchor':self.defaults.text['text-anchor'],'is_regular':self.defaults.text.is_regular,'is_italic_enabled':self.defaults.text.is_italic_enabled,'is_bold_enabled':self.defaults.text.is_bold_enabled,'gradient':{is_enabled:false,start:'#ffffff',end:'#000000',angle:self.defaults.figure.gradient.angle,start_percent:self.defaults.text.gradient.start_percent,end_percent:self.defaults.text.gradient.end_percent},'transform':{'val':''},'draggable':true,'pos':key});if(add_params_only==false){self.applyRandomColorSet(key);self.loadTextLayer(key,self.defaults.text.size,self.defaults.text.font,self.defaults.text.style,self.defaults.text.is_regular,self.defaults.text.is_bold_enabled,self.defaults.text.is_italic_enabled,self.defaults.text.pos,self.defaults.text.caption,false,true);if(place_near){self.placeNear(key,self.type_text);$('.logotizer-add-layer').hide();$('#create_layer_menu').find('.context-button-active').removeClass('context-button-active')}}break}if(add_params_only==false){self.updateSortableItems();self.activateLayer(key);$('#logotizer_layers').S3ChangeControls()}self.orderLayers();self.recountLayers();return key},copyLayer:function(layer,place_near){if(this.countLayers()==this.max_layers){s3.alert("Создано "+this.max_layers+" слоев из "+this.max_layers);return}if(place_near===undefined){place_near=false}var self=this,m_id=0,new_id=0,key=self.layers.length,layer_copy=$.extend(true,{},self.layers[layer]),type=layer_copy.type;layer_copy['id']=key;layer_copy['el']=undefined;layer_copy['pos']=key;self.updateLayerEffectsPanel(key,type);var l=$('#layer_'+layer);var template=$('#template-layer-'+type).html();Mustache.parse(template);var rendered_layer=Mustache.render(template,{"id":key});l.before(rendered_layer);self.layers.push(layer_copy);if(type==self.type_figure){self.loadFigureLayer(key,layer_copy.current_figure,layer_copy.is_hidden,true)}else{self.loadTextLayer(key,layer_copy.size,layer_copy.font,layer_copy.style,layer_copy.is_regular,layer_copy.is_bold_enabled,layer_copy.is_italic_enabled,layer_copy.pos,layer_copy.caption,layer_copy.is_hidden,true)}self.updateSortableItems();self.activateLayer(key);self.recountLayers();$('#logotizer_layers').S3ChangeControls();return key},updateLayerEffectsPanel:function(layer,type){var self=this;var tpl_effects='';switch(type){case self.type_text:tpl_effects=$('#template-settings-text').html();break;case self.type_figure:tpl_effects=$('#template-settings-figure').html();break}$('#effects').hide().appendTo('body');Mustache.parse(tpl_effects);tpl_effects=Mustache.render(tpl_effects,{"id":layer});$('#logotizer_effects').html(tpl_effects);$('#effects').appendTo('#effects_'+layer+' .effects').show();$('.layer-panel').show();$('#logotizer_effects').S3ChangeControls()},recountLayers:function(){var cou=this.countLayers();if(cou==this.max_layers){$('#create_layer_menu').find('.s3-btn').addClass('disabled')}else{$('#create_layer_menu').find('.s3-btn').removeClass('disabled')}$('#layers_count').text('('+cou+'/'+this.max_layers+')')},countLayers:function(){var cnt=0;$.each(this.layers,function(k,l){if(l!==undefined){cnt++}});return cnt},addFigureLayerAndChooseFigure:function(){var self=this,$mi=$('.btn-add-figure-layer'),offset=$mi.offset();if(self.countLayers()==self.max_layers){s3.alert("Создано "+self.max_layers+" слоев из "+self.max_layers);return}var main_offset=$('.logotizer').offset().top;self.showFigures(-1,50,offset.top-main_offset-15)},removeLayer:function(layer){var self=this;if($('#layer_'+layer).data('locked')){return}s3.confirm("Удалить слой?",function(){self.removeSelGroup();layer=parseInt(layer);if($('#layer_'+layer).find('#effects').length){$('#effects').appendTo('body').hide()}if(layer==self.current_layer){self.current_layer=-1;self.disableEffects()}if(self.layers[layer]!==undefined&&self.layers[layer].el!==undefined){self.layers[layer].el.remove();self.layers[layer]=undefined}$('#layer_'+layer).removeClass('animated flipInX').addClass('animated flipOutX');if($('#logotizer_layers').hasClass('.ui-sortable')){}self.recountLayers();popupController.closeLastPopup();setTimeout(function(){$('#layer_'+layer).remove()},600)},undefined,function(){$('#layer_'+layer).data('locked',false)});$('#layer_'+layer).data('locked',true)},removeLayers:function(){var self=this;s3.confirm("Удалить выбранные слои?",function(){$.each(self.selected_layers,function(index,layer){layer=parseInt(layer);if($('#layer_'+layer).find('#effects').length){$('#effects').appendTo('body').hide()}if(layer==self.current_layer){self.current_layer=-1;self.disableEffects()}if(self.layers[layer]!==undefined&&self.layers[layer].el!==undefined){self.layers[layer].el.remove();self.layers[layer]=undefined}$('#layer_'+layer).removeClass('animated flipInX').addClass('animated flipOutX');self.recountLayers();popupController.closeLastPopup();setTimeout(function(){$('#layer_'+layer).remove()},600)});self.removeSelGroup()})},disableEffects:function(){var self=this;var $choose_layer=$('<div>').addClass('choose-layer').css('height',self.logo.canvas.getAttribute('height')).append($('<div>').css({'text-align':'center','font-size':'18px','margin':'20px'}).text('Выберите слой').append($('<div>').css('font-size','14px').text('Выделяйте слои по одному для изменения настроек')));$('#effects').hide().appendTo('body');$('#logotizer_effects').html($choose_layer)},setLogoSize:function(width,height){var self=this;self.logo.setSize(width,height);self.afterRender()},recalculateViewBox:function(){var max_x=0,max_y=0,min_x=1000,min_y=1000,self=this;var temp=self.logo.set();self.layers.forEach(function(l){if(l!==undefined){temp.push(l.el)}});var bbox=temp.getBBox();self.logo.setViewBox(bbox.x,bbox.y,bbox.width,bbox.height);self.logo.setSize(bbox.width,bbox.height);temp.clear();return{'width':bbox.width,'height':bbox.height}},revealViewBox:function(){this.logo.setViewBox(0,0,this.settings.width,this.settings.height);this.logo.setSize(this.settings.width,this.settings.height)},createNew:function(){var self=this;s3.confirm("Создать новый логотип?<br/> Несохраненные изменения пропадут.",function(){if($('#btn_create_new_logo').data('disabled')){return}$('#btn_create_new_logo').data('disabled',true).addClass('disabled');self.logo_id=0;self.example_id=0;self.layers=[];self.history_key=0;self.history=[];self.logo.clear();$('#effects').appendTo('body').hide();$('#logotizer_layers').find('li').remove();self.init();$('#s3_favicon_module_title').text(JS_LOGO_GENERATOR_CREATE_NEW);popupController.closeLastPopup()},null,function(){$('#btn_create_new_logo').data('disabled',false).removeClass('disabled')})},showLoader:function(){$('.logotizer').find('.percent').text('0%');$('.logotizer').find('.overlay').show();$('#logo_save_progress').progressbar({value:0}).show()},hideLoader:function(){$('.logotizer').find('.overlay').hide();$('#logo_save_progress').hide()},updateLoader:function(n){$('#logo_save_progress').progressbar({value:n});$('.logotizer').find('.percent').text(n+'%')},offEvents:function(){$(document).off('.logotizer')},openSavedImage:function(image_id){s3.openModalPopup('/-/cms/v1/image/?act=edit&object_id='+image_id+'&'+access,false,null)},updateFontSizeInput:function(){var self=this;var timeout=window.setTimeout(function(){self.$font_family.trigger("liszt:updated")},300)}});$.fn[pluginName]=function(options){var self=this;var plugin=this.data(dataKey);if(plugin instanceof Plugin){if(typeof options!=='undefined'){plugin.init(options)}}else{plugin=new Plugin(this,options);self.data(dataKey,plugin)}return plugin}})(jQuery,window,document);var ForumController={};(function($){ForumController={forumSortButtons:false,reloadContentAfterEdit:false,edit:function(forum_id){var self=this;openAjaxForm('/-/cms/v1/forum/?act=edit&'+S3_ACCESS+'&forum_id='+forum_id,function(r){popupController.closeLastPopup();s3.reloadVisibleContent()},function(){if(self.reloadContentAfterEdit){s3.reloadVisibleContent()}self.reloadContentAfterEdit=false},function(){self.reloadContentAfterEdit=true})},save:function(form,reload){var self=this,form=$(form),data=form.serializeObject();$.ajax({url:form.attr('action'),data:data,type:form.attr('method'),dataType:'json',success:function(data){if(typeof data!='object'){s3.alert(s3.loc('JS_ERROR')+' code: 1');return}if(data.error){s3.alert(s3.loc('JS_ERROR')+' code: 3'+' -- '+data.error);return}popupController.closeLastPopup();if(reload){s3.reloadVisibleContent()}},error:function(){s3.alert(s3.loc('JS_ERROR')+' code: 2')}})},delete:function(forum_id){var self=this,url='/-/cms/v1/forum/?act=delete&'+S3_ACCESS,forum_id=parseInt(forum_id,10);if(!forum_id){return false}s3.confirm(s3.loc('JS_FORUM_CONFIRM_DELETE_FORUM_AND_SUBFORUMS'),function(){$.ajax({url:url,data:{'forum_id':forum_id},type:'post',dataType:'json',success:function(data){if(typeof data!='object'){s3.alert(s3.loc('JS_ERROR')+' code: 1');return}if(data.error){s3.alert(s3.loc('JS_ERROR')+' code: 3'+' -- '+data.error);return}popupController.closeLastPopup();s3.reloadVisibleContent()},error:function(){s3.alert(s3.loc('JS_ERROR')+' code: 2')}})})},saveSortPosition:function(obj){var self=this,pos=[];$(obj).each(function(item){$this=$(this);pos.push({key:$this.data('id'),index:$this.index()})});$.ajax({url:'/-/cms/v1/forum/?act=set_position&'+S3_ACCESS,data:{sort_data:JSON.stringify(pos)},type:'post',dataType:'json',success:function(data){if(data.done){s3.alert(s3.loc('JS_SAVED'));self.forumSortButtons.css('display','none')}},error:function(){s3.alert('error')}})},initSort:function(){var self=this;self.forumSortButtons=$('.forum-sort-button');$('.forum-list tbody').sortable({handle:'.forum-handle',update:function(){if(self.forumSortButtons.is(':hidden')){s3.alert(s3.loc('JS_FORUM_SORT_MESSAGE'));self.forumSortButtons.css('display','inline-block')}}});$('.forum-list .subforums').sortable({handle:'.subforum-handle',update:function(){if(self.forumSortButtons.is(':hidden')){s3.alert(s3.loc('JS_FORUM_SORT_MESSAGE'));self.forumSortButtons.css('display','inline-block')}}})},dropUserBan:function(user_id){var self=this,url='/-/cms/v1/forum/?act=ban&'+S3_ACCESS;s3.confirm(s3.loc('JS_FORUM_USER_CONFIRM_DROP_BAN'),function(){$.ajax({url:url,data:{'user_id':user_id,'days':0},type:'post',dataType:'json',success:function(data){if(typeof data!='object'){s3.alert(s3.loc('JS_ERROR')+' code: 1');return}if(data.error){s3.alert(s3.loc('JS_ERROR')+' code: 3'+' -- '+data.error);return}popupController.closeLastPopup();s3.reloadVisibleContent()},error:function(){s3.alert(s3.loc('JS_ERROR')+' code: 2')}})})},toggleEditTime:function(condition){if(condition==true){$('input[name="edit_time"]').attr('disabled','disabled')}else{$('input[name="edit_time"]').removeAttr('disabled')}}}})(jQuery);var FileController;(function($){FileController={checked:false,folder_id:false,file_count:false,container:false,checkAll:function(checkbox,folder_id,idPrefix){var self=this,checkbox=$(checkbox),label=checkbox.parent(),folder_id=(folder_id!=undefined)?parseInt(folder_id):undefined;if(!label.size())return false;if(typeof folder_id=='number'){self.folder_id=folder_id}else{self.folder_id=false}if(idPrefix){if(!self.container)self.container=self._getContainer(idPrefix);$(self.container).attr('data-form',idPrefix+'search_form')}else{if(self.container){$(self.container).removeAttr('data-form')}}label.checkboxClickFunction(null,true,null,folder_id)},_getContainer:function(idPrefix){return util.getObject(idPrefix+'container')},_getSearchForm:function(idPrefix){return util.getObject(idPrefix+'search_form')},_getSearchFormQuery:function(idPrefix){var f=this._getSearchForm(idPrefix);if(!(f&&f.elements.submitted.value))return'';var q='';$.each(f.elements,function(k,v){if(/^s\[/.test(v.name)){q+='&'+encodeURIComponent(v.name)+'='+encodeURIComponent(v.value)}});return q},updateSelector:function(container){var self=this,n_files=$(container).find('li[class="^box"]').length;$('.file-pagination-wrap').show(0);$('.file-wrapper-table').show(0);if(n_files>self.file_count){$('.image-selector .selector-image-count').each(function(){this.innerHTML=Number(this.innerHTML.trim())+1})}$('.image-selector .selector-visible-number').each(function(){this.innerHTML=$(container).find('li').length})},getFileCount:function(container){var self=this;self.file_count=$(container).find('li.file-item').length},search:function(form){var text=form.elements['s[text]'].value.trim();if(text){search(form,'/-/cms/v1/file/?'+S3_ACCESS)}return false},groupResetCategory:function(idPrefix){var self=this,url='/-/cms/v1/file/?act=move&'+S3_ACCESS+self._getSearchFormQuery(idPrefix),current_folder=self.folder_id;openAjaxForm(url+'&mode=choose&popup=1',function(r){s3.cronJobs(self._getContainer(idPrefix),'LI','file',url+'&mode=reset&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupMoveToCategory:function(idPrefix){var self=this,url='/-/cms/v1/file/?act=move&'+S3_ACCESS+self._getSearchFormQuery(idPrefix),current_folder=self.folder_id;openAjaxForm(url+'&mode=choose&popup=1',function(r){s3.cronJobs(self._getContainer(idPrefix),'LI','file',url+'&mode=set&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupCopyToCategory:function(idPrefix){var self=this,url='/-/cms/v1/file/?act=move&'+S3_ACCESS+self._getSearchFormQuery(idPrefix),current_folder=self.folder_id;openAjaxForm(url+'&mode=choose&popup=1',function(r){s3.cronJobs(self._getContainer(idPrefix),'LI','file',url+'&mode=append&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupDelete:function(idPrefix){var self=this,url='/-/cms/v1/file/?act=delete&'+S3_ACCESS+self._getSearchFormQuery(idPrefix),current_folder=self.folder_id;s3.cronJobs(self._getContainer(idPrefix),'LI','file',url,null,'input',{checked:true},true,current_folder);self.folder_id=false},showDataBrowser:function(obj,type_group_id){var self=this,ul=$(obj).parent().find('ul#selected_container'),s=selector.getInstance(),idsArr=[],extraGet='';util.eraseCookie('selected_files');ul.find('li').each(function(){var id=$(this).attr('id').replace('file','');idsArr.push(id)});if(idsArr.length){extraGet='selected_files='+idsArr.join(',');util.createCookie('selected_files',extraGet)}s.showDataBrowser(extraGet,type_group_id)},removeFromSelector:function(id){var self=this,d=popupController.getPreviousPopup();if(d&&d.obj.id=="selected"){var obj=$(d.obj).find('li#'+id)[0];if(!obj)return false;util.detachElement(obj)}},findLost:function(message){s3.confirm(message,function(){popupController.closeLastPopup();openAjaxForm('/-/cms/v1/file/?act=find_lost&'+S3_ACCESS,function(r){},function(r){s3.reloadVisibleContent()})})},}})(jQuery);var CronController;(function($){CronController={tasksButton:'.tasks',tasksList:'.cron-tasks-list',deleteCronTask:function(obj,url){var self=this;s3.deleteObject(obj,'TR',url,function(){self.reloadCronPopup(self.tasksList)})},updateCronTask:function(obj,url){var self=this,cronList=$(obj).closest('.cron-tasks-list'),cronListMargin=parseInt(cronList.css('margin-left'))*(-1),cronListWidth=parseInt(cronList.innerWidth());s3.updateObject(obj,'TR','TABLE',url,function(){cronList.css({'margin-left':(parseInt(cronList.innerWidth())-cronListWidth+cronListMargin)*(-1)})})},clearCompleteCron:function(url){var self=this;s3.touchAndReload(url);self.reloadCronPopup(self.tasksList)},reloadCronPopup:function(obj){var self=this,process=$(obj).data('process'),cnt_span=$(obj).closest('.tasks').find('span.count span'),result;result=util.makeGetRequest('/-/cms/v1/cron-queue/?act=list&'+S3_ACCESS+'&process='+process);if(result&&!result.error){$(obj).removeAttr('style');$(obj).empty().html(result.text);var cronCount=$(result.text).data('count');if(!parseInt(cronCount)){cnt_span.parent().empty().remove()}else{cnt_span.text(parseInt(cronCount))}}},toggleCronHiddenItems:function(obj){var self=this,spanToggle=$(obj),textShow=spanToggle.data('text-show'),textHide=spanToggle.data('text-hide'),targetItems=$(spanToggle.data('target'));spanToggle.toggleClass('opened');if(spanToggle.hasClass('opened')){targetItems.show();spanToggle.text(textHide)}else{targetItems.hide();spanToggle.text(textShow)}}}})(jQuery);(function($){var hover_timeout;var keyup_timeout;var FormController=window.FormController={init:function(options){var self=this,win_scroll=$(window).scrollTop();self.anketa_id=parseInt(options.anketa_id);self.ver_id=parseInt(options.ver_id);self.main_box='#form-controls';self.form='#form_layout';self.field_box='.form-field-wrap';self.row_box='.form-row-wrap';self.row='.form-row';self.reorderButtons=$(self.form).find('#saveAnketaOrder');self.controlIds='';self.controls_box=$(self.main_box).find('.controls-wrap');self.is_locked=parseInt(options.locked);var dragObjects=$(self.controls_box).find(self.field_box);for(var i=0;i<dragObjects.length;i++){new DragObjectForm(dragObjects[i])};new DropTargetForm($(self.form).get(0));new DropTargetForm($(self.main_box).find('.dropTargetForm').get(0));$(self.main_box).find('.controls-box.active').find('.control-body').show();$(window).scroll(function(){if($(self.form).get(0)){var controls_pos=self.controls_box.offset().top+self.controls_box.height(),form_pos=$(self.form).offset().top+$(self.form).height();if($(this).scrollTop()>$(self.form).offset().top-15&&$(self.form).height()>self.controls_box.height()){if(!self.controls_box.addClass('fixed').prev('.controls-wrap-shadow').length){};if($(this).scrollTop()+$(this).height()>=form_pos&&controls_pos>=form_pos){self.controls_box.removeClass('fixed').addClass('absolute').css('top',$(self.form).height()-self.controls_box.height())}else{self.controls_box.removeClass('absolute').addClass('fixed').removeAttr('style')}}else{self.controls_box.removeClass('fixed').removeClass('absolute').removeAttr('style')}}});$(window).scrollTop(win_scroll-1)},updateTarget:function(){var self=this;if($(self.form).find('.anketa_control').size()){$(self.form).find('.form-target-message').hide()}else{$(self.form).find('.form-target-message').show()}},reorderControls:function(obj){var self=this,url='/-/cms/v1/anketa/?act=reorder_controls&ver_id='+self.ver_id+S3_ACCESS+'&anketa_id='+self.anketa_id;var result=s3.getElementsOrder('form_layout','DIV','control_');if(obj){$(self.form).find('div#'+obj.attr('id')).S3ChangeControls()}if(result.ids.length>0){var data="ids="+encodeURIComponent(result.ids.join())+"&levels="+encodeURIComponent(result.levels.join());var r=util.makePostRequest(url,data);if(r.error){util.msg("Error");return false}}$(self.form).removeClass('no-hover');$(self.form).find('.helper').remove();util.msg(s3.loc('JS_SAVED'));self.updateTarget();return true},dropItem:function(elem,event,new_field){var self=this,field_type,part,new_elem,new_field_form;new_elem=elem.removeClass('temp').removeAttr('style').show();field_type=new_elem.attr('data-field-type');part=self.getHoverPart(event);if(self.is_locked){s3.alert(s3.loc('ANKETA_LOCKED'));return}if(new_field){$.ajax({type:'GET',url:'/-/cms/v1/anketa/?act=edit_control&anketa_id='+self.anketa_id+'&ver_id='+self.ver_id+'&'+S3_ACCESS+'&type_id='+field_type+'&blind_create=1',dataType:'html',async:false,success:function(data){if(data){var result_data=$('<div>').html(data);new_field_form=$(result_data).find('#control_edit_form').serializeArray();$.ajax({type:"POST",url:'/-/cms/v1/anketa/?act=editing_control&'+S3_ACCESS,data:new_field_form,dataType:'html',async:false,success:function(field_data){if(field_data){if($(event.target).is(self.row_box)||$(event.target).is('.helper')||$(event.target).is('.form-target-message')||$(event.target).parent().is('.form-target-message')){var target=$(self.form).find(self.row_box);$(target).append($(field_data))}else if($(event.target).is('.dropTargetForm')){$(self.form).find(self.row_box).append($(field_data))}else{var target=$(event.target).parents(self.field_box);switch(part){case'top':$(field_data).insertBefore(target,null);break;default:$(field_data).insertAfter(target);break}}setTimeout(function(){self.reorderControls($(field_data))},10)}},error:function(){s3.alert(JS_ERROR)}})}},error:function(){s3.alert(JS_ERROR)}})}else{if($(event.target).is('.field-handle')){var target=$(event.target).parents(self.field_box);if(part=="top"){$(target).before(new_elem)}else if(part=="bottom"){$(target).after(new_elem)}}else{$(self.form).find(self.row_box).append(new_elem)}setTimeout(function(){self.reorderControls()},10)}},toggleControlsBox:function(elem){var self=this,parent_box=elem.parent('.controls-box');if(!parent_box.find('.control-body').is(':animated')){if(parent_box.hasClass('active')){parent_box.removeClass('active').find('.control-body').hide(300)}else{parent_box.addClass('active').find('.control-body').show(300)}}},getHoverPart:function(event){var self=this,elem=$(event.target),elem_size={'height':elem.height(),'width':elem.width(),},elem_pos={'left':elem.offset().left,'top':elem.offset().top,},curr_pos={'left':event.clientX,'top':event.clientY,},part=false;curr_pos.top+=$(document).scrollTop();if(curr_pos.top>=elem_pos.top&&curr_pos.top<=elem_pos.top+elem_size.height/4){part='top'}else{part='bottom'};return part},showHelper:function(event,element){var self=this;$(self.form).removeClass('no-hover');$(self.form).find('.helper').remove();if($(event.target).is('.field-handle')){var part=self.getHoverPart(event),target=$(event.target).parents(self.field_box);if(target.parents(self.form).length){$(self.form).find('.helper').remove();if(part=='top'){$(target).prepend('<div class="before-row helper"></div>')}else{$(target).append('<div class="after-row helper"></div>')}}}else{if($(self.form).find('.anketa_control').size()){$(self.form).find(self.row_box).append('<div class="after-row helper"></div>')}}},openContextMenu:function(cntMenu,event){var self=this,targetOffset=$(event.target).offset();S3ContextMenuController.openContextMenu(cntMenu,function(contextMenu){$(contextMenu).css({'left':event.pageX-targetOffset.left+5,'top':event.pageY-targetOffset.top+17,})})},toggleRefererInit:function(referer,button){var self=this,refererHeight=$(referer).innerHeight();if(refererHeight>60){$(button).css('display','block');$(referer).height(60).addClass('overflow')}$(button).on('click',function(){var buttonText=$(this).text(),buttonTextShow=$(this).data('show-text'),buttonTextHide=$(this).data('hide-text');if(buttonText==buttonTextShow){$(referer).css('height','auto');$(button).find('span').text(buttonTextHide)}else{$(referer).css('height','60px');$(button).find('span').text(buttonTextShow)};$(referer).toggleClass('overflow')})}};var FormdragMaster=(function(){var dragObject,mouseDownAt,currentDropTarget;function mouseDown(e){e=fixEvent(e);if(e.which!=1)return;mouseDownAt={x:e.pageX,y:e.pageY,element:this};addFormEventHandlers();return false};function mouseMove(e){e=fixEvent(e);if(mouseDownAt){if(Math.abs(mouseDownAt.x-e.pageX)<10&&Math.abs(mouseDownAt.y-e.pageY)<10){return false};var elem=mouseDownAt.element;dragObject=elem.dragObject;var mouseOffset={x:-10,y:$(window).scrollTop()-10};mouseDownAt=null;dragObject.onDragStart(mouseOffset)};dragObject.onDragMove(e.pageX,e.pageY,e);var newTarget=getCurrentTarget(e);if(currentDropTarget!=newTarget){if(currentDropTarget){currentDropTarget.onLeave()};if(newTarget){newTarget.onEnter()};currentDropTarget=newTarget};return false};function mouseUp(event){if(!dragObject){mouseDownAt=null}else{if(currentDropTarget){currentDropTarget.accept(dragObject);dragObject.onDragSuccess(currentDropTarget,event)}else{dragObject.onDragFail()};dragObject=null};$(FormController.form).find('.form-row-wrap').removeClass('dragging');$('.controls-wrap').find(FormController.field_box).removeClass('temp').removeAttr('style');$('.controls-wrap').find(FormController.row_box).removeClass('temp').removeAttr('style');$(FormController.form).find('.helper, .ghost, .temp').remove();$('.clone').remove();removeFormEventHandlers()}function getCurrentTarget(e){if(navigator.userAgent.match('MSIE')||navigator.userAgent.match('Gecko')){var x=e.clientX,y=e.clientY}else{var x=e.pageX,y=e.pageY};dragObject.hide();var elem=document.elementFromPoint(x,y);dragObject.show();while(elem){if(elem.dropTarget&&elem.dropTarget.canAccept(dragObject)){return elem.dropTarget};elem=elem.parentNode};return null};function addFormEventHandlers(){document.getElementById('form-controls').onmousemove=mouseMove;document.getElementById('form-controls').onmouseup=mouseUp;document.getElementById('form-controls').ondragstart=document.getElementById('form-controls').onselectstart=function(){return false}};function removeFormEventHandlers(){document.getElementById('form-controls').onmousemove=document.getElementById('form-controls').onmouseup=document.getElementById('form-controls').ondragstart=document.getElementById('form-controls').onselectstart=null};return{makeDraggable:function(element){element.onmousedown=mouseDown}}}());function DragObjectForm(element){element.dragObject=this;FormdragMaster.makeDraggable(element);var rememberPosition,mouseOffset;this.onDragStart=function(offset){var s=element.style;rememberPosition={top:s.top,left:s.left,position:s.position};s.position='fixed';S3ContextMenuController.closeContextMenu();$(FormController.form).addClass('no-hover');mouseOffset=offset;var clone=$(element).clone().addClass('clone');if($(element).hasClass('origin')){$(element).before(clone.removeAttr('style')).addClass('temp copy')}else{$(element).addClass('flying').before(clone.removeAttr('style').addClass('ghost'))};var result=s3.getElementsOrder('form_layout','DIV','control_');FormController.controlIds=result.ids};this.hide=function(){element.style.display='none'};this.show=function(){element.style.display=''};this.onDragMove=function(x,y,event){element.style.top=y-mouseOffset.y+'px';element.style.left=x-mouseOffset.x+'px';clearTimeout(hover_timeout);hover_timeout=setTimeout(function(){FormController.showHelper(event,element)},10)};this.onDragSuccess=function(dropTarget,event){var new_field=$(element).clone().removeClass('origin');if($(element).hasClass('origin')==false){element.remove();FormController.dropItem(new_field,event,false)}else{FormController.dropItem(new_field,event,true)};$(FormController.form).removeClass('no-hover');$(FormController.form).find(FormController.field_box).removeClass('flying')};this.onDragFail=function(dropTarget,event){var s=element.style;s.top=rememberPosition.top;s.left=rememberPosition.left;s.position=rememberPosition.position;$(FormController.form).removeClass('no-hover');$(FormController.form).find(FormController.field_box).removeClass('flying')};this.toString=function(){return element.id}};function DropTargetForm(element){element.dropTarget=this;this.canAccept=function(dragObject){return true};this.accept=function(dragObject){this.onLeave();dragObject.hide()};this.onLeave=function(){};this.onEnter=function(){};this.toString=function(){return element.id}};function fixEvent(e){e=e||window.event;if(e.pageX==null&&e.clientX!=null){var html=document.documentElement,body=document.body;e.pageX=e.clientX+(html&&html.scrollLeft||body&&body.scrollLeft||0)-(html.clientLeft||0);e.pageY=e.clientY+(html&&html.scrollTop||body&&body.scrollTop||0)-(html.clientTop||0)};if(!e.which&&e.button){e.which=e.button&1?1:(e.button&2?3:(e.button&4?2:0))};return e}})(jQuery);var Shop2Controller={};(function($){Shop2Controller={folder_id:false,product_ids:false,shop_id:false,checked:false,container:false,localStorageInit:function(){var self=this,productsList=$('table.products-list'),ls=LS.get('shop2_view_params'),viewParams=[];if(productsList.get(0)){if(!$.isEmptyObject(ls)){viewParams=ls.split(',')}else{viewParams=[]}if(viewParams.length>0){for(var i=0;i<=viewParams.length;i++){var label=$('.shop2-product-list-view-params').find('form>div.'+viewParams[i]).find('label.s3-cb');label.addClass('active');label.find('input').attr('checked','checked');switch(viewParams[i]){case'product_image':productsList.find('td.product-name').addClass('with-image');break;case'price_old':productsList.find('td.price').find('span.'+viewParams[i]).css('display','inline-block');productsList.find('th.price').find('span.'+viewParams[i]).css('display','inline-block')}productsList.find('th.'+viewParams[i]).addClass('view');productsList.find('td.'+viewParams[i]).addClass('view')}}}s3.keyFilter('input.keyfilter',0);util.createCookie('s3_shop_visited',1);$('header.s3-header-new .navbar a.hide__icon.shop2').find('span.s3-ico:first').remove()},checkAll:function(checkbox,folder_id,idPrefix){var self=this,checkbox=$(checkbox),label=checkbox.parent(),folder_id=(folder_id!=undefined)?parseInt(folder_id):undefined;if(!label.size())return false;if(typeof folder_id=='number'){self.folder_id=folder_id}else{self.folder_id=false}if(idPrefix){$('#shop2_products_container').attr('data-form','shop2_products_search_form')}else{$('#shop2_products_container').removeAttr('data-form')}label.checkboxClickFunction(null,true,null,folder_id)},_getContainer:function(idPrefix){return util.getObject(idPrefix+'container')},_getSearchForm:function(idPrefix){return util.getObject(idPrefix+'search_form')},_getSearchFormQuery:function(idPrefix){var f=this._getSearchForm(idPrefix);var q='';$.each(f.elements,function(k,v){if(/^s\[/.test(v.name)){q+='&'+encodeURIComponent(v.name)+'='+encodeURIComponent(v.value)}});return q},addProduct:function(shop_id,folder_id,object,wrapper,parent){var wrapper=$(object).closest(parent).find(wrapper),shop_id=s3.getInt(shop_id,0),folder_id=s3.getInt(folder_id,0),url='/-/cms/v1/shop2/product/?act=edit&'+S3_ACCESS+'&folder_id='+folder_id+'&shop_id='+shop_id;openAjaxForm(url,function(r){$(r.text).prependTo(wrapper).S3ChangeControls();popupController.closeLastPopup();treeController.reloadTree('.tree-wrapper');s3.reloadContent()},null,null)},editProduct:function(product_id,shop_id,folder_id,object,parent){var self=this,object=$(object).closest(parent),product_id=s3.getInt(product_id,0),shop_id=s3.getInt(shop_id,0),folder_id=s3.getInt(folder_id,0),url='/-/cms/v1/shop2/product/?act=edit&help=edit&'+S3_ACCESS+'&folder_id='+folder_id+'&shop_id='+shop_id+'&product_id='+product_id,nobject;openAjaxForm(url,function(r){var object=$('tr#shop2_product_'+product_id);$(r.text).insertAfter(object).S3ChangeControls();object.empty().remove();popupController.closeLastPopup();treeController.reloadTree('.tree-wrapper');self.updateProductKindsAfterEdit(object,product_id);self.localStorageInit();fadeController.init($(parent).get(0))},null,function(r){var p=popupController.getLastPopup();if(p&&p.obj){var form=$(p.obj).find('form:first');form.find('#kinds_items input.kind_was_modified').each(function(){var value=s3.getInt($(this).val());if(value){$(this).parents('tr:first').effect("highlight",{color:'#AAA'},2000)}})}var object=$('tr#shop2_product_'+product_id);$(r.text).insertAfter(object).S3ChangeControls();object.empty().remove();treeController.reloadTree('.tree-wrapper');self.updateProductKindsAfterEdit(object,product_id);self.localStorageInit();fadeController.init($(parent).get(0))})},copyProduct:function(product_id,shop_id,folder_id,object,parent,button,product_name){var self=this,object=$(object).closest(parent),product_id=s3.getInt(product_id,0),shop_id=s3.getInt(shop_id,0),folder_id=s3.getInt(folder_id,0),url='/-/cms/v1/shop2/product/?act=copy&'+S3_ACCESS+'&folder_id='+folder_id+'&shop_id='+shop_id+'&product_id='+product_id,nobject;if($(button).hasClass('disable'))return false;nobject=util.makePostRequest(url,'');if(nobject&&!nobject.error){$(nobject.text).insertBefore(object).S3ChangeControls();treeController.reloadTree('.tree-wrapper');var copy_message=s3.loc('JS_SHOP2_PRODUCT_COPY_MESSAGE');copy_message=copy_message.replace('%PRODUCT%',product_name);s3.alert(copy_message,false,'SHOP2_PRODUCT_COPY_MESSAGE');self.localStorageInit()}},deleteProduct:function(product_id,shop_id,object,parent,msg){var self=this,object=$(object).closest(parent),product_id=s3.getInt(product_id,0),shop_id=s3.getInt(shop_id,0),url='/-/cms/v1/shop2/product/?act=delete&'+S3_ACCESS+'&shop_id='+shop_id+'&product_id='+product_id,res;s3.confirm((msg?msg:JS_CONFIRM_DELETE),function(){res=util.makePostRequest(url,'');popupController.closeLastPopup();if(res.text=='OK'){object.empty().remove();s3.reloadContent()}})},editKind:function(product_id,kind_id,shop_id,object,parent){var self=this,product_id=s3.getInt(product_id,0),kind_id=s3.getInt(kind_id,0),shop_id=s3.getInt(shop_id,0),url='/-/cms/v1/shop2/product/?act=edit_kind&redesign=1&'+S3_ACCESS+'&kind_id='+kind_id+'&shop_id='+shop_id+'&product_id='+product_id,nobject;openAjaxForm(url,function(r){var object=$('tr.kind-'+kind_id+'.kind-product-id-'+product_id);var nextMeta=object.next();if(nextMeta.hasClass('shop2-product-meta')){$(nextMeta).remove()}nobject=$(r.text).insertAfter(object).show().S3ChangeControls();object.empty().remove();popupController.closeLastPopup();fadeController.init($('tr.kind-'+kind_id+'.kind-product-id-'+product_id).get(0));self.localStorageInit()},null,function(r){var object=$('tr.kind-'+kind_id+'.kind-product-id-'+product_id);var nextMeta=object.next();if(nextMeta.hasClass('shop2-product-meta')){$(nextMeta).empty().remove()}$(r.text).insertAfter(object.get(0)).show().S3ChangeControls();object.empty().remove();fadeController.init($('tr.kind-'+kind_id+'.kind-product-id-'+product_id).get(0));self.localStorageInit()})},copyKind:function(product_id,kind_id,shop_id,object,parent,func){var self=this,object=$(object).closest(parent),product_id=s3.getInt(product_id,0),kind_id=s3.getInt(kind_id,0),shop_id=s3.getInt(shop_id,0),url='/-/cms/v1/shop2/product/?act=copy_kind&redesign=1&'+S3_ACCESS+'&kind_id='+kind_id+'&shop_id='+shop_id+'&product_id='+product_id,res;res=util.makePostRequest(url,'');if(res&&!res.error){var nextMeta=object.next();if(nextMeta.hasClass('shop2-product-meta')){$(res.text).insertAfter(nextMeta).S3ChangeControls()}else{$(res.text).insertAfter(object).S3ChangeControls()}var count=parseInt($('tr.product-'+product_id).find('.shop2-product-modification-count').text());count++;$('tr.product-'+product_id).find('.shop2-product-modification-count').text(count);if(func)func();self.localStorageInit()}},deleteKind:function(product_id,kind_id,shop_id,object,parent,msg){var object=$(object).closest(parent),product_id=s3.getInt(product_id,0),kind_id=s3.getInt(kind_id,0),shop_id=s3.getInt(shop_id,0),url='/-/cms/v1/shop2/product/?act=delete_kind&'+S3_ACCESS+'&shop_id='+shop_id+'&kind_id='+kind_id+'&product_id='+product_id,res;s3.confirm((msg?msg:JS_CONFIRM_DELETE),function(){res=util.makePostRequest(url,'');popupController.closeLastPopup();var nextMeta=object.next();if(nextMeta.hasClass('shop2-product-meta')){$(nextMeta).remove()}object.empty().remove();var count=parseInt($('tr.product-'+product_id).find('.shop2-product-modification-count').text());if(count==1){$('tr.product-'+product_id).find('.shop2-product-modification-count').hide()}else{count--;$('tr.product-'+product_id).find('.shop2-product-modification-count').text(count)}})},editFolder:function(folder_id){var node=$.ui.dynatree.getNode($('.s3-tree .dynatree-node.folder-'+folder_id)),mode=node.data.mode||'browse',hidden=node.data.hidden||0,type_id=node.data.type_id||0,object_id=node.data.object_id||0,nodeIdPostfix=node.data.nodeIdPostfix||'',global_folder=0,locked=node.data.locked||0;if(locked>0&&!isStaffUser){s3.alert(s3.loc('JS_FOLDER_LOCKED'));return}treeController.edit(folder_id,object_id,type_id,global_folder,mode,hidden,null,nodeIdPostfix,true)},ajaxProductKinds:function(obj,shop_id,product_id,kind_id,parentTR){var self=this,spanButton=$(obj),parentTR=$(parentTR),shop_id=s3.getInt(shop_id,0),product_id=s3.getInt(product_id,0),kind_id=s3.getInt(kind_id,0),url='/-/cms/v1/shop2/?act=load_kinds&'+S3_ACCESS+'&shop_id='+shop_id+'&product_id='+product_id+'&kind_id='+kind_id,flag=(parentTR.hasClass('ajax'))?true:false;if(!flag){var r=util.makeGetRequest(url);if(r&&!r.error){$(r.text).insertAfter(parentTR);parentTR.addClass('ajax');$('#shop2_products_container').S3ChangeControls();self.localStorageInit()}}if(spanButton.hasClass('active')){spanButton.removeClass('active');$('#shop2_products_container').find('tr.kind-product-id-'+product_id).hide().addClass('hide-meta')}else{spanButton.addClass('active');$('#shop2_products_container').find('tr.kind-product-id-'+product_id).show().removeClass('hide-meta')}},_ajaxProductCardKinds:function(shop_id,product_id,all=false,limit=10){const removeGetButtons=()=>{$(`span.get_kinds`).remove()};const $table=$(`#kinds_items`),$tr=$table.find('tr'),offset=$tr.length;let url=`/-/cms/v1/shop2/product/?act=load_kinds&${S3_ACCESS}&shop_id=${shop_id}&product_id=${product_id}&offset=${offset}`;if(all){url+=`&is_all=1`}else{$tr.each(function(){url+=`&exception_kind_ids[]=${$(this).attr("setting-id")}`})};$table.closest('div').css('position','relative');Preloader.show({to:$table.closest('div')});$.get(url).done(function(content){content=content.substr(1);const $content=$(content),$tr=$content.find('#kinds_items tr');if(all){removeGetButtons();$table.find('tr').remove()}$tr.appendTo($table);$content.find('script').each(function(){const code=$(this).html();new Function('return '+code)();(1,eval)(code)});$tr.find('.s3-select').chosen();if($tr.length<limit){removeGetButtons()}Preloader.hide()}).fail(function(){Preloader.hide()})},ajaxProductCardKinds:function(shop_id,product_id,limit){this._ajaxProductCardKinds(shop_id,product_id,false,limit)},ajaxProductCardKindsAll:function(shop_id,product_id){this._ajaxProductCardKinds(shop_id,product_id,true)},updateProductKindsAfterEdit:function(object,product_id){var self=this,kindsCount=s3.getInt($(object).data('kinds-count'),0);if(kindsCount!=0){$(object).find('.shop2-product-modification-count').removeClass('active').text(kindsCount)}else{$(object).find('.shop2-product-modification-count').hide()}$('tr.kind-product-id-'+product_id).remove();$(object).removeClass('ajax')},toggleCustomFieldsByChangeFolder:function(event,searchType){const customFieldsContainerId=searchType?`shop2_search_custom_fields_${searchType}`:`shop2_search_custom_fields`;const value=event.target.value;const customFieldsContainer=document.getElementById(customFieldsContainerId);const $customFieldsContainer=$(customFieldsContainer);const url=`/-/cms/v1/shop2/product/?act=getCustomFields&${S3_ACCESS}&folder_id=${value}&redesign=true`;$customFieldsContainer.show();if(value){util.loadObject(customFieldsContainer,url);$customFieldsContainer.S3ChangeControls();$customFieldsContainer.find('input[type="text"]').toArray().forEach((input)=>{$(input).on('blur',function(){util.changeStyleControlIfValueASet(this)})})}else{$customFieldsContainer.find('.list-item-row').remove();$customFieldsContainer.find('.empty-block').css({'display':'flex'})}},shop2SearchFullClear:function(ctx){const form=util.getParent(ctx,'FORM');if(!form){console.warn('Форма для отчистки не найдена!');return}util.resetForm(form,true);$(form).find('select').each(function(){$(this).prop('selectedIndex',0).trigger('liszt:updated').trigger('change')});$(form).find('.s3-cb, .s3-rb').each(function(){$(this).S3changeCheckboxAndRadio()});$(form).find('input[type="text"]').each(function(){$(this).blur()})},shop2SearchFull:function(object){var self=this,inputValue=$.trim($(object).prev().find('input:first').val()),object=$(object).parents('.shop2-product-search-form-wrapper').find('.shop2-search-full-wrapper');object.addClass('opened');var searchPopup=object.find('.shop2-search-full');searchPopup.find('input.product-text-search').val(inputValue)},shop2SearchFullPopup:function(object){var self=this;var popupSearch=new PopupWindow('ajaxPopupWindow_'+popupController.popups.length),inputValue=$.trim($(object).prev().val());popupSearch.drag=true;popupSearch.modal=true;popupSearch.center=true;popupSearch.elemDiv=$('#popupSearch');function changeStyleControl(event){util.changeStyleControlIfValueASet(event.currentTarget)}popupSearch.onClose=function(){$(popupSearch.obj).find('input[type="text"]').toArray().forEach((input)=>{$(input).off('blur',changeStyleControl)});self.closeShop2SearchFullPopup($(popupSearch.obj).find('.shop2-search-full-wrapper'))};popupController.showPopup(popupSearch);$(popupSearch.obj).S3ChangeControls();$(popupSearch.obj).find('input[type="text"]').toArray().forEach((input)=>{$(input).on('blur',changeStyleControl)});$(popupSearch.obj).find('input.product-text-search').val(inputValue).trigger('blur');return popupSearch},closeShop2SearchFull:function(){$('.shop2-search-full-wrapper').removeClass('opened');$('.shop2_search_full').trigger('reset')},closeShop2SearchFullPopup:function(obj){$(obj).removeClass('popup');var append=$('<div id="popupSearch"></div>').append($(obj));var search=$('.shop2-product-search-form-wrapper').find('#popupSearch');if(search.get(0)){search.empty().remove()}$('.shop2-product-search-form-wrapper').append(append)},toggleGlobalField:function(object){$(object).parent().toggleClass('opened')},productListViewParams:function(form,shop_id){var self=this,formdata=$(form).serializeArray(),data='';LS.remove('shop2_view_params');$(formdata).each(function(index,obj){if(index==0){data+=obj.name}else{data+=','+obj.name}});LS.set('shop2_view_params',data);S3ContextMenuController.closeContextMenu();s3.reloadVisibleContent();return false},groupHide404:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=hide',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupEditing:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=edit&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;openAjaxForm(url+'&action=choose',function(r){s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&action=save',function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder,r.text)});self.folder_id=false},groupHideWithLink:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=hide_link',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupShow:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=show',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupDeleteProducts:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=delete&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url,null,'input',{checked:true},true,current_folder);self.folder_id=false},groupDeleteProductsFromFolder:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=delete_from_folder&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url,null,'input',{checked:true},true,current_folder);self.folder_id=false},groupProductsAddFlag:function(shop_id,flag_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&flag_id='+flag_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=add_flag',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupProductsRemoveFlag:function(shop_id,flag_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&flag_id='+flag_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=remove_flag',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupProductsAddMarketplace:function(shop_id,integration_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&integration_id='+integration_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=add_marketplace',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupProductsRemoveMarketplace:function(shop_id,integration_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&integration_id='+integration_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=remove_marketplace',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupProductsAddNew:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=new',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupProductsAddSpecial:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=special',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupProductsAddYml:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=yml&status=1',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupProductsResetNew:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=remove_new',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupProductsResetSpecial:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=remove_special',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupProductsResetYml:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=yml&status=0',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupChooseMainCategory:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=move&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;openAjaxForm(url+'&action=choose&mode_action=mark&popup=1',function(r){s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&action=mark_as_main&folder_id='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupMoveToCategory:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=move&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;openAjaxForm(url+'&action=choose&mode_action=move&popup=1',function(r){s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&action=set&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupCopyToCategory:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=move&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;openAjaxForm(url+'&action=choose&mode_action=add&popup=1',function(r){s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&action=append&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupResetCategory:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=move&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;openAjaxForm(url+'&action=choose&mode_action=delete&popup=1',function(r){s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&action=extract&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},true,current_folder)});self.folder_id=false},groupProductsSetAmount:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id,n=prompt('Введите число');if(n){n=Number(n);if(!isNaN(n)){s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=set_amount&amount='+n,null,'input',{checked:true},false,current_folder);self.folder_id=false}}},groupProductsAllowIndexing:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=noindex&noindex=0',null,'input',{checked:true},false,current_folder);self.folder_id=false},groupProductsDisallowIndexing:function(shop_id){var self=this,url='/-/cms/v1/shop2/product/group-operations/?act=status&shop_id='+shop_id+'&'+S3_ACCESS,current_folder=self.folder_id;s3.cronJobs(self._getContainer('shop2_products_'),'TR','shop2_product_',url+'&mode_action=noindex&noindex=1',null,'input',{checked:true},false,current_folder);self.folder_id=false},showPriceInputEdit:function(obj,flag){if(!flag){$(obj).next().val($(obj).text());var len=$(obj).next().val().length*2,kindInput=$(obj).next();$(obj).hide();$(kindInput).show().focus();kindInput[0].setSelectionRange(len,len);if(len<10){kindInput[0].style.width='25px'}}else{$(obj).hide();$(obj).prev().show()}},editProductPrice:function(obj,url,product_id,parent,kind_id){if(obj.nodeName=='INPUT'){var parentTR=$(obj).parents('tr:first'),self=this,modValues=[],nobject;parentTR.find('[data-kind^=price]').each(function(){var value=$.trim($(this).val())||0;if(parseFloat(value)>0){value=value.replace(/\s+/g,'');value.replace(',','.')}modValues.push(value)});if(kind_id){url+='&is_kind=1'}var res=util.makePostRequest(url,"&price="+modValues[0]+"&price_old="+modValues[1]+"&price2="+modValues[2]+"&price3="+modValues[3]);if(res&&!res.error){if(kind_id){var object=$('tr.kind-'+kind_id+'.kind-product-id-'+product_id);var nextMeta=object.next();if(nextMeta.hasClass('shop2-product-meta')){$(nextMeta).empty().remove()}$(res.text).insertAfter(object).S3ChangeControls();object.empty().remove();fadeController.init($('tr.kind-'+kind_id+'.kind-product-id-'+product_id).get(0))}else{var object=$('tr#shop2_product_'+product_id);$(res.text).insertAfter(object).S3ChangeControls();object.empty().remove();fadeController.init($(parent).not('.product-meta').get(0))}self.localStorageInit();util.msg(s3.loc('JS_CHANGES_SAVED'))}}},editProductAmount:function(obj,url){if(obj.nodeName=='INPUT'){var parent=$(obj).parents('tr:first'),self=this,modValues=[],amount,data={};amount=$.trim($(obj).val());data.amount=amount||0;$.ajax({url:url,data:data,type:"GET",dataType:'json',async:false,success:function(data){if(data.done){var kindField=$(obj).data('kind'),amount=data.kind[kindField],width=parseInt(data.kind[kindField].toString().length)*7,parentTr=$(obj).parents('tr:first');$(obj).prev().text(amount);$(obj).val(amount);$(obj).prev().css('width',width);$(obj).css('width',width);self.showPriceInputEdit(obj,true);if(parseFloat(amount)>0){$(obj).parents('td:first').find('>.s3-ico').hide()}else{$(obj).parents('td:first').find('>.s3-ico').show()}util.msg(s3.loc('JS_CHANGES_SAVED'))}},error:function(){s3.alert('Error');$(obj).prev().text($(obj).val())}})}},openModalPopup:function(url,reload,postParams){var popup=new PopupWindow('ajaxPopupWindow_'+popupController.popups.length);popup.url=url;popup.postParams=postParams;popup.drag=true;popup.modal=true;popup.center=true;if(reload)popup.onClose=function(){s3.reloadVisibleContent()};popupController.showPopup(popup);return popup},loadRefs:function(event,object,ref_id,ref_code,multi,in_product){var self=this,ref_id=s3.getInt(ref_id,0),parent=$(object).parents('.list-item-row:first'),container=parent.find('#shop2_search_custom_color_ref_'+ref_code),url='/-/cms/v1/shop2/reference/?act=get_ref_items&'+S3_ACCESS+'&ref_id='+ref_id+'&code='+ref_code,data={},selected='',res;if(multi){url+='&multi=true'};if(in_product){url+='&in_product='+in_product}var selected=$(object).find('input.color-ref-selected').get(0);if(selected){selected=selected.value};if($(parent).hasClass('opened')){$(parent).removeClass('opened');return false};if(!$(parent).hasClass('ajax')){Preloader.show({mini:true});res=util.makePostRequest(url,"selected="+selected);if(res&&!res.error){container.find('.color-ref-selected').empty().remove();container.append(res.text);$(parent).addClass('opened ajax');Preloader.hide()}}else{$(parent).addClass('opened')}return false},setProductPosition:function(url,form){var self=this,r=util.makePostRequest(url,formcontents(form));if(r&&!r.error){popupController.closeLastPopup();setTimeout(function(){s3.reloadVisibleContent()},800)};return false},openContextMenu:function(obj,kind_id,product_id){var self=this,targetOffset=$(obj).offset(),cntMenu=$(obj).parents('.shop2-wrapper:first').find('.shop2-product-element-ids'),spanKindId="<span class='s3-clipboard-btn no-icon' data-clipboard-text='"+kind_id+"'>"+kind_id+"</span>",spanProductId="<span class='s3-clipboard-btn no-icon' data-clipboard-text='"+product_id+"'>"+product_id+"</span>";S3ContextMenuController.closeContextMenu();S3ContextMenuController.openContextMenu(cntMenu,function(contextMenu){$(contextMenu).css({'top':targetOffset.top+21,'left':targetOffset.left});$(contextMenu).find('.name.kind-id').html(spanKindId);$(contextMenu).find('.name.product-id').html(spanProductId);$(contextMenu).find('.s3-clipboard-btn').each(function(){var clipboardBtn=$(this).get(0),successText=$(this).attr('data-clipboard-success-text')||JS_COPIED+": \""+$(this).attr('data-clipboard-text')+"\"",onSuccess=function(){util.msg(successText)};s3.clipboard(clipboardBtn,onSuccess)})},null,obj)},printMpDeliveryLabels:function(order_id){window.open('/-/cms/v1/shop2/order/marketplace/?'+S3_ACCESS+'&act=delivery_labels&order_id='+order_id,'_blank')},openAddProductPopup:function(shopId,folderId){const url='/-/cms/v1/shop2/product/?act=edit&'+S3_ACCESS+'&shop_id='+shopId+'&folder_id='+folderId;const onDomAfterChangedHandler=()=>{const loadObjectUrl='/-/cms/v1/shop2/?act=status&'+S3_ACCESS+'&shop_id='+shopId+'&folder_id='+folderId+'&target=product_amount';util.loadObject('shop2-product-amount',loadObjectUrl);if(popupController.popups.length>1){const previousPopup=popupController.getPreviousPopup();const previousPopupUrl=previousPopup.url+'&add_product=1';popupController.reloadPreviousPopup(previousPopupUrl);return}const original=historyController.loadByHistory;historyController.loadByHistory=true;s3.reloadContent(false,{'add_product':1});historyController.loadByHistory=original};s3.editObject(null,'TR','shop2_products_container',url,onDomAfterChangedHandler,true)},productSelectionModal:{containerWidgetId:'ProductSelectionModal',isProductSelectionWidgetLoaded:false,storageSearchId:'storageSearch',overlayId:'modal_layer',openSearchModal:function(){const storageSearch=document.getElementById(this.storageSearchId);const overlay=document.getElementById(this.overlayId);const popupSearch=new PopupWindow('ajaxPopupWindow_'+popupController.popups.length);if(!storageSearch){popupSearch.url='/-/cms/v1/shop2/product/?act=getSearchForm&search_type=select&popup=1&'+S3_ACCESS}else{popupSearch.elemDiv=storageSearch.querySelector('.popup')}popupSearch.drag=true;popupSearch.modal=true;popupSearch.center=true;popupSearch.onClose=()=>{const popupContent=popupSearch.obj.querySelector('.popup');if(storageSearch){storageSearch.append(popupContent)}else{const newStorageSearch=document.createElement('div');newStorageSearch.id=this.storageSearchId;newStorageSearch.style.display='none';newStorageSearch.append(popupContent);document.body.append(newStorageSearch)}setTimeout(()=>{overlay.style.zIndex=`${+overlay.style.zIndex+2}`},0)};popupController.showPopup(popupSearch);const buttonSearch=popupSearch.obj.getElementsByTagName('button')[0];const formSearch=popupSearch.obj.getElementsByTagName('form')[0];if(!storageSearch){buttonSearch.addEventListener('click',(event)=>{event.preventDefault();const formData=formParamsHelpers.getFormData(formSearch);const formDataObject=formParamsHelpers.convertFormDataToObject(formData);delete formDataObject['ver_id'];delete formDataObject['access'];ProductSelectionModalWidget.onFullSearchButtonClick(formDataObject);popupController.closeLastPopup()})}popupSearch.obj.style.zIndex=`${+popupSearch.obj.style.zIndex+2}`;overlay.style.zIndex=`${+overlay.style.zIndex+2}`},openInDiscountGift:function(formName){const idList=`#${formName}_gift`;function addItem(items){if(items.length<1){return}const item=items[0];const productData={productId:item.productId,article:item.article,price:item.price,disableBadge:true,};ListSelectedItemsController.addItem(item.kindId,item.name,'gift',idList,productData,true);Shop2Controller.productSelectionModal.close()}function open(){ProductSelectionModalWidget.open({isOnlyOneProductSelect:true,isOnlyProducts:false,limit:0,kindsIdsAdded:[],productsIdsAdded:[],addFn:addItem,})}this.load(open)},openInBlocksOnMain:function(containerId){let selectedProductIds=[];let selectedKindIds=[];$(containerId).find('input[name="objects[]"]').toArray().forEach((elem)=>{const value=elem.value.split('_');if(value[0]==='kind'){selectedKindIds.push(+value[1])}else if(value[0]==='product'){selectedProductIds.push(+value[1])}});function addItems(items){items.forEach((item)=>{const id=item.productId!==item.kindId?item.kindId:item.productId;const productData={productId:item.productId,article:item.article,price:item.price,disableBadge:false,};ListSelectedItemsController.addItem(id,item.name,'objects[]',containerId,productData)})}function open(){ProductSelectionModalWidget.open({isOnlyOneProductSelect:false,isOnlyProducts:false,limit:0,kindsIdsAdded:selectedKindIds,productsIdsAdded:selectedProductIds,addFn:addItems,})}this.load(open)},openInCollect:function(collectId,type,page,subId){const containerParentId=`collection_${collectId}_${type}_${collectId}_parent`;const containerChildId=`collection_${collectId}_${type}_${collectId}_child`;const selectedParentProductIds=$(`#${containerParentId}`).find('a').toArray().map((elem)=>+elem.dataset.objectId);const selectedChildProductIds=$(`#${containerChildId}`).find('a').toArray().map((elem)=>+elem.dataset.objectId);function addItems(items){const productsIds=items.map((item)=>item.productId);const url=`/-/cms/v1/shop2/collect/?${S3_ACCESS}&type=${type}&collect_id=${collectId}&sub_id=${subId}&act=add_product_group`;const res=util.makePostRequest(url,'product_ids='+productsIds.join(','));if(res&&!res.error){util.msg(s3.loc('JS_ADDED'));Shop2Controller.collect.loadCurrentCollectTab(type,'',parseInt(page));Shop2Controller.productSelectionModal.close()}else{s3.alert(res.text)}}function open(){ProductSelectionModalWidget.open({isOnlyOneProductSelect:false,isOnlyProducts:true,limit:0,kindsIdsAdded:[],productsIdsAdded:[...selectedParentProductIds,...selectedChildProductIds],addFn:addItems,})}this.load(open)},open:function(formName,limit=0,isPromo=false){let selectedProductIds=[];let selectedKindIds=[];let idList=`#${formName}_products`;if(isPromo){idList=`#${formName}_promo_products`;selectedProductIds=$(idList).find('input[name="promo_products[]"]').toArray().map((input)=>+input.value);selectedKindIds=$(idList).find('input[name="promo_kinds[]"]').toArray().map((input)=>+input.value)}else{selectedProductIds=$(idList).find('input[name="products[]"]').toArray().map((input)=>+input.value);selectedKindIds=$(idList).find('input[name="kinds[]"]').toArray().map((input)=>+input.value)}function addItems(items){items.forEach((item)=>{const type=isPromo?'promo':'';const kindId=item.productId!==item.kindId?item.kindId:0;if(kindId===0){$(idList+' .pp_product'+item.productId).click()}Shop2Controller.discount.appendItem(item.productId,kindId,item.name,item.price,item.article,null,null,formName,type)})}function open(){ProductSelectionModalWidget.open({isOnlyOneProductSelect:false,isOnlyProducts:false,limit:+limit,kindsIdsAdded:selectedKindIds,productsIdsAdded:selectedProductIds,addFn:addItems,})}this.load(open)},load:function(openCallback){ProductSelectionModalWidget.manager.setWidgetProps(this.containerWidgetId,{onClose:this.close});ProductSelectionModalWidget.manager.mountWidget(this.containerWidgetId);if(this.isProductSelectionWidgetLoaded){openCallback();return}const unsubscribe=EventBus.subscribe('loaded-widget-select-product',()=>{openCallback();this.isProductSelectionWidgetLoaded=true;unsubscribe()})},close:function(){ProductSelectionModalWidget.manager.unmountWidget(Shop2Controller.productSelectionModal.containerWidgetId);const storageSearch=document.getElementById(Shop2Controller.productSelectionModal.storageSearchId);if(storageSearch){storageSearch.remove()}}},discount:{baseUrl:'/-/cms/v1/shop2/discount/?'+S3_ACCESS,saveOrEdit:function(f,act,shopId,discountId=0){let url=this.baseUrl+'&popup=1&act='+act+'&shop_id='+shopId;if(discountId){url+='&discount_id='+discountId}if(_processing_post_ajax_form){return false}_processing_post_ajax_form=1;util.makeAsynchPostRequest(url,formcontents(f),function(rr){const firstChar=rr.data.charAt(0);if(firstChar=='2'){popupController.reloadPreviousPopup(false);popupController.closeLastPopup()}else{const text=rr.data.substring(1,rr.data.length);s3.alertHTML(text)}});window.setTimeout('_processing_post_ajax_form = 0',0);return false},openAddDiscountModal:function(shopId,type){const url=this.baseUrl+'&popup=1&act='+type+'&shop_id='+shopId;popupController.closeLastPopup();openAjaxForm(url)},openAddMenu:function(){const url=this.baseUrl+'&act=addMenu';s3.openModalPopup(url)},openEditModal:function(discountId,shopId,popup=0){const url=this.baseUrl+'&act=edit&discount_id='+discountId+'&shop_id='+shopId+'&popup='+popup;openAjaxForm(url);return false},removeItemList:function(ctx,discountId,shopId,popup=0){const url=this.baseUrl+'&act=del&discount_id='+discountId+'&shop_id='+shopId+'&popup='+popup;s3.deleteObject(ctx,'TR',url);return false},changeStatus:function(discountId,status,msgAfter){const url=this.baseUrl+'&act=status';const data={'discount_id':discountId,'status':status?1:0};$.post(url,data,function(){util.msg(msgAfter)})},discountSelectProduct:function(container,form_name,currency,type){var self=this,all_products=$('#'+container).parent().find('.checked-all-wcond').hasClass('active');if(all_products){var search_params=$('#'+container).parent().parent().parent().find('[name^="s["]').serialize();$.ajax({url:"/-/cms/v2/shop2/product/?act=search&"+S3_ACCESS,dataType:"JSON",data:{s:search_params,type:"json",limit:2000},success:(products)=>{$.each(products,function(kindid,product){var has_kinds=product.kinds_count>1,product_id=product.product_id,prod=$('#product'+product_id),kind_id=has_kinds&&prod?prod.val():0,price=product.price+' '+currency;Shop2Controller.discount.appendItem(product_id,kind_id,product.name,price,product.article,has_kinds,'',form_name,type)})}})}else{var checked_inputs=$('#'+container+' li input:checked');if(!checked_inputs.length){s3.alert(s3.loc('JS_NO_OBJECTS_CHOSEN_ERROR'));return}checked_inputs.each(function(){var elem=$(this),has_kinds=elem.parent().parent().parent().find('select').length,product_id=elem.val(),prod=type==="promo"?$('#promo_product'+product_id):$('#product'+product_id),name=elem.parent().parent().parent().find('.objectName').text(),data=has_kinds?$('option:selected',prod).data():prod.data(),price=data.price+' '+currency,article=data.article?data.article:'',kind_id=has_kinds?prod.val():0;if(!has_kinds){var parentEl=$('#shop2_collect_product_'+product_id);parentEl.find('.checkbox').remove();parentEl.addClass('active');parentEl.find('.action').remove();parentEl.prepend('<span class="action" style="float: right; color: #777777;">'+s3.loc('JS_ADDED')+'</span>')}else{if(!parseInt(kind_id)){var wrap=type==='promo'?form_name+'_promo_products':form_name+'_products';$('#'+wrap+' .pp_product'+product_id).click();$('#product'+product_id+' option').prop('disabled',true)}}Shop2Controller.discount.appendItem(product_id,kind_id,name,price,article,has_kinds,prod,form_name,type)})}return false},appendItem:function(product_id,kind_id,name,price,article,has_kinds,prod,form_name,type){let id;let nameInput;if(kind_id>0){id=kind_id;nameInput=type==='promo'?'promo_kinds[]':'kinds[]'}else{id=product_id;nameInput=type==='promo'?'promo_products[]':'products[]'}let idListContainer;if(type==="promo"){idListContainer='#'+form_name+'_promo_products'}else{idListContainer='#'+form_name+'_products'}ListSelectedItemsController.addItem(id,name,nameInput,idListContainer,{price,article,productId:product_id})},selectProductGiftInDiscountGift:function(productId,formName){const idListContainer='#'+formName+'_gift';let addedElement=document.getElementById('product'+productId);let addedElementName=$(addedElement.closest('li')).find('.objectName').text();if(addedElement.options){addedElement=addedElement.options[addedElement.selectedIndex];addedElementName=$(addedElement.closest('li')).find('ul').find('li[data-id="'+ +addedElement.value+'"]').text()}const productData={productId:productId,article:addedElement.dataset.article,price:addedElement.dataset.price,disableBadge:true,};ListSelectedItemsController.addItem(addedElement.value,addedElementName.toString(),'gift',idListContainer,productData,true);popupController.closeLastPopup()}},collect:{loadCurrentCollectTab:function(tab,product_id,page){$.post('/-/cms/v1/shop2/collect/?act=all_collects&&type='+tab+'&view=1&p['+tab+']='+parseInt(page)+'&product_id='+product_id+'&'+S3_ACCESS,'',function(data){$('#'+tab+'_block').html(data)})},addProductToCollect:function(container,type,url,product_id,page){var self=this,collect_products,all_products=$('#'+container).parent().find('.checked-all-wcond').hasClass('active'),search_params='';url+='&act=add_product_group';container=util.getObject(container);collect_products=s3.getBatchOpInfo(container,'LI','shop2_collect_product_','',null,'input',{checked:true});if(!collect_products.ids.length){s3.alert(s3.loc('JS_NO_OBJECTS_CHOSEN_ERROR'));return}if(all_products){search_params=$('.shop2_search_product-'+type).parent().find('[name^="s["]').serialize()}var res=util.makePostRequest(url,'product_ids='+collect_products.ids+search_params+'&all_products='+all_products);if(res&&!res.error){popupController.closeLastPopup();util.msg(s3.loc('JS_ADDED'));Shop2Controller.collect.loadCurrentCollectTab(type,product_id,parseInt(page))}else{s3.alert(res.text)}},markProduct:function(obj){var parent=$(obj).parents('.collect-items-block:first');$(obj).toggleClass('delete');if(parent.find('.shop2-collect-product.delete').size()){parent.find('.btns').addClass('show')}else{parent.find('.btns').removeClass('show')}},markCollectItem:function(obj){var parent=$(obj).parents('.collect-items-block:first');$(obj).toggleClass('delete');if(parent.find('.shop2-collect-remove-item.delete').size()){parent.find('.btns').addClass('show')}else{parent.find('.btns').removeClass('show')}},deleteProducts:function(obj,type,collect_id,product_id,page){var parent=$(obj).parents('.collect-items-block:first'),product_ids=[],url='/-/cms/v1/shop2/collect/?'+S3_ACCESS+'&act=del_product_group&type='+type+'&collect_id='+collect_id;parent.find('.shop2-collect-product.delete').each(function(){var elem=$(this),id=$(elem).data('object-id');product_ids.push(id)});if(!product_ids.length){s3.alert(s3.loc('JS_NO_OBJECTS_CHOSEN_ERROR'));return}s3.confirm(s3.loc('JS_COLLECT_DELETE_PRODUCTS'),function(){var confirm=$(popupController.getLastPopup().obj).attr('id')=='confirm',res=util.makePostRequest(url,'ids='+product_ids.join(','));if(confirm){popupController.closeLastPopup()}if(res.text==='OK'){Shop2Controller.collect.loadCurrentCollectTab(type,product_id,parseInt(page))}})},deleteFolders:function(obj,type,collect_id,relation,product_id,page){var parent=$(obj).parents('.collect-items-block:first'),folder_ids=[],url='/-/cms/v1/shop2/collect/?'+S3_ACCESS+'&act=del_folder_group&type='+type+'&collect_id='+collect_id+"&relation="+relation;parent.find('.shop2-collect-folder.delete').each(function(){var elem=$(this),id=$(elem).data('folder-id');folder_ids.push(id)});if(!folder_ids.length){s3.alert(s3.loc('JS_NO_OBJECTS_CHOSEN_ERROR'));return}s3.confirm(s3.loc('JS_COLLECT_DELETE_FOLDERS'),function(){var confirm=$(popupController.getLastPopup().obj).attr('id')==='confirm',res=util.makePostRequest(url,'ids='+folder_ids.join(','));if(confirm){popupController.closeLastPopup()}if(res.text==='OK'){Shop2Controller.collect.loadCurrentCollectTab(type,product_id,parseInt(page))}})},},delivery:{baseUrl:'/-/cms/v1/shop2/delivery/?'+S3_ACCESS,init:function(){var self=this;$('#delivery-form').append($('<script>').attr('src','/shared/shop2/shop2.edost.regions.js'));$("#address").suggestions({serviceUrl:"/-/cms/v1/shop2/delivery/deligate/?act=suggest_address&"+S3_ACCESS,type:"ADDRESS",onSelect:function(suggestion){var name=suggestion.value;$.ajax({url:"/-/cms/v1/shop2/delivery/deligate/?act=suggest_address&"+S3_ACCESS,type:'POST',dataType:'json',data:JSON.stringify({query:name,count:1}),success:function(suggestion){$("#dadata").val(JSON.stringify(suggestion.result.suggestions[0].data))}})}});self.initEdost()},initEdost:function(){var self=this,p=popupController.getLastPopup().obj;if(!window.shop2EdostRegions){return}var $country=$(p).find('#shop2-edost2-country');var countryDef=$country.html();var $region=$(p).find('#shop2-edost2-region');var regionDef=$region.html();var $city=$(p).find('#shop2-edost2-city');var cityDef=$city.html();var $to=$(p).find('#shop2-edost2-to');var list;if($country.length){list=$.grep(shop2EdostRegions,function(item){return item.is_country});$country.html(countryDef+makeHTML(list));hide($region);hide($city);$country.on('change',function(){var country=$(this).val();if($region.length){list=$.grep(shop2EdostRegions,function(item){return item.is_region&&item.country==country});$region.html(regionDef+makeHTML(list));if(list.length==0){hide($region);hide($city);$to.val(country)}else{show($region);$to.val('')}}else if($city.length){list=$.grep(shop2EdostRegions,function(item){return item.is_city&&item.country==country});$city.html(cityDef+makeHTML(list));if(list.length==0){hide($city);$to.val(country)}else{show($city);$to.val('')}}else{$to.val(country)}})}if($region.length){if(!$country.length){list=$.grep(shop2EdostRegions,function(item){return item.is_region});$region.html(regionDef+makeHTML(list));hide($city)}$region.on('change',function(){var region=$(this).val();list=$.grep(shop2EdostRegions,function(item){return item.is_city&&item.region==region});$city.html(cityDef+makeHTML(list));if(list.length==0){hide($city);$to.val(region)}else{show($city);$to.val(region)}})}if(!$country.length&&!$region.length){list=$.grep(shop2EdostRegions,function(item){return item.is_city});$city.html(cityDef+makeHTML(list))}$city.on('change',function(){var val=$(this).val();if(val=='default'){if($region.length){$to.val($region.val())}}else{$to.val(val)}});var countryValue=$country.data('value');var regionValue=$region.data('value');var cityValue=$city.data('value');if(countryValue){$country.val(countryValue).trigger('change')}if(regionValue){$region.val(regionValue).trigger('change')}if(cityValue){$city.val(cityValue).trigger('change')}function makeHTML(arr){var html=$.map(arr,function(item){return'<option value="'+item.id+'">'+item.name+'</option>'});return html.join('')}function hide($el){$el.html('').closest('.option-item').addClass('hide')}function show($el){$el.closest('.option-item').removeClass('hide')}},deligateCalc:function(url){var self=this,data={},delivery=$('#shop2-delivery-edit');Preloader.show();$('#shop2-perfect-form').find('input, textearea, select').each(function(){var $this=$(this);if(this.tagName==='INPUT'&&this.type==='checkbox'){if(this.checked){data[this.name]='on'}}else{data[this.name]=$(this).val()}});$.ajax({url:url,type:'post',data:data,success:function(result){Preloader.hide();var deliveryContentDiv=$(util.getElementFromText(result,'DIV')).find('#shop2-delivery-edit');$(delivery).html(deliveryContentDiv.html()).S3ChangeControls();self.init()},error:function(result){Preloader.hide()}})},addNewDelivery:function(shopId,deliveryId){const url=this.baseUrl+'&act=item&popup=1&shop_id='+shopId+'&delivery_id='+deliveryId;s3.updateObject(null,'LI','delivery_attached',url,function(){popupController.closeLastPopup()})},openPopupMenuAddingOfDeliveries:function(shopId){const url=this.baseUrl+'&act=add&popup=1&shop_id='+shopId;s3.editObject(null,'LI','delivery_attached',url,false,true)},requestEnabledDelivery:function(delivery){const url=this.baseUrl+'&act=request_enable&popup=1&delivery='+delivery;$.ajax({url:url,success:function(result){s3.alert(result,function(){popupController.reloadLastPopup()})}})}},importCml:{toggleTabs:function(obj,id){var tabBlockContent=$('.tabs-block-content'),tabsDiv=tabBlockContent.find('>div'),tabIdActive=id;if($(obj).hasClass('disabled'))return false;tabsDiv.addClass('hide');$(tabIdActive).removeClass('hide');$(obj).siblings().removeClass('active');$(obj).addClass('active')},connectReload:function(){}},folder:{additionalSettings:function(shop_id,action,obj){var self=this,url='/-/cms/v1/shop2/select/folder-filter/?act=settings&'+S3_ACCESS+'&shop_id='+shop_id+'&action='+action,form=util.getParent(obj,'FORM'),filter=form.json_meta.value.replace(/\&/g,'%26').replace(/\&amp;/g,'%26');url=url+'&s='+filter;openAjaxForm(url,function(r){popupController.closeLastPopup();var p=popupController.getLastPopup();if(p.obj){var textarea=$(p.obj).find('#json_meta');textarea.text(r.text);textarea.val(r.text)}},null,function(r){})},folderFilterAddParam:function(ver_id,shop_id,param){var self=this,url='/-/cms/v1/shop2/select/folder-filter/?act=get_entity_list&'+S3_ACCESS+'&shop_id='+shop_id+'&param='+param+'&popup=1';Shop2Controller.openModalPopup(url,false)},addParam:function(id,name,param){var self=this,p=popupController.getPreviousPopup(),input_name=(param=="folder")?"s":"",input='<input type="hidden" name="s[_'+param+'_id'+input_name+'][]" value="'+id+'">',element='<li class="param_id_'+id+'"><span class="title"><span class="name">'+name+'</span></span><span class="remove" onclick="Shop2Controller.folder.delParam(this.parentNode)"><span class="s3-ico i-delete-svg"></span></span>'+input+'</li>';if(p.obj){var objectList=$(p.obj).find('#objectEdit'+param+'List');if(objectList){if(objectList.find('li.param_id_'+id).get(0)){s3.alert(s3.loc('SHOP2_JSON_FILTER_ITEM_IN_LIST'));return false}else{objectList.append(element)}}}},delParam:function(obj){var self=this;$(obj).empty().remove()},addHTMLRef:function(ref_id,shop_id){var self=this,url='/-/cms/v1/shop2/select/folder-filter/?act=get_reference&'+S3_ACCESS+'&shop_id='+shop_id+'&ref_id='+ref_id,p=popupController.getPreviousPopup();if(p.obj){var objectList=$(p.obj).find('#filter-custom-fields');if(objectList){if(objectList.find('div.filter-reference-'+ref_id).get(0)){s3.alert(s3.loc('SHOP2_JSON_FILTER_ITEM_IN_LIST'));return false}else{var result=util.makeGetRequest(url);if(result&&result.text){objectList.append(result.text);$(objectList).S3ChangeControls()}}}}}},settingsBlocksOnMain:{containerName:'',$container:null,amount:0,limit:0,baseUrl:'/-/cms/v1/shop2/block/?'+S3_ACCESS,init:function(containerName,limit,amount){this.containerName=containerName;this.$container=$('#'+containerName);this.limit=limit;this.amount=amount;this.$container.sortable({cursor:"move",placeholder:"s3_sortable_placeholder",items:'li:not(.controls)'})},openMenuAddNewBlock:function(){if(this.amount>=this.limit){return s3.alert(s3.loc('JS_BLOCKS_LIMIT').replace('%1','<strong>'+this.limit+'</strong>'))}const url=this.baseUrl+'&act=add_menu';s3.openModalPopup(url)},openAddNewBlockPopup:function(blockType){const url=this.baseUrl+'&act=add&block_type='+blockType;popupController.closeLastPopup();s3.editObject(null,'LI',this.containerName,url)},editBlock:function(ctx,blockId,blockType){const url=this.baseUrl+'&act=edit&block_id='+blockId+'&block_type='+blockType;s3.editObject(ctx,'LI',this.containerName,url,false)},deleteBlock:function(ctx,blockId){const self=this;const url=this.baseUrl+'&act=del&block_id='+blockId;function deleteCallbackHandler(){self.amount--}s3.deleteObject(ctx,'LI',url,deleteCallbackHandler,null)},openChoiceOfAddingProductsToBlock:function(idContainer,blockId){const productIds=[];const kindIds=[];const inputs=$(idContainer).find('input').toArray();for(let i=0;i<=inputs.length-1;i++){const[prefix,id]=inputs[i].value.split('_');if(prefix==='product'){productIds.push(id)}else if(prefix==='kind'){kindIds.push(id)}}const url='/-/cms/v1/shop2/select/product/?'+S3_ACCESS+'&act=selprod_blocks&popup=1'+'&block_id='+blockId+'&ff='+idContainer.replace('#','').replace('_products','')+'&product_ids='+productIds.join()+'&kind_ids='+kindIds.join();openAjaxForm(url)},changeVisibility:function(ctx,blockId,shopId){const url=this.baseUrl+'&act=toggle_hidden&block_id='+blockId+'&shop_id='+shopId;s3.updateObject(ctx,'LI',this.containerName,url)},addProductsToBlock:function(idContainer,formName,currency){const idListContainer='#'+formName;const isAllProducts=$(idContainer).closest('form').find('.checked-all-wcond').hasClass('active');if(isAllProducts){const searchParams=$(idContainer).closest('td').find('[name^="s["]').serialize();const successHandler=(products)=>{function addProduct(_,product){const price=product.price+' '+currency;const productData={productId:product.product_id,price:price,article:product.article,hidden:product.hidden,disableBadge:false,};ListSelectedItemsController.addItem(product.product_id,product.name,'objects[]',idListContainer,productData)}$.each(products,addProduct)};$.ajax({url:"/-/cms/v2/shop2/product/?act=search&"+S3_ACCESS,dataType:"JSON",data:{s:searchParams,type:"json",limit:2000},success:successHandler,});return}const checkedInputs=$(idContainer+' li input:checked').toArray();if(!checkedInputs.length){const msg=s3.loc('JS_NO_OBJECTS_CHOSEN_ERROR');s3.alert(msg);return}function addProduct(checkedInput){const element=$(checkedInput);const productId=element.val();const kindsSelectOrProductInput=$('#product'+productId);const hasKinds=Boolean(element.closest('li').find('select').length);const name=element.closest('li').find('.objectName').text();const dataAttrs=hasKinds?$('option:selected',kindsSelectOrProductInput).data():kindsSelectOrProductInput.data();const price=dataAttrs.price?dataAttrs.price+' '+currency:'';const article=dataAttrs.article?dataAttrs.article:'';const kindId=hasKinds?+kindsSelectOrProductInput.val():0;const id=kindId?kindId:productId;const productData={productId:productId,article:article,price:price,disableBadge:false,};if(!hasKinds){const elementLi=$('#shop2_collect_product_'+productId);elementLi.find('.checkbox').remove();elementLi.addClass('active').prepend('<span class="action" style="float: right; color: #777777;">'+s3.loc('JS_ADDED')+'</span>')}else if(!kindId){$(idListContainer+' .pp_product'+productId).click();$('#product'+productId+' option').prop('disabled',true)}ListSelectedItemsController.addItem(id,name,'objects[]',idListContainer,productData);if(kindId>0){$('option:selected',kindsSelectOrProductInput).prop('disabled',true);kindsSelectOrProductInput.val('0')}}checkedInputs.forEach(addProduct)}},suppliers:{containerWidgetId:'Shop2SuppliersModal',isWidgetLoaded:false,open:function(shopId){Preloader.show();Shop2SuppliersModalWidget.manager.mountWidget(this.containerWidgetId);if(this.isWidgetLoaded){Shop2SuppliersModalWidget.open({shopId});Preloader.hide();return}const unsubscribe=EventBus.subscribe('suppliers-widget-loaded',()=>{Shop2SuppliersModalWidget.open({shopId});Preloader.hide();this.isWidgetLoaded=true;unsubscribe()})}}}})(jQuery);var ShopController={};(function($){ShopController={folder_id:false,product_ids:false,shop_id:false,checked:false,container:false,toggleTab:function(url,popup){if(popup){s3.reloadVisibleContent(url);util.centerElement(popupController.getLastPopup().obj)}else{s3.loadContent(url)}},editProduct:function(product_id,shop_id,folder_id,object,parent){var self=this,object=$(object).closest(parent),product_id=s3.getInt(product_id,0),shop_id=s3.getInt(shop_id,0),folder_id=s3.getInt(folder_id,0),url='/-/cms/v1/shop/product/?act=edit&'+S3_ACCESS+'&folder_id='+folder_id+'&shop_id='+shop_id+'&object_id='+product_id;openAjaxForm(url,function(r){var object=$('tr#shop_product_'+product_id);$(r.text).insertAfter(object).S3ChangeControls();object.empty().remove();popupController.closeLastPopup();treeController.reloadTree('.tree-wrapper');fadeController.init($(parent).get(0))},null,function(r){var p=popupController.getLastPopup();if(p&&p.obj){var form=$(p.obj).find('form:first');form.find('#kinds_items input.kind_was_modified').each(function(){var value=s3.getInt($(this).val());if(value){$(this).parents('tr:first').effect("highlight",{color:'#AAA'},2000)}})}var object=$('tr#shop_product_'+product_id);$(r.text).insertAfter(object).S3ChangeControls();object.empty().remove();treeController.reloadTree('.tree-wrapper');fadeController.init($(parent).get(0))})},shopSearchFull:function(object){var self=this,inputValue=$.trim($(object).prev().find('input:first').val()),object=$(object).parents('.shop2-product-search-form-wrapper').find('.shop-search-full-wrapper');object.addClass('opened');var searchPopup=object.find('.shop-search-full');searchPopup.find('input.product-text-search').val(inputValue)},shopSearchFullPopup:function(object){var self=this;var popupSearch=new PopupWindow('ajaxPopupWindow_'+popupController.popups.length),inputValue=$.trim($(object).prev().val());popupSearch.drag=true;popupSearch.modal=true;popupSearch.center=true;popupSearch.elemDiv=$('#popupSearch');function changeStyleControl(event){util.changeStyleControlIfValueASet(event.currentTarget)}popupSearch.onClose=function(){$(popupSearch.obj).find('input[type="text"]').toArray().forEach((input)=>{$(input).off('blur',changeStyleControl)});self.closeShopSearchFullPopup($(popupSearch.obj).find('.shop-search-full-wrapper'))};$(object).parents('.shop2-product-search-form-wrapper').find('.shop-search-full-wrapper').addClass('popup');console.log($(object).parents('.shop2-product-search-form-wrapper').find('.shop-search-full-wrapper').attr('class'));popupController.showPopup(popupSearch);$(popupSearch.obj).S3ChangeControls();$(popupSearch.obj).find('input[type="text"]').toArray().forEach((input)=>{$(input).on('blur',changeStyleControl)});$(popupSearch.obj).find('input.product-text-search').val(inputValue).trigger('blur');return popupSearch},closeShopSearchFull:function(){$('.shop-search-full-wrapper').removeClass('opened');$('.shop_search_full').trigger('reset')},closeShopSearchFullPopup:function(obj){$(obj).removeClass('popup');var append=$('<div id="popupSearch"></div>').append($(obj));var search=$('.shop2-product-search-form-wrapper').find('#popupSearch');if(search.get(0)){search.empty().remove()}$('.shop2-product-search-form-wrapper').append(append)},}})(jQuery);var ShopOrderController={};(function($){ShopOrderController={baseUrl:'/-/cms/v1/shop/order/?'+S3_ACCESS,init:function(){var self=this;self.dateRangePickerInit('.order-date-picker')},initSelect:function(select){var self=this,option=$(select).find('option:selected'),styleClass=option[0].className;$(select).parent().find('a.chzn-single > span').addClass(styleClass)},dateRangePickerInit:function(object){var self=this,object=$(object),form=util.getParent(object.get(0),'FORM'),orderDateFrom=object.parent().find('input#order_date_from'),orderDateTo=object.parent().find('input#order_date_to');var l=$.datepicker.regional[i18n_map[S3_LANG_CODE]];var $drp=object.daterangepicker({autoUpdateInput:false,alwaysShowCalendars:true,startDate:$.trim(orderDateFrom.val())||moment(),endDate:$.trim(orderDateTo.val())||moment(),ranges:{'Сегодня':[moment(),moment()],'Вчера':[moment().subtract(1,'days'),moment().subtract(1,'days')],'Неделя':[moment().subtract(6,'days'),moment()],'Месяц':[moment().startOf('month'),moment().endOf('month')]},locale:{"separator":" - ","format":"DD.MM.YYYY","applyLabel":JS_CHOOSE,"cancelLabel":JS_CANCEL,"customRangeLabel":JS_PERIOD,"daysOfWeek":[l['dayNamesMin'][0],l['dayNamesMin'][1],l['dayNamesMin'][2],l['dayNamesMin'][3],l['dayNamesMin'][4],l['dayNamesMin'][5],l['dayNamesMin'][6]],"monthNames":[l['monthNames'][0],l['monthNames'][1],l['monthNames'][2],l['monthNames'][3],l['monthNames'][4],l['monthNames'][5],l['monthNames'][6],l['monthNames'][7],l['monthNames'][8],l['monthNames'][9],l['monthNames'][10],l['monthNames'][11]],"firstDay":1},opens:"left",});if(orderDateFrom.val()!=''){object.val(orderDateFrom.val())}if(orderDateTo.val()!=''){object.val(object.val()+' - '+orderDateTo.val())}$(object).on('apply.daterangepicker',function(ev,picker){object.val(picker.startDate.format('DD.MM.YYYY')+' - '+picker.endDate.format('DD.MM.YYYY'));orderDateFrom.val(picker.startDate.format('DD.MM.YYYY'));orderDateTo.val(picker.endDate.format('DD.MM.YYYY'));$(form).submit()});$drp.on('show.daterangepicker',function(ev,picker){var c=picker.container[0];$(c).find('.daterangepicker_input').hide()})},orderExport:function(url){var self=this;s3.openModalPopup(url,true);var p=popupController.getLastPopup();if(p.obj){var dateSelect=$(p.obj).find('.date-select'),selects=dateSelect.find('select');selects.addClass('s3-select without-search white');selects.attr('data-width',100);dateSelect.S3ChangeControls();p.onReload=function(){setTimeout(function(){var dateSelect=$(p.obj).find('.date-select'),selects=dateSelect.find('select');selects.addClass('s3-select without-search white');selects.attr('data-width',100);dateSelect.S3ChangeControls()},1)}}return false},viewOrder:function(obj,tagName,containerID,url,urlUpdate){var self=this;var e=util.getElement(obj,tagName);var container;if(containerID=='UL'||containerID=='DIV'||containerID=='TABLE'){container=util.getParent(e,containerID)}else{container=util.getObject(containerID)}if(!container)return;var onClose;if(urlUpdate){onClose=function(){s3.updateObject(obj,tagName,containerID,urlUpdate,null)}}else{onClose=false}openAjaxForm(url,false,onClose,false)},updateStatus:function(obj,url,order_id,status_id,urlUpdate,product_amount_auto_decrease,denial_status,msg){var self=this,form=util.getParent(obj,'FORM'),url=url+status_id;if(denial_status&&product_amount_auto_decrease){openAjaxForm(url,null,function(){s3.updateObject(obj,'TR','shop_order_container',urlUpdate,null)})}else if(product_amount_auto_decrease){if(status_id==4){s3.confirm(msg,function(){var r=util.makePostRequest(url,formcontents(form));popupController.closeLastPopup();if(r&&!r.error){s3.updateObject(obj,'TR','shop_order_container',urlUpdate,null)}})}else{var r=util.makePostRequest(url,formcontents(form));if(r&&!r.error){s3.updateObject(obj,'TR','shop_order_container',urlUpdate,null)}}}else{var r=util.makePostRequest(url,formcontents(form));if(r&&!r.error){s3.updateObject(obj,'TR','shop_order_container',urlUpdate,null)}}return false},search:function(form,filter,url){var self=this;url+=$(form).serialize()+'&'+$(filter).serialize();s3.reloadVisibleContent(url)},}})(jQuery);var OrderController={};(function($){OrderController={baseUrl:'/-/cms/v1/shop2/order/?'+S3_ACCESS,folder_id:false,viewColumsDefault:['board_date','order_paid','order_status','order_delivery','order_payment','has_pre_order'],allowedGroupOperations:{ORDER_MOVE_TO_ALL:'order_move_to_all',ORDER_MOVE_TO_ARCHIVE:'order_move_to_archive',ORDER_MOVE_TO_BASKET:'order_move_to_basket',ORDER_REMOVE:'order_remove',ORDER_PROCESS_PAY:'order_process_pay',ORDER_PROCESS_REFUND:'order_process_refund',ORDER_UPDATE_STATUS:'order_update_status',ORDER_UPDATE_1C_STATUS:'order_update_1c_status',},init:function(){var self=this;self.localStorageInit();self.dateRangePickerInit('.order-date-picker')},initSelect:function(select){var self=this,option=$(select).find('option:selected'),styleClass=option[0].className;$(select).parent().find('a.chzn-single > span').addClass(styleClass)},localStorageInit:function(){var self=this,orderList=$('table#shop2_orders_container'),ls=LS.get('shop2_order_view_params'),viewParams=[];if(orderList.get(0)){if(typeof ls=='object'&&$.isEmptyObject(ls)){viewParams=self.viewColumsDefault}else{if(ls!==null){viewParams=ls.split(',')}}if(viewParams.length>0&&viewParams[0]!=''){for(var i=0;i<=viewParams.length;i++){var label=$('.shop2-product-list-view-params').find('form>div.'+viewParams[i]).find('label.s3-cb');label.addClass('active');label.find('input').attr('checked','checked');orderList.find('th.'+viewParams[i]).addClass('view');orderList.find('td.'+viewParams[i]).addClass('view')}}}},dateRangePickerInit:function(object){var self=this,object=$(object),form=util.getParent(object.get(0),'FORM'),orderDateFrom=object.parent().find('input#order_date_from'),orderDateTo=object.parent().find('input#order_date_to');var l=$.datepicker.regional[i18n_map[S3_LANG_CODE]];var $drp=object.daterangepicker({autoUpdateInput:false,alwaysShowCalendars:true,startDate:$.trim(orderDateFrom.val())||moment(),endDate:$.trim(orderDateTo.val())||moment(),ranges:{'Сегодня':[moment(),moment()],'Вчера':[moment().subtract(1,'days'),moment().subtract(1,'days')],'Неделя':[moment().subtract(6,'days'),moment()],'Месяц':[moment().startOf('month'),moment().endOf('month')]},locale:{"separator":" - ","format":"DD.MM.YYYY","applyLabel":JS_CHOOSE,"cancelLabel":JS_CANCEL,"customRangeLabel":JS_PERIOD,"daysOfWeek":[l['dayNamesMin'][0],l['dayNamesMin'][1],l['dayNamesMin'][2],l['dayNamesMin'][3],l['dayNamesMin'][4],l['dayNamesMin'][5],l['dayNamesMin'][6]],"monthNames":[l['monthNames'][0],l['monthNames'][1],l['monthNames'][2],l['monthNames'][3],l['monthNames'][4],l['monthNames'][5],l['monthNames'][6],l['monthNames'][7],l['monthNames'][8],l['monthNames'][9],l['monthNames'][10],l['monthNames'][11]],"firstDay":1},opens:"left",});if(orderDateFrom.val()!=''){object.val(orderDateFrom.val())}if(orderDateTo.val()!=''){object.val(object.val()+' - '+orderDateTo.val())}$(object).on('apply.daterangepicker',function(ev,picker){object.val(picker.startDate.format('DD.MM.YYYY')+' - '+picker.endDate.format('DD.MM.YYYY'));orderDateFrom.val(picker.startDate.format('DD.MM.YYYY'));orderDateTo.val(picker.endDate.format('DD.MM.YYYY'));$(form).submit()});$drp.on('show.daterangepicker',function(ev,picker){var c=picker.container[0];$(c).find('.daterangepicker_input').hide()})},orderListViewParams:function(form){var self=this,formdata=$(form).serializeArray(),data='';LS.remove('shop2_order_view_params');$(formdata).each(function(index,obj){if(index==0){data+=obj.name}else{data+=','+obj.name}});LS.set('shop2_order_view_params',data);S3ContextMenuController.closeContextMenu();s3.reloadVisibleContent();return false},clearFolderId:function(){this.folder_id=false},checkAll:function(checkbox,folder_id,idPrefix){var self=this,checkbox=$(checkbox),label=checkbox.parent(),folder_id=(folder_id!=undefined)?parseInt(folder_id):undefined;if(!label.size())return false;if(typeof folder_id=='number'){self.folder_id=folder_id}else{self.folder_id=false}if(idPrefix){$('#shop_order_container').attr('data-form','order_datetime')}else{$('#shop_order_container').removeAttr('data-form')}label.checkboxClickFunction(null,true,null,folder_id)},orderExport:function(url){var self=this;s3.openModalPopup(url,true);var p=popupController.getLastPopup();if(p.obj){var dateSelect=$(p.obj).find('.date-select'),selects=dateSelect.find('select');selects.addClass('s3-select without-search white');selects.attr('data-width',100);dateSelect.S3ChangeControls();p.onReload=function(){setTimeout(function(){var dateSelect=$(p.obj).find('.date-select'),selects=dateSelect.find('select');selects.addClass('s3-select without-search white');selects.attr('data-width',100);dateSelect.S3ChangeControls()},1)}}return false},viewOrder:function(obj,tagName,containerID,url,urlUpdate){var self=this;var e=util.getElement(obj,tagName);var container;if(containerID=='UL'||containerID=='DIV'||containerID=='TABLE'){container=util.getParent(e,containerID)}else{container=util.getObject(containerID)}if(!container)return;var onClose;if(urlUpdate){onClose=function(){s3.updateObject(obj,tagName,containerID,urlUpdate,null);self.localStorageInit()}}else{onClose=false}openAjaxForm(url,false,onClose,false)},copyOrder:function(elId,tagName,containerID,url,urlView,urlUpdate){var request=util.getRequest();request.open('GET',url,false);request.send('');request=util.parseRequestResult(request);if(request){var orderId=$(request.text).find('.order_checkboxes').first().val();if(orderId){$(request.text).prependTo($('#'+containerID)).S3ChangeControls();var obj=document.getElementById(elId+orderId);this.viewOrder(obj,tagName,containerID,urlView+'&order_id='+orderId,urlUpdate+'&order_id='+orderId)}else{s3.alert('Невозможно скопировать заказ - все товары из заказа недоступны.')}}},removeDiscount:function(url){var request=util.getRequest();request.open('GET',url,false);request.send('');request=util.parseRequestResult(request);if(request){popupController.reloadLastPopup();s3.reloadVisibleContent()}},hideOrderNote:function(){var self=this;util.createCookie('shop2_order_view_note',1,7);s3.reloadVisibleContent()},transactionEdit:function(url,is_payment){var self=this,res;if(is_payment){url+='&is_payment=1'};res=util.makeGetRequest(url);if(res.text=='OK'){util.msg(s3.loc('SAVED'));popupController.reloadLastPopup()}},orderGroupOperations:function(url,operation,msgConfirm=null,msgOk=null){var container=util.getObject('shop2_orders_container');var orders=s3.getBatchOpInfo(container,'TR','shop2_order_','',null,'input',{checked:true});var orderIds;const cronInfoPopupOpen=(r)=>{var popup=new PopupWindow('ajaxPopupWindow_'+popupController.popups.length);var obj=document.createElement('DIV');popup.drag=true;popup.modal=true;popup.center=true;popup.created=true;obj.id=popup.elementId;obj.style.position='absolute';obj.style.display='none';obj.innerHTML=r.text;document.body.appendChild(obj);popupController.showPopup(popup)};url+='&operation='+operation;if(!orders.ids.length){s3.alert(s3.loc('JS_NO_OBJECTS_CHOSEN_ERROR'));return}if(this.folder_id===0){url+='&order_all=1';orderIds=-1}else{orderIds=orders.ids}if([this.allowedGroupOperations.ORDER_UPDATE_STATUS,this.allowedGroupOperations.ORDER_UPDATE_1C_STATUS].includes(operation)){var statusId=0;var act='';if(operation===this.allowedGroupOperations.ORDER_UPDATE_STATUS){act='getStatus'}else if(operation===this.allowedGroupOperations.ORDER_UPDATE_1C_STATUS){act='get1sStatus'}S3Ajax.openAjaxPopup({type:'dynamic',link:'/-/cms/v1/shop2/order/group-operations/?act='+act+'&'+S3_ACCESS,isReloaded:true,onOpen:function(popup){const submitHandler=(event)=>{event.preventDefault();S3PopUp.closeLastPopup();var r=util.makePostRequest(url,'status_id='+statusId+'&ids='+orderIds);s3.reloadVisibleContent();if(!r.error&&r.code===1){cronInfoPopupOpen(r)}else if(!r.error){s3.alert(msgOk)}};const statusClickHandler=(event)=>{var $this=$(event.currentTarget);statusId=$this.data('status-id');$this.closest('form').submit()};popup.find('form[name="shop2_order_group_status"]').submit(submitHandler);popup.find('[data-status-id]').each(function(_,e){$(e).click(statusClickHandler)})},});return}s3.confirm(msgConfirm,function(){popupController.closeLastPopup();var r=util.makePostRequest(url,'ids='+orderIds);s3.reloadVisibleContent();if(!r.error&&r.code===1){cronInfoPopupOpen(r)}})},orderGroupAction:function(url,msg,act){var self=this;url+='&act='+act+'&order_id=';s3.confirm(msg,function(){popupController.closeLastPopup();var container=util.getObject('shop2_orders_container');var orders=s3.getBatchOpInfo(container,'TR','shop2_order_','',null,'input',{checked:true});if(!orders.ids.length){return s3.alert(s3.loc('JS_NO_OBJECTS_CHOSEN_ERROR'))}var promise=$.when();$.each(orders.ids?orders.ids.split(','):[],function(i,order_id){promise=promise.then(function(){s3.updateObject($('#shop2_order_'+order_id)[0],'TR','shop2_orders_container',url+order_id)})});promise.then(function(){s3.reloadVisibleContent();self.localStorageInit()})})},updateStatus:function(obj,url,order_id,status_id,urlUpdate,product_amount_auto_decrease,denial_status,preorder,msg){var self=this,form=util.getParent(obj,'FORM'),url=url+status_id;if(denial_status&&product_amount_auto_decrease){openAjaxForm(url,null,function(){s3.updateObject(obj,'TR','shop_order_container',urlUpdate,null);self.localStorageInit()})}else if(product_amount_auto_decrease){if(status_id==4){if(!preorder){s3.confirm(msg,function(){var r=util.makePostRequest(url,formcontents(form));popupController.closeLastPopup();if(r&&!r.error){s3.updateObject(obj,'TR','shop_order_container',urlUpdate,null);self.localStorageInit()}})}else{var r=util.makePostRequest(url,formcontents(form));if(r&&!r.error){s3.updateObject(obj,'TR','shop_order_container',urlUpdate,null);self.localStorageInit()}}}else{var r=util.makePostRequest(url,formcontents(form));if(r&&!r.error){s3.updateObject(obj,'TR','shop_order_container',urlUpdate,null);self.localStorageInit()}}}else{var r=util.makePostRequest(url,formcontents(form));if(r&&!r.error){s3.updateObject(obj,'TR','shop_order_container',urlUpdate,null);self.localStorageInit()}}return false},search:function(form,filter,url){var self=this;url+=$(form).serialize()+'&'+$(filter).serialize();s3.reloadVisibleContent(url)},toggleTab:function(url,popup){var self=this;if(popup){s3.reloadVisibleContent(url);util.centerElement(popupController.getLastPopup().obj)}else{s3.loadContent(url)}},changePS:function(url){var self=this,form=$('#shop2-order-payments'),r=util.makePostRequest(url,form.serialize());if(r&&r.text==='OK'){popupController.closeLastPopup();popupController.reloadLastPopup()}else{$('#shop2-order-payment-container').html(r.text)}},onPSChange:function(obj){$('#shop2-order-payments .option-type').removeClass('active-type');$('#shop2-order-payments .option-details').hide();$(obj).parent().parent().addClass('active-type');$(obj).parent().parent().find('.option-details').show()},moveToArchive:function(ctx,shopId,orderId){const url=this.baseUrl+'&act=archive&archive_type=1'+'&shop_id='+shopId+'&order_id='+orderId;const msg=s3.loc('MOVE_TO_ARCHIVE_MSG');s3.deleteObject(ctx,'TR',url,null,msg,null)},moveToTrash:function(ctx,shopId,orderId){const url=this.baseUrl+'&act=basket&archive_type=2'+'&shop_id='+shopId+'&order_id='+orderId;const msg=s3.loc('ORDER_DELETE_MSG');s3.deleteObject(ctx,'TR',url,null,msg,null)},delete:function(ctx,shopId,orderId){const url=this.baseUrl+'&act=delete'+'&shop_id='+shopId+'&order_id='+orderId;const msg=s3.loc('ORDER_DELETE_BASKET_MSG');s3.deleteObject(ctx,'TR',url,null,msg,null)}}})(jQuery);var InnerNoticeController={};(function($){'use strict';InnerNoticeController={checkAll:function(checkbox,folder_id,idPrefix){var self=this,checkbox=$(checkbox),label=checkbox.parent(),folder_id=(folder_id!=undefined)?parseInt(folder_id):undefined;if(!label.size()){return false}$('#inner_notice_container').removeAttr('data-form');label.checkboxClickFunction(null,true,null,folder_id)},editPost:function(notice_id,parent,save_only){var self=this,notice_id=s3.getInt(notice_id,0),url='/-/cms/v1/inner-notice/?'+S3_ACCESS+'&act=edit&notice_id='+notice_id;openAjaxForm(url,function(r){popupController.closeLastPopup();treeController.reloadTree('.tree-wrapper');fadeController.init($(parent).get(0));s3.reloadContent()},null,function(r){treeController.reloadTree('.tree-wrapper');fadeController.init($(parent).get(0));$(parent).S3ChangeControls()},)},addPost:function(subscribe_id,parent){var self=this,subscribe_id=s3.getInt(subscribe_id,0),url='/-/cms/v1/inner-notice/?'+S3_ACCESS+'&act=edit&subscribe_id='+subscribe_id;openAjaxForm(url,function(r){popupController.closeLastPopup();treeController.reloadTree('.tree-wrapper');fadeController.init($(parent).get(0));s3.reloadContent()},null,function(r){treeController.reloadTree('.tree-wrapper');fadeController.init($(parent).get(0));$(parent).S3ChangeControls()},)},editSubscribe:function(subscribe_id,parent){var self=this,subscribe_id=s3.getInt(subscribe_id,0),url='/-/cms/v1/inner-notice/?'+S3_ACCESS+'&act=edit_subscribe&subscribe_id='+subscribe_id;openAjaxForm(url,function(r){popupController.closeLastPopup();s3.reloadContent()},null,function(r){s3.reloadContent()},)},deleteSubscribe:function(subscribe_id,object,parent,msg){var self=this,parent=$(object).closest(parent),subscribe_id=s3.getInt(subscribe_id,0),url='/-/cms/v1/inner-notice/?'+S3_ACCESS+'&subscribe_id='+subscribe_id+'&act=remove_subscribe',res;s3.confirm((msg?msg:JS_CONFIRM_DELETE),function(){res=util.makePostRequest(url,'');popupController.closeLastPopup();if(res.text==='OK'){parent.empty().remove();s3.reloadContent()}})},noticeActions:function(notice_id,act,object,parent,msg){var self=this,parent=$(object).closest(parent),notice_id=s3.getInt(notice_id,0),url='/-/cms/v1/inner-notice/?'+S3_ACCESS+'&notice_id='+notice_id+'&act='+act,res;s3.confirm((msg?msg:JS_CONFIRM_DELETE),function(){res=util.makePostRequest(url,'');popupController.closeLastPopup();if(res.text==='OK'){parent.empty().remove();s3.reloadContent()}})},selectedNotice:function(notice_id,id_client,object,parent,result_act,view_notice){var self=this,parent=$(object).closest(parent),notice_id=s3.getInt(notice_id,0),result_act=s3.getInt(result_act,0),id_client=s3.getInt(id_client,0),url='/-/cms/v1/inner-notice/?'+S3_ACCESS+'&id_client='+id_client+'&notice_id='+notice_id+'&mode=selected&act=notice_operation&result_act='+result_act;Preloader.show({mini:true,});$.ajax({url:url,type:'GET',success:function(){if(view_notice){popupController.reloadLastPopup()}else{parent.empty().remove()}s3.reloadContent();Preloader.hide()},error:function(){console.log('Error')},})},openModalPopup:function(url,reloadContent,postParams){var popup=new PopupWindow('ajaxPopupWindow_'+popupController.popups.length);popup.url=url;popup.postParams=postParams;popup.drag=true;popup.modal=true;popup.center=true;if(reloadContent)popup.onClose=function(){s3.reloadContent()};popupController.showPopup(popup);return popup},_getContainer:function(idPrefix){return util.getObject(idPrefix+'container')},groupAction:function(mode,client_id,result){var self=this,url='/-/cms/v1/inner-notice/?act=group_action&'+S3_ACCESS+'&client_id='+client_id+'&mode='+mode+'&result_act='+result;s3.cronJobs(self._getContainer('inner_notice_'),'TR','inner_notice_',url,null,'input',{checked:true,},false)},search:function(form){var text=form.elements['s[text]'].value.trim();if(text){search(form,'/-/cms/v1/inner-notice/?'+S3_ACCESS,null)}return false},toggleTab(target,popup=false,callback=null){var $target=$(target),$parent=$target.parents('.js-tabs:first'),tab_id=$target.data('tab-id'),url=$target.data('url');if(typeof tab_id!=='string'){return}url+='&tab_id='+tab_id;$parent.find('.js-tabs-handle').removeClass('active');$parent.find('.js-tabs-content').addClass('hide');$target.addClass('active');$parent.find('#'+tab_id).removeClass('hide');if(popup){url+='&selector=1&popup=1';s3.loadPopupContent(url)}else{s3.loadContent(url,callback)}}}})(jQuery);var BoardController={};(function($){window.BoardController={checked:false,folder_id:false,image_count:false,container:false,_getContainer:function(idPrefix){return util.getObject(idPrefix+'container')},groupDelete:function(obj,board_id,tab){var all=parseInt(this.folder_id)===0?1:0,url='/-/cms/v1/board/?act=status&'+S3_ACCESS+'&mode=delete&multiple=1&board_id='+board_id+'&view_type='+tab+'&all='+all;s3.deleteObjects(util.getObject(obj),'DIV','post',url,null,'input',{checked:true})},groupSpam:function(obj,board_id,tab){var all=parseInt(this.folder_id)===0?1:0,url='/-/cms/v1/board/?act=status&'+S3_ACCESS+'&mode=spam&multiple=1&board_id='+board_id+'&view_type='+tab+'&all='+all;s3.deleteObjects(util.getObject(obj),'DIV','post',url,null,'input',{checked:true},s3.loc('JS_MOVE_TO_SPAM'))},groupHide:function(obj,board_id,tab){var all=parseInt(this.folder_id)===0?1:0,url='/-/cms/v1/board/?act=status&'+S3_ACCESS+'&mode=hide&multiple=1&board_id='+board_id+'&view_type='+tab+'&all='+all;s3.updateObjects(util.getObject(obj),'DIV','post',url,null,'input',{checked:true})},groupShow:function(obj,board_id,tab){var all=parseInt(this.folder_id)===0?1:0,url='/-/cms/v1/board/?act=status&'+S3_ACCESS+'&mode=show&multiple=1&board_id='+board_id+'&view_type='+tab+'&all='+all;s3.updateObjects(util.getObject(obj),'DIV','post',url,null,'input',{checked:true})},groupNew:function(obj,board_id,tab){var all=parseInt(this.folder_id)===0?1:0,url='/-/cms/v1/board/?act=status&'+S3_ACCESS+'&mode=new&multiple=1&board_id='+board_id+'&view_type='+tab+'&all='+all;s3.updateObjects(util.getObject(obj),'DIV','post',url,null,'input',{checked:true})},groupRestore:function(obj,board_id,tab){var all=parseInt(this.folder_id)===0?1:0,url='/-/cms/v1/board/?act=status&'+S3_ACCESS+'&mode=restore&multiple=1&board_id='+board_id+'&view_type='+tab+'&all='+all;s3.deleteObjects(util.getObject(obj),'DIV','post',url,null,'input',{checked:true},s3.loc('JS_RESTORE_FROM_SPAM'))}}})(jQuery);var SystemMessagesController={};(function($){'use strict';SystemMessagesController={initialized:false,sm_last_modified:null,sm_last_modified_updated:0,sm_last_modified_ls_key:'x-sm-modified',update_interval:5000,request_throttle_delay:1000,last_request_timestamp:0,request_queue:{},$system_messages:null,$system_messages_counter:null,$system_messages_list:null,$system_messages_list_element:null,init:function(){if(this.initialized){return}var self=this;this.$system_messages=$('.js-system-messages');this.$system_messages_counter=this.$system_messages.find('.js-system-messages-counter');this.$system_messages_list=this.$system_messages.find('.js-system-messages-list');this.$system_messages_list_empty=this.$system_messages.find('.js-system-messages-list-empty');this.$system_messages_handler=this.$system_messages.find('.js-system-messages-handler');this.$system_messages_list_element=this.$system_messages_list.children().detach();this.$system_messages_counter.text(0);this.$system_messages_list_empty.show();this.$system_messages_list.on('click','li',function(){var message_id=$(this).attr('data-message_id');self.openModalPopup('/-/cms/v1/system-messages/?act=view&message_id='+message_id+'&id_client='+window.S3_CLIENT_ID+'&popup=1&'+window.S3_ACCESS,true)});$(document).ajaxSuccess(function(event,xhr){if(event.timeStamp-self.sm_last_modified_updated>self.update_interval){self.sm_last_modified_updated=0}if(self.sm_last_modified&&self.sm_last_modified_updated>0){return}self.sm_last_modified=xhr.getResponseHeader('X-SM-Modified');self.sm_last_modified_updated=event.timeStamp});setInterval(function(){var sm_last_modified=LS.get(self.sm_last_modified_ls_key);if(sm_last_modified===self.sm_last_modified||!self.isQueryAllowed()){return}self.getList();LS.set(self.sm_last_modified_ls_key,self.sm_last_modified)},1000);self.getList();this.initialized=true},getList:function(){var self=this;$.ajax({url:'/-/cms/v2/system-messages/list-new?'+window.access,type:"GET",contentType:'application/json',async:false}).done(function(response){if(response.count){if(response.count>0){self.$system_messages_counter.show()}else{self.$system_messages_counter.hide()}self.$system_messages_counter.text(response.count)}if(response.list){self.$system_messages_list.html(null);self.$system_messages_list_empty.hide();if(response.list.length===0){self.$system_messages_list_empty.show()}for(var i in response.list){var result_item=response.list[i];var $list_element=self.$system_messages_list_element.clone();if(result_item.viewed==='0'){$list_element.find('.news-item').addClass('new')}var title=result_item.title;var body=result_item.body;if(result_item.upgrade_id>0){title=result_item.upgrade_title;body=result_item.upgrade_body}var re=/<(?!br\s*\/?)[^>]+>/gi;title=title.replace(re,' ').replace(/\s+/,' ');body=body.replace(re,' ').replace(/\s+/,' ');$list_element.attr('data-message_id',result_item.message_id);$list_element.find('.news-item__title').text(title);$list_element.find('.news-item__subtitle').html(body);$list_element.find('.news-item__date').text(result_item.created_formated);self.$system_messages_list.append($list_element)}self.setListHeight()}})},isQueryAllowed:function(){if(!this.initialized){return true}var now=Date.now();if(now-this.last_request_timestamp<this.request_throttle_delay){return false}if(util.readCookie("rpc_error_system_message_"+window.VER_ID)){return false}this.last_request_timestamp=now;return true},setListHeight:function(){this.$system_messages_list.parent().show();this.$system_messages_list.height('auto');var correction=this.$system_messages_list.parent().height()+this.$system_messages_list.parent().offset().top;if(correction<=$(window).height()){this.$system_messages_list.parent().hide();return}correction-=this.$system_messages_list.height();this.$system_messages_list.css({'height':$(window).height()-correction,'overflow-y':'scroll'});this.$system_messages_list.parent().hide()},openModalPopup:function(url,reloadContent,postParams){var popup=new PopupWindow('ajaxPopupWindow_'+popupController.popups.length);popup.url=url;popup.postParams=postParams;popup.drag=true;popup.modal=true;popup.center=true;if(reloadContent){popup.onClose=function(){s3.reloadContent()}}popupController.showPopup(popup);this.sm_last_modified_updated=0;return popup},checkAll:function(checkbox,folder_id,idPrefix){var $checkbox=$(checkbox),label=$checkbox.parent(),folder_id=(folder_id!=undefined)?parseInt(folder_id):undefined;if(!label.size()){return false}$('#'+idPrefix).removeAttr('data-form');label.checkboxClickFunction(null,true,null,folder_id)},groupAction:function(mode,client_id,result){var url='/-/cms/v1/system-messages/?act=group_action&'+S3_ACCESS+'&client_id='+client_id+'&mode='+mode+'&result_act='+result;s3.cronJobs(util.getObject('system_messages_container'),'TR','system_message_',url,null,'input',{checked:true,},false)},}})(jQuery);var UserFileController;(function($){UserFileController={checked:false,folder_id:false,file_count:false,container:false,checkAll:function(checkbox,folder_id,idPrefix){var self=this,checkbox=$(checkbox),label=checkbox.parent(),folder_id=(folder_id!=undefined)?parseInt(folder_id):undefined;if(!label.size()){return false}if(typeof folder_id=='number'){self.folder_id=folder_id}else{self.folder_id=false}if(idPrefix){if(!self.container){self.container=self._getContainer(idPrefix)}$(self.container).attr('data-form',idPrefix+'search_form')}else{if(self.container){$(self.container).removeAttr('data-form')}}label.checkboxClickFunction(null,true,null,folder_id)},_getContainer:function(idPrefix){return util.getObject(idPrefix+'container')},_getSearchForm:function(idPrefix){return util.getObject(idPrefix+'search_form')},_getSearchFormQuery:function(idPrefix){var f=this._getSearchForm(idPrefix);if(!(f&&f.elements.submitted.value)){return''}var q='';$.each(f.elements,function(k,v){if(/^s\[/.test(v.name)){q+='&'+encodeURIComponent(v.name)+'='+encodeURIComponent(v.value)}});return q},updateSelector:function(container){var self=this,n_files=$(container).find('li[class="^box"]').length;$('.file-pagination-wrap').show(0);$('.file-wrapper-table').show(0);if(n_files>self.file_count){$('.image-selector .selector-image-count').each(function(){this.innerHTML=Number(this.innerHTML.trim())+1})}$('.image-selector .selector-visible-number').each(function(){this.innerHTML=$(container).find('li').length})},getFileCount:function(container){var self=this;self.file_count=$(container).find('li.file-item').length},groupDelete:function(idPrefix){var self=this,url='/-/cms/v1/user-file/?act=delete&'+S3_ACCESS+self._getSearchFormQuery(idPrefix),current_folder=self.folder_id;s3.cronJobs(self._getContainer(idPrefix),'LI','file',url,null,'input',{checked:true},true,current_folder);self.folder_id=false},removeFromSelector:function(id){var self=this,d=popupController.getPreviousPopup();if(d&&d.obj.id=="selected"){var obj=$(d.obj).find('li#'+id)[0];if(!obj){return false}util.detachElement(obj)}},restrictToNumbers:function(input){input.value=input.value.replace(/^0|[^0-9]/g,'')},updateFieldVisibility:function($radioButton){const parent=$radioButton.parents('.data-list');const value=$radioButton.val();parent.find('input[name="period"]').prop('required',!!+value);!!+value?parent.find('.choose-edit').show():parent.find('.choose-edit').hide()},isAnyCheckboxChecked:function(){if($('.user-file-checkbox-field:checked').length===0){s3.alert(s3.loc('JS_SELECT_LEAST_ONE_OPTION'));return false}return true}}})(jQuery);let ListSelectedItemsController={};(function($){ListSelectedItemsController={CLASS_SELECTED_ITEM:'.s3-selected-item',CLASS_BUTTON_ADD:'.s3-selected-items__add-button',addItem:function(id,name,nameInput,idListContainer,productData=null,isOneElement=false){if(this._isAdded(idListContainer,id)){return this}if(this.isLimitItems(idListContainer)){const msg=this._getLimitMsg(idListContainer);s3.alert(msg,function(){popupController.closeLastPopup()});return this}let idPrefix='';if(nameInput==='objects[]'&&productData){if(id===productData.productId){idPrefix='product_'}else{idPrefix='kind_'}}const element=`<div class="s3-selected-item"data-id="${productData && productData.productId !== id ? productData.productId + '_' + id : id}"><input type="hidden"name="${nameInput}"value="${idPrefix}${id}"><div class="s3-selected-item__content"><div class="s3-selected-item__title ${productData && productData.hidden === 1 ? 's3-selected-item__title--gray' : ''} ${productData && productData.hidden === 2 ? 's3-selected-item__title--orange' : ''}">${name}</div>${productData?`<div class="s3-selected-item-product"><div class="s3-selected-item-product__article">${s3.loc('JS_ARTICLE')}:${productData.article?productData.article:'&ndash;'}</div><div class="s3-selected-item-product__price">${productData.price}</div>${!productData.disableBadge?`<div class="s3-selected-item-product__badge"><span class="discounts__badge discounts__badge--product">${id===productData.productId?s3.loc('JS_SHOP_PRODUCT'):s3.loc('JS_SHOP2_PRODUCT_KIND')}</span></div>`:''}</div>`:''}</div><span class="s3-selected-item__delete-button ${productData ? `pp_product${productData.productId}`: ''}"onclick="ListSelectedItemsController.deleteItem(this, '${idListContainer}')"></span></div>`;if(isOneElement&&element){const countSelectedItems=this.getCountSelectedItems(idListContainer);if(countSelectedItems>=1){this.clearContainer(idListContainer)}this.changeNameButtonAddOrChange(idListContainer,"JS_CHANGE")}$(idListContainer).append(element);util.msg(s3.loc('JS_ADDED'));return this},deleteItem:function(ctx,idListContainer){util.detachElement(util.getParent(ctx,'DIV'));if(this.getCountSelectedItems(idListContainer)===0){this.changeNameButtonAddOrChange(idListContainer,"JS_CHOOSE")}},markSelected:function(ctx){$(ctx.parentElement.getElementsByClassName('objectAction')).replaceWith($('<span>'+s3.loc('JS_ADDED')+'</span>').css({float:'right',color:'#777777'}))},_isAdded:function(idListContainer,id){const addedElements=$(idListContainer).find(this.CLASS_SELECTED_ITEM);let flag=false;if(!addedElements.length){return flag}$.each(addedElements,function(_,addedElement){if(String($(addedElement).data('id'))===String(id)){flag=true;return false}});return flag},getCountSelectedItems:function(idListContainer){return $(idListContainer).find(this.CLASS_SELECTED_ITEM).length},changeNameButtonAddOrChange:function(idListContainer,localizationKey){$(idListContainer).prev().find(this.CLASS_BUTTON_ADD).text(s3.loc(localizationKey))},clearContainer:function(idListContainer){$(idListContainer).html('')},initSortable:function(idListContainer){$(idListContainer).sortable({cursor:"move",placeholder:"s3-selected-item__sortable-placeholder",items:'>div'})},checkLimitBeforeOpeningSelectionPopup:function(idListContainer,callback){if(this.isLimitItems(idListContainer)){const msg=this._getLimitMsg(idListContainer);s3.alert(msg);return}if(typeof callback==='function'){callback()}},isLimitItems:function(idListContainer){const limit=$(idListContainer).data('limit');const itemsCount=this.getCountSelectedItems(idListContainer);return!!limit&&itemsCount>=limit},_getLimitMsg:function(idListContainer){return s3.loc($(idListContainer).data('limit-msg'))}}})(jQuery);let DiscountCouponsController={};(function($){DiscountCouponsController={DISCOUNT_COUPONS_LIST_ID:'#discount-coupons-list-',DISCOUNT_COUPONS_COUNT_ID:'#discount-coupons-count-',BASE_URL:'/-/cms/v1/shop2/discount/?'+S3_ACCESS+'&popup=1',openModalWindowCoupons:function(shopId,discountId){const url=this.BASE_URL+'&shop_id='+shopId+'&discount_id='+discountId+'&act=coupon_codes';openAjaxForm(url)},addCoupons:function(ctx,shopId,discountId){const self=this;const url=this.BASE_URL+'&shop_id='+shopId+'&discount_id='+discountId+'&act=coupon_code_add';function successCallback(){popupController.reloadLastPopup();self.setCountCoupons(self.getCountCoupons(discountId),discountId)}postAjaxForm(url,ctx,true,successCallback)},deleteCoupon:function(ctx,shopId,discountId,codeCoupon){const self=this;const url=this.BASE_URL+'&code='+codeCoupon+'&shop_id='+shopId+'&discount_id='+discountId+'&act=coupon_code_del';function successDeleteCallback(){const countCoupons=self.getCountCoupons(discountId);self.setCountCoupons(countCoupons,discountId);if(!countCoupons){const list=$(self.DISCOUNT_COUPONS_LIST_ID+discountId).closest('table');if(!list.length){return false}list.remove()}}s3.deleteObject(ctx,'TR',url,successDeleteCallback)},setCountCoupons:function(countCoupons,discountId){$(this.DISCOUNT_COUPONS_COUNT_ID+discountId).text(countCoupons)},getCountCoupons:function(discountId){return $(this.DISCOUNT_COUPONS_LIST_ID+discountId).find('>TR').length}}})(jQuery);var ACLController={};(function($){"use strict";ACLController={access:null,aclUrl:'/-/cms/v1/settings/security/acl/',staffMode:false,tooltips:{section:"Access denied to section %s",action:"Access denied to action %s",admins:""},setToolTip:function(name,template){this.tooltips[name]=template},setAccess:function(access,staffMode){this.access=access;this.staffMode=!!staffMode},renameAttr:function(inputs,name,newName){var self=this,val;return $(inputs).each(function(){val=$(this).attr(name);$(this).attr(newName,val);$(this).removeAttr(name)})},getToolTipContent:function(rule){var locSection="",locAction="";if(rule.indexOf(".")===-1){locSection=s3.loc('ACL_ACCESS_'+rule.toUpperCase());return this.tooltips['section'].replace('%section%',locSection).replace('%rule%',rule)}else{locSection=s3.loc('ACL_ACCESS_'+rule.split(".")[0].toUpperCase());locAction=s3.loc('ACL_ACCESS_'+rule.replace('.','_').toUpperCase());return this.tooltips['action'].replace('%section%',locSection).replace('%action%',locAction).replace('%rule%',rule)}},init:function(container){var self=this;if(self.access){$('[data-access]',container).each(function(){var elem=$(this),access=$.trim(elem.data('access')),elemName=elem[0].nodeName,accessText=self.getToolTipContent(access);if(self.access.indexOf(access)===-1){switch(elemName){case'OPTION':case'OPTGROUP':if(!self.staffMode){elem.attr('disabled','disabled');elem.parents('.s3-select:first').trigger('liszt:updated')}return;case'CHECKBOX':case'RADIO':case'INPUT':case'TEXTAREA':if(!self.staffMode){elem.attr('disabled','disabled')}case'SELECT':$(this).attr('disabled',true);default:elem.addClass('deny');if(self.staffMode){elem.tooltip({tooltipClass:"custom-tooltip-styling access",position:{my:"left top",at:"left bottom+5"}});elem.attr('title',accessText)}if(!self.staffMode){if(elem.attr('ondblclick')){self.renameAttr(elem,'ondblclick','onclick')}elem.attr('onclick','ACLController.accessError(event, this)')}}if(!self.staffMode){elem.on('mouseout',function(){elem.removeClass('on');$('.custom-tooltip-styling.access').empty().remove()})}}})}},accessError:function(event,object){var self=this,elem=$(object),access=$.trim(elem.data('access')),accessText=self.getToolTipContent(access),window_width=parseInt($(window).width()),denyTooltip='<div class="ui-tooltip ui-widget ui-corner-all ui-widget-content custom-tooltip-styling access"><div class="ui-tooltip-content">'+accessText+'</div></div>';event.stopPropagation();event.preventDefault();if(!elem.hasClass('on')){$('body').append(denyTooltip);$('.custom-tooltip-styling.access').show();if((event.pageX+$('.custom-tooltip-styling.access').width()+5)>window_width){$('.custom-tooltip-styling.access').show().css({top:event.pageY+25,right:window_width-event.pageX,})}else{$('.custom-tooltip-styling.access').show().css({top:event.pageY+25,left:event.pageX+20,})}elem.addClass('on')}return false},initTabsRoles:function(tabsWrapper){var self=this,tabItem=$(tabsWrapper).find('.tab-item');tabItem.find('span.title').on('click',function(e){var tab=$(this).parents('.tab-item:first');if(tab.hasClass('opened')){tab.removeClass('opened');return false}tab.addClass('opened')})},toggleTabs:function(act,popup,callback,params){var self=this,url=self.aclUrl+'?act='+act+'&'+S3_ACCESS;if(typeof name!=='string'){return}if(params){var toggle_params=$.parseJSON(params);if(!$.isEmptyObject(toggle_params)){url+="&"+$.param(toggle_params)}}if(popup){url+='&selector=1&popup=1';s3.loadPopupContent(url)}else{s3.loadContent(url,callback)}},checkSection:function(object){var self=this,object=$(object),actions=object.parents('.tab-item:first').find('.params-items input');console.log(object);if(object.hasClass('active')){self.renameAttr(actions,'name','data-name')}else{self.renameAttr(actions,'data-name','name')}},loadRoles:function(object,user_id){var self=this,user_id=s3.getInt(user_id,0),object=$(object).parent(),url=self.aclUrl+'?act=roles&user_id='+user_id+'&'+S3_ACCESS+'&popup=1';openAjaxForm(url,null,function(){s3.reloadVisibleContent()},null)},addRoleToUser:function(object,user_id,role_id){var self=this,object=$(object),user_id=s3.getInt(user_id,0),role_id=s3.getInt(role_id,0),url=self.aclUrl+'?act=assign&'+S3_ACCESS,params='&role_id='+role_id+'&cabinet_user_id='+user_id,res;res=util.makePostRequest(url,params);if(res&&res.text=='OK'){$(object).addClass('added').removeAttr('onclick');$(object).find('span.text').text(s3.loc('JS_ADDED'));util.msg(s3.loc('JS_ADDED'))}},removeUserRole:function(object,user_id,role_id,msg,context){var self=this,object=$(object).parents('.user-role:first'),user_id=s3.getInt(user_id,0),role_id=s3.getInt(role_id,0),url=self.aclUrl+'?act=unassign&'+S3_ACCESS,params='&role_id='+role_id+'&cabinet_user_id='+user_id,parent='tr.acl-user_'+user_id,contextBlock=$(object).closest('.role-rules-context.user'+user_id),res;s3.confirm(msg?msg:s3.loc('JS_CONFIRM_DELETE'),function(){res=util.makePostRequest(url,params);popupController.closeLastPopup();if(res&&!res.error){var userObject=$('tr#acl-user_'+user_id);$(res.text).insertAfter(userObject);userObject.empty().remove();fadeController.init($(parent).get(0));util.msg(s3.loc('JS_DELETED'))}});return false},toggleBlockUser:function(user_id,unblock){var self=this;console.log('toggleBlockUser')},addRole:function(object){var self=this,url=self.aclUrl+'?act=new&action=add&'+S3_ACCESS,wrapper=document.getElementById(object);openAjaxForm(url,function(r){$(r.text).appendTo(wrapper);popupController.closeLastPopup();s3.reloadContent()},null,null)},editRole:function(role_id,object,parent){var self=this,role_id=s3.getInt(role_id,0),object=$(object).closest(parent),url=self.aclUrl+'?act=new&action=edit&'+S3_ACCESS+'&role_id='+role_id;openAjaxForm(url,function(r){var object=$('tr.role-'+role_id);$(r.text).insertAfter(object);object.empty().remove();popupController.closeLastPopup();fadeController.init($(parent).get(0))},null,function(r){var object=$('tr.role-'+role_id);$(r.text).insertAfter(object);object.empty().remove();fadeController.init($(parent).get(0))})},viewRole:function(role_id){var self=this,url=self.aclUrl+'?act=view&'+S3_ACCESS+'&role_id='+role_id;s3.openModalPopup(url)},copyRole:function(role_id,object,parent,msg){var self=this,url=self.aclUrl+'?act=copy&role_id='+role_id+'&'+S3_ACCESS,wrapper=document.getElementById(object);openAjaxForm(url,function(r){$(r.text).appendTo(wrapper);popupController.closeLastPopup();s3.reloadContent()},null,null)},deleteRole:function(role_id,object,parent,msg){var self=this,object=$(object).closest(parent),role_id=s3.getInt(role_id,0),url=self.aclUrl+'?act=delete&role_id='+role_id+'&'+S3_ACCESS,res;s3.confirm(msg?msg:s3.loc('JS_CONFIRM_DELETE'),function(){res=util.makePostRequest(url,'');popupController.closeLastPopup();object.empty().remove();s3.reloadContent()})},loadUsers:function(control){var self=this,users=$(control).find('li:not(.controls)'),url=self.aclUrl+'?act=users&'+S3_ACCESS+'&popup=1',selected='';if(users.get(0)){var len=users.length;users.each(function(index,element){var input=$(this).find('input');if(index==len-1){selected+=input[0].value}else{selected+=input[0].value+','}})}s3.openModalPopup(url,false,'&selected='+selected)},addUserToRole:function(span,user_id,user_name){var self=$(this),previousPopup=popupController.getPreviousPopup(),objectUserList=null,elem='<li class="box user-item"><span class="title"><span class="edit s3-ico i-user-small-svg"></span> <span class="name" id="user_name"><b>'+user_name+'</b><input type="hidden" name="user_ids[]" value="'+user_id+'"/></span></span><span class="remove" onclick="ACLController.deleteUserFromRole(this.parentNode)"><span class="s3-ico i-delete-svg"></span></span></li>';if(previousPopup){var a=previousPopup.obj;objectUserList=util.getElementByIdAndTagName(a,'UL','objectUserList');if($(objectUserList).append($(elem))){$(span).addClass('added').removeAttr('onclick');$(span).find('span.text').text(s3.loc('JS_ADDED'));util.msg(s3.loc('JS_ADDED'))}}},deleteUserFromRole:function(object){var self=this;$(object).remove()},search:function(form){var self=this,text=form.elements['search'].value.trim(),url=self.aclUrl+'?act=users&search='+text+'&'+S3_ACCESS;if(text){search(form,url,null)}return false}}})(jQuery);let ToggleController={};(function($){"use strict";ToggleController={toggle_container:[],tab_container:[],init:function(){let container,tabs;this.toggle_container=[];container=$($.find(".tabs-container"));tabs=container.find(">div").toArray();tabs.map((tab)=>{let toggle_elements=$(tab).find("[data-toggle_group]").toArray();$(tab).find("[data-tab_ids]").toArray().map((el)=>{if(!this.tab_container[$(el).data('toggle')]){this.tab_container[$(el).data('toggle')]=[]}let isActive=$(el).attr("checked");$(el).data('tab_ids').split(',').map((id)=>{let $tab=$($(el).closest('.tabs')).find(`[href=${id}]`).closest('li');if(isActive){$tab.hide()}this.tab_container[$(el).data('toggle')].push($tab)})});if(toggle_elements.length>0){toggle_elements.map((toggle_element)=>{let name=$(toggle_element).data("toggle_name");let group=+$(toggle_element).data("toggle_group");let isActive=!!$(tab).find(`[data-toggle="${name}"]`).attr("checked");if(!this.toggle_container[name]){this.toggle_container[name]=[]}if(group===0&&!isActive){$(toggle_element).closest("div").hide()}else if(group===1&&isActive){$(toggle_element).closest("div").hide()}this.toggle_container[name].push(toggle_element)})}})},toggle:function(name){this.toggle_container[name].map((element)=>{$(element).closest("div").toggle()})},toggleTabs:function(name){this.tab_container[name].map((element)=>{$(element).toggle()})},toggleParamsInOrder:function(ver_id){const param_hide=localStorage.getItem(`${ver_id}param_hide`);const btn=document.getElementById('btn-toggle-view-params-order');const icon=document.getElementById('icon-toggle-view-params-order');const params=document.getElementsByClassName('s3-order-product-params');if(!param_hide){localStorage.setItem(`${ver_id}param_hide`,"hide")}btn.addEventListener('click',()=>{localStorage.getItem(`${ver_id}param_hide`)==="hide"?localStorage.setItem(`${ver_id}param_hide`,"show"):localStorage.setItem(`${ver_id}param_hide`,"hide")});if(param_hide==="hide"||!param_hide){icon.classList.remove('i-eyehide-svg');icon.classList.add('i-eyeshow-svg');btn.querySelector('.s3-btn-text').textContent=s3.loc('SHOP_ORDER_PRODUCT_PARAMETERS_SHOW');for(let param of params){param.style.display="none"}}else{icon.classList.remove('i-eyeshow-svg');icon.classList.add('i-eyehide-svg');btn.querySelector('.s3-btn-text').textContent=s3.loc('SHOP_ORDER_PRODUCT_PARAMETERS_HIDE');for(let param of params){param.style.display="table-cell"}}}}})(jQuery);var templateController={};(function($){templateController={editor:{},undoData:{},tplsInit:function(tpls_data){var self=this,files_dir=LS.get("_files_dir"),curr_list=LS.get("_curr_list"),curr_tab=LS.get("_curr_tab"),opened_tabs=LS.get("_opened_tabs"),direct_tab=LS.get("_direct_tab"),has_opened_file=false;self.tpl_params=tpls_data;self.mainBox=tpls_data.container;self.staff_user=tpls_data.staff_user;self.cms_advanced=tpls_data.cms_advanced;if(self.mainBox.find('#templatesList').length==0)self.mainBox.append('<div id="templatesList" class="main-container"></div>');if(self.mainBox.find('#editorContent').length==0){editor_html='<div id="ace_editor_wrapper"></div>';self.mainBox.append($('<div id="editorContent" class="main-container">'+editor_html+'</div>'))};self.editor=ace.edit("ace_editor_wrapper");$("#ace_editor_wrapper").on("click",function(event){curr_tab=LS.get("_curr_tab");if(!isNaN(curr_tab.tpl_id)&&(event.ctrlKey||event.metaKey)&&$(event.target).attr('class')=="ace_content"){var range=self.editor.getSelectionRange();var line=self.editor.session.getLine(range.start.row);var chunks=line.split(/['"]/);var left=0;for(var i=0,len=chunks.length;i<len;i++){left+=chunks[i].length+1;if(left>range.start.column){self.fastOpen(chunks[i]);return}}}});$(document).on('keydown',function(e){var active_tab=self.mainBox.find('#tplTabs li.active'),tpl_id=active_tab.attr('data-template-id'),theme_id=active_tab.attr('data-theme-id');self.checkForUnsavedTabs(e);var keyCode=e.keyCode||e.which,ctrlKey=e.ctrlKey||e.metaKey;if(ctrlKey&&keyCode==83){e.preventDefault();if(popupController.getLastPopup()){return false};if(typeof(curr_tab.tpl_id)=="number"&&self.mainBox.find('#tplTabs li[data-template-id="'+curr_tab.tpl_id+'"]').hasClass('global')){if(self.mainBox.find('.tab-body[data-template-id="'+curr_tab.tpl_id+'"][data-theme-id="'+curr_tab.theme_id+'"] input.save-changes').length==1){templateController.save()}else{self.popupMessage('Вы не можете редактировать глобальные шаблоны!')}}else{templateController.save()};self.parseTabs()};if(e.altKey&&keyCode==68&&self.mainBox.find('.s3-btn-tpl-data[data-tpl-id="'+tpl_id+'"]').size()){e.preventDefault();setTimeout(function(){if($('#s3-template-data-wrapper').size()==0){self.openTemplateData(tpl_id)}},50)};if(e.altKey&&keyCode==13){e.preventDefault();setTimeout(function(){self.switchFullscreen()},50)}});var um;$(document).on('keyup',function(e){var keyCode=e.keyCode||e.which;if($(e.target).attr('class')=="ace_text-input"&&$.inArray(keyCode,[27,33,34,35,36,37,38,39,40])===-1){var curr_tab=LS.get('_curr_tab'),area_val=self.mainBox.find('.tab-body[data-template-id="'+curr_tab.tpl_id+'"][data-theme-id="'+curr_tab.theme_id+'"] textarea[name="body"]').text().replace(/(?:\r\n|\r|\n)/g,'<br />'),editor_val=self.editor.getValue(),active_tab={'tpl_id':self.mainBox.find('#tplTabs li.active').attr('data-template-id'),'theme_id':self.mainBox.find('#tplTabs li.active').attr('data-theme-id')};if(curr_tab.tpl_id!=active_tab.tpl_id||curr_tab.theme_id!=active_tab.theme_id){curr_tab=active_tab}if(area_val!=editor_val){self.mainBox.find('.tab-body[data-template-id="'+curr_tab.tpl_id+'"][data-theme-id="'+curr_tab.theme_id+'"] textarea[name="body"]').text(editor_val)};if($(e.target).attr('class')=="ace_text-input"&&$(e.target).parent().attr('id')=="ace_editor_wrapper"){var origin_val=self.mainBox.find('div.tab-body[data-template-id="'+curr_tab.tpl_id+'"][data-theme-id="'+curr_tab.theme_id+'"] #bodyVal').val();origin_val=origin_val.replace(/(?:\r\n|\r|\n)/g,'<br />'),curr_val=self.mainBox.find('.tab-body[data-template-id="'+curr_tab.tpl_id+'"][data-theme-id="'+curr_tab.theme_id+'"] textarea[name="body"]').text().replace(/(?:\r\n|\r|\n)/g,'<br />'),not_all=false;self.mainBox.find('.tab-body[data-template-id="'+curr_tab.tpl_id+'"][data-theme-id="'+curr_tab.theme_id+'"] .template-themes-wrapper .template-theme').each(function(){if($(this).hasClass('unsaved')&&$(this).attr('data-theme-id')!=curr_tab.theme_id){not_all=true}});if(curr_val!=origin_val){self.setUnsavedTab(curr_tab.tpl_id,curr_tab.theme_id)}else if(curr_val==origin_val){self.removeUnsavedTab(curr_tab.tpl_id,curr_tab.theme_id,not_all)};self.undoData[curr_tab.tpl_id+'_'+curr_tab.theme_id]=jQuery.extend(true,new ace.UndoManager(),self.editor.getSession().getUndoManager())}}});$(document).on('mouseover','.s3-content #editorWrapper.fullscreen .main-tabs-wrapper, .s3-content #editorWrapper #editorContent .tab-body .tpl-title',function(){self.mainBox.find('.main-tabs-wrapper').addClass('active')});$(document).on('mouseleave','.s3-content #editorWrapper #editorContent .tab-body .tpl-title',function(){self.mainBox.find('.main-tabs-wrapper').removeClass('active')});if(!$.isEmptyObject(opened_tabs)){self.openExistingTabList(opened_tabs)};var hash=document.location.hash.split('&');for(var i=0;i<hash.length;i++){var params=hash[i].split('=');if(params[0]=="template_id"){var tpl_id=parseInt(params[1]),tpl;if(isNaN(direct_tab)){tpl=tpl_id;LS.set("_direct_tab",tpl_id);has_opened_file=true}else{tpl=tpl_id};if(tpl!=false){self.newTab(tpl,'smarty',0,null)}}};if(has_opened_file==false){if($.isEmptyObject(curr_tab)||curr_tab.tpl_id==0){if(self.tpl_params.request_list=='files'){if($.isEmptyObject(files_dir)){self.loadFilesList()}else{if(!self.mainBox.find('#filesList').length){self.mainBox.append('<div id="filesList" class="main-container"></div>')};self.switchMainBlocks('#filesList');self.loadFiles(files_dir)}}else{if(self.tpl_params.request_list!=''){curr_list=self.tpl_params.request_list;if(self.staff_user||self.cms_advanced){historyController.loadInProgress=true;window.location.hash=window.location.hash.replace('tab='+curr_list+'&','');setTimeout(function(){historyController.loadInProgress=false},500)}}switch(curr_list){case'sandbox':self.openSandbox(LS.get('_theme_id'));break;case'files':self.loadFilesList();break;case'root_files':self.loadFilesList(1);break;case'tpls':default:self.loadTemplatesList();break}}}};var win_height;$(window).resize(function(){if(self.mainBox.hasClass('fullscreen')){win_height=parseInt($(this).height())-116}else{win_height=parseInt($(this).height())-330}self.mainBox.find('.tpl-body').css('height',win_height);self.editor.renderer.onResize(true)})},loadTemplatesList:function(hidden){var self=this;if(self.mainBox){var self=this,groups_to_show=LS.get('groups_to_show');if(hidden==true){self.loadGroups()}else{LS.set('_curr_list','tpls');self.removeActiveTab();if(self.mainBox.find('#templatesList').is(':empty')){self.loadGroups()};if(groups_to_show.length>1){self.loadGroupTemplates()};self.switchMainBlocks('#templatesList');self.mainBox.find('#tabsMainLinks li').removeClass('active')}}self.hideLoader()},loadGroupTemplates:function(){var self=this,curr_group_id=LS.get('_tpl_current_group'),rnd=new Date().getTime();self.mainBox.find('.tpl-list-box').removeClass('visible');if(self.mainBox.find('.tpl-list-box[data-group-id="'+curr_group_id+'"]')[0]){self.mainBox.find('.tpl-list-box[data-group-id="'+curr_group_id+'"]').addClass('visible')}else{$.ajax({url:'/-/cms/v1/template/?act=list&'+S3_ACCESS+'&rnd='+rnd+'&group_id='+curr_group_id,method:'get',async:false,success:function(data){if($(data).find('.tpl-list-box')[0]){var tpls=$(data).find('.tpl-list-box').S3ChangeControls().attr('data-group-id',curr_group_id);self.mainBox.find('#tpl-list-container').append(tpls)}else{$.ui.dynatree.getNode($('#templatesList').find('.tpl-group-tree .group-'+curr_group_id)).expand(true)}}})}},loadGroups:function(){var self=this,templatesTab=$('#templatesList'),curr_group_id=LS.get('_tpl_current_group'),curr_group,rnd=new Date().getTime();if(!isNaN(curr_group_id)){curr_group='&group_id='+curr_group_id};$.get('/-/cms/v1/template/?act=list&'+S3_ACCESS+'&rnd='+rnd+curr_group,function(data){self.mainBox.find('#templatesList').html(data).S3ChangeControls().find('.tpl-group-tree').dynatree({debugLevel:0,noLink:true,minExpandLevel:2,onRender:function(node){$(node.span).find('.dynatree-title').click(function(){var curr_node=curr_group_id;node=$.ui.dynatree.getNode($(this));node.tree.$tree.find('.active').removeClass('active');node.tree.$tree.find('.active-parent').removeClass('active-parent');curr_node=node.data.group;LS.set('_tpl_current_group',curr_node);$(node.span).addClass('active').parents('ul').each(function(){$(this).siblings('.dynatree-node').addClass('active-parent')});if(node.data.group==true){self.mainBox.find('.tpl-group').not('.search-result').show()}else if(typeof node.data.group=='number'){self.loadGroupTemplates()}})},onExpand:function(flag,dtnode){try{var data=LS.get('_tpl_tree');if(typeof data!='object'||data==null){data={}};if(flag==true){data[dtnode.data.group]=true}else{delete data[dtnode.data.group]};LS.set('_tpl_tree',data)}catch(e){};var tpl_current_group=LS.get('_tpl_current_group');self.setActiveGroup(tpl_current_group)},onPostInit:function(node,nodeSpan){var tpl_tree_data=LS.get('_tpl_tree'),tpl_current_group=LS.get('_tpl_current_group');if(!$.isEmptyObject(tpl_tree_data)){for(var i in tpl_tree_data){$.ui.dynatree.getNode(templatesTab.find('.tpl-group-tree .group-'+i)).expand(true)}};self.setActiveGroup(tpl_current_group)}})})},setActiveGroup:function(group_id){var self=this,group_id=parseInt(group_id);if(isNaN(group_id)){self.mainBox.find('.dynatree-node.group-601, .dynatree-node.group-201').addClass('active')}else{self.mainBox.find('.dynatree-node.group-'+group_id).addClass('active').parents('li').find('>.dynatree-node').addClass('active')}},setUnsavedTab:function(tab_id,theme_id){var self=this;self.mainBox.find('#tplTabs li[data-template-id="'+tab_id+'"]').addClass('unsaved');self.mainBox.find('.tab-body[data-template-id="'+tab_id+'"] span.template-theme[data-theme-id="'+theme_id+'"]').addClass('unsaved')},removeUnsavedTab:function(tab_id,theme_id,not_all){var self=this;if(!not_all){self.mainBox.find('#tplTabs li[data-template-id="'+tab_id+'"]').removeClass('unsaved')};self.mainBox.find('.tab-body[data-template-id="'+tab_id+'"] span.template-theme[data-theme-id="'+theme_id+'"]').removeClass('unsaved')},loadFilesList:function(is_root){var self=this,$filesContainer=self.mainBox.find('#filesList'),dir="",files_dir=LS.get('_files_dir'),rnd=new Date().getTime();if(!$.isEmptyObject(files_dir)){dir=files_dir};if(!is_root&&!self.staff_user&&!self.cms_advanced&&($.isEmptyObject(files_dir)||!dir.match(/^\&dir=%2Fimages/))){dir="&dir=%2Fimages"};if(!$filesContainer.length){self.mainBox.append('<div id="filesList" class="main-container"></div>')};self.switchMainBlocks('#filesList');$.get('/-/cms/v1/file-storage/?act=list&root='+is_root+'&'+S3_ACCESS+'&rnd='+rnd+dir,function(data){self.mainBox.find('#filesList').html(data).S3ChangeControls();self.removeActiveTab()});if(is_root){LS.set('_curr_list','root_files')}else{LS.set('_curr_list','files')}self.hideLoader()},loadFilesListByExt:function(ext,popup){var rnd=new Date().getTime();if(popup){popup='&popup=1'};var mode="";switch(ext){case"css":mode=ext;break;case"js":ext="js";mode=ext;break;case"tpl":ext="tpl";mode="smarty";break;case"less":ext="less";mode="css";break;case"scss":ext="scss";mode="css";break};if(!mode){mode="htmlmixed"};$.get('/-/cms/v1/file-storage/?act=lisByExt&'+S3_ACCESS+'&rnd='+rnd+'&ext='+ext+popup,function(data){if(data){S3PopUp.closeLastPopup();S3PopUp.open('popup',{'body':data,'title':"Файлы *."+ext})}else{s3.alert("Произошла ошибка при открытии списка файлов.")}})},loadFiles:function(dir,is_root){var self=this,rnd=new Date().getTime();if($.isEmptyObject(dir)){dir=''}if(!self.staff_user&&!self.cms_advanced&&dir&&!dir.match(/^\&dir=%2Fimages/)&&!dir.match(/^\&dir=images/)){dir="&dir=%2Fimages"}LS.set('_files_dir',dir);$.get('/-/cms/v1/file-storage/?act=list&root='+is_root+'&'+S3_ACCESS+'&rnd='+rnd+dir,function(data){self.mainBox.find('#filesList').html(data).S3ChangeControls()})},loadFilesListByThemeId:function(theme_id){var self=this,theme_id=parseInt(theme_id,10),rnd=new Date().getTime();if(theme_id){$.get('/-/cms/v1/file-storage/?act=lisByExt&'+S3_ACCESS+'&rnd='+rnd+'&theme_id='+theme_id,function(data){var $files_cont=$('#theme-files');if(data){$files_cont.html(data);var theme_files='',counter=0;self.mainBox.find('#theme-files table.files tr').each(function(){if($(this).attr('data-file-changed')=="true"&&$(this).attr('data-publicating-forbidden')!="true"){if(counter>0)theme_files+=',';theme_files+=$(this).attr('data-file_path');counter++}});self.mainBox.find('#theme_files').val(theme_files);if(self.mainBox.find('#theme_files').val()==""&&self.mainBox.find('#theme_tpls').val()==""){self.mainBox.find('span.publicate').attr('onclick','s3.alert("Нет файлов для публикации. Все соответствует оригиналам")')}}})}},openSandbox:function(theme_id){var self=this,rnd=new Date().getTime();self.removeActiveTab();if($('#sandboxList').length==0){self.mainBox.append($('<div id="sandboxList" class="main-container"></div>'))}var $tabContent=self.mainBox.find('#sandboxList');$tabContent.empty();if(theme_id){$.get('/-/cms/v1/template/?act=theme&'+S3_ACCESS,{'theme_id':theme_id,'rnd':rnd},function(data){self.switchMainBlocks('#sandboxList');LS.set('_curr_list','sandbox');LS.set('_theme_id',theme_id);if(data){$tabContent.html(data).S3ChangeControls()};$tabContent.append($('<div id="theme-files"></div>'));self.loadFilesListByThemeId(theme_id)})};self.switchMainBlocks('#sandboxList');self.mainBox.find('#themeTabs li').each(function(){if($(this).attr('data-theme-id')==theme_id){$(this).addClass('active')}else{$(this).removeClass('active')}})},switchMainBlocks:function(selector){var self=this;if(selector!="#sandboxList"){self.mainBox.find('#themeTabs li').removeClass('active')};self.mainBox.find('.main-container').css('display','none');self.mainBox.find(selector).css('display','block')},newTab:function(file_id,mode,theme_id,event,is_root){var self=this,hidden=false,params={},rnd=new Date().getTime();if((event!=null&&event.ctrlKey==true)||event=="hidden"){hidden=true};opened_tabs=LS.get('_opened_tabs');for(key in opened_tabs){if(opened_tabs[key]['tpl_id']==file_id){opened_tabs[key]['theme_id']=theme_id;opened_tabs[key]['is_root']=is_root}};LS.set('_opened_tabs',opened_tabs);if(typeof(file_id)=="number"){if(self.mainBox.find('#tplTabs li[data-template-id="'+file_id+'"]').length==0){data=self.templateGetData(file_id,theme_id,rnd);self.createTab(data,mode,theme_id,hidden)}else{self.switchTab(file_id,theme_id,event)}}else if(typeof(file_id)=="string"){var origin_path=(theme_id==0)?file_id:file_id.replace('theme'+theme_id,'images');if(self.mainBox.find('#tplTabs li[data-template-id="'+origin_path+'"]').length==0){var themes={},th={},curr_dir=LS.get('_files_dir');$('#themeTabs li').each(function(){is_sandbox=($(this).attr('data-sandbox')=="true")?1:0;th[$(this).attr('data-theme-id')]=is_sandbox;themes=th});if(curr_dir!="&dir="){themes=JSON.stringify(themes)};data=self.fileGetData(file_id,theme_id,rnd,themes,is_root);if(data){self.createTab(data,mode,theme_id,hidden,is_root)}}else{self.switchTab(origin_path,theme_id,event)}}},createTab:function(data,mode,theme_id,hidden){var self=this,rnd=new Date().getTime(),tab_index,new_tab_index=0,is_root=data.hasOwnProperty('is_root')?data.is_root:1;if(self.mainBox.find('.main-tabs-wrapper #tplTabs').length==0){self.mainBox.find('.main-tabs-wrapper').append('<ul id="tplTabs" class="te-tabs"></ul>');self.tabsSortInit()};if(self.mainBox.find('#tplTabs li').size()==0){tab_index=1}else{var this_tab_index;self.mainBox.find('#tplTabs li').each(function(){this_tab_index=parseInt($(this).attr('data-tab-index'));if(this_tab_index&&this_tab_index>new_tab_index){new_tab_index=this_tab_index}});tab_index=new_tab_index+1};if(mode=="smarty"){file_id=parseInt(data.part.template_id);file_name=data.part.filename;file_body=data.body;file_global=(data.part.global==1)?" global":"";file_unsaved=(file_id==0)?"unsaved":"";if(self.mainBox.find('#tplTabs li[data-template-id="'+file_id+'"]').length==0){self.mainBox.find('#tplTabs').append('<li class="'+file_unsaved+'" data-readonly="'+data.part.readonly+'" data-tab-index="'+tab_index+'" data-template-id="'+file_id+'" data-theme-id="'+theme_id+'" data-mode="'+mode+'"><span data-tab-id="'+tab_index+'" class="name'+file_global+'" onclick="templateController.switchTab('+file_id+','+theme_id+', event)">'+file_name+'<span onclick="templateController.closeTab('+file_id+', event);" class="s3-ico i-close-small gray close-butt"></span></span></li>');self.mainBox.find('#editorContent').prepend('<div class="tab-body" data-template-id="'+file_id+'" data-theme-id="0" data-tab-index="'+tab_index+'">'+file_body+'</div>').S3ChangeControls()}}else{file_id=data.origin_path;file_name=data.name;file_body=data.body;file_icon="";file_pic="data-pic='false'";file_theme="";if(data.mode=="pic"){file_icon="<span class='s3-ico i-pic'></span>";file_pic="data-pic='true'"};if(data.theme_name){file_theme=data.theme_name};if(data.theme_id){file_theme_id=data.theme_id}else{file_theme_id=0};if(self.mainBox.find('#tplTabs li[data-template-id="'+file_id+'"]').length==0){self.mainBox.find('#tplTabs').append('<li data-tab-index="'+tab_index+'" data-root="'+is_root+'" data-template-id="'+file_id+'" data-theme-id="'+theme_id+'" data-mode="'+mode+'"><span data-tab-id="'+tab_index+'" class="name" onclick="templateController.switchTab(\''+file_id+'\','+theme_id+', event)">'+file_icon+file_name+'<span onclick="templateController.closeTab(\''+file_id+'\', event);" class="s3-ico i-close-small gray close-butt"></span></span></li>');self.mainBox.find('#editorContent').prepend('<div class="tab-body" '+file_pic+' data-template-id="'+file_id+'" data-theme-id="'+file_theme_id+'" data-tab-index="'+tab_index+'">'+file_body+'</div>').S3ChangeControls()}};if(mode=="smarty"){if(!$.isEmptyObject(data.part.themes)){self.mainBox.find('#tplTabs li[data-template-id="'+file_id+'"]').attr('data-theme-id',theme_id);for(var i=0;i<data.part.themes.length;i++){if(self.mainBox.find('#editorContent div.tab-body[data-template-id="'+data.part.themes[i].template_id+'"][data-theme-id="'+data.part.themes[i].theme_id+'"]').length==0){if(!self.staff_user&&self.cms_advanced){if(data.part.themes[i]['is_sandbox']==0){self.mainBox.find('#editorContent').prepend('<div class="tab-body" data-template-id="'+data.part.themes[i].template_id+'" data-theme-id="'+data.part.themes[i].theme_id+'" data-tab-index="'+tab_index+'">'+data.part.themes[i].body+'</div>').S3ChangeControls()}}else{self.mainBox.find('#editorContent').prepend('<div class="tab-body" data-template-id="'+data.part.themes[i].template_id+'" data-theme-id="'+data.part.themes[i].theme_id+'" data-tab-index="'+tab_index+'">'+data.part.themes[i].body+'</div>').S3ChangeControls()}}}}}else{if(!$.isEmptyObject(data.themes)){self.mainBox.find('#tplTabs li[data-template-id="'+file_id+'"]').attr('data-theme-id',theme_id);for(key in data.themes){theme=data.themes[key];file_pic="data-pic='false'";if(theme.mode=="pic"){file_pic="data-pic='true'"};if(self.mainBox.find('#editorContent div.tab-body[data-template-id="'+theme.origin_path+'"][data-theme-id="'+theme.theme_id+'"]').length==0){self.mainBox.find('#editorContent').prepend('<div class="tab-body" '+file_pic+' data-template-id="'+theme.origin_path+'" data-theme-id="'+theme.theme_id+'" data-tab-index="'+tab_index+'">'+theme.body+'</div>').S3ChangeControls()}}}};self.parseTabs();if(mode=="smarty"){if(data.part.template_id!=0){redis_file_id=file_id}}else{redis_file_id="'"+file_id+"'"};if(hidden!=true){if(!isNaN(file_id)){file_id=parseInt(file_id)};curr_tab={"tpl_id":file_id,"theme_id":theme_id,"is_root":is_root};LS.set('_curr_tab',curr_tab);self.switchTab(file_id,theme_id,hidden);self.switchMainBlocks('#editorContent')};if(self.mainBox.hasClass('fullscreen')){var height=parseInt($(window).height())-200;self.mainBox.addClass('fullscreen');if(height>500){self.mainBox.find('.tpl-body').css('height',height)}};self.editor.renderer.onResize(true)},fastOpen:function(file){var self=this,ver_id=self.mainBox.find('#ver_id').val(),tpl_name="",file_name="",rnd=new Date().getTime();if(file==""){return false};if(file.match(/^db:([a-z0-9\.-]+\.(arc|tpl))$/i)){tpl_name=file.match(/^db:([a-z0-9\.-]+\.(arc|tpl))$/i);tpl_ver_id=ver_id}else if(file.match(/^global:([a-z0-9\.-]+\.(arc|tpl))$/i)){tpl_name=file.match(/^global:([a-z0-9\.-]+\.(arc|tpl))$/i);tpl_ver_id=0};if(tpl_name!=""){params={"tpl_name":tpl_name[1],"tpl_ver_id":parseInt(tpl_ver_id)};$.ajax({dataType:"json",url:'/-/cms/v1/template/?act=getByName&'+S3_ACCESS+'&rnd='+rnd,data:params,async:false,success:function(data){if(data.status==1){self.newTab(data.value,'smarty',0,false)}else{s3.alert("Данный шаблон не найден")}}})};if(file.match(/\.css$/)||file.match(/\.js$/)){file_name=file};if(file_name!=""){$.ajax({dataType:"json",url:'/-/cms/v1/file-storage/?act=getByName&'+S3_ACCESS+'&rnd='+rnd,data:{"filename":file_name},async:false,success:function(data){if(data.existing==true){templateController.newTab(data.path,data.ext,0,false)}else{window.open(file_name,'_blank')}}})}},templateGetData:function(tpl_id,theme_id,rnd){var template_data={},params;params={'output_json':true,'template_id':tpl_id,'theme_id':theme_id,'rnd':rnd};$.ajax({dataType:"json",url:'/-/cms/v1/template/?act=edit&'+S3_ACCESS,data:params,async:false}).done(function(data){template_data=data});return template_data},fileGetData:function(file_id,theme_id,rnd,themes,is_root){var self=this;params={'file_path':file_id,'theme_id':theme_id,'rnd':rnd,'themes':themes};$.ajax({dataType:"json",url:'/-/cms/v1/file-storage/?act=edit&root='+is_root+'&'+S3_ACCESS,data:params,async:false}).done(function(data){file_data=data});if(file_data){return file_data}else{s3.alert(s3.loc('JS_TEMPLATE_CHARS_ENCODING_ERROR'));return false}},checkForUnsavedTabs:function(e){var self=this,keyCode=e.keyCode||e.which;if(keyCode==116||keyCode==116&&e.ctrlKey||keyCode==82&&e.ctrlKey){self.mainBox.find('#tplTabs li').each(function(){if($(this).hasClass('unsaved')){e.preventDefault();if($('#modal_layer').is(':visible')){return false}else{message='Изменения во вкладке <span style="color:#cc3333;">'+$(this).text()+'</span> не сохранены, перезагрузить страницу ?';s3.confirm(message,function(){popupController.closeLastPopup();document.location.reload()})}}})}},parseTabs:function(){var self=this,win_height=parseInt($(window).height())-330;template_tabs={};$('#tplTabs li').each(function(){tab_data={'theme_id':parseInt($(this).attr('data-theme-id')),'mode':$(this).attr('data-mode')};if(tab_data.mode=="smarty"){tab_data['tpl_id']=parseInt($(this).attr('data-template-id'))}else{tab_data['tpl_id']=$(this).attr('data-template-id')};tab_data['is_root']=$(this).data('root');template_tabs[$(this).index()]=tab_data});if(!self.mainBox.hasClass('fullscreen')){self.mainBox.find('.tpl-body').css('height',win_height);self.editor.renderer.onResize(true)}LS.set('_opened_tabs',template_tabs)},switchTab:function(tab_id,theme_id,event){var self=this,editor_theme=util.readCookie('editorTheme'),close=false;self.mainBox.find('.main-tabs-wrapper').removeClass('active');if(event!=null){if(event.ctrlKey&&event.ctrlKey==true&&!$(event.target).hasClass('list-item')||$(event.target).hasClass('close-butt')){close=true}};if(close){self.closeTab(tab_id,event)}else{if(theme_id!=0&&self.mainBox.find('#editorContent .tab-body[data-template-id="'+tab_id+'"][data-theme-id="'+theme_id+'"]').size()==0){theme_id=0};self.switchMainBlocks('#editorContent');self.setActiveTab(tab_id,theme_id);if(typeof(tab_id)=="string"){self.mainBox.find('#tplTabs li[data-template-id="'+tab_id+'"] span.name').attr('onclick','templateController.switchTab(\''+tab_id+'\','+theme_id+',event)').parent('li[data-theme-id="'+theme_id+'"]')}else{self.mainBox.find('#tplTabs li[data-template-id="'+tab_id+'"] span.name').attr('onclick','templateController.switchTab('+tab_id+','+theme_id+',event)').parent('li[data-theme-id="'+theme_id+'"]')};var $body=self.mainBox.find('.tab-body[data-template-id="'+tab_id+'"][data-theme-id="'+theme_id+'"] textarea[name="body"]');var tab=self.mainBox.find('#tplTabs li[data-template-id="'+tab_id+'"]');var is_root=tab.data('root');editor_text=$body.val();editor_mode=tab.attr('data-mode');if(!isNaN(tab_id)){tab_id=parseInt(tab_id)};curr_tab={"tpl_id":tab_id,"theme_id":theme_id,"is_root":is_root};LS.set('_curr_tab',curr_tab);readonly=self.mainBox.find('#tplTabs li[data-template-id="'+tab_id+'"]').attr('data-readonly');if($body.hasClass('xedit')||["pic","lite"].indexOf(editor_mode)!==-1){$('#ace_editor_wrapper').addClass('hidden')}else{$('#ace_editor_wrapper').removeClass('hidden');var scrolls_info=LS.get('_scrolls_info');if(scrolls_info[tab_id]&&scrolls_info[tab_id][theme_id]){scrollTop=scrolls_info[tab_id][theme_id]}else{scrollTop=0};self.editor.getSession().on('changeScrollTop',function(scroll){var self=this,curr_tab=LS.get('_curr_tab'),scroll_info,scrolls_info=LS.get('_scrolls_info');scroll_info=curr_tab;tpl_id=scroll_info['tpl_id'];theme_id=scroll_info['theme_id'];scroll_val=scroll;if(tpl_id in scrolls_info){scroll_item=scrolls_info[tpl_id]}else{scroll_item={}};scroll_item[theme_id]=scroll_val;scrolls_info[tpl_id]=scroll_item;LS.set('_scrolls_info',scrolls_info)});self.editorUpdate(editor_text,editor_mode,tab_id,theme_id,readonly,scrollTop);self.mainBox.find('.editor-theme-select option').each(function(){if($(this).val()==editor_theme){$(this).attr('selected','selected')}else{$(this).removeAttr('selected')}});self.mainBox.find(".editor-theme-select").trigger("liszt:updated")};self.parseTabs()}},openExistingTabList:function(tabs){var self=this,curr_tab=LS.get('_curr_tab');for(tab in tabs){var hidden='hidden';mode=tabs[tab]['mode'];theme_id=tabs[tab]['theme_id'];tpl_id=tabs[tab]['tpl_id'];is_root=tabs[tab]['is_root'];if(tpl_id==curr_tab['tpl_id']){hidden=false};if(tpl_id!=0){self.newTab(tpl_id,mode,theme_id,hidden,is_root)}}},setActiveTab:function(tab_id,theme_id){var self=this;self.mainBox.find('#tplTabs li').removeClass('active');self.mainBox.find('#tplTabs li[data-template-id="'+tab_id+'"]').addClass('active').attr('data-theme-id',theme_id);tab_index=self.mainBox.find('#tplTabs li[data-template-id="'+tab_id+'"]').attr('data-tab-index');if(self.mainBox.find('#editorContent .tab-body').attr('data-pic')=="true"){self.mainBox.find('#editorContent .tab-body').find('.fileform input[name="userfile[]"]').attr('id','new_file_'+theme_id)};self.mainBox.find('#editorContent .tab-body').removeClass('visible');self.mainBox.find('#editorContent .tab-body[data-tab-index="'+tab_index+'"][data-theme-id="'+theme_id+'"]').addClass('visible');if(self.mainBox.find('#editorContent .tab-body[data-template-id="'+tab_id+'"][data-theme-id="'+theme_id+'"]').attr('data-pic')=="true"){self.mainBox.find('#editorContent .tab-body[data-template-id="'+tab_id+'"][data-theme-id="'+theme_id+'"]').find('.fileform input[name="userfile[]"]').attr('id','new_file')}},removeActiveTab:function(){var self=this;LS.remove('_curr_tab');self.mainBox.find('#tplTabs li').removeClass('active')},closeTab:function(tpl_id,event){var self=this,opened_tabs=LS.get("_opened_tabs"),scrolls_info=LS.get("_scrolls_info"),tab=self.mainBox.find('#tplTabs li[data-template-id="'+tpl_id+'"]'),tab_index=tab.attr('data-tab-index'),is_root=tab.data('root'),tab_id_to_show,tab_theme_id_to_show,empty;if(tab.hasClass('unsaved')){message='Изменения во вкладке <span style="color:#cc3333;">'+tab.text()+'</span> не сохранены, закрыть вкладку?';s3.confirm(message,function(){popupController.closeLastPopup();closeTab()})}else{closeTab()};function closeTab(){if(isNaN(+tpl_id)){$.post('/-/cms/v1/file-storage/?act=activity&'+S3_ACCESS,{"filepath":tpl_id,'remove':1})}else{$.post('/-/cms/v1/template/?act=activity&'+S3_ACCESS,{"template_id":tpl_id,'remove':1})}for(key in opened_tabs){if(opened_tabs[key]['tpl_id']==tpl_id){delete opened_tabs[key]}};LS.set('_opened_tabs',opened_tabs);if(scrolls_info[tpl_id]){delete scrolls_info[tpl_id];LS.set('_scrolls_info',scrolls_info)};if(tab.hasClass('active')){if(tab.prev('li')[0]){tab_to_show=tab.prev('li').attr('data-template-id');tab_theme_id_to_show=tab.prev('li').attr('data-theme-id')}else{tab_to_show=tab.next('li').attr('data-template-id');tab_theme_id_to_show=tab.next('li').attr('data-theme-id')};if(!$.isEmptyObject(opened_tabs)){self.switchTab(tab_to_show,tab_theme_id_to_show,false)};if(!isNaN(tab_to_show)){tab_to_show=parseInt(tab_to_show)};curr_tab={"tpl_id":tab_to_show,"theme_id":tab_theme_id_to_show,"is_root":tab_to_show?is_root:empty};LS.set('_curr_tab',curr_tab)};tab.remove();self.mainBox.find('#editorContent .tab-body[data-tab-index="'+tab_index+'"]').remove();if(self.mainBox&&self.mainBox.find('#tplTabs li').size()==0){var curr_list=LS.get('_curr_list');if(curr_list=='root_files'){is_root=1}self.mainBox.find('#tplTabs').remove();switch(curr_list){case"tpls":if(self.mainBox.find('#tplData').length==0){self.loadTemplatesList()}else{self.switchMainBlocks('#templatesList')};break;case"root_files":case"files":if(self.mainBox.find('#filesList').length==0){self.loadFilesList(is_root)}else{if(!self.mainBox.find('#filesList').length){self.mainBox.append('<div id="filesList" class="main-container"></div>')};self.switchMainBlocks('#filesList');self.loadFiles(LS.get('_files_dir'),is_root)};break;case"sandbox":if(self.mainBox.find('#sandboxList').length==0){self.openSandbox(LS.get('_theme_id'))}else{self.switchMainBlocks('#sandboxList')};break;default:self.loadTemplatesList();break}}};if(event!=false){event.stopPropagation()}},openTemplateData:function(template_id){template_id=parseInt(template_id,10);s3.openModalPopup('/-/cms/v1/template/data/?'+S3_ACCESS+'&popup=1&template_id='+template_id,false)},openTemplateInfo:function(template_id){template_id=parseInt(template_id,10);s3.openModalPopup('/my/s3/template2/info/?'+S3_ACCESS+'&popup=1&template_id='+template_id,false)},newTemplate:function(){var self=this;var params={'output_json':true};$.getJSON('/-/cms/v1/template/?act=edit&'+S3_ACCESS,params,function(data){data['part']['filename']="untitled.tpl";data['part']['template_id']=0;self.createTab(data,"smarty",0,false)})},save:function(){var self=this,curr_tab=LS.get('_curr_tab'),timeout=300,tpl_tab=self.mainBox.find('.tab-body[data-template-id="'+curr_tab['tpl_id']+'"][data-theme-id="'+curr_tab['theme_id']+'"] .template-themes-wrapper .template-theme[data-theme-id="'+curr_tab['theme_id']+'"]'),error_text="",no_global_access=false,active_tab={'tpl_id':self.mainBox.find('#tplTabs li.active').attr('data-template-id'),'theme_id':self.mainBox.find('#tplTabs li.active').attr('data-theme-id'),'is_root':self.mainBox.find('#tplTabs li.active').data('root')};if(!$.isEmptyObject(curr_tab)&&$('#editor-loader').length==0){file_id=curr_tab['tpl_id'];theme_id=curr_tab['theme_id'];is_root=curr_tab['is_root'];if(!isNaN(file_id)){file_id=parseInt(file_id)}if(!isNaN(active_tab.tpl_id)){active_tab.tpl_id=parseInt(active_tab.tpl_id)}if(!self.mainBox.is(':visible')){return false}if(active_tab.tpl_id!=file_id){file_id=active_tab.tpl_id;is_root=active_tab.is_root}if(active_tab.theme_id!=theme_id){theme_id=active_tab.theme_id}curr_tab={'tpl_id':file_id,'theme_id':theme_id,'is_root':is_root};LS.set('_curr_tab',curr_tab);if(self.mainBox.find('.tab-body[data-template-id="'+curr_tab['tpl_id']+'"][data-theme-id="'+curr_tab['theme_id']+'"] input.save-changes').length==0){no_global_access=true};setTimeout(function(){if(typeof(file_id)=="number"){if(no_global_access){error_text="Вы не можете редактировать глобальные шаблоны"}else{self.saveTemplate(file_id,theme_id,false)}}else{if(no_global_access){error_text="Вы не можете редактировать глобальные файлы"}else{self.saveFile(file_id,theme_id,false,is_root)}};if(no_global_access){s3.alert(error_text)}},timeout)}},saveTemplate:function(template_id,theme_id,compairing_save,callback){var self=this,rnd=new Date().getTime();if($('#editor-popup-message').length==0){var template_id=parseInt(template_id,10),theme_id=parseInt(theme_id,10);if(compairing_save==true){var form_data={};var tpl_data=self.templateGetData(template_id,theme_id,rnd);form_data={"ver_id":tpl_data.part.ver_id,"access":$('#access').val(),"template_id":tpl_data.part.template_id,"name":tpl_data.part.name,"filename":tpl_data.part.filename,"plugin_id":tpl_data.part.plugin_id,"content_type":tpl_data.part.content_type,"template_group_id":tpl_data.part.template_group_id,"body":self.origin_editor.getValue()}}else{var $form=$('#tpl-editor-form-'+template_id+'-'+theme_id),disabled=$form.find(':input:disabled').removeAttr('disabled'),form_data=$form.serializeArray()}self.showLoader();var form_body="";for(key in form_data){if(form_data[key].name=="body"){form_body=form_data[key].value}}$.ajax({type:"POST",url:"/-/cms/v1/template/?act=editing&"+S3_ACCESS+'&rnd='+rnd,data:form_data,async:true,success:function(data){self.hideLoader();if(data=="1"){self.popupMessage('JS_TEMPLATE_SUCCESSFULY_SAVED')}if(compairing_save==true){self.popupMessage('JS_TEMPLATE_SUCCESSFULY_SAVED');var theme_body=self.theme_editor.getValue();if(form_data.body==theme_body){$(self.origin_editor.container).parents('.compare-block').prev('tr').find('.s3-ico.i-brick').removeClass('s3-tooltip').addClass('hidden');$(self.origin_editor.container).parents('.compare-block').prev('tr').find('.s3-ico.i-view').addClass('hidden');$(self.origin_editor.container).parents('.compare-block').prev('tr').find('td.status').html('<span class="published">Опубликовано</span>');$(self.origin_editor.container).parents('.compare-block').remove()}self.refreshTabs()}else{var added=data.match(/^added([0-9]+)/);if(added&&added.length>0&&added[1]!=null){self.removeUnsavedTab(0,0);self.closeTab(0,false);self.newTab(parseInt(added[1]),"smarty",0,false);s3.alert(s3.loc('JS_TEMPLATE_SUCCESSFULY_SAVED'))}else{if(self.mainBox){if(data==1){self.popupMessage(data);var not_all=false;self.mainBox.find('.tab-body[data-template-id="'+curr_tab.tpl_id+'"][data-theme-id="'+curr_tab.theme_id+'"] .template-themes-wrapper .template-theme').each(function(){if($(this).hasClass('unsaved')&&$(this).attr('data-theme-id')!=curr_tab.theme_id){not_all=true}});self.mainBox.find('div.tab-body[data-template-id="'+template_id+'"][data-theme-id="'+theme_id+'"]').find('#bodyVal').text(form_body);self.removeUnsavedTab(template_id,theme_id,not_all)}else{s3.alert(data)}}else{if(data!=1){s3.alert(data);return false}}}self.loadTemplatesList(true)}if(typeof callback=='function'){callback()}},error:function(XMLHttpRequest,textStatus,errorThrown){self.hideLoader();s3.alert('Произошла ошибка. Проверьте корректность кода')}})}},templateGlobalContext:function(object,target,template_id,group_id){S3ContextMenuController.openContextMenu(target,function(context){var pos=$(object).position();context.find('.make-local-copy').attr('template_id',template_id).attr('group_id',group_id);context.css({left:pos.left+5,top:pos.top+15})})},templateLocalContext:function(object,target,template_id){S3ContextMenuController.openContextMenu(target,function(context){var pos=$(object).position();context.find('.make-local-copy').attr('template_id',template_id);context.css({left:pos.left+5,top:pos.top+15})})},saveFile:function(file_path,theme_id,compairing_save,is_root){var self=this,$form=$('form[data-file-path="'+file_path+'"][data-theme-id="'+theme_id+'"]');if(compairing_save==true){var form_data={},rnd=new Date().getTime();var themes={},th={};$('#themeTabs li').each(function(){var is_sandbox=($(this).attr('data-sandbox')=="true")?1:0;th[$(this).attr('data-theme-id')]=is_sandbox;themes=th});themes=JSON.stringify(themes);var file_data=self.fileGetData(file_path,0,rnd,themes),is_root=file_data.is_root;if(!file_data){return false}form_data={"name":file_data.name,"dir":file_data._dir,"sandbox":0,"body":self.origin_editor.getValue(),}}else{var form_data=$form.serializeArray()}form_body="";for(key in form_data){if(form_data[key].name=="body"){form_body=form_data[key].value}}if($('#editor-popup-message').length==0){self.showLoader();$.post('/-/cms/v1/file-storage/?act=editing&root='+is_root+'&'+S3_ACCESS+'&rnd='+new Date().getTime(),form_data,function(data){self.hideLoader();if(data=='1'){if(compairing_save==true){theme_body=self.theme_editor.getValue();if(form_data.body==theme_body){$(self.origin_editor.container).parents('.compare-block').prev('tr').find('.s3-ico.i-brick').removeClass('s3-tooltip').addClass('hidden');$(self.origin_editor.container).parents('.compare-block').prev('tr').find('.s3-ico.i-view').addClass('hidden');$(self.origin_editor.container).parents('.compare-block').prev('tr').find('td.status').html('<span class="published">Опубликовано</span>');$(self.origin_editor.container).parents('.compare-block').remove()}}else{self.popupMessage("Файл успешно сохранен.");curr_tab=LS.get('_curr_tab');not_all=false;self.mainBox.find('.tab-body[data-template-id="'+curr_tab.tpl_id+'"][data-theme-id="'+curr_tab.theme_id+'"] .template-themes-wrapper .template-theme').each(function(){if($(this).hasClass('unsaved')&&$(this).attr('data-theme-id')!=curr_tab.theme_id){not_all=true}});self.mainBox.find('div.tab-body[data-template-id="'+file_path+'"][data-theme-id="'+theme_id+'"]').find('#bodyVal').text(form_body);self.removeUnsavedTab(file_path,theme_id,not_all)}}else{s3.alert("Ошибка:<br>"+data)}})}},addToSandbox:function(theme_id){var template_ids=[],self=this,rnd=new Date().getTime();$('.tpl_id:checked').each(function(){template_ids.push($(this).val())});if(template_ids.length==0){s3.alert('Шаблоны не отмечены');return false}if(theme_id!=''){self.showLoader();$.post('/-/cms/v1/template/?act=addToTheme&'+S3_ACCESS+'&rnd='+rnd,{'template_ids':template_ids,'theme_id':theme_id},function(data){self.addTheme(data,"tpl")})}},addFilesToSandbox:function(theme_id){var selected_files=[],self=this,rnd=new Date().getTime();$('.copy_file_to_theme:checked').each(function(){selected_files.push($(this).attr('data-file_id'))});if(theme_id!=''){self.showLoader();$.get('/-/cms/v1/file-storage/?act=addToTheme&'+S3_ACCESS+'&rnd='+rnd,{'theme_id':theme_id,'files_to_move':selected_files},function(data){self.addTheme(data,"file")})}},addTheme:function(data,type){if(data==""){return false}var self=this,theme=$.parseJSON(data),add_class='';if(theme&&theme.theme_name){if(self.mainBox.find('#themeTabs li').length==0){add_class="one"}else if(self.mainBox.find('#themeTabs li').length==1){self.mainBox.find('#themeTabs li:first').removeClass('one').addClass('first');add_class="last"}else{self.mainBox.find('#themeTabs li:last').removeClass('last').addClass('middle');add_class="last"}self.mainBox.find('#themeTabs').append('<li data-sandbox="true" data-theme-id="'+theme.theme_id+'" class="'+add_class+'"><span class="s3-btn" style="color: #f7922d" onclick="templateController.openSandbox('+theme.theme_id+');">'+theme.theme_name+'</span></li>');self.mainBox.find('#templates_current_theme option.new-theme, #files_current_theme option.new-theme').before('<option value="'+theme.theme_id+'">'+theme.theme_name+'</option>');$("#templates_current_theme, #files_current_theme").trigger("liszt:updated")}if(type=="tpl"){$('.tpl_id:checked').each(function(){$(this).removeAttr('checked').parents('label:first-child').removeClass('active').parents('tr:first-child').find('.name').removeClass('active')});self.popupMessage('Версия шаблона(ов) для темы создана.');self.hideLoader();self.refreshTabs()}else if(type=="file"){$('.copy_file_to_theme').each(function(){$(this).removeAttr('checked').parents('label:first-child').removeClass('active').parents('tr:first-child').find('.name').removeClass('active')});self.popupMessage('Файлы скопированы.');self.hideLoader();self.refreshTabs()}},applyTheme:function(theme_id){var self=this,theme_id=parseInt(theme_id,10),tpls=self.mainBox.find('#theme_tpls[data-theme-id="'+theme_id+'"]').val(),tpls_tmp=self.mainBox.find('#theme_tpls[data-theme-id="'+theme_id+'"]').val(),files=self.mainBox.find('#theme_files[data-theme-id="'+theme_id+'"]').val();if(tpls!=""){tpls=tpls.split(",");publishTpl(tpls,theme_id,0)}if(files!=""){files=files.split(",")}if(tpls_tmp==""){s3.confirm('Публикация данных файлов можно затереть изменения, которые были внесены в основные файлы. Продолжить?',function(){publishFile(files,0);popupController.closeLastPopup()})}function publishTpl(tpls,theme_id,index){var tpl_id=parseInt(tpls[index]),theme_id=parseInt(theme_id),tpl_row=self.mainBox.find('.sandbox-templates-list table.templates tr[data-template-id="'+tpl_id+'"] td.status');tpl_row.text('Шаблон публикуетcя...');setTimeout(function(){$.ajax({url:'/-/cms/v1/template/?act=publish&'+S3_ACCESS,async:false,type:'post',data:{'theme_id':theme_id,'template_id':tpl_id},success:function(data){data=JSON.parse(data);if(data.status==0){tpl_row.html('<span class="not-published">Шаблоны различаются, внесите изменения вручную</span>')}else if(data.status==1){tpl_row.html('<span class="published">Опубликовано</span>');if(tpls.length==1||tpls.length-index==1){self.refreshTabs()}}if(tpls.length>1){if(index>=0&&index<tpls.length-1){index+=1;publishTpl(tpls,theme_id,index)}else{if(files!=""){s3.confirm('Публикация данных файлов можно затереть изменения, которые были внесены в основные файлы. Продолжить?',function(){publishFile(files,0);popupController.closeLastPopup()})}}}else{if(files!=""){s3.confirm('Публикация данных файлов можно затереть изменения, которые были внесены в основные файлы. Продолжить?',function(){publishFile(files,0);popupController.closeLastPopup()})}}}})},20)}function publishFile(files,index){var index=parseInt(index),file_path=files[index],file_row=self.mainBox.find('#theme-files table.files tr[data-file_path="'+file_path+'"] td.status');file_row.text('Файл публикуетcя...');setTimeout(function(){$.ajax({url:'/-/cms/v1/file-storage/?act=publish&'+S3_ACCESS,async:false,type:'post',data:{'file':file_path},success:function(data){if(data=="success"){file_row.html('<span class="published">Опубликовано</span>')}else{file_row.html('<span class="not-published">Файлы различаются, внесите изменения вручную</span>')}if(files.length>1){if(index>=0&&index<files.length-1){index+=1;publishFile(files,index)}}}})},20)}},refreshTabs:function(){var self=this;opened_tabs=LS.get('_opened_tabs');self.mainBox.find('#tplTabs li span span').click();self.openExistingTabList(opened_tabs)},applyTpl:function(template_id,theme_id){theme_id=parseInt(theme_id);template_id=parseInt(template_id);var applyTpl=function(){$.post('/-/cms/v1/template/?act=publish&'+S3_ACCESS,{'theme_id':theme_id,'template_id':template_id},function(data){data=JSON.parse(data);s3.reloadContent();s3.alert(data.msg)});popupController.closeLastPopup()};s3.confirm("Применить данный шаблон?",applyTpl)},applyFile:function(file_path){var applyTpl=function(){$.post('/-/cms/v1/file-storage/?act=publish&'+S3_ACCESS,{'file':file_path},function(data){s3.reloadContent();s3.alert('Файл опубликован')});popupController.closeLastPopup()};s3.confirm("Применить данный файл (можно затереть изменения, которые были внесены в основной файл)?",applyTpl)},deleteTheme:function(theme_id){var self=this,del_theme=function(){$.ajax({url:'/-/cms/v1/theme/?act=delete&'+S3_ACCESS+'&theme_id='+theme_id,async:false,success:function(data){if(data=="1"){self.refreshTabs();self.loadTemplatesList();s3.reloadContent()}else{s3.alert("Возникла ошибка при удалении темы. <br/>"+data)}popupController.closeLastPopup()}})};s3.confirm("Удалить тему?",del_theme)},clearTheme:function(theme_id){var self=this;var del_theme=function(){self.showLoader();$.get('/-/cms/v1/theme/?act=clear&'+S3_ACCESS+'&theme_id='+theme_id,function(data){self.hideLoader();if(data=="1"){self.refreshTabs();self.openSandbox(theme_id)}else{s3.alert("Возникла ошибка при очистке темы. <br/>"+data)}popupController.closeLastPopup()})};s3.confirm("Очистить тему?",del_theme)},addSandboxUser:function(){var self=this,add_user=self.mainBox.find('#add_user').val();if(add_user==""){self.popupMessage('Введите ID пользователя')}else if(isNaN(add_user)){self.popupMessage('Можно вводить только цифры')}else{var add_user_html='<div class="item" data-user-id="'+add_user+'">'+add_user+'<span onclick="templateController.removeSandboxUser(this);" class="s3-ico i-close-small gray"></span></div>';if(self.mainBox.find('#access_users_array div.item.empty').length!=0){self.mainBox.find('#access_users_array div.item.empty').remove()}if(self.mainBox.find('#access_users_array div.item[data-user-id="'+add_user+'"]').length==0){self.mainBox.find('#access_users_array').append(add_user_html);self.popupMessage('Пользователь добавлен в список',600)}else{self.popupMessage('Данный пользователь уже добавлен в список',1500)}self.mainBox.find('#add_user').val('')}},removeSandboxUser:function(elem){var self=this;$(elem).parent().remove();if(self.mainBox.find('#access_users_array div.item').length==0){self.mainBox.find('#access_users_array').append('<div class="item empty">Список пуст</div>')}},validateSandboxUser:function(e){var keyCode=e.keyCode||e.which;if($.inArray(keyCode,[46,8,9,27,13,110,116])!==-1||(keyCode==65&&e.ctrlKey===true)||(keyCode>=35&&keyCode<=39)){return}if((e.shiftKey||(keyCode<48||keyCode>57))&&(keyCode<96||keyCode>105)){e.preventDefault()}},saveSandboxAccess:function(){var self=this,public_theme=self.mainBox.find('#public_theme').prop('checked'),theme_id=self.mainBox.find('#theme_id').val(),access_users="";self.mainBox.find('#access_users_array .item').each(function(){if($(this).hasClass('empty')){access_users=""}else{access_users+=($(this).index()==0)?$(this).text():","+$(this).text()}});public_theme=public_theme?1:0;$.ajax({url:'/-/cms/v1/template/?act=sandboxEdit&'+S3_ACCESS+'&theme_id='+theme_id+"&public_theme="+public_theme+"&access_users="+access_users,async:false,success:function(data){if(data=="1"){self.popupMessage('JS_CHANGES_SAVED')}else{s3.alert('	Возникла ошибка. <br/>')}}})},replaceList:function(object){var template_id=$(object).attr('template_id');s3.openModalPopup('/-/cms/v1/template/?act=replaceList&'+S3_ACCESS+'&template_id='+template_id,false)},makeLocalCopyInTab:function(object){var self=this,template_id=$(object).attr('template_id'),group_id=$(object).attr('group_id');$.get('/-/cms/v1/template/?act=copy&replace=1&'+S3_ACCESS+'&template_id='+template_id+'&template_group_id='+group_id,[],function(data){data=JSON.parse(data);if(data.done){$(object).before('<span class="s3-btn green" onclick="templateController.newTab('+parseInt(data.template_id)+',\'smarty\', 0, event);">'+s3.loc("TPL_GO_TO_LOCAL_COPY")+'</span>');$(object).remove();self.newTab(parseInt(data.template_id),'smarty',0,false);self.popupMessage(data.message);self.loadTemplatesList(true)}else{S3PopUp.open('alert',data.message)}})},makeTemplateCopy:function(object,replace){var self=this,template_id=$(object).attr('template_id'),group_id=$(object).attr('group_id');$.get('/-/cms/v1/template/?act=copy&replace='+replace+'&'+S3_ACCESS+'&template_id='+template_id+'&template_group_id='+group_id,[],function(data){try{data=JSON.parse(data);if(data.done){S3PopUp.open('alert',data.message);self.loadTemplatesList(true)}}catch(e){s3.alert(JS_ERROR_TEMPLATE_CODE_SYNTAX)}})},deleteLinkToLocal:function(object){var self=this,template_id=$(object).attr('template_id');$.get('/-/cms/v1/template/?act=replaceDelete&'+S3_ACCESS+'&template_id='+template_id,[],function(data){data=JSON.parse(data);if(data.done){S3PopUp.open('alert',data.message);self.loadTemplatesList(true)}})},showBigPic:function(object){var link=$(object);link.parents('.drop-zone:first').html('<img src="'+link.attr('href')+'" />')},toggleTemplatePanel:function(){var obj=$('.tpl-panel-toggle');if(obj.eq(0).is(':visible')){obj.hide()}else{obj.show()}cm.resize($("#cmDiv"+cm.currentTab))},toggleTemplateGroupAdd:function(){$('.tpl-group-add').toggle()},addTemplateGroup:function(){if($('#template_group_name').val()){jQuery.post('/-/cms/v1/template/?act=templateGroupEdit&'+S3_ACCESS,{group_name:$('#template_group_name').val(),group_parent:$('#templateGroupParent').val()},function(data){if(data==1){s3.alert('Группа создана успешно')}else{s3.alert('Возникла ошибка при добавлении группы.')}})}},popupMessage:function(text,timeout){var delay=1700;if(timeout){delay=timeout}if($('#editor-popup-message').length==0){$('body').append('<div id="editor-popup-message">'+s3.loc(text)+'</div>');setTimeout(function(){$('#editor-popup-message').remove()},delay)}},showLoader:function(){$('body').append('<div id="editor-loader"><img src="/shared/images/preloader.gif" alt="" /></div>')},hideLoader:function(){$('#editor-loader').remove()},uploadFiles:function(max,form,event,id){this.showLoader();var files_input=document.getElementById(id),files_size=0,max=parseInt(max);for(var i=0;i<files_input.files.length;i++){files_size+=files_input.files[i]['size']}files_size=files_size/1000/1000;if(files_size>=max){event.preventDefault();this.hideLoader();s3.alert('Максимально допустимый размер файлов '+max+' Мб')}},getUploadingName:function(id,file_path,file_theme){var self=this,files=document.getElementById(id).files,files_cnt=files.length;if(files_cnt==1){text=files[0]['name']}else{text=files_cnt+" файла(ов)"}if(file_path){self.mainBox.find('div.tab-body:visible[data-template-id="'+file_path+'"][data-theme-id="'+file_theme+'"]').find('#fileformlabel').text(text)}else{self.mainBox.find('#'+id).parent('.fileform').find('#fileformlabel').text(text)}},deleteCheckedFiles:function(){var files=[],target=$('.copy_file_to_theme:checked');target.each(function(){files.push($(this).attr('data-file_id'))});if(files.length==0){s3.alert(s3.loc('JS_ERROR'));return}s3.confirm(s3.loc('JS_CONFIRM_DELETE'),function(){$.ajax({url:'/-/cms/v1/file-storage/?act=deleteMultiple&'+S3_ACCESS,type:'post',data:{files:JSON.stringify(files)},success:function(data){target.each(function(){$(this).parents('tr:first').empty().remove()})}});popupController.closeLastPopup()})},compareFiles:function(origin,theme_id,elem){var self=this,tr=elem.parents('tr'),td_cnt=tr.find('>td').size(),rnd=new Date().getTime(),block_exists=false,file_type='',file_id=origin;if(tr.next('tr.compare-block').length==1){block_exists=true}self.mainBox.find(".compare-block").remove();if(!block_exists){tr.after('<tr class="compare-block"><td colspan="'+td_cnt+'"></td></tr>');var compare_block=tr.next('tr.compare-block');if(typeof(origin)=="number"){file_type='tpl';origin=self.templateGetData(origin,theme_id,rnd);for(key in origin['part']['themes']){var tpl_theme=origin['part']['themes'][key];if(tpl_theme['theme_id']==theme_id){theme=tpl_theme['part']['body']}}var readonly=origin.part.readonly;origin=origin['part']['body']}else{file_type='file';var themes={},th={};$('#themeTabs li').each(function(){var is_sandbox=($(this).attr('data-sandbox')=="true")?1:0;th[$(this).attr('data-theme-id')]=is_sandbox;themes=th});themes=JSON.stringify(themes);var file_data=self.fileGetData(origin,theme_id,rnd,themes);if(!file_data){return false}var theme=file_data.themes[theme_id].part.body;readonly=file_data.part.readonly}var td=compare_block.find('>td');if(td.find('div.diff').length==0){var file_editing='<span style="color:#f7922d;"> (внесите изменения вручную)</span>';if(readonly==true){file_editing='<span class="warn">(редактируется другим пользователем!)</span>'}compare_block.find('>td').append('<table><tr><td><div id="LeftPreview"></div><div class="diff" id="diff_origin"></div><div class="diff-title">Боевая версия'+file_editing+'</div></td><td><div id="RightPreview"></div><div class="diff" id="diff_theme"></div><div class="diff-title">Публикуемая песочница</div></td></tr></table>')}LS.set("_val_changes",parse_changes(origin,theme));o_val=$('#LeftPreview').html().replace(/&nbsp;/gi,'');$('#LeftPreview').append('<textarea id="o_clean_body">'+o_val+'</textarea>');self.origin_editor=ace.edit("diff_origin");self.origin_editor.setValue($('#o_clean_body').val(),-1);self.origin_editor.setFontSize(15);self.origin_editor.getSession().setUseWorker(false);self.origin_editor.getSession().setMode("ace/mode/smarty");self.origin_editor.getSession().setUseSoftTabs(false);self.origin_editor.setTheme("ace/theme/chrome");self.origin_editor.setShowPrintMargin(false);if(readonly==true){self.origin_editor.setReadOnly(true)}else{if(file_type=='tpl'){self.mainBox.find('#diff_origin').next('.diff-title').append('<span class="save-button" onclick="templateController.saveTemplate('+file_id+','+0+',true)">Сохранить</span>')}else{self.mainBox.find('#diff_origin').next('.diff-title').append('<span class="save-button" onclick="templateController.saveFile(\''+file_id+'\','+0+',true)">Сохранить</span>')}}self.origin_editor.on("change",$.debounce(250,function(){var val_changes=LS.get("_val_changes");for(var i=0;i<val_changes.length;i++){var origin_text=self.origin_editor.session.getLine(i),theme_text=self.theme_editor.session.getLine(i);if(origin_text==theme_text){$(self.origin_editor.renderer.$textLayer.element.children[i]).removeAttr('class').addClass('ace_line');$(self.theme_editor.renderer.$textLayer.element.children[i]).removeAttr('class').addClass('ace_line');self.theme_editor.session.selection.clearSelection()}}}));var undo_manager=self.origin_editor.getSession().getUndoManager();undo_manager.reset();self.origin_editor.getSession().setUndoManager(undo_manager);var t_val=$('#RightPreview').html().replace(/&nbsp;/gi,'');$('#RightPreview').append('<textarea id="t_clean_body">'+t_val+'</textarea>');self.theme_editor=ace.edit("diff_theme");self.theme_editor.setValue($('#t_clean_body').val(),-1);self.theme_editor.setFontSize(15);self.theme_editor.getSession().setUseWorker(false);self.theme_editor.getSession().setMode("ace/mode/text");self.theme_editor.getSession().setUseSoftTabs(false);self.theme_editor.setReadOnly(true);self.theme_editor.setShowPrintMargin(false);self.origin_editor.getSession().on('changeScrollTop',function(scroll){self.theme_editor.getSession().setScrollTop(parseInt(scroll)||0)});self.theme_editor.getSession().on('changeScrollTop',function(scroll){self.origin_editor.getSession().setScrollTop(parseInt(scroll)||0)});self.origin_editor.getSession().on('changeScrollLeft',function(scroll){self.theme_editor.getSession().setScrollLeft(parseInt(scroll)||0)});self.theme_editor.getSession().on('changeScrollLeft',function(scroll){self.origin_editor.getSession().setScrollLeft(parseInt(scroll)||0)})}},editorUpdate:function(text,type,tpl_id,theme_id,readonly,scroll){var self=this,theme=util.readCookie('editorTheme');if(theme){self.editor.setTheme("ace/theme/"+theme)}else{self.editor.setTheme("ace/theme/chrome")}self.editor.getSession().setMode("ace/mode/"+type);self.editor.setValue(text,-1);self.editor.getSession().setUseWrapMode(true);self.editor.getSession().setUseWorker(false);self.editor.setFontSize(15);self.editor.getSession().setUseSoftTabs(false);if(readonly=="true"){self.editor.setReadOnly(true)}else{self.editor.setReadOnly(false)}self.editor.getSession().setScrollTop(parseInt(scroll));self.editor.setOption("enableEmmet",true);self.editor.setShowPrintMargin(false);self.editorDropUndo(tpl_id,theme_id);if(util.readCookie('editorHighlight')=="off"){self.mainBox.find('#ace_editor_wrapper').addClass('hidden')}},editorDropUndo:function(tpl_id,theme_id){var self=this,undo_manager=jQuery.extend(true,new ace.UndoManager(),self.editor.getSession().getUndoManager()),tab_undo=self.undoData[tpl_id+'_'+theme_id];if(tab_undo!==undefined){self.editor.getSession().setUndoManager(tab_undo)}else{undo_manager.reset();self.editor.getSession().setUndoManager(undo_manager)}},editorSetTheme:function(theme){var self=this;self.editor.setTheme("ace/theme/"+theme);util.createCookie('editorTheme',theme,24)},turnOnEditor:function(){var self=this,theme=util.readCookie('editorTheme'),curr_tab=LS.get("_curr_tab");util.createCookie('editorHighlight','on',24);theme=(theme)?theme:'chrome';self.editor.setTheme("ace/theme/"+theme);self.editor.getSession().setScrollTop(1);var new_val=self.mainBox.find('.tab-body[data-template-id="'+curr_tab.tpl_id+'"][data-theme-id="'+curr_tab.theme_id+'"]').find('#bodyVal').val();self.editor.setValue(new_val,-1);self.mainBox.find('#ace_editor_wrapper').removeClass('hidden')},turnOffEditor:function(){var self=this;util.createCookie('editorHighlight','off',24);self.mainBox.find('#ace_editor_wrapper').addClass('hidden')},searchBy:function(form){var self=this,form=$(form),data=form.serializeArray(),url="/-/cms/v1/template/?act=search";$.ajax({url:url,type:form.attr('method'),data:data,async:false,success:function(data){if(data==""){self.mainBox.find('.tpl-search-result .tpl-list').html('<tr><td class="tpl-name"><span class="desc">По данному запросу ничего не найдено</span></td></tr>').parents('.tpl-search-result').removeClass('hidden')}else{self.mainBox.find('.tpl-search-result table.tpl-list').html(data).S3ChangeControls().parent().removeClass('hidden');if(self.mainBox.find('.tpl-search form .tpl-search-reset').length==0){self.mainBox.find('.tpl-search form').append('<span class="tpl-search-reset s3-ico i-close-small gray" onclick="templateController.searchReset();">123</span>')}}},error:function(){S3PopUp.open('alert','Ошибка в поиске, повторите позже')}})},searchReset:function(){var self=this;self.mainBox.find('.tpl-search .tpl-search-reset').remove();self.mainBox.find('.tpl-search-result').addClass('hidden');self.mainBox.find('.tpl-search .tpl-search-text').val('')},escapeHTML:function(elem){return elem.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/{/g,'&#123;').replace(/}/g,'&#125;')},changePicInTab:function(tabid,url){$('#editorContent div.tab-body[data-template-id="'+tabid+'"]:visible').find('.drop-zone').html('<image src="'+url+'" />');return true},tabsSortInit:function(){var self=this;$("#tplTabs").sortable({delay:50,tolerance:'pointer',distance:0,forcePlaceholderSize:true,placeholder:"tplTabPlaceHolder",cancel:".no-sortable",stop:function(event,ui){self.parseTabs()}})},createFile:function(form){var self=this,file_name=$(form).find('#create_filename').val(),file_ext=$(form).find('select[name="file_ext"]').val(),file_dir=$(form).find('#create_dir').val(),file_path='',is_root=$(form).find('#is_root').val();if(file_name==""){s3.alert(s3.loc("FILE_NAME_ERROR"))}else if(file_ext==""){s3.alert(s3.loc("FILE_EXTENSION_ERROR"))}if(file_name==""||file_ext==""){return false}file_path=file_dir+'/'+file_name+'.'+file_ext;$.ajax({dataType:"json",url:'/-/cms/v1/file-storage/?act=create&'+S3_ACCESS,type:'post',data:{"file_path":file_path,root:is_root},async:false,success:function(data){if(data.error){s3.alert(data.msg)}else{self.popupMessage(data.msg);self.newTab(data.file_info.path,data.file_info.extension,data.file_info.theme_id,null,is_root)}}})},renameFileFormToggle:function(elem){var self=this,form_wrap=$(elem).next('.rename-form-wrapper');if(form_wrap.is(':visible')){form_wrap.addClass('hidden')}else{$('body').click(function(e){if($(e.target).is('.rename-form-wrapper')||$(e.target).is('.toggle-rename')||$(e.target).is('.new-name')||$(e.target).is('.rename-apply')){return}self.mainBox.find('.rename-form-wrapper').addClass('hidden')});self.mainBox.find('.rename-form-wrapper').addClass('hidden');form_wrap.removeClass('hidden');form_wrap.find('input[name="new_name"]').select()}},renameFile:function(form){var self=this,form_data=$(form).serializeArray(),curr_dir=LS.get("_files_dir");if(form_data[1].value==""){s3.alert('Вы ввели пустое значение');return false}form_data[1].value=self.translit(form_data[1].value);$.post('/-/cms/v1/file-storage/?act=rename&'+S3_ACCESS,form_data,function(data){if(data=="0"){s3.alert('Такого файла не существует')}else{self.closeTab(form_data[0].value,false);self.popupMessage('Файл переименован');self.loadFiles(curr_dir)}})},translit:function(text){var space='_',transl={'а':'a','б':'b','в':'v','г':'g','д':'d','е':'e','ё':'e','ж':'zh','з':'z','и':'i','й':'j','к':'k','л':'l','м':'m','н':'n','о':'o','п':'p','р':'r','с':'s','т':'t','у':'u','ф':'f','х':'h','ц':'c','ч':'ch','ш':'sh','щ':'sh','ъ':'','ы':'y','ь':'','э':'e','ю':'yu','я':'ya',' ':space,'_':space,'`':space,'~':space,'!':space,'@':space,'#':space,'$':space,'%':space,'^':space,'&':space,'*':space,'(':space,')':space,'-':space,'\=':space,'+':space,'[':space,']':space,'\\':space,'|':space,'/':space,',':space,'{':space,'}':space,'\'':space,'"':space,';':space,':':space,'?':space,'<':space,'>':space,'№':space},result='',curent_sim='';for(i=0;i<text.length;i++){if(transl[text[i]]!=undefined){if(curent_sim!=transl[text[i]]||curent_sim!=space){result+=transl[text[i]];curent_sim=transl[text[i]]}}else{result+=text[i];curent_sim=text[i]}}result=result.replace(new RegExp(/[^a-zA-Z0-9\.\-\_]/igm),"");return result},switchFullscreen:function(){var self=this;if(self.mainBox.hasClass('fullscreen')){self.mainBox.removeClass('fullscreen');self.mainBox.find('.tpl-body').css('height',parseInt($(window).height())-330)}else{var height=parseInt($(window).height())-116;self.mainBox.addClass('fullscreen');if(height>500){self.mainBox.find('.tpl-body').css('height',height)}}self.editor.renderer.onResize(true)},callJsonData:function(object_id){var meta_id=parseInt(object_id),url='/-/cms/v1/template/data/?act=jsonList&'+S3_ACCESS+'&popup=1'+'&meta_id='+meta_id;openAjaxForm(url,false,function(){popupController.reloadLastPopup()},false)},jsonMetaAddToUsage:function(data,selected_ids,template_id,tpl_ver_id){var meta_ids=selected_ids,new_id=data.text,tpl_id=parseInt(template_id),url='/-/cms/v1/template/data/?act=jsonMetaSaveUsage&'+S3_ACCESS+'&tpl_id='+tpl_id+'&tpl_ver_id='+tpl_ver_id;popupController.closeLastPopup();if(new_id&&new_id!=""){if(meta_ids==''){meta_ids=data.text}else{meta_ids+=','+new_id}}if(meta_ids!=''){$.post(url+'&meta_ids='+meta_ids,function(){util.msg(s3.loc('JS_SAVED'));popupController.reloadLastPopup()})}}}})(jQuery);$(function(){var hash_check=document.location.hash.split('?');if(hash_check[0]!="#/-/cms/v1/template/"){LS.remove('_direct_tab')}});(function($){$.widget("ui.combobox",{_create:function(){var input,self=this,select=this.element.hide(),selected=select.children(":selected"),value=selected.val()?selected.text()+(selected.hasClass('is_default')?'('+JS_VALUE_BY_DEFAULT+')':''):"",wrapper=this.wrapper=$("<span>").addClass("ui-combobox").insertAfter(select);input=$("<input>").attr('name',this.element[0].name.replace(/cf_g[^\[]*\[/i,'_combobox[')).appendTo(wrapper).val(value).addClass("ui-state-default ui-combobox-input").bind("keydown",function(event){if(event.keyCode===$.ui.keyCode.ESCAPE&&$(this).data("autocomplete").menu.active||event.keyCode===$.ui.keyCode.ENTER&&!$(this).data("autocomplete").menu.active){$(this).data('autocomplete').close();return false}}).bind("keyup",function(event){}).autocomplete({delay:0,minLength:0,source:function(request,response){var matcher=new RegExp($.ui.autocomplete.escapeRegex(request.term),"i");response(select.children("option").map(function(){var text=$(this).text();if(this.value&&(!request.term||matcher.test(text)))return{label:request.term?text.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+$.ui.autocomplete.escapeRegex(request.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"[strong]$1[/strong]"):text,value:text,option:this}}))},select:function(event,ui){ui.item.option.selected=true;self._trigger("selected",event,{item:ui.item.option})},change:function(event,ui){if(!ui.item){var matcher=new RegExp("^"+$.ui.autocomplete.escapeRegex($(this).val())+"$","i"),valid=false;select.children("option").each(function(){if($(this).text().match(matcher)){this.selected=valid=true;return false}});if($(this).val()&&!valid){if(!$('#cust').length){var value=$(this).val().trim();var isDuplicateValue=false;select.find('option').each(function(){if($(this).text()==value){isDuplicateValue=true}});if(!isDuplicateValue){select.append($('<option id="asdf234" value="-1" selected>'+value+'</option>'))}}else{$('#cust').text($(this).val())}valid=true}if(!valid){select.val("");input.data("autocomplete").term="";return false}}}}).addClass("ui-widget ui-widget-content ui-corner-left");input.data("autocomplete")._renderItem=function(ul,item){return $("<li></li>").addClass(item.option.className).data("item.autocomplete",item).append("<a>"+$('<span>').text(item.label).html().replace(/\[(\/*strong)\]/g,"\<$1\>")+($(item.option).hasClass('default')?'('+JS_VALUE_BY_DEFAULT+')':'')+"</a>").appendTo(ul)};$("<a>").attr("tabIndex",-1).attr("title",JS_SHOP2_CUSTOM_FIELDS_SHOW_ALL_ITEMS).appendTo(wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:false}).removeClass("ui-corner-all").addClass("ui-corner-right ui-combobox-toggle").click(function(){if(input.autocomplete("widget").is(":visible")){input.autocomplete("close");return}$(this).blur();input.autocomplete("search","");input.focus()})},destroy:function(){this.wrapper.remove();this.element.show();$.Widget.prototype.destroy.call(this)}})})(jQuery);var LpController={},lpDemoStatusUpdateTimeout;(function($){LpController={init:function(options){var self=this,keyCode;self.variant_id=parseInt(options.variant_id);self.main_wrapper=$(options.wrapper);self.site_wrapper=options.site_wrapper;self.samples_wrapper=options.samples_wrapper;self.sample_list=options.sample_list;self.sample_group=options.sample_group;self.sample_item=options.sample_item;self.sample_item_controls=options.sample_item_controls;self.lp_id=options.lp_id;self.lp_preset=options.preset;self.theme=options.theme;self.lang_code=options.lang_code;self.theme_global=options.theme_global;self.preset_id=parseInt($(self.lp_preset).val());self.lp_blocks=options.lp_blocks;self.block_clone='block_clone';self.lp_donor_blocks=options.lp_donor_blocks;self.folders_call_btn=options.folders_call_btn;self.folders_menu_wrapper=options.folders_menu_wrapper;self.folders_menu=options.folders_menu;self.block_call_buttons=$(self.folders_menu).find('.block-call-btn');self.previews_container=options.previews_container;self.lp_overlay=options.lp_overlay;self.loader=options.loader;self.folder_preset_list=options.folder_preset_list;self.loader_html='<div class="lp-loader"><div class="spinner"></div></div>';self.settings=options.lp_settings;self.theme_link=options.theme_link;self.view_only=options.view_only;self.content_lp=options.content_lp;self.can_edit_global=options.can_edit_global;self.staff_user=options.staff_user;self.is_platform_site=options.is_platform_site;self.mosaic_iframe=options.mosaic_iframe;self.mosaic_iframe_wrap=options.mosaic_iframe_wrap;self.mosaic_iframe_url=options.mosaic_iframe_url;self.root_folder_id=parseInt(options.root_folder_id,10);self.can_edit_lp_mosaic=options.can_edit_lp_mosaic;self.can_edit_lp_mosaic_global=options.can_edit_lp_mosaic_global;self.lp_feature_access=options.lp_feature_access;self.block_placeholder="block-placeholder";self.block_placehoder_html="<div class='"+self.block_placeholder+"' style='text-align: center;'>"+s3.loc('JS_LP_BLOCK_PLACEHOLDER_TEXT')+"</div>";self.check_demo_status=options.check_demo_status;self.blocks_anchor_prefix=options.blocks_anchor_prefix;self.service_group=self.content_lp?'lpc':'lp16';self.list_index=0;self.business_card=options.business_card;self.lp_mode_wrap=options.lp_mode_wrap;self.row='.lp-row';self.add_after_id=0;self.add_before_id=0;self.selected_element=null;self.preview_mode=options.preview_mode;self.panel_params=null;self.visual=options.visual;self.fonts_settings=options.fonts_settings;self.exception_classes=['lp-selected-element','modified','cloned','has-slider','active','stop-animate','s3-animator'];self.commented_props=[];self.css_params={};self.media_rules=['media_rule_1','media_rule_2','media_rule_3','media_rule_4'];self.button_default_class='.lp-button';self.block_css_controls='.block-css-controls';self.videoEmbed=new Map([['1','https://www.youtube.com/embed/{ID_VIDEO}?enablejsapi=1&mute=1'],['2','https://vk.com/video_ext.php?{ID_VIDEO}'],['3','https://rutube.ru/play/embed/{ID_VIDEO}'],['4','https://ok.ru/videoembed/{ID_VIDEO}'],['5','https://dzen.ru/embed/{ID_VIDEO}'],['6',''],['7',''],]);self.CUSTOM_VIDEO_TYPE="7";self.params_stack={};self.lp_palette=LS.get('lp_palette');self.element_types={'block':['block_background','block_indents','animate'],'promo_block':['block_background','block_indents','animate'],'text':['text','clear','background','border','shadow','indents'],'header':['text','clear','background','border','shadow','indents','tag'],'button':['text','clear','background','border','shadow','link','indents'],'container':['background','border','shadow','indents'],'slider_container':['background','border','indents'],'card_container':['background','border','shadow','indents'],'image':['image','media_size','border','shadow','indents'],'unresize_image':['image','border','shadow','indents'],'logo':['image','media_size','border','shadow','indents','link'],'video':['video','media_size','border','shadow','indents'],'unresize_video':['video','border','shadow','indents'],'form':['form','text','clear','background','border','shadow','indents'],'selected_fragment':['text','clear','link','background']};self.fast_edit_image_types=['image','unresize_image','logo'];self.hide_sub_control={'slider_container':['padding_left','padding_right','margin_left','margin_right'],'card_container':['margin_left','margin_right'],};self.lpc_callback=null;self.after_save_callback=null;self.deleted_block_id=0;self.arrayKeyCode=[];self.notApplyPopupParams=false;self.cancelAllBtn=$("#cancel_all_button");self.publishBtn=$("#publish_button");self.publishButtonState={publish:{class:'publish-button--rocket-icon',text:s3.loc('JS_PUBLISH'),},inPublish:{class:'publish-button--spin-icon',text:s3.loc('JS_IN_PUBLISH'),},published:{class:'publish-button--apply-icon',text:s3.loc('JS_PUBLISHED'),}};self.zb_field_name=s3.loc('JS_ZERO_BLOCK_FIELD_NAME_DEFAULT');self.zb_field_description=s3.loc('JS_ZERO_BLOCK_FIELD_DESCRIPTION_DEFAULT');self.new_presets=options.new_presets.split(',').map(e=>parseInt(e));self.reg_state=options.reg_state;self.default_palette=['#E33938','#FF9417','#FDDE09','#99CF00','#38C4D9','#0A51CA','#5B35B5','#000000','#ffffff','#B49861','#33B81D','#33CBA9','#008FE0','#DC62C1'];if(!self.lp_palette||(self.lp_palette&&$.isEmptyObject(self.lp_palette))){self.lp_palette=[]}if(!window.hasOwnProperty('img_convert_cache')){window.img_convert_cache={}}if(self.preview_mode&&self._get('init_from_iframe')&&$('.media-panel .screen.media_active').length){Preloader.show()}const blocks=[];for(const key in self.lp_blocks){const block=self.lp_blocks[key];blocks[block['block_id']]=block}self.lp_blocks=blocks;$(document).on('keydown',function(event){keyCode=event.keyCode||event.which;if(!self.isKeyDownCode(keyCode)){self.arrayKeyCode.push(keyCode)}if(keyCode==27&&!popupController.getLastPopup()){self.closeBlockSelector();if($('.colorpicker-visible').length){$('.colorpicker-visible').find('.cp-close').click()}else if($('.context-popup:visible').length&&$('.context-popup:visible').find('.cancel-popup').length){self.hideContextMenu($('.context-popup:visible').find('.cancel-popup'),self.selected_element,true)}}});$(document).on('keyup',function(event){keyCode=event.keyCode||event.which;if(self.arrayKeyCode.length){self.arrayKeyCode=self.arrayKeyCode.filter(function(item){if(item!==keyCode){return true}})}});$(window).on('blur',function(){self.arrayKeyCode=[]});$(document).on('click',function(event){if($(event.target).is($(self.lp_overlay))){self.closeBlockSelector();$('#popup-message').remove()}if(!$(event.target).closest('.dropdown-box').length){$('.dropdown-box').removeClass('visible');$('.dropdown-box .sub-level').hide()}});$(document).on('mouseup',function(event){if(self.isActiveOnboarding()){return false}setTimeout(function(){if(self.hasSelection(true)||(window.getSelection&&window.getSelection().focusNode&&$(window.getSelection().focusNode.parentNode).is('.lp-fragment-elem'))){var sel_elem=self.getSelectionElement();if($(event.target).closest('[data-elem-type]').length&&sel_elem&&!$(sel_elem).parents('[data-elem-type="form"]').length&&!$(sel_elem).closest('[data-elem-type="button"]').length&&!$(sel_elem).closest(self.button_default_class).length){if($('.lp-link-popup').is(':visible')&&!$(event.target).closest('.block-css-controls').length){self.removeTextLinks();self.updateLinkPopup()}else{self.prepareControls($(sel_elem),'selected_fragment')}}}else if($(self.selected_element).attr('data-elem-type')&&!$('.lp-link-popup').is(':visible')){self.prepareControls($(self.selected_element),$(self.selected_element).attr('data-elem-type'))}},100)});$(document).on('mousedown',function(event){if(isBlockedElement(event)){return false}});self.fast_edit_image_types.forEach(function(type){$(document).on('dblclick',"[data-elem-type='"+type+"']",function(e){e.preventDefault();e.stopPropagation();setTimeout(function(){if(!self.hasSelection(true)){self.inlineUpdateImage()}},100)})});function isBlockedElement(event){const{target}=event;if($(target).is('.link-control')||$(target).parent().is('.link-control')){return true}if(!self.hasSelection()){return false}if($(target).closest(self.block_css_controls).length||$(target).closest('.context-popup').length||$(target).closest('.colorpicker input').length){if($(target).is('#lp_link')){return false}if($(target).is('#lp_anchor_link')){return false}if($(target).is('input.fz-params.s3-input')){self.wrapSelection({},'fz-params-text');return false}if($(target).is('.colorpicker input')){self.wrapSelection({},'colorpicker-text');return false}return true}return false}$(document).on('keydown paste','.lp-selected-element',function(event){$(this).data('html',$(this).html());$(this).addClass('modified').addClass('modified-text')});if(!self.preview_mode&&!self.view_only){document.addEventListener('click',function(e){var target=$(e.target);if(!target.closest('.tippy-tooltip').length){if(self.isActiveOnboarding()){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation()}var type_elem=target.closest('[data-elem-type]');if($(self.selected_element).length&&type_elem.length){S3ContextMenuController.closeContextMenu();self.closeColorpicker()}if((type_elem.length&&e.isTrusted&&!$('.context-popup.lp-link-popup').is(':visible')&&type_elem.attr('data-elem-type')!=="block"&&type_elem.attr('data-elem-type')!=="promo_block")){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation()}self.unSelectElement(target);self.selectElement(target)}},true);$(document).on('mousemove',self.row,$.throttle(500,function(e){var offset_top=$(this).offset().top;$('.lp-row-add-wrap').hide();if((e.pageY-offset_top)>$(this).height()/2){$(this).find('.lp-row-add-wrap.last').show()}else{$(this).find('.lp-row-add-wrap').not('.last').show()}}))}$(document).on('click',self.samples_wrapper+','+self.folders_menu_wrapper,function(event){event.stopPropagation()});$(document).on('click','.lp-popup-dimming',function(){self.closePopupForm()});self.site_controls_dublicate_delete='<li><span data-metrika="landingBlockDuplicate" class="control-btn s3-btn duplicate-block "><span class="s3-ico i-copy-svg"></span>'+s3.loc('LP_COPY_BLOCK')+'</span></li>';let staff_user_class=self.staff_user&&!self.is_platform_site?"staffUser ":"";self.site_controls_lock_block='<li><span  data-metrika="landingBlockLock" class="control-btn s3-btn lock-block '+staff_user_class+'" onclick="LpController.triggerBlockLocking($(this))"><span class="s3-ico i-folder-lock-svg"></span><span class="s3-btn-title">'+s3.loc('LOCK')+'</span></span></li>';if(self.business_card){self.site_controls_dublicate_delete=''}if(!self.lp_feature_access||self.is_platform_site){self.site_controls_lock_block=''}const isAllowed=self.preset_id!==1851||self.staff_user;if(isAllowed){const isStaff=self.preset_id===1851&&self.staff_user;let blockClass='s3-btn control-btn through-block-control';if(isStaff){blockClass+=' staffUser'}self.site_controls_through_block=`<li><span data-metrika="landingBlockThrough"class="${blockClass}"><span class="s3-ico lp-ico i-pin"></span><span class="s3-btn-title">${s3.loc('JS_LP_THROUGH_PIN_BUTTON')}</span></span></li>`}else{self.site_controls_through_block=''}self.add_button='<div class="lp-row-add-wrap" onclick="LpController.foldersToggle(event, this);">'+'<span class="lp-block-add-button"><span class="s3-ico i-add-black-svg"></span></span></div>'+'<div class="lp-row-add-wrap last" onclick="LpController.foldersToggle(event, this);">'+'<span class="lp-block-add-button"><span class="s3-ico i-add-black-svg"></span></span></div>';self.site_controls='<div class="site-controls"><ul class="controls-inner">'+'<li class="edit-control"><span class="control-btn s3-btn edit-mosaic-block staff s3-tooltip small" title="'+s3.loc('JS_EDIT_LP_BLOCK_SETTINGS')+'"><span class="s3-ico i-lollipop-svg"></span><span class="name">'+s3.loc('JS_ZERO_BLOCK_EDITOR_NAME')+"</span></span></li><li class=\"edit-control\"><span class=\"control-btn s3-btn edit-through-block s3-tooltip small\" title=\""+s3.loc('JS_LP_THROUGH_NOTICE')+"\"><span class=\"s3-ico i-lightning-svg\"></span><span class=\"name\"></span></span></li>"+'<li class="edit-control"><span class="control-group"><span data-metrika="landingBlockEdit"  title="'+s3.loc('JS_EDIT_DATA')+'" data-attached="false" class="control-btn s3-btn w-ico-first edit-layout s3-tooltip small"><span class="s3-ico i-pencil-svg"></span><span class="name">'+s3.loc('JS_EDIT_DATA')+'</span></span>'+'<span class="control-btn s3-btn edit-layout-settings s3-tooltip small" title="'+s3.loc('JS_EDIT_LP_BLOCK_SETTINGS')+'" data-metrika="landingBlockSettings"><span class="s3-ico i-gear-svg"></span></span>'+'<span title="'+s3.loc('JS_EDIT_LP_STYLES')+'"  data-metrika="landingBlockCssParams" onclick="LpController.editBlockCssParams($(this));" class="control-btn s3-btn edit-layout-css staffUser s3-tooltip small"><span class="lp-ico i-bg-fill-staff"></span></span>'+'</li>'+'<li class="inverse-control"><span title="'+s3.loc('JS_INVERSE_LP_BLOCK')+'" onclick="LpController.invertBlockColor($(this));" class="control-btn s3-btn inverse-layout s3-tooltip small"><span class="lp-ico i-inverse"></span></span></span></li>'+'<li class="layout-control"><span class="control-title select-theme">'+s3.loc('JS_LP_BLOCK_THEME')+':</span>'+'<span class="control-group"><span title="'+s3.loc('JS_EDIT_LP_SWITCH_THEME')+'" onclick="LpController.listLayout($(this), \'left\')" class="control-btn s3-btn list-theme s3-tooltip small"><span class="lp-ico i-larr"></span></span>'+'<span title="'+s3.loc('JS_EDIT_LP_SWITCH_THEME')+'" onclick="LpController.listLayout($(this), \'right\')" class="control-btn s3-btn list-theme"><span class="lp-ico i-rarr"></span></span></span></li>'+'<li class="move-control"><span class="control-title hidden">'+s3.loc('JS_LP_BLOCK_POSITION')+':</span><span class="control-group"><span data-metrika="landingBlockMoveUp"  title="'+s3.loc('JS_LP_MOVE_BLOCK_UP')+'" onclick="LpController.moveBlock($(this), \'up\')" class="control-btn s3-btn up-block s3-tooltip small"><span class="s3-ico i-arrow-up"></span></span>'+'<span  data-metrika="landingBlockMoveDown" title="'+s3.loc('JS_LP_MOVE_BLOCK_DOWN')+'" onclick="LpController.moveBlock($(this), \'down\')" class="control-btn s3-btn down-block s3-tooltip small"><span class="s3-ico i-arrow-down"></span></span></span></li>'+'<li><span data-metrika="landingBlockDelete" title="'+s3.loc('JS_DELETE')+'" class="control-btn s3-btn delete-block  s3-tooltip small"><span class="s3-ico i-delete-svg"></span></span></li>'+'<li class="more-control"><span class="control-btn s3-btn more-block s3-tooltip small" title="'+s3.loc('LP_ADDITIONAL_TOOLS')+'"><span class="s3-ico i-more"></span></span>'+'<ul class="drop-block more-params">'+'<li><span data-metrika="landingBlockAnchor" class="edit-block-anchor anchor-link s3-btn" onclick="LpController.editBlockAnchorLink(this)"><span class="s3-ico i-anchor"></span>'+s3.loc('JS_ANCHOR')+'</span></li>'+'<li class="hide-block-li"><span  data-metrika="landingBlockVisibility" onclick="LpController.triggerBlockVisibility($(this))" class="control-btn s3-btn hide-block"><span class="s3-ico i-eyehide-svg"></span><span class="s3-btn-title">'+s3.loc('LP_HIDE_BLOCK')+'</span></span></li>'+self.site_controls_dublicate_delete+self.site_controls_through_block+self.site_controls_lock_block+'<li class="row-layout-id"><span></span></li></ul>'+'</li>'+'</ul></div>';var block_layouts,block_id,block_layout_id,block_json_id,scroll_add=0,css_json,rnd=new Date().getTime();if(!self.view_only){new DropTarget($(self.site_wrapper).get(0));new DropTarget($(self.main_wrapper).find('.lp-block-add-wrap').get(0))}$(self.site_wrapper).find('[id^="_lp_block_"]').each(function(index){const $parent=$(this).parents(`.lp-row`),block_id=parseInt($parent.attr(`data-block-id`)),block_variant_id=parseInt($parent.attr('data-variant-id'));block_layouts={};var block_height=$(this).height();if(!block_id){return}block_layout_id=self.lp_blocks[block_id]['layout_id'];block_json_id=$(this).parent('.lp-row').attr('data-json-id');if(!self.view_only){if(!$(this).parent().is('.lp-row')){console.error(`Error in block template with layout_id:${block_layout_id}`)}$(this).attr('data-block-layout',block_layout_id).attr('data-block-index',index).append(self.site_controls)}else{$('body').addClass('preview_mode')}if(self.preset_id===1851&&!self.staff_user){$(this).find('.site-controls .inverse-control').remove()}if(block_variant_id){$(this).find('.site-controls .edit-through-block').hide()}if(self.preset_id===1461){$(this).find('.site-controls .inverse-control').remove()}if(!$(this).parent('.lp-row').attr('data-has-css')){$(this).find('.site-controls .edit-layout-css').remove()}$(this).find('form').each(function(){$(this).attr('title',s3.loc('JS_LP_FORM_NOTE')).tooltip();$(this).find('input[type="submit"], button[type="submit"]').on('click',function(){return false})});$(this).find('script').each(function(){$(this).addClass('no-reload')});$(this).find('a').each(function(){$(this).on('click',function(event){event.preventDefault()})});self.reInitCssObject(block_id);if(!self.view_only){self.setControlsContext($(this),block_id,block_json_id);self.orientBlockControls($(this),scroll_add)}if($(this).outerHeight()<=200){$(this).parents('.lp-row').addClass('mini-row')}});function fixedMenu(){var fixed_menu;scroll_add=0;$('[id^="_lp_block_"][data-fixed-menu="true"]').each(function(){if($(this).find('.fixable_menu').length){fixed_menu=$(this).find('.fixable_menu')}else{fixed_menu=$(this)}if(fixed_menu.outerHeight()){if(fixed_menu.outerHeight()>scroll_add){scroll_add=fixed_menu.outerHeight()}}else{if(fixed_menu.find('> div').outerHeight()>scroll_add){scroll_add=fixed_menu.find('> div').outerHeight()}}})}$(window).scroll(function(){fixedMenu();$('[id^="_lp_block_"]:hover').each(function(){if(!$(this).attr('data-fixed-menu')){self.orientBlockControls($(this),scroll_add)}})});$('[id^="_lp_block_"]').on('mouseover',function(){fixedMenu();if(!$(this).attr('data-fixed-menu')){self.orientBlockControls($(this),scroll_add)}});if(!self.settings['main_colors']){self.settings['main_colors']=['#fff','#bbb','#000']}if(self.settings.themes&&!self.view_only&&self.content_lp==false){var themes_html='',theme,theme_active_class;theme_active_class=self.theme?'':' _theme-list__item--selected';themes_html+='<div class="_theme-list__item close'+theme_active_class+'" data-theme="drop" onclick="LpController.applyTheme($(this));">'+'<span class="_theme-list__part" style="background: '+self.settings['main_colors'][0]+';"></span>'+'<span class="_theme-list__part" style="background: '+self.settings['main_colors'][1]+';"></span>'+'<span class="_theme-list__part" style="background: '+self.settings['main_colors'][2]+';"></span>'+'<span class="_theme-list__item-index">0</span>'+'</div>';$.get(self.settings.themes.global+'?'+S3_ACCESS+'&rnd='+rnd,function(data){if(typeof data=='object'&&!$.isEmptyObject(data)){for(var theme in data){theme_active_class=(theme==self.theme&&self.theme_global)?' _theme-list__item--selected':'';themes_html+='<div class="_theme-list__item'+theme_active_class+'" data-global="true" data-theme="'+theme+'" onclick="LpController.applyTheme($(this));">'+'<span class="_theme-list__part" style="background: '+data[theme]["colors"][0]+';"></span>'+'<span class="_theme-list__part" style="background: '+data[theme]["colors"][1]+';"></span>'+'<span class="_theme-list__part" style="background: '+data[theme]["colors"][2]+';"></span>'+'<span class="_theme-list__item-index">'+theme+'</span>'+'</div>';self.list_index=theme}}$.get(self.settings.themes.local+'?'+S3_ACCESS+'&rnd='+rnd,function(data){if(typeof data=='object'&&!$.isEmptyObject(data)){for(var theme in data){self.list_index++;theme_active_class=(theme==self.theme&&!self.theme_global)?' _theme-list__item--selected':'';themes_html+='<div data-metrika="landingPanelThemeApply" class="_theme-list__item'+theme_active_class+'" data-theme="'+theme+'" onclick="LpController.applyTheme($(this));">'+'<span class="_theme-list__part" style="background: '+data[theme]["colors"][0]+';"></span>'+'<span class="_theme-list__part" style="background: '+data[theme]["colors"][1]+';"></span>'+'<span class="_theme-list__part" style="background: '+data[theme]["colors"][2]+';"></span>'+'<span class="_theme-list__item-index">'+self.list_index+'</span>'+'</div>'}}var full_mode='';if(self.can_edit_global){full_mode="&full_mode=1"}themes_html+='<a data-metrika="landingPanelThemeAdd" target="_blank" href="/-/cms/v1/lp/preset/?act=css_patch&'+S3_ACCESS+'&preset_id='+self.preset_id+'&preset_ver_id='+VER_ID+'&lp_id='+self.lp_id+'&variant_id='+self.variant_id+full_mode+'&access_granted=1'+'" class="p _theme-list__add" data-theme="add" ></a>';$('#landing_page_controls ._row._theme-list').append(themes_html)})})}if(self.check_demo_status){self.demoStatusAutoUpdate()}$('body').S3ChangeControls();self.initRangeSlider($('body'));self.initPicker($('body'));self.convertImages($('body'));self.setContextEvents();s3.initEmitterPostMessage(window);self.initIframeMosaic();window.addEventListener("CloseLpPanel",function(){self.hideVisualPanel()});window.addEventListener("SaveLpPanel",function(data){self.saveGlobalStyle(data.detail)});$('#lp-panel-iframe').on('load',function iframeLpPanelOnLoad(){const iframe=$('#lp-panel-iframe');Preloader.hide();if(iframe.attr('src')!==''){$('body').css('overflow','hidden');iframe.css('display','block')}});if(self.content_lp&&!self.preview_mode){var ro=new ResizeObserver($.debounce(800,function(e){self.setLpcParams()}));ro.observe(document.querySelector('.decor-wrap'));$('.lpc-iframe-wrap').on('click',function(){$('.lpc-iframe-wrap').addClass('active');S3ContextMenuController.closeContextMenu();LpController.closeColorpicker();setTimeout(function(){if($('.lpc-iframe-wrap').hasClass('active')){$('.lpc-iframe-wrap').removeClass('active')}},500)})}const observer=new MutationObserver((mutations)=>{if(self.publishBtn.is(':visible')||self.cancelAllBtn.is(':visible'))return;for(let mutation of mutations){if(!$(mutation.target).hasClass('modified'))continue;self.publishBtn.show();self.cancelAllBtn.show()}});observer.observe(self.main_wrapper[0],{childList:true,subtree:true,attributes:true,attributeFilter:['class'],});$(window).trigger('resize');Preloader.hide();if(!options.notifications_disable&&!options.staff_user){self.startOnboarding()}},isKeyDownCode:function(keyCode){var self=this;if(self.arrayKeyCode.length){for(let i=0;i<self.arrayKeyCode.length;i++){if(self.arrayKeyCode[i]===keyCode){return true}}}return false},isActiveOnboarding:function(){var self=this;return self.onboarding&&self.onboarding.tour&&self.onboarding.tour.isActive()},selectParentElement:function(){var self=this;var $elem=$(self.selected_element);S3ContextMenuController.closeContextMenu();self.unSelectElement($('body'));self.selectElement($elem.parents('[data-elem-type]').eq(0))},eventAction:function(){var self=this;$(self.selected_element).trigger('click')},selectElement:function(target){var self=this;if(!target.closest('[data-elem-type]').length){return}var $elem=target.closest('[data-elem-type]');if(window.getSelection().toString().trim().length){$elem=$(window.getSelection().focusNode.parentElement).closest('[data-elem-type]')}var has_slider=$elem.closest('.owl-carousel').length;$(self.block_css_controls).show();if($elem.is('svg')){var cls=$elem.attr('class')?$elem.attr('class'):'';$elem.attr('class',cls+' lp-selected-element')}else{$elem.addClass('lp-selected-element')}self.selected_element=$elem[0];self.selected_element_class=self.getSelector(self.selected_element,$elem.parents('.lp-row').attr('data-block-id'));if(has_slider){$elem.closest('.owl-carousel').trigger('stop.owl.autoplay');$elem.addClass('has-slider')}if(self.isKeyDownCode(18)&&self.selected_element){var element=self.selected_element.closest('[data-has-event]');if(element){$(element).trigger('click')}}},unSelectElement:function(target){var self=this;if(target.closest('.controls-inner').length||target.closest('.colorpicker').length||(($('.context-menu').is(':visible')||$('.colorpicker').is(':visible'))&&!target.closest('[data-elem-type]').length)||$('.bluepopup-wrapper').is(':visible')||(target.closest('.lp-selected-element').length&&!target.closest('.lp-selected-element').find('[data-elem-type]').length)||target.closest('.bluepopup-wrapper').length){return}if($('.lp-selected-element').closest('.owl-carousel').length&&$('.lp-selected-element').closest('.owl-carousel').attr('data-autoplay')){$('.lp-selected-element').closest('.owl-carousel').trigger('play.owl.autoplay')}$('.lp-selected-element').removeClass('lp-selected-element').removeClass('has-slider');$('svg.lp-selected-element').each(function(i,e){var cls=$(e).attr('class');$(e).attr('class',cls.replace("lp-selected-element",""))});self.selected_element=null;self.selected_element_class=null;$(self.block_css_controls).hide()},setContentEditable:function($elem){$('[contenteditable="true"]').removeAttr('contenteditable');$elem=$elem.find('[data-text-container]').length?$elem.find('[data-text-container]'):$elem;$elem.attr('contenteditable',true).focus();var range=document.createRange();range.selectNodeContents($elem[0]);range.collapse(false);var sel=window.getSelection();sel.removeAllRanges();sel.addRange(range)},prepareControls:function($elem,type){var self=this;if($(window).width()<=1023){return}$(self.block_css_controls).find('li').hide();$(self.block_css_controls).find('.control-btn').hide();var control_list=self.getElemControlList(type,$elem);if(control_list.length){control_list.forEach(function(control_name,index){var $control=$(self.block_css_controls).find('.'+control_name+'-control');$control.show();if(!$control.parents('li').is(':visible')){$control.parents('li').show()}});if(self.isEditableElem(type,$elem)&&$elem.attr('data-path')&&!$elem.closest('[contenteditable="true"]').length&&!$elem.children('.text-block-wrap-div[contenteditable="true"]').length){self.setContentEditable($elem)}}if(self.isTagElem(type,$elem)){$(self.block_css_controls).find('.tag-control').text($elem[0].tagName)}if(type==='block'||type==='promo_block'){self.toggleElement($(self.selected_element).find('[data-s3-animator]').length,$(self.block_css_controls).find('.edit-layout-animate'))}if($elem.parents('[data-elem-type]').length){$(self.block_css_controls).find('.select-control').show();$(self.block_css_controls).find('.select-control').parent().show()}if($elem.closest('[data-has-event]').length){$(self.block_css_controls).find('.event-control').show();$(self.block_css_controls).find('.event-control').parent().show()}if($elem.closest('[data-list-path]').length&&$elem.closest('.lp-row[data-library-id]').length){$(self.block_css_controls).find('.select-list-item-js').show();$(self.block_css_controls).find('.select-list-item-js').closest('li').show()}if($elem.closest('[data-widget-id]').length){$(self.block_css_controls).find('.widget-control').show();$(self.block_css_controls).find('.widget-control').parent().show()}},getElemControlList:function(type,element){var self=this;var list=[];if(type==='generate'&&$(element).attr('data-lp-controls-list')){list=$(element).attr('data-lp-controls-list').split(",").map(item=>item.trim())}else if(self.element_types.hasOwnProperty(type)){list=[...self.element_types[type]]}if(type==='text'&&$(element).attr('data-control-tag')==="tag"){list.push('tag')}return list},isEditableElem:function(type,element){var self=this;var control_list=self.getElemControlList(type,element);return $.inArray('text',control_list)>=0&&type!=='form'&&type!=='selected_fragment'},isTagElem:function(type,element){var self=this;var control_list=self.getElemControlList(type,element);return $.inArray('tag',control_list)>=0},setContextEvents:function(){var self=this;let currentSelectedFont='';$('.lp-link-popup select').on('change',function(event){var index=this.selectedIndex;var $popup=$(this).closest('.lp-link-popup');var $input=$popup.find('input[name="lp_link"]');$input.val('');if(index===0){$input.parent().removeClass('disabled');$popup.find('.link-type').show();$popup.find('.anchor-type').hide()}else{$input.parent().addClass('disabled');$popup.find('.link-type').hide();$popup.find('.anchor-type').show();$popup.find('.anchor-type .s3-btn').attr('data-type',index===1?'popup':'scroll')}});$('.media-box li').on('click',function(event){var media=$(this).attr('data-media');var $popup=$(this).parents('.context-popup');$popup.find('.media-params-box '+'.'+media).addClass('active').siblings().removeClass('active');$(this).addClass('active').siblings().removeClass('active')});$('.lp-tag-popup select').on('change',function(event){var tag=$(this).val();var old_tag=self.selected_element.tagName.toLowerCase();self.updateElemTag(tag,function(){if(!$(self.selected_element).attr('data-old-tag')){$(self.selected_element).attr('data-old-tag',old_tag)}})});$('#animate_options').on('change',function(event){self.updateAnimateEffect()});$('.s3-lp-animate-settings .settings-right-part .s3-btn').on('click',function(event){$(this).parent().find('.active').removeClass('active');$(this).addClass('active');self.updateAnimateEffect()});$(document).on('click','.pos-control .s3-btn',function(){var $popup=$(this).parents('.context-popup');const class_elem=$popup.data('type')==='block_background_item'?'.lp-block-bg_item':'.lp-block-bg';var image_elem=$(self.selected_element).find(class_elem).length?$(self.selected_element).find(class_elem):$(self.selected_element);$(this).parent().find('.selected').removeClass('selected');$(this).addClass('selected');var x_pos=$popup.find('.x-position .s3-btn.selected').attr('data-val');var y_pos=$popup.find('.y-position .s3-btn.selected').attr('data-val');self.applyStyles(this,image_elem,{'background-position':x_pos+' '+y_pos});LpController.applyPopupParams($('.context-popup:visible'))});$(document).on('click','.family-item .dropdown-box .drop-item',function(e){var $box=$(e.target).parents('.dropdown-box');if($(e.target).attr('data-font-variants')){return false}else{var fw='normal';var ff=$(e.target).attr('data-value');var ff_text=$(e.target).text();var fs='normal';var has_italic=false;var $row=$(self.selected_element).parents('.lp-row');var last_fonts=$.isPlainObject(LS.get('last_fonts'))?[]:LS.get('last_fonts');var item=this.outerHTML;if($(e.target).parents('.sub-level').length){var cur_weight=$(e.target).text();item=$box.find('.over')[0].outerHTML;if(!cur_weight.indexOf('italic')){has_italic=true}ff=$box.find('.over').attr('data-value');fw=$(e.target).attr('data-weight');ff_text=$box.find('.over').text();if(has_italic){$box.parents('.context-popup').find('.fsi').addClass('selected');fs='italic'}else{$box.parents('.context-popup').find('.fsi').removeClass('selected')}if(fw>=600){$box.parents('.context-popup').find('.fsb').addClass('selected')}else{$box.parents('.context-popup').find('.fsb').removeClass('selected')}}if(last_fonts.indexOf(item)===-1){last_fonts.unshift(item);if(last_fonts.length>3){last_fonts.pop()}}LS.set('last_fonts',last_fonts);if($box.parents('.context-popup').find('.fsi').hasClass('selected')&&fs==='normal'){fs='italic'}if($box.parents('.context-popup').find('.fsb').hasClass('selected')&&fw==='normal'){fw=600}$box.find('.selected-value').attr('data-font',ff).text(ff_text);$box.parents('.media-rule-box').nextAll().not('.changed-rule').each(function(i,r){var media=$(this).attr('media');var saved=self.getElemCssProp('font','family',null,media);if(!saved)$(r).find('.family-item .selected-value').attr('data-font',ff).text(ff_text)});var obj={'font-family':ff,'font-weight':fw,'font-style':fs};if(self.hasSelection()){self.setSelectionParams(obj)}else{self.applyStyles(e.target,$row.find(self.selected_element_class),obj)}$(e.target).parents('.dropdown-box').removeClass('visible');$(e.target).parents('.dropdown-box').find('.sub-level').hide().html('');LpController.applyPopupParams($('.context-popup:visible'))}});let currentFont;const dropFamilyItem='.family-item-control .dropdown-box .dropdown-popup .family-drop-item';const dropFamilyItemGl='.lp-panel-item-family .dropdown-box .dropdown-popup .family-drop-item';$(document).on('click',dropFamilyItem,function(e){const $box=$(e.target).parents('.dropdown-box').find('.sub-level .sub-item[data-weight="400"]');if($box.length){$box.trigger('click')}currentFont=$(this).data('value')});$(document).on('mouseover',dropFamilyItem,function(){const fontFamily=$(this).data('value');currentSelectedFont=fontFamily;self.setFontFamilyToElement(fontFamily)});$(document).on('mouseout','.family-item-control .dropdown-box .dropdown-popup',function(){const fontFamily=currentFont?currentFont:'';self.setFontFamilyToElement(fontFamily)});$(document).on('mouseover',dropFamilyItemGl,function(){const fontFamily=$(this).data('value');self.setFontFamilyToElement(fontFamily)});$(document).on('mouseover','.dropdown-box .sub-level .sub-item',function(event){const fontWeight=$(event.target).data('weight');if(!currentSelectedFont||!fontWeight){return}self.setFontFamilyToElement(currentSelectedFont,fontWeight)});$(document).on('mouseenter','.family-item .dropdown-box .dropdown-popup .family-drop-item',function(e){var $box=$(e.target).parents('.dropdown-box');$box.find('.sub-level').hide().html('');$box.find('.over').removeClass('over');if($(e.target).attr('data-font-variants')){var childPos=$(e.target).offset();var parentPos=$(e.target).parents('.dropdown-popup').offset();var params_list=$(e.target).attr('data-font-variants').split(','),weights={400:'normal'},_w={100:['thin','hairline'],200:['extra-light','ultra-light'],300:['light'],400:['normal'],500:['medium'],600:['demi-bold','semi-bold'],700:['bold'],800:['extra-bold','ultra-bold'],900:['black','heavy']},key;if(params_list&&params_list.length){for(var i=0;i<params_list.length;i++){for(key in _w){if($.inArray(params_list[i],_w[key])>=0){weights[key]=params_list[i]}}}}$(e.target).addClass('over');for(var w in weights){$box.find('.sub-level').append('<div class="sub-item drop-item" data-weight="'+w+'">'+weights[w]+'</div>')}$box.find('.sub-level').css('top',childPos.top-parentPos.top+60).show();self.ff_flag=true}});$(document).on('mouseleave','.family-item .dropdown-box',function(e){var box=this;self.ff_flag=false;setTimeout(function(){if(!self.ff_flag){$(box).find('.sub-level').hide().html('');$(box).find('.over').removeClass('over')}})});$('.size-item input').on('input',$.debounce(1500,function(e){var row=$(self.selected_element).parents('.lp-row');var val=$(this).val();val=val.replace(/[^\d,]/g,'');val=Math.max(Math.min(val,96),12);$(this).val(val);if($(self.selected_element).find('.fz-params-text').get(0)){self.setSelection($(self.selected_element).find('.fz-params-text').get(0));$('.fz-params-text').removeClass('fz-params-text')}self.setFontSizeToElement(this,val+'px',row,self.selected_element_class);self.removeSelection();$(this).parents('.dropdown-box').removeClass('visible');$(this).parents('.media-rule-box').nextAll().not('.changed-rule').each(function(i,r){var media=$(this).attr('media');var saved=self.getElemCssProp('font','size',null,media);if(!saved)$(r).find('.size-item input').val(val)});LpController.applyPopupParams($('.context-popup:visible'))}));$('.height-item input').on('input',$.debounce(1500,function(e){var row=$(self.selected_element).parents('.lp-row');var val=$(this).val();val=val.replace(/[^\d,]/g,'');val=Math.max(Math.min(val,180),90);$(this).val(val);self.setLineHeightToElement(this,val+"%",row,self.selected_element_class);$(this).parents('.dropdown-box').removeClass('visible');$(this).parents('.media-rule-box').nextAll().not('.changed-rule').each(function(i,r){var media=$(this).attr('media');var saved=self.getElemCssProp('font','lineheight',null,media);if(!saved)$(r).find('.height-item input').val(val)});LpController.applyPopupParams($('.context-popup:visible'))}));$('.align-item .s3-btn').on('click',function(){var val='';var row=$(self.selected_element).parents('.lp-row');if($(this).find('.i-align').hasClass('center')){val='center'}else if($(this).find('.i-align').hasClass('right')){val='right'}else if($(this).find('.i-align').hasClass('justify')){val='justify'}else{val='left'}$(this).parents('.media-rule-box').nextAll().not('.changed-rule').each(function(i,r){var media=$(this).attr('media');var saved=self.getElemCssProp('font','text_align',null,media);if(!saved)$(r).find('.align-item [data-val="'+val+'"]').siblings().removeClass('selected').addClass('selected')});self.applyStyles(this,row.find(self.selected_element_class),{'text-align':val,'text-align-last':val});$(this).parent().find('.selected').removeClass('selected');$(this).addClass('selected');LpController.applyPopupParams($('.context-popup:visible'))});$('.fsb').on('click',function(){var row=$(self.selected_element).parents('.lp-row');self.setFontWeightToElement($(this),row,self.selected_element_class);LpController.applyPopupParams($('.context-popup:visible'))});$('.fsi').on('click',function(){var row=$(self.selected_element).parents('.lp-row');self.setFontStyleToElement($(this),row,self.selected_element_class);LpController.applyPopupParams($('.context-popup:visible'))});$('.tdu').on('click',function(){var row=$(self.selected_element).parents('.lp-row');self.setTextDecorationToElement($(this),row,self.selected_element_class,'.tdlt','underline');LpController.applyPopupParams($('.context-popup:visible'))});$('.tdlt').on('click',function(){var row=$(self.selected_element).parents('.lp-row');self.setTextDecorationToElement($(this),row,self.selected_element_class,'.tdu','line-through');LpController.applyPopupParams($('.context-popup:visible'))});window.addEventListener('beforeunload',(event)=>{if($('.modified').length){event.preventDefault();event.stopPropagation()}})},setFontFamilyToElement:function(fontFamily,fontWeight=''){const self=this;const css={'font-family':fontFamily,'font-weight':fontWeight,};if(self.hasSelection()){self.setSelectionParams(css)}else{self.applyStyles(_,$(self.selected_element),css)}},setFontSizeToElement:function(control,fz,$parent,element_class){var self=this;if(self.hasSelection()){self.setSelectionParams({'font-size':fz})}else{self.applyStyles(control,$parent.find(element_class),{'font-size':fz})}},setValueToControl:function(el){var self=this;var $input=$(el).parents('.dropdown-box').find('input');$input.val($(el).text()).trigger("input")},setLineHeightToElement:function(control,val,$parent,element_class){var self=this;if(self.hasSelection()){self.setSelectionParams({'line-height':val})}else{self.applyStyles(control,$parent.find(element_class),{'line-height':val})}},setFontWeightToElement:function($btn,$parent,element_class){var self=this;$btn.toggleClass('selected');if(self.hasSelection()){if($btn.hasClass('selected')){self.setSelectionParams({'font-weight':'bold'})}else{self.setSelectionParams({'font-weight':'normal'})}}else{if($btn.hasClass('selected')){self.applyStyles($btn[0],$parent.find(element_class),{'font-weight':'bold'})}else{self.applyStyles($btn[0],$parent.find(element_class),{'font-weight':'normal'})}$btn.parents('.media-rule-box').nextAll().not('.changed-rule').each(function(i,r){var media=$(this).attr('media');var saved=self.getElemCssProp('font','weight',null,media);if(!saved){if($btn.hasClass('selected')){$(r).find('.fsb').addClass('selected')}else{$(r).find('.fsb').removeClass('selected')}}})}},setFontStyleToElement:function($btn,$parent,element_class){var self=this;$btn.toggleClass('selected');if(self.hasSelection()){if($btn.hasClass('selected')){self.setSelectionParams({'font-style':'italic'})}else{self.setSelectionParams({'font-style':'normal'})}}else{if($btn.hasClass('selected')){self.applyStyles($btn[0],$parent.find(element_class),{'font-style':'italic'})}else{self.applyStyles($btn[0],$parent.find(element_class),{'font-style':'normal'})}$btn.parents('.media-rule-box').nextAll().not('.changed-rule').each(function(i,r){var media=$(this).attr('data-media');var saved=self.getElemCssProp('font','style',null,media);if(!saved){if($btn.hasClass('selected')){$(r).find('.fsi').addClass('selected')}else{$(r).find('.fsi').removeClass('selected')}}})}},setTextDecorationToElement:function($btn,$parent,element_class,sibling_class,param){var self=this;$btn.toggleClass('selected').removeClass('disable');if(self.hasSelection()){if($btn.hasClass('selected')){$btn.parent().find(sibling_class).removeClass('selected').addClass('disable');self.setSelectionParams({'text-decoration':param})}else{self.setSelectionParams({'text-decoration':'none'})}}else{if($btn.hasClass('selected')){$btn.parent().find(sibling_class).removeClass('selected').addClass('disable');self.applyStyles($btn[0],$parent.find(element_class),{'text-decoration':param})}else{self.applyStyles($btn[0],$parent.find(element_class),{'text-decoration':'none'})}$btn.parents('.media-rule-box').nextAll().not('.changed-rule').each(function(i,r){var media=$(this).attr('media');var saved=self.getElemCssProp('font','text_decoration',null,media);var btn_class=param=='undrline'?'.tdu':'.tdlt';if(!saved){if($btn.hasClass('selected')){$(r).find(btn_class).addClass('selected')}else{$(r).find(btn_class).removeClass('selected')}}})}},getElemCssParams:function($popup,check_disable){var self=this;var data={};var type=$popup.attr('data-type');var $media_rules=$popup.find('.media-rule-box.changed-rule');if(!self.hasSelection()){$media_rules.each(function(index,box){var media=$(box).attr('data-media');var obj=self.getElemCssParam(box,type,self.selected_element_class,check_disable);if(media==='screen'){$.extend(data,obj)}else{if(!data.hasOwnProperty('media_rules'))data['media_rules']={};data['media_rules'][media]=obj}})}return data},getElemCssParam:function(box,type,selector,disabled){var self=this;var obj={};switch(type){case'background':var bgp_x=$(box).find('.x-position .selected').length?$(box).find('.x-position .selected').attr('data-val'):'0%';var bgp_y=$(box).find('.y-position .selected').length?$(box).find('.y-position .selected').attr('data-val'):'0%';var bgp=bgp_x+' '+bgp_y;var bga=$(box).find('.attachment-param input').prop('checked')?'fixed':'scroll';var bgc=$(box).find('.colorpicker-bg-component').data('color');var start_color=$(box).find('.colorpicker-grad_start-component').data('color');var end_color=$(box).find('.colorpicker-grad_end-component').data('color');var bg_type=$(box).find('.bg-types select').val()?$(box).find('.bg-types select').val():'transparent';var grad_dir=$(box).find('.gradient-direction input').val()?$(box).find('.gradient-direction input').val():0;if(bg_type==='image'){const bgs=$(box).find('.size-control').val();const image=$(box).find('.image-select input').val();const bgr=$(box).find('.repeat-control').val();obj['background']={attachment:bga,bg_type:bg_type,color:'transparent',end_color:'transparent',end_color_hex:'transparent',gradient_direction:"top bottom",image:image,position:bgp,repeat:bgr,start_color:'transparent',start_color_hex:'transparent',size:bgs}}else{obj['background']={attachment:bga,bg_type:bg_type,color:bgc,end_color:end_color,end_color_hex:end_color,gradient_direction:grad_dir+'deg',image:'{"image_id":"","filename":""}',position:bgp,repeat:'no-repeat',start_color:start_color,start_color_hex:start_color}}break;case'text':var ff=$(box).find('.selected-value').attr('data-font');var fs=$(box).find('.size-item input').val();var lh=$(box).find('.height-item input').val();var c=$(box).find('.change-color .colorpicker-color-component').data('color');var fw=$(self.selected_element).css('font-weight');var td=$(box).find('.td-control.selected').length?$(box).find('.td-control.selected').attr('data-val'):'none';var al=$(box).find('.align-item .selected').attr('data-val');var fst=$(box).find('.fsi').hasClass('selected');obj['font']={'color':c,'size':fs,'text_align':al,'text_align_last':al,'weight':fw,'text_decoration':td,'lineheight':lh+'%','family':ff,'style':fst};break;case'indents':obj['padding']={};obj['margin']={};$(box).find('.paddings .personal-type .control-wrap').each(function(i,e){var side=$(e).data('val');var v=$(e).find('.range-value').val();if(parseFloat(v)||v=='0'){obj['padding'][side]=v}});$(box).find('.margins .personal-type .control-wrap').not('.hide').each(function(i,e){var side=$(e).data('val');var v=$(e).find('.range-value').val();if(parseFloat(v)||v=='0'){obj['margin'][side]=v}});break;case'border':var bdc=$(box).find('.color-wrap .colorpicker-border-component').data('color');var bdw=$(box).find('.border_width-body .range-value').val();obj['border_radius']={};$(box).find('.border-radius-control .personal-type > div').each(function(i,e){var side=$(e).data('val');var v=$(e).find('.range-value').val();obj['border_radius'][side]=disabled?0:v});obj['border']={color:bdc,style:'solid',width:disabled?0:bdw};break;case'box_shadow':var bshc=$(box).find('.colorpicker-shadow-component').data('color');var offset_x=$(box).find('.offset_x input').val();var offset_y=$(box).find('.offset_y input').val();var blur=$(box).find('.blur input').val();var spread=$(box).find('.spread input').val();obj['box_shadow']={color:bshc,offset_x:disabled?0:offset_x,offset_y:disabled?0:offset_y,blur:disabled?0:blur,spread:disabled?0:spread};break;case'size':obj['width']={"size":$(box).find('.image_width-body input').val()};obj['height']={"size":$(box).find('.image_height-body input').val()};break}if($(self.selected_element).closest(self.button_default_class).length){obj=self.getStylesForRule(obj,selector)}return obj},getMedia:function($popup){return $popup.find('.media-box .active').attr('data-media')?$popup.find('.media-box .active').attr('data-media'):'screen'},getPreviewMedia:function($popup){return $('.media-panel .media_active').attr('data-media-type')},getElemCssProp:function(obj,prop,css_prop,media,block,sel){var self=this;var block_id=$(self.selected_element).parents('.lp-row').attr('data-block-id');var $elem=block?block:$(self.selected_element);var selector=sel?sel:self.selected_element_class;var value='';if(self.hasSelection()){if(css_prop){var elem=self.getSelectionElement();if(elem){value=$(elem).css(css_prop)}}return value}if(self.css_params.hasOwnProperty(block_id)&&self.css_params[block_id].hasOwnProperty(selector)){var params=self.css_params[block_id][selector];if(media){if(self.css_params[block_id][selector].hasOwnProperty('media_rules')&&self.css_params[block_id][selector]['media_rules'].hasOwnProperty(media)){params=self.css_params[block_id][selector]['media_rules'][media];if(params.hasOwnProperty(obj)&&prop&&params[obj].hasOwnProperty(prop)){value=params[obj][prop]}else if(params.hasOwnProperty(obj)&&!prop){value=params[obj]}}}else{if(params.hasOwnProperty(obj)&&prop&&params[obj].hasOwnProperty(prop)){value=params[obj][prop];if(obj==='background'&&prop==='image'&&value&&!value['filename']){value=$elem.css(css_prop)}}else if(params.hasOwnProperty(obj)&&!prop){value=params[obj]}else if(css_prop){value=$elem.css(css_prop)}}}else if(css_prop){value=$elem.css(css_prop)}return self.isJsonString(value)?JSON.parse(value):value},getCommentedProp:function(prop){var self=this;var block_id=$(self.selected_element).parents('.lp-row').attr('data-block-id');var value={};if(self.css_params.hasOwnProperty(block_id)&&self.css_params[block_id].hasOwnProperty(self.selected_element_class)&&self.css_params[block_id][self.selected_element_class].hasOwnProperty('commented_props')){var params=self.css_params[block_id][self.selected_element_class]['commented_props'];value=params[prop]}return value},getStylesForRule:function(data,selector){var self=this;var color_props=['color','start_color','end_color','start_color_hex','end_color_hex'];Object.keys(data).forEach(function(prop){if(prop===selector+':hover'||prop===selector+':active')return true;Object.keys(data[prop]).forEach(function(param){if(color_props.indexOf(param)!==-1){if(!data.hasOwnProperty(selector+':hover'))data[selector+':hover']={};if(!data.hasOwnProperty(selector+':active'))data[selector+':active']={};if(!data[selector+':hover'].hasOwnProperty(prop))data[selector+':hover'][prop]=$.extend({},data[prop]);if(!data[selector+':active'].hasOwnProperty(prop))data[selector+':active'][prop]=$.extend({},data[prop]);data[selector+':hover'][prop][param]=tinycolor(data[prop][param]).brighten(8).toString();data[selector+':active'][prop][param]=tinycolor(data[prop][param]).darken(8).toString()}})});return data},getSelector:function(node,block_id){var self=this;var wr=document.querySelector('[id="_lp_block_'+block_id+'"]');var parent=node.parentElement;var classList=node.classList;var path='';if($(node).attr('data-lp-selector')){return $(node).attr('data-lp-selector')}if($(node).parent().is('.lp-row')){return''}classList.forEach(function(c){if($.inArray(c,self.exception_classes)===-1){path+='.'+c}});if(path===''){path+=node.tagName.toLowerCase()}while(parent&&parent!==wr){var parent_path='';var parent_classList=parent.classList;parent_classList.forEach(function(c){if($.inArray(c,self.exception_classes)===-1){parent_path+='.'+c}});path=parent_path+" "+path;parent=parent.parentElement}return path.trim()},rebuildCss:function(){var self=this;var url='/-/cms/v1/lp/block/?act=rebuild_css&'+S3_ACCESS+'&variant_id='+self.variant_id;$.ajax({url:url,type:'GET',async:false,success:function(r){self.reloadCustomStyles(function(){setTimeout(function(){LpController.convertImages($('body'))},200)})},error:function(e){console.log('Error',e)}});return false},saveInlineParams:function(callback){var self=this;var promise=$.when();var data={};var urls={};var has_data=false;self.cancelAllBtn.hide();self.publishBtn.removeClass(self.publishButtonState.publish.class);self.publishBtn.addClass(self.publishButtonState.inPublish.class);self.publishBtn.text(self.publishButtonState.inPublish.text);$(self.row).each(function(i,row){var block_id=parseInt($(row).attr('data-block-id'));var layout_id=parseInt($(row).attr('data-block-layout-id'));var json_id=parseInt($(row).attr('data-json-id'));var rnd=new Date().getTime();let variant_id=$(row).attr('data-variant-id');variant_id=variant_id==undefined?self.variant_id:parseInt(variant_id,10);var url='/-/cms/v1/lp/block/?act=save_css&'+S3_ACCESS+'&block_id='+block_id+'&layout_id='+layout_id+'&variant_id='+variant_id+'&rnd='+rnd;var $elements=$(row).find('.modified');if($elements.length){has_data=true;if(!urls[block_id])urls[block_id]=[];urls[block_id]=url}$elements.each(function(i,e){if(!data[block_id])data[block_id]={};if(!data[block_id]['blocks'])data[block_id]['blocks']={};var selector=self.getSelector(e,block_id);if(self.css_params.hasOwnProperty(block_id)){if(self.css_params[block_id].hasOwnProperty(selector)){data[block_id]['blocks'][selector]=self.css_params[block_id][selector]}if(self.css_params[block_id].hasOwnProperty('.lp-block-bg_item')||self.css_params[block_id].hasOwnProperty('.lp-block-overlay_item')){if(self.css_params[block_id].hasOwnProperty('.lp-block-bg_item'))data[block_id]['blocks']['.lp-block-bg_item']=self.css_params[block_id]['.lp-block-bg_item'];if(self.css_params[block_id].hasOwnProperty('.lp-block-overlay_item'))data[block_id]['blocks']['.lp-block-overlay_item']=self.css_params[block_id]['.lp-block-overlay_item']}if(selector===""&&(self.css_params[block_id].hasOwnProperty('.lp-block-bg')||self.css_params[block_id].hasOwnProperty('.lp-block-overlay'))){if(self.css_params[block_id].hasOwnProperty('.lp-block-bg'))data[block_id]['blocks']['.lp-block-bg']=self.css_params[block_id]['.lp-block-bg'];if(self.css_params[block_id].hasOwnProperty('.lp-block-overlay'))data[block_id]['blocks']['.lp-block-overlay']=self.css_params[block_id]['.lp-block-overlay']}data[block_id]['layout_id']=layout_id}self.updateElementData(e,json_id)})});$.each(urls,function(block_id,url){var layout_id=data[block_id]['layout_id'];var obj=data[block_id]['blocks'];if(!obj||$.isEmptyObject(obj)){return true}promise=promise.then(function(){return $.ajax({url:url,type:'POST',data:{"block_id":block_id,"layout_id":layout_id,"css_value":JSON.stringify(obj),"inline_editing":1,"preset_id":self.preset_id},dataType:'json',async:false,error:function(e){console.log('Error',e)}})}).then(function(result){self.reloadCustomStyles()})});$.ajax({url:'/-/cms/v1/json/?act=edit_items&'+S3_ACCESS+'&lp_variant_id='+self.variant_id,data:{'ver_id':VER_ID,'data_json':JSON.stringify(self.params_stack)},type:'post',dataType:'json',error:function(e){console.log('Error',e)},success:function(){self.params_stack={};$('.colorpicker-visible').find('.cp-close').click();S3ContextMenuController.closeContextMenu();setTimeout(()=>{self.publishBtn.removeClass(self.publishButtonState.inPublish.class);self.publishBtn.addClass(self.publishButtonState.published.class);self.publishBtn.text(self.publishButtonState.published.text);util.msg(s3.loc('JS_PUBLISHED'),'green');setTimeout(()=>{self.publishBtn.hide();self.publishBtn.removeClass(self.publishButtonState.published.class);self.publishBtn.addClass(self.publishButtonState.publish.class);self.publishBtn.text(self.publishButtonState.publish.text)},2000)},2000);if(callback&&typeof callback==='function'){callback()}}});setTimeout(function(){var custom_styles_url='/t/css/__landing_page_'+self.variant_id+'.css';var $custom_styles=$('link[href^="'+custom_styles_url+'"]');if($custom_styles.length){$('.modified').removeAttr('style')}$('.modified').removeClass('modified modified-link modified-text').removeAttr('data-cleaned_css').removeAttr('data-old-href').removeAttr('data-rate').removeData('cleaned_params');if($('svg.modified').length){$('svg.modified').attr('class',$('svg.modified').attr('class').replace("modified",""))}if(self.after_save_callback&&typeof self.after_save_callback==='function'){self.after_save_callback()}},0);self.unSelectElement($('body'))},getBlockCssParams:function($popup){var self=this;var type=$popup.attr('data-type');var data={};switch(type){case'block_background':case'block_background_item':var image_selector=$(self.selected_element).find('.lp-block-bg').length?'.lp-block-bg':'';var overlay_selector=$(self.selected_element).find('.lp-block-overlay').length?'.lp-block-overlay':'';if(type==='block_background_item'){image_selector=$(self.selected_element).find('.lp-block-bg_item').length?'.lp-block-bg_item':'';overlay_selector=$(self.selected_element).find('.lp-block-overlay_item').length?'.lp-block-overlay_item':''}var bgr=$popup.find('.repeat-control').val();var bgs=$popup.find('.size-control').val();var bgp_x=$popup.find('.x-position .selected').length?$popup.find('.x-position .selected').attr('data-val'):'0%';var bgp_y=$popup.find('.y-position .selected').length?$popup.find('.y-position .selected').attr('data-val'):'0%';var bgp=bgp_x+' '+bgp_y;var bga=$popup.find('.attachment-param input').prop('checked')?'fixed':'scroll';var image=$popup.find('.image-select input').val();var bgc=$popup.find('.colorpicker-bg-component').data('color');var start_color=$popup.find('.colorpicker-grad_start-component').data('color');var end_color=$popup.find('.colorpicker-grad_end-component').data('color');var bg_type=$popup.find('.bg-types select').val();var grad_dir=$popup.find('.gradient-direction input').val();if(bgc=="rgba(0, 0, 0, 0)"){bgc='transparent'}if(bg_type==='transparent'){bgc='transparent';start_color='transparent';end_color='transparent'}else if(bg_type==='solid'){start_color='transparent';end_color='transparent'}else if(bg_type==='gradient'){bgc=start_color}if($(self.selected_element).find(image_selector).length&&$(self.selected_element).find(overlay_selector).length){data[image_selector]={background:{attachment:bga,bg_type:"solid",color:'transparent',end_color:'transparent',end_color_hex:'transparent',gradient_direction:"top bottom",image:image,position:bgp,repeat:bgr,start_color:'transparent',start_color_hex:'transparent',size:bgs}};data[overlay_selector]={background:{attachment:bga,bg_type:bg_type,color:bgc,end_color:end_color,end_color_hex:end_color,gradient_direction:grad_dir+'deg',image:'',position:bgp,repeat:bgr,start_color:start_color,start_color_hex:start_color}}}else{data[image_selector]={background:{attachment:bga,bg_type:bg_type,color:bgc,end_color:end_color,end_color_hex:end_color,gradient_direction:grad_dir+'deg',image:image,position:bgp,repeat:bgr,start_color:start_color,start_color_hex:start_color,size:bgs}}}break;case'block_indents':data['']={};data['']['padding']={};$popup.find('.media-rule-box.changed-rule').each(function(index,box){var media=$(box).attr('data-media');var obj={};$(box).find('.paddings .personal-type .control-wrap').each(function(i,e){var side=$(e).data('val');var v=$(e).find('.range-value').val();obj[side]=v});if(media==='screen'){$.extend(data['']['padding'],obj)}else{if(!data[''].hasOwnProperty('media_rules'))data['']['media_rules']={};if(!data['']['media_rules'].hasOwnProperty(media))data['']['media_rules'][media]={};data['']['media_rules'][media]['padding']=obj}});break}return data},updateElementData:function(element,json_id){var self=this;var elem_type=$(element).attr('data-elem-type');if(self.isEditableElem(elem_type,element)&&$(element).attr('data-path')&&$(element).hasClass('modified')){$(element).find('[data-props]').removeAttr('data-props');self.updateElemHtml(element)}if($(element).attr('data-changeable-type')){self.updateButtonType(element)}if($(element).closest('[data-link_path]').length&&$(element).hasClass('modified-link')){self.saveElemLink(element)}if(self.isTagElem(elem_type)||element.hasAttribute('data-control-tag'),element){self.saveElemTag(element)}if($(element).data('animate')){self.saveBlockAnimateParams(element)}var media_data=$(element).data('media')?JSON.parse($(element).data('media')):{};if(!self.params_stack.hasOwnProperty(json_id))self.params_stack[json_id]={};$.extend(true,self.params_stack[json_id],media_data)},updateElemHtml:function(element){var self=this;var data=$(element).find('[data-text-container]').length?$(element).find('[data-text-container]').html():$(element).html();$(element).removeClass('modified-text');self.updateMediaData($(element),$(element).attr('data-path'),data)},updateButtonType:function(element){var self=this;var path=$(element).attr('data-path');var key=path+'_type';var data=$(element).attr('data-type');self.updateMediaData($(element),key,data)},saveElemLink:function(element){element=element.closest('[data-link_path]');var self=this;var data=$(element).attr('href');var key=$(element).attr('data-link_path');var old_href=$(element).attr('data-old-href');if(!key){return}if(old_href){self.updateMediaData($(element),key+'_old',old_href)}self.updateMediaData($(element),key,data);self.updateMediaData($(element),key+'_rel',$(element).attr('rel')?$(element).attr('rel'):'');self.updateMediaData($(element),key+'_target',$(element).attr('target')?$(element).attr('target'):'');return false},saveElemTag:function(element){var self=this;var data=element.tagName.toLowerCase();var key=$(element).attr('data-path')+'_tag';if(!key){return}self.updateMediaData($(element),key,data);return false},saveOpenedPopup:function(){var self=this;if($('.context-popup:visible').length){var save_elem=$('.context-popup:visible').find('.save-block');save_elem.trigger('click')}},applyPopupParams:function($popup){if(LpController.notApplyPopupParams){return}var self=this;var block_id=$(self.selected_element).parents('.lp-row').attr('data-block-id');var disabled=$popup.find('.prop-toggle input').length&&!$popup.find('.prop-toggle input').prop('checked');var params=self.getElemCssParams($popup,disabled);var type=$popup.attr('data-type');if(type==='size'){var size_key=$(self.selected_element).attr('data-size-path')?$(self.selected_element).attr('data-size-path'):$(self.selected_element).attr('data-path');self.updateMediaData($(self.selected_element),size_key+'_width',$popup.find('.range-value').eq(0).val());self.updateMediaData($(self.selected_element),size_key+'_height',$popup.find('.range-value').eq(1).val())}else if(type==='background'){$(self.selected_element).find('.bg-wrap').removeClass('bg-wrap')}self.initCssParamsKeys(block_id,self.selected_element_class);if(~type.indexOf('block_')){var block_params=self.getBlockCssParams($popup);self.css_params[block_id]=$.extend(true,self.css_params[block_id],block_params)}else{var css_params=self.css_params[block_id][self.selected_element_class];css_params=$.isArray(css_params)&&!css_params.length?{}:css_params;self.css_params[block_id][self.selected_element_class]=$.extend(true,css_params,params)}self.setModified();$popup.find('.changed-rule').removeClass('changed-rule');$(self.selected_element).removeAttr('data-old-s3-animator');self.addColorToPalette($popup)},applyVideoParams:function($popup){const self=this;const $videoType=$popup.find('.background-types-select select').val();const $path=$(self.selected_element).attr('data-path');const $autoplay=$popup.find('input.autoplay').attr('checked')?1:0;const $controls=$popup.find('input.show_panel').attr('checked')?1:0;const $videoId=$popup.find('input.video-id').val();const $loop=$popup.find('input.repeat').attr('checked')?1:0;const $video=$popup.find('.video-change-wrap');const filename=$video.find('source').attr('src');let video_html='';if($videoType===self.CUSTOM_VIDEO_TYPE){video_html=`<video type="video/mp4"><source src="${filename}"></video>`}else{const $iframeSrc=self.videoEmbed.get($videoType).replace('{ID_VIDEO}',$videoId)+`&controls=${$controls}&autoplay=${$autoplay}`;video_html=`<iframe src="${$iframeSrc}"></iframe>`}$(self.selected_element).html(video_html);self.updateMediaData($(self.selected_element),`${$path}_autoplay`,$autoplay);self.updateMediaData($(self.selected_element),self.getVideoDataPath('youtube_panel'),$controls);self.updateMediaData($(self.selected_element),self.getVideoDataPath('youtube'),$videoId);self.updateMediaData($(self.selected_element),`${$path}_loop`,$loop);self.updateMediaData($(self.selected_element),`${$path}_type`,$videoType);self.updateMediaData($(self.selected_element),$path,{filename:filename?filename:''});$(self.selected_element).attr('data-video-type',$videoType);$(self.selected_element).attr('data-video-controls',$controls);$(self.selected_element).attr('data-video-autoplay',$autoplay);$(self.selected_element).attr('data-video-loop',$loop);$(self.selected_element).attr('data-video-id',$videoId);$(self.selected_element).attr('data-video-filename',filename);self.setModified();S3ContextMenuController.closeContextMenu()},addColorToPalette:function($popup){var self=this;if($popup.find('.picker-input-wrap input').length){var colors=[];if($popup.find('.bg-types').length&&$popup.find('.bg-types select').val()==='gradient'){var color1='#'+$popup.find('.gradient-type .picker-input-wrap input').eq(0).val();var color2='#'+$popup.find('.gradient-type .picker-input-wrap input').eq(1).val();colors.push(color1);colors.push(color2)}else{var color='#'+$popup.find('.picker-input-wrap input').val();colors.push(color)}colors.forEach(function(color){if(self.lp_palette.indexOf(color)===-1){self.lp_palette.unshift(color);if(self.lp_palette.length>7){self.lp_palette.pop()}}});LS.set('lp_palette',self.lp_palette)}},initCssParamsKeys(block_id,selector){var self=this;if(!self.css_params.hasOwnProperty(block_id))self.css_params[block_id]={};if(!self.css_params[block_id].hasOwnProperty(selector))self.css_params[block_id][selector]={}},cancelInlineParams:function(){var self=this;self.cancelAllBtn.hide();self.publishBtn.hide();$('#landing_page_site .modified').each(function(ind,elem){var $row=$(elem).parents('.lp-row');var block_id=$row.attr('data-block-id');var layout_id=$row.attr('data-block-layout-id');if($(elem).hasClass('modified-text')){$(elem).html($(elem).data('html'));$(elem).removeClass('modified-text')}$('.context-popup').each(function(i,popup){self.hideContextMenu($(popup).find('.cancel-popup'),elem,true)});if($(elem).data('old_img')){if($(elem).attr('data-slide-item')){var item=$(elem).attr('data-slide-item');var $mini_pic=$row.find('[data-slide-item="'+item+'"]').not($(elem));if($mini_pic.length&&$mini_pic.data('old_img')){$mini_pic.replaceWith($mini_pic.data('old_img'))}}$(elem).replaceWith($(elem).data('old_img'))}if($(elem).attr('data-cleaned_css')){var selector=self.getSelector(elem,block_id);var cleaned_data=$(elem).data('cleaned_params');var custom_styles_url='/t/css/__landing_page_'+self.variant_id+'.css';var $custom_styles=$('link[href^="'+custom_styles_url+'"]');self.css_params[block_id][selector]=JSON.parse(cleaned_data);if($custom_styles.length){for(var i in $custom_styles[0].sheet.rules){var rules=$custom_styles[0].sheet.rules[i];if(rules&&rules.selectorText){var full_selector='#_lp_block_'+block_id+'[data-block-layout="'+layout_id+'"] '+$(elem).attr('data-lp-selector');if(rules.selectorText.trim()===full_selector.trim()){rules.style.cssText=$(elem).attr('data-cleaned_css');break}}}}$(elem).removeAttr('data-cleaned_css').removeData('cleaned_params')}$(elem).removeAttr('data-old-href');$(elem).removeData('media');$(elem).removeData('old_img');self.reInitCssObject(block_id);$(elem).removeAttr('data-rate')});$('[data-thumb-path]').each(function(i,e){var $img=$(e).find('img');$img.attr('src',$(e).attr('data-thumb-path'));$(e).removeAttr('data-thumb-path')});self.unSelectElement($('body'))},getImageElem:function($elem){var self=this;var $element=$elem?$elem:$(self.selected_element);if($element.find('img').length){$element=$element.find('img')}else if($element.find('svg').length){$element=$element.find('svg')}return $element},hideContextMenu:function(control,elem,not_reinit){var self=this;var $popup=$(control).parents('.context-menu');var element=elem?elem:self.selected_element;var selector=self.getSelector(element,$(element).parents('.lp-row'));var elements=selector?$(selector):null;var css_obj={};if(!elements){elements=$(element)}if($popup.data('type')==='indents'||$popup.data('type')==='block_indents'){elements.each(function(i,e){e.style.padding='';e.style.margin='';e.style.marginLeft='';e.style.marginTop='';e.style.marginBottom='';e.style.marginRight='';e.style.paddingLeft='';e.style.paddingTop='';e.style.paddingBottom='';e.style.paddingRight=''})}else if($popup.data('type')==='background'){var $bg_wrap=$(element).find('.bg-wrap');elements.each(function(i,e){e.style.background='';e.style.backgroundColor='';e.style.backgroundImage=''});if($bg_wrap.length){self.cleanSelectionElement($bg_wrap[0])}}else if($popup.data('type')==='block_background'||$popup.data('type')==='block_background_item'||$popup.data('type')==='video'){const class_elem=$popup.data('type')==='block_background_item'?'.lp-block-bg_item':'.lp-block-bg';const class_overlay_elem=$popup.data('type')==='block_background_item'?'.lp-block-overlay_item':'.lp-block-overlay';var image_elem=$(element).find(class_elem).length?$(element).find(class_elem):$(element);var overlay_elem=$(element).find(class_overlay_elem).length?$(element).find(class_overlay_elem):$(element);var default_attrs='';if($popup.data('type')==='block_background'||$popup.data('type')==='block_background_item'){image_elem[0].style.backgroundImage='';image_elem[0].style.backgroundAttachment='';image_elem[0].style.backgroundRepeat='';image_elem[0].style.backgroundPosition='';overlay_elem[0].style.backgroundColor='';overlay_elem[0].style.backgroundImage='';default_attrs+="playsinline=1"}var custom_video=$(element).data('custom_video');var youtube_video=$(element).data('youtube_video');var $video_wrapper=$(element).is('._lp-video')?$(element):$(element).find('._lp-video');if(custom_video||youtube_video){$video_wrapper.html(custom_video?$(custom_video):$(youtube_video))}}else if($popup.data('type')==='border'&&element.style.border!=="none"){var border=self.getElemCssProp('border',null,null,null,null,selector);var border_radius=self.getElemCssProp('border_radius');css_obj=self.convertCssValue({'border':border,'border-radius':border_radius});elements.each(function(i,e){e.style.borderRadius='';e.style.borderTopLeftRadius='';e.style.borderBottomLeftRadius='';e.style.borderTopRightRadius='';e.style.borderBottomRightRadius='';e.style.borderStyle='';e.style.borderWidth='';e.style.borderColor='';e.style.border=''})}else if($popup.data('type')==='box_shadow'&&element.style.boxShadow!=="none"){var box_shadow=self.getElemCssProp('box_shadow',null,null,null,null,selector);css_obj=self.convertCssValue({'box-shadow':box_shadow});elements.each(function(i,e){e.style.boxShadow=''})}else if($popup.data('type')==='size'){elements.each(function(i,e){e.style.width='';e.style.height='';$(e).find('img').removeAttr('style')})}else if($popup.data('type')==='tag'&&$(element).attr('data-old-tag')){var old_tag=$(element).attr('data-old-tag');self.updateElemTag(old_tag)}else if($popup.data('type')==='text'){if(self.hasSelection()){var elem=self.getSelectionElement();if(elem){self.cleanSelectionElement(elem)}}else{elements.each(function(i,e){e.style.color='';e.style.fontSize='';e.style.lineHeight='';e.style.textDecoration='';e.style.fontFamily='';e.style.fontStyle='';e.style.fontWeight='';e.style.textAlign='';e.style.textAlignLast='';e.style.textFamily=''})}}else if($popup.data('type')==='link'){$(element).find('.link-wrap').each(function(i,e){var elem=e;if(elem.tagName.toLowerCase()==='a'&&e.style.length){self.replaceTag(elem,'span')}else if(!e.style.length){$(e).replaceWith($(e).html())}$(elem).removeClass('link-wrap')})}else if($popup.data('type')==='animate'){var old_animate=$(element).find('[data-s3-animator]').attr('data-old-s3-animator');$(self.selected_element).find('[data-s3-animator]').attr('data-s3-animator',old_animate);$(self.selected_element).removeAttr('data-old-s3-animator')}if(!$.isEmptyObject(css_obj)){$(element).css(css_obj)}if(!element.style.length&&!$(element).hasClass('modified-link')&&!$(element).hasClass('modified-text')){if($(element).is('svg')){$(element).attr('class',$(element).attr('class').replace("modified",""))}else{$(element).removeClass('modified')}}$(element).removeAttr('data-rate');if(!not_reinit){var block_id=$(element).parents('.lp-row').attr('data-block-id');self.reInitCssObject(block_id)}$('.colorpicker-visible').find('.cp-close').click();S3ContextMenuController.closeContextMenu()},cleanSelectionElement:function(elem){var props=$(elem).attr('data-props')?$(elem).attr('data-props'):'';var props_arr=props.split(",");props_arr.forEach(function(prop){elem.style[prop]=''});$(elem).removeAttr('data-props');if($(elem).is('.lp-fragment-elem')&&!elem.style.length){$(elem).replaceWith($(elem).html())}},hidePicker:function($el){var self=this;var $cur=$('.current-picker');var elem=$(self.selected_element).length?$(self.selected_element):$('.color-editable-element');$el.closest('.colorpicker').find('.cp-close').click();if(elem.length){if($cur.data('type')=='color'){elem[0].style.color=''}else if($cur.data('type')=='background'){elem[0].style.backgroundColor=''}else if($cur.data('type')=='border'){elem[0].style.border='';elem[0].style.borderColor='';elem[0].style.borderWidth='';elem[0].style.borderRadius=''}else if($cur.data('type')=='box_shadow'){elem[0].style.boxShadow=''}if(elem.is('svg')){elem.attr('class',elem.attr('class').replace("modified",""))}else{elem.removeClass('modified')}}},setColorToElement:function($btn,$parent,element_class){if(!($parent instanceof jQuery)){$parent=$($parent)}var self=this;var $picker=$btn.closest('.colorpicker');var color=$picker.find('.colorpicker-color .color-preview').css('background-color');if($parent.find('.current-picker').hasClass('colorpicker-color-component')){$parent.find(element_class).css('color',color);if($('.color-editable-element').length&&$('.color-editable-element').parents('.control-line.active').find('.hover-params').length&&$('.color-editable-element').parents('.control-line.active').find('.active-params').length){$parent.find('.control-line.active .hover-params .font-control .colorpicker-color-component').colorpicker('setValue',tinycolor(color).brighten(8).toString());$parent.find('.control-line.active .active-params .font-control .colorpicker-color-component').colorpicker('setValue',tinycolor(color).darken(8).toString())}}else if($parent.find('.current-picker').hasClass('colorpicker-bg-component')){$parent.find(element_class).css('background-color',color);if($('.color-editable-element').length&&$('.color-editable-element').parents('.control-line.active').find('.hover-params').length&&$('.color-editable-element').parents('.control-line.active').find('.active-params').length){$parent.find('.control-line.active .hover-params .background-control .colorpicker-bg-component').colorpicker('setValue',tinycolor(color).brighten(8).toString());$parent.find('.control-line.active .active-params .background-control .colorpicker-bg-component').colorpicker('setValue',tinycolor(color).darken(8).toString())}}else if($parent.find('.current-picker').hasClass('colorpicker-grad_start-component')||$parent.find('.current-picker').hasClass('colorpicker-grad_end-component')){var row=$parent.find('.current-picker').parents('.gradient-color');var start_color=row.find('.colorpicker-grad_start-component input').val();var end_color=row.find('.colorpicker-grad_end-component input').val();var direction=row.find('.gradient-direction input').val();$parent.find(element_class).css('background',self.getGradient(direction,start_color,end_color));if($('.color-editable-element').length&&$('.color-editable-element').parents('.control-line.active').find('.hover-params').length&&$('.color-editable-element').parents('.control-line.active').find('.active-params').length){$parent.find('.control-line.active .hover-params .background-control .colorpicker-grad_start-component').colorpicker('setValue',tinycolor(start_color).brighten(8).toString());$parent.find('.control-line.active .hover-params .background-control .colorpicker-grad_end-component').colorpicker('setValue',tinycolor(end_color).brighten(8).toString());$parent.find('.control-line.active .active-params .background-control .colorpicker-grad_start-component').colorpicker('setValue',tinycolor(start_color).darken(8).toString());$parent.find('.control-line.active .active-params .background-control .colorpicker-grad_end-component').colorpicker('setValue',tinycolor(end_color).darken(8).toString())}}else if($parent.find('.current-picker').hasClass('colorpicker-border-component')){if($picker.find('.range-value').length){$parent.find(element_class).css('border-width',$picker.find('.range-value').val())}var bdts=$parent.find(element_class).css('border-top-style');var bdls=$parent.find(element_class).css('border-left-style');var bdrs=$parent.find(element_class).css('border-right-style');var bdbs=$parent.find(element_class).css('border-bottom-style');if(bdts===bdls&&bdls===bdrs&&bdrs===bdbs){$parent.find(element_class).css('border-style','solid')}else{if(bdts!="none"){$parent.find(element_class).css('border-top-style','solid')}if(bdls!="none"){$parent.find(element_class).css('border-left-style','solid')}if(bdrs!="none"){$parent.find(element_class).css('border-right-style','solid')}if(bdbs!="none"){$parent.find(element_class).css('border-bottom-style','solid')}}$parent.find(element_class).css('border-color',color);if($('.color-editable-element').length&&$('.color-editable-element').parents('.control-line.active').find('.hover-params').length&&$('.color-editable-element').parents('.control-line.active').find('.active-params').length){$parent.find('.control-line.active .hover-params .border-control .colorpicker-border-component').colorpicker('setValue',tinycolor(color).brighten(8).toString());$parent.find('.control-line.active .active-params .border-control .colorpicker-border-component').colorpicker('setValue',tinycolor(color).darken(8).toString())}}else if($parent.find('.current-picker').hasClass('colorpicker-shadow-component')){var $shadow_control=$parent.find('.shadow-control');var shadow_color=$shadow_control.find('.color-value').val();var x=$shadow_control.find('.range-value').eq(0).val();var y=$shadow_control.find('.range-value').eq(1).val();var blur=$shadow_control.find('.range-value').eq(2).val();var spray=$shadow_control.find('.range-value').eq(3).val();var val=x+'px '+y+'px '+blur+'px '+spray+'px '+shadow_color;$parent.find(element_class).css('box-shadow',val);if($('.color-editable-element').length&&$('.color-editable-element').parents('.control-line.active').find('.hover-params').length&&$('.color-editable-element').parents('.control-line.active').find('.active-params').length){$parent.find('.control-line.active .hover-params .shadow-control .colorpicker-shadow-component').colorpicker('setValue',tinycolor(shadow_color).brighten(8).toString());$parent.find('.control-line.active .active-params .shadow-control .colorpicker-shadow-component').colorpicker('setValue',tinycolor(shadow_color).darken(8).toString())}}if($parent.find('.current-picker').parents('.s3-btn')){var brightness=self.getColorBrightness(color).brightness;$parent.find('.current-picker').parents('.s3-btn').removeClass('dark light').addClass(brightness).css('background-color',color)}$btn.closest('.colorpicker').find('.cp-close').click()},orientBlockControls:function(block,scroll_add){var block_top_pos=block.offset().top,block_bot_pos=block_top_pos+block.height(),block_controls=block.find('.site-controls'),add_button=block.parent().find('.lp-row-add-wrap').not('.last'),add_button2=block.parent().find('.lp-row-add-wrap.last'),panel_height=$('#landing_page_controls').outerHeight(),win_scroll=$(window).scrollTop();if(block_top_pos-scroll_add-72<win_scroll&&block_bot_pos>win_scroll){block_controls.css('top',win_scroll-block_top_pos+scroll_add+panel_height);add_button.css('top',win_scroll-block_top_pos+scroll_add+panel_height-20)}else{block_controls.css('top',0);add_button.css('top','-20px');add_button2.css('bottom','-20px')}},foldersToggle:function(event,elem){var self=this;const $row=$(elem).parents('.lp-row');if($(elem).is('.last')){self.add_after_id=$row.attr('data-block-id')}else{self.add_before_id=$row.attr('data-block-id')}const $variant_block_id=$row.attr(`data-variant-block-id`);if($variant_block_id){self.add_data_variant_block_id=$variant_block_id}S3ContextMenuController.closeContextMenu();self.closeColorpicker();event.stopPropagation();if($(self.folders_menu_wrapper).hasClass('hidden')){self.showBlockSelector();if(self.preset_id===706&&!$(self.folder_preset_list).length){const $folder=self.block_call_buttons.filter(function(){const folder_id=$(this).data('folder-id');return folder_id>0&&folder_id!=self.root_folder_id}).first();if($folder.length){self.blockSelectorCall(event,$folder,$folder.data('folder-id'),$folder.text())}}}else{self.closeBlockSelector()}},foldersShow:function(){var self=this;$(self.folders_menu_wrapper).removeClass('hidden');$(self.previews_container).removeClass('hidden');var folders_height=$(self.folders_menu).height();$('#landing_page_controls').css('z-index',126);$('.lp-folders-wrapper').on('scroll',function(){if($(this).scrollTop()+$(self.folders_menu_wrapper).height()-20==folders_height){$(this).addClass('_bounced__bottom');setTimeout(function(){$(this).removeClass('_bounced__bottom')},1000)}else if($(this).scrollTop()==0){$(this).addClass('_bounced__top');setTimeout(function(){$(this).removeClass('_bounced__top')},1000)}});self.hideHtmlScroll()},foldersHide:function(){var self=this;$(self.folders_menu_wrapper).addClass('hidden').find(self.block_call_buttons).each(function(){$(this).removeAttr('data-insert-position').removeAttr('data-target-block')});$(self.previews_container).addClass('hidden');$('#landing_page_controls').css('z-index',105);self.showHtmlScroll()},switchToFolders:function(){var self=this;$(self.folders_menu_wrapper).removeClass('hidden');self.blockSelectorHide()},showBlockSelector:function(){var self=this;self.foldersShow();self.toggleOverlay('show')},closeBlockSelector:function(){var self=this;self.blockSelectorHide();self.foldersHide();self.closePopupForm();self.toggleOverlay('hide')},onLoadIframeLPC:function($this){if($this.contents().find('#onicon').length>0){$this.contents().find('#onicon').remove()}else{$this.contents()[0].addEventListener('onLoadOnicon',info=>{$this.contents().find('#onicon').remove()})}const $cookieMsg=$this.contents().find('#s3-cookie-message');if($cookieMsg.length>0){$cookieMsg.remove()}LpController.setLpcParams(null,function(){LpController.convertImages($('body'))},true);$this.contents().find('.lpc-content-wrapper *').css('visibility','hidden');$(window).on('scroll',function(){var top=$(window).scrollTop();$this.contents().scrollTop(top)})},openModalMosaic:function(action){s3.openModalPopup('/-/cms/v1/lp/mosaic/?act=view&'+S3_ACCESS+'&action='+action)},openWidgetParamsMosaic:function(){const self=this;const widget_id=$(self.selected_element).closest('[data-widget-id]').data('widget-id');const $parent=$(self.selected_element).closest('.lp-row');const library_id=$parent.data('library-id');const layout_id=$parent.data('block-layout-id');const url='/-/cms/v1/lp/mosaic/?act=widget_params&';s3.openModalPopup(url+S3_ACCESS+'&widget_id='+widget_id+'&preset_id='+self.preset_id+'&library_id='+library_id+'&layout_id='+layout_id)},showWidgetParamsMosaic:function(){Preloader.hide();$('.bluepopup-wrapper').css('visibility','visible')},saveWidgetParamsMosaic:function(close){const self=this;self.sendMessageToMosaic('SaveWidgetParamsZeroBlock',{close:close,},'.mosaic-iframe-widget-params')},submitOrderMosaicBlock:function(form){const url='/-/cms/v1/lp/mosaic/?act=order_block&'+S3_ACCESS;popupController.closeLastPopup();s3.openModalPopup(url,false,form.serialize())},submitModalMosaic:function(action){var self=this;switch(action){case'close':self.closeIframeMosaic();break;case'save':self.saveBlockMosaic();break;case'edit':self.updateTitleIframeMosaic();self.renderNameIframeMosaic();break}popupController.closeLastPopup();return false},publishBlockMosaic:function(){const self=this;self.sendMessageToMosaic(self.event_publish_lp_template,{})},saveBlockMosaic:function(){const self=this;self.sendMessageToMosaic(self.event_save_lp_template,{})},sendMessageToMosaic:function(eventName,dataObject,iframe_selector){const self=this;const selector=iframe_selector?iframe_selector:self.mosaic_iframe;const $iframeMosaic=$(selector)[0];if($iframeMosaic&&$iframeMosaic.contentWindow){s3.sendMessageToWindow(eventName,dataObject,$iframeMosaic.contentWindow)}else{s3.alert(s3.loc('JS_ZERO_BLOCK_NO_IFRAME'))}},initIframeMosaic:function(){var self=this,$mosaicIframeWrap=$(self.mosaic_iframe_wrap),$mosaicIframe=$(self.mosaic_iframe);self.mosaic_iframe_name_block='#mosaic-iframe-panel-name-block';self.mosaic_iframe_input_title='#mosaic-iframe-title';self.mosaic_iframe_input_description='#mosaic-iframe-description';self.event_save_lp_template='SaveZeroBlock';self.event_publish_lp_template='PublishZeroBlock';self.event_update_title_lp_template='UpdateTitleZeroBlock';self.event_close_iframe_mosaic='CloseZeroBlock';self.event_update_layout_iframe_mosaic='UpdateLayout';$mosaicIframe.on('load',function loadIframeMosaic(){Preloader.hide();if($mosaicIframe.attr('src')!==''){$mosaicIframeWrap.removeClass('hidden');self.sendMessageToMosaic(self.event_update_title_lp_template,self.mosaic_iframe_data);self.renderNameIframeMosaic()}});window.addEventListener(self.event_update_layout_iframe_mosaic,function onCloseIframeMosaic(event){const data=event.detail;const layout_id=parseInt(data.layout_id,10);const close=Boolean(data.close);if(data.status==='success'&&layout_id){const $block=$(self.site_wrapper).find('.lp-row[data-block-layout-id="'+layout_id+'"]');$block.each(function(){const block_id=$(this).attr('data-block-id');self.switchLayout(block_id,layout_id)})}else{s3.alert(s3.loc('JS_ZERO_BLOCK_SAVE_ERROR'))}if(close){popupController.closeLastPopup()}});window.addEventListener(self.event_publish_lp_template,function onCloseIframeMosaic(event){const data=event.detail;const layout_id=parseInt(data.layout_id,10);const folder_id=parseInt(data.folder_id,10);const preview=data.preview;Preloader.show();if(data.status==='success'&&layout_id){if(data.update&&!data.isTemplate){const $block=$(self.site_wrapper).find('.lp-row[data-block-layout-id="'+layout_id+'"]');$block.each(function(){const block_id=$(this).attr('data-block-id');self.switchLayout(block_id,layout_id)});Preloader.hide();util.msg(s3.loc('JS_DONE'))}else{const preview_images={};preview_images[self.lang_code]=preview;self.saveLayoutPreview(preview_images,layout_id,true);self.flickeringBlockID=layout_id;self.folderIdRequiringUpdating=folder_id}}else{Preloader.hide();s3.alert(s3.loc('JS_ZERO_BLOCK_SAVE_ERROR'))}});window.addEventListener(self.event_save_lp_template,function(event){const data=event.detail;const library_id=parseInt(data.library_id,10);if(data.status==='success'&&library_id){util.msg(s3.loc('JS_DONE'))}else{s3.alert(s3.loc('JS_ZERO_BLOCK_SAVE_ERROR'))}});self.setTitleIframeMosaic(self.zb_field_name,self.zb_field_description)},updatePreviewsFolderMosaic:function(){var self=LpController;var folder_id=self.folderIdRequiringUpdating||self.currentOpenFolder;if(folder_id){self.updateBlockList(folder_id,function(){var $buttonFolder=$(self.folders_menu).find('li span[data-folder-id="'+folder_id+'"]');$buttonFolder.click();Preloader.hide()})}},editGlobalTemplateMosaic:function(btn){var self=this;var parent=btn.parents('.sample-block-item');var layout_id=parent.find('input[name="layout_id"]').val();var layout_name=parent.find('input[name="name"]').val();var library_id=parent.attr('data-library-id');var folder_id=parent.attr('data-folder-id');self.openIframeMosaic(folder_id,library_id,layout_id,layout_name)},openIframeMosaic:function(folder_id,library_id,layout_id,block_name,parent_id){var self=this,url=self.mosaic_iframe_url+'&preset_id='+self.preset_id,$mosaicIframe=$(self.mosaic_iframe);if(!self.new_presets.includes(self.preset_id)){return}const openIframe=function(url){Preloader.show();$('body, html').addClass('overflow-hidden');$mosaicIframe.attr('src',url)};if(!folder_id){folder_id=self.currentOpenFolder}url=url+'&folder_id='+folder_id;if(!self.can_edit_lp_mosaic&&!self.can_edit_lp_mosaic_global){s3.alert(s3.loc('JS_ZERO_BLOCK_EDIT_ACCESS_ERROR'));return false}if(library_id&&layout_id&&block_name){url=url+'&library_id='+library_id+'&layout_id='+layout_id;self.setTitleIframeMosaic(block_name,'');if(parent_id){url=url+'&parent_id='+parent_id}}if(folder_id&&folder_id!==self.root_folder_id&&!parent_id){url=url+'&global_tpl=1'}if(self.is_platform_site){url=url+'&platform=1'}if(layout_id&&library_id){const message=s3.loc(!parent_id?'JS_ZERO_BLOCK_EDIT_GLOBAL_TEMPLATE':'JS_ZERO_BLOCK_EDIT_LOCAL_TEMPLATE');s3.confirm(message,function(){popupController.closeLastPopup();openIframe(url)})}else{openIframe(url)}document.getElementById('lp-mosaic-save').setAttribute('onclick',`LpController.saveBlockMosaic();`);document.getElementById('lp-mosaic-publish').setAttribute('onclick',`LpController.publishBlockMosaic();`);if(!layout_id){document.getElementById('lp-mosaic-save').style.display=`none`}else{document.getElementById('lp-mosaic-save').style.display=`flex`}},closeIframeMosaic:function(){var self=this,$mosaicIframeWrap=$(self.mosaic_iframe_wrap),$mosaicIframe=$(self.mosaic_iframe);$('body, html').removeClass('overflow-hidden');$mosaicIframeWrap.addClass('hidden');$mosaicIframe.attr('src','');self.setTitleIframeMosaic(self.zb_field_name,self.zb_field_description)},closeColorpicker:function(){$('.colorpicker-visible').find('.cp-close').click()},setTitleIframeMosaic:function(title,description){var self=this;self.mosaic_iframe_data={title:title,description:description,}},renderTitleIframeMosaic:function(){var self=this,data=self.mosaic_iframe_data,$mosaicTitle=$(self.mosaic_iframe_input_title),$mosaicDescription=$(self.mosaic_iframe_input_description);$mosaicTitle.val(data.title);$mosaicDescription.val(data.description)},renderNameIframeMosaic:function(){var self=this,data=self.mosaic_iframe_data,$mosaicName=$(self.mosaic_iframe_name_block);$mosaicName.text(data.title)},updateTitleIframeMosaic:function(){var self=this,title=$(self.mosaic_iframe_input_title).val(),description=$(self.mosaic_iframe_input_description).val();self.setTitleIframeMosaic(title,description);self.sendMessageToMosaic(self.event_update_title_lp_template,self.mosaic_iframe_data)},copyListItemMosaic:function(){const self=this;const $select=$(self.selected_element);const $data_path_element=$select.closest('[data-list-path]');const slickIndex=$data_path_element.attr('data-slick-index');const index=slickIndex?slickIndex:$data_path_element.index();const data_path=$data_path_element.attr('data-list-path')+'.'+index;const $row=$select.closest('.lp-row[data-block-id]');const block_id=$row.attr('data-block-id');const layout_id=$row.attr('data-block-layout-id');const url='/-/cms/v1/json/?act=copy_item&'+S3_ACCESS+'&block_id='+block_id+'&data_path='+data_path;$.ajax({url:url,type:'POST',success:function(){self.switchLayout(block_id,layout_id)},error:function(e){console.log(e)}})},deleteListItemMosaic:function(){const self=this;const $select=$(self.selected_element);const $data_path_element=$select.closest('[data-list-path]');const slickIndex=$data_path_element.attr('data-slick-index');const index=slickIndex?slickIndex:$data_path_element.index();const data_path=$data_path_element.attr('data-list-path')+'.'+index;const $row=$select.closest('.lp-row[data-block-id]');const block_id=$row.attr('data-block-id');const layout_id=$row.attr('data-block-layout-id');const url='/-/cms/v1/json/?act=delete_item&'+S3_ACCESS+'&block_id='+block_id+'&data_path='+data_path;$.ajax({url:url,type:'POST',success:function(){self.switchLayout(block_id,layout_id)},error:function(e){console.log(e)}})},updateBlockList:function(folder_id,callback){var self=this,folder_id=parseInt(folder_id),rnd=new Date().getTime(),url='/-/cms/v1/lp/block/?act=get_preview_by_folder&'+S3_ACCESS+'&rnd='+rnd,lp_preset_id=$(self.lp_preset).val()?parseInt($(self.lp_preset).val()):0;if(folder_id){$.ajax({url:url,type:'POST',data:{'lp_id':self.lp_id,'variant_id':self.variant_id,'folder_id':folder_id,'preset_id':lp_preset_id,'root_folder_id':self.root_folder_id,},dataType:'html',success:function(data){var $newSampleGroup=$(data);var layout_id=self.flickeringBlockID;var $item=$newSampleGroup.find('#add_block_'+layout_id);self.flickeringBlockID=null;self.folderIdRequiringUpdating=null;$(self.sample_list).find('.folder-preset-list[data-folder-id="'+folder_id+'"]').remove();$(self.sample_list).append($newSampleGroup);$item.addClass('green-backlight');$item.hover(function(){$item.removeClass('green-backlight')});if(callback&&typeof callback==='function'){callback()}},error:function(e){console.log(e)}})}},blockSelectorCall:function(event,elem,folder_id,folder_name){var self=this,folder_id=parseInt(folder_id,10),rnd=new Date().getTime(),url='/-/cms/v1/lp/block/?act=get_preview_by_folder&'+S3_ACCESS+'&rnd='+rnd,lp_preset_id=$(self.lp_preset).val()?parseInt($(self.lp_preset).val()):0,folder_preset_list=$(self.samples_wrapper).find(self.folder_preset_list+'[data-preset-id="'+lp_preset_id+'"][data-folder-id="'+folder_id+'"]');$(self.samples_wrapper).removeClass('hidden');self.currentOpenFolder=folder_id;if(folder_name&&folder_name!=""){$(self.samples_wrapper).find('#folder_name').text(folder_name)}const isThrough=elem.attr('data-is-through')||0;if(folder_id||isThrough){const $samplesWrapper=$(self.samples_wrapper).find('.sample-block-new__wrapper');$(self.samples_wrapper).find(self.folder_preset_list).addClass('hidden').removeAttr('style');if(folder_id===self.root_folder_id&&(self.can_edit_lp_mosaic||self.can_edit_lp_mosaic_global)){$samplesWrapper.removeClass('hidden')}else{$samplesWrapper.addClass('hidden')}if(folder_preset_list.size()){folder_preset_list.removeClass('hidden').animate({'opacity':1},300);self.blockSelectorShow(elem)}else{$.ajax({url:url,type:'POST',data:{'lp_id':self.lp_id,'variant_id':self.variant_id,'folder_id':folder_id,'preset_id':lp_preset_id,'root_folder_id':self.root_folder_id,'is_through':isThrough,},dataType:'html',success:function(data){var new_sample_group=$(data);$(self.sample_list).append(new_sample_group);new_sample_group.animate({'opacity':1},300);var samles_height=new_sample_group.height();$(self.folder_preset_list).on('scroll',function(){if($(this).scrollTop()+$('.sample-block-wrapper').height()-22>=samles_height){$(self.folder_preset_list).find('.sample-block-item').addClass('_bounced__bottom');setTimeout(function(){$(self.folder_preset_list).find('.sample-block-item').removeClass('_bounced__bottom')},1000)}else if($(this).scrollTop()==0){$(self.folder_preset_list).find('.sample-block-item').addClass('_bounced__top');setTimeout(function(){$(self.folder_preset_list).find('.sample-block-item').removeClass('_bounced__top')},1000)}});self.blockSelectorShow(elem)},error:function(e){console.log(e)}})}}if(elem.attr('data-insert-position')&&elem.attr('data-target-block')){var insert_position=elem.attr('data-insert-position'),target_block_id=elem.attr('data-target-block');$(self.samples_wrapper).find('form[id^="add_block_"]').each(function(){$(this).removeAttr('data-insert-before').removeAttr('data-insert-after').attr('data-insert-'+insert_position,target_block_id)})}event.stopPropagation();return false},blockSelectorShow:function(elem){var self=this,folder_id=parseInt(elem.attr('data-folder-id')),position=elem.attr('data-insert-position'),block_id=elem.attr('data-target-block');if(elem.parent('li').hasClass('active')){return}if(position&&block_id){$(self.sample_item).each(function(){$(this).removeAttr('data-insert-before').removeAttr('data-insert-after').attr('data-insert-'+position,block_id)})}elem.parent('li').addClass('active').siblings().removeClass('active')},hideHtmlScroll:function(){var width=$('body').width();$('html').css('overflow','visible');$('body').css('overflow','hidden');var scrollWidth=$('body').width()-width;$('body').css('margin-right',scrollWidth+'px')},showHtmlScroll:function(){$('html, body').css('overflow','');$('body').css('margin-right',0)},blockSelectorHide:function(){var self=this;$(self.samples_wrapper).find('form[id^="add_block_"]').each(function(){$(this).removeAttr('data-insert-before').removeAttr('data-insert-after')});$(self.folder_preset_list).off('scroll')},insertBlock:function(event,block_id,position){var self=this,block_id=parseInt(block_id),folder_id,folder_name;if(!block_id){return false}if(position!="before"&&position!="after"){position="after"}self.foldersToggle(event);self.block_call_buttons.each(function(){folder_id=parseInt($(this).attr('data-folder-id'));folder_name=$(this).attr('data-folder-name');$(this).attr('data-insert-position',position).attr('data-target-block',block_id)})},updateBlockHtml:function(block_id,layout_id,force_update){if(!block_id||!layout_id){return false}var self=this,rnd=new Date().getTime(),url='/-/cms/v1/lp/block/?act=check_modified&'+S3_ACCESS+'&rnd='+rnd,block_id=parseInt(block_id),block_row=$(self.site_wrapper).find('.lp-row[data-block-id="'+block_id+'"]'),block_modified=block_row.attr('data-modified'),block_data_modified=block_row.attr('data-data-modified'),block_anchor=block_row.attr('data-anchor-link'),json_id=block_row.attr('data-json-id');if(force_update){self.switchLayout(block_id,layout_id,true);return true}$.ajax({url:url,type:'POST',data:{"block_id":block_id,"variant_id":self.variant_id,"block_modified":block_modified,"block_data_modified":block_data_modified,"json_id":json_id},dataType:'json',async:false,success:function(modified){if(modified){if(modified.block||modified.block_data||force_update){self.switchLayout(block_id,layout_id,true)}if(modified.block){block_row.attr('data-modified',modified.block)}if(modified.block_data){block_row.attr('data-data-modified',modified.block_data)}}},error:function(e){console.log(e)}})},addBlockMosaic:function($elem,layout_id,event){var self=this;var form=$elem.parents('form#add_block_'+layout_id).clone();if(form.length>0){self.createLocalCopy(layout_id,function(id){form.attr('id','add_block_'+id);form.find('input[name="layout_id"]').val(id);if(event.ctrlKey){form.attr('data-multiple-add',true)}form.submit()})}else{console.error('Форма не найдена')}},addBlock:function(elem,layout_id,event){if(!elem||!layout_id||!event){return false}var layout_id=parseInt(layout_id),form=$(elem).parents('form#add_block_'+layout_id);if(event.ctrlKey){form.attr('data-multiple-add',true)}form.submit()},editBLock:function(form){if(!form){return false}var self=this,$form=$(form),data=$form.serializeArray(),block_id=$form.find('input[name="object_id"]').val(),library_id=$form.find('input[name="layout_id"]').val(),block=$(self.site_wrapper).find('[id="_lp_block_'+block_id+'"]'),block_layout_id=$form.find('input[name="layout_id"]').val(),multiple_add=$form.attr('data-multiple-add'),lp_styles=$(document).find('#styles_lp_'+self.lp_id),lp_styles_url=lp_styles.attr('href'),rnd='?rnd'+new Date().getTime(),position=$form.find('input[name="position"]').val(),new_id,new_block,new_block_json_id,new_row,result,custom_css,lp_preset_id;if(self.add_after_id){$form.attr('data-insert-after',self.add_after_id);self.add_after_id=0}else if(self.add_before_id){$form.attr('data-insert-before',self.add_before_id);self.add_before_id=0}if(self.add_data_variant_block_id){$form.attr('data-variant-block-id',self.add_data_variant_block_id);self.add_data_variant_block_id=0}if(block_id){$('.lp-row[data-block-id='+block_id+']').each(function(){let selector='.lp-row[data-block-id='+block_id+']';const variantBlockId=$(this).attr(`data-variant-block-id`);if(variantBlockId){selector+=`[data-variant-block-id="${variantBlockId}"]`}Preloader.show({hideClass:'s3-preloader-hide',to:selector,local:true})})}if($(form).attr('data-main-params')){$.ajax({url:location.href+' #_lp_block_'+block_id,dataType:'html',success:function(data){result=$('<div>').html(data);new_row=$(result).find(self.site_wrapper).find('.lp-row[data-block-id="'+block_id+'"]');new_block=$(result).find(self.site_wrapper).find('#_lp_block_'+block_id).first();new_block_json_id=new_row.attr('data-json-id');custom_css=new_block.parent('.lp-row').attr('data-has-css');new_block.attr('data-block-layout',block_layout_id);var replace_id=parseInt($(form).attr('data-switch-theme')),replace_row=block.parent('.lp-row'),old_height=block.first().height(),animate_time=400,new_height;result.find('link').toArray().forEach((link)=>{const href=link.attributes.href.nodeValue;if(href&&typeof href==='string'&&!href.match(/^\/t\//g)){return null}util.loadCss(href)});if(replace_row){replace_row.height(old_height).addClass('clipped');new_block.addClass('replacer');var script_class,script_value;new_block.find('script').each(function(){script_class='block_script_'+new Date().getTime();$(this).addClass(script_class);script_value=$(this).text().replace('document.write','$(".'+script_class+'").after');$(this).text(script_value)});block.fadeOut(300);block.addClass('replacing').css('margin-bottom',old_height*-1);setTimeout(function(){if(new_height>500){animate_time=1000}const promises=[];block.each(function(){const dfd=$.Deferred();promises.push(dfd);const $this=$(this),$row=$this.parent(`.lp-row`),$form=$row.find(`form[data-block-id="${block_id}"]`);self.deleteBlock($this,position,'fadeout',true,()=>{const $new_block_in_document=new_block.clone(true);$form.after($new_block_in_document);new_height=$new_block_in_document.height();lp_styles.attr('href',lp_styles_url+rnd);setTimeout(function(){$row.animate({'height':new_height},animate_time,function(){$row.height('auto').removeClass('clipped');$new_block_in_document.fadeIn(400,function(){$new_block_in_document.removeClass('replacer').append(self.site_controls);self.initPicker(new_block)});$row.append(self.add_button);self.convertImages($new_block_in_document);setTimeout(function(){self.convertImages($new_block_in_document)},500);$(form).removeAttr('data-main-params');$(form).find('input[name="object_id"]').val('');if(!custom_css){$new_block_in_document.find('.site-controls .edit-layout-css').remove()}for(let i=0;i<block.length;i++){Preloader.hide()}$(self.site_wrapper).find('[id^="_lp_block_"]').each(function(index){$(this).attr('data-block-index',index)});dfd.resolve()})},200)})});$.when.apply($,promises).done(function(){$.ajax({url:'/-/cms/v1/lp/block/?act=get_block_data&'+S3_ACCESS,type:'POST',data:{"block_id":block_id,"json_id":new_block_json_id,"ver_id":VER_ID},dataType:'json',success:function(result){if(result){if(!self.lp_blocks.hasOwnProperty(block_id)){self.lp_blocks[block_id]={}}self.lp_blocks[block_id]['data']=result['data'];self.lp_blocks[block_id]['data_json']=result['data_json']}if(library_id){setTimeout(function(){window.__do__restart__bind()},400)}const $blocks=$(self.site_wrapper).find(`[id='_lp_block_${block_id}']`);$blocks.each(function(){self.setControlsContext($(this),block_id,new_block_json_id)});try{self.blockScriptReinit($blocks)}catch(e){console.warn('Error while update block scripts',e)}},error:function(e){console.log('Error',e)}})})},200)}if(multiple_add!='true'){self.blockSelectorHide()}},error:function(e){console.log(e)}})}else{Preloader.show();self.foldersHide();$.ajax({url:$(form).attr('action'),data:data,type:$(form).attr('method'),dataType:'html',success:function(data){if(data.match(/^error:/)){var error_text=data.replace(/^error:/,'');if(error_text==="Limit exceeded"){s3.openModalPopup("/-/cms/v1/lp/?act=payment&"+access+'&service_group='+self.service_group+"&variant_id="+self.variant_id);return false}s3.alert(error_text);return false}var block_data=data.replace(/^([0-9])/,""),new_block_form,new_block_row;block_data=$.parseJSON(block_data);new_id=block_data.block_id;custom_css=block_data.block_css&&block_data.block_css.length;$.ajax({url:location.href.replace(location.hash,'').replace('#','')+'&get_block_id='+new_id,dataType:'html',success:function(data){if(!data){console.error('Not enough data');return false}result=$('<div>').html(data);const rows=$(result).find(self.site_wrapper).find('.lp-row[data-block-id="'+new_id+'"]');if(rows.length==1){new_row=rows}else if(rows.length>0){const existsVariantBlockIds=[];$(`.lp-row[data-block-id="${new_id}"]`).each(function(){existsVariantBlockIds.push($(this).data('variant-block-id'))});rows.each(function(){const variant_block_id=$(this).data('variant-block-id');if(!existsVariantBlockIds.includes(variant_block_id)){new_row=$(this);return}})}if(!new_row){console.error(`can't find needeed block`);return}new_block=new_row.find('#_lp_block_'+new_id);new_block_form=$(form).clone().attr('data-block-id',new_id).attr('id','edit_block_'+new_id);new_block_form.find('input[name="object_id"]').val(new_id);new_block_json_id=new_row.attr('data-json-id');new_block_row=new_row.append(new_block);new_block_row.find('form#edit_block_'+new_id).remove();new_block_row.append(new_block_form);new_block.attr('data-block-layout',block_layout_id);if(!new_block_json_id){new_block_json_id=''}if($(form).attr('data-switch-theme')){var replace_id=parseInt($(form).attr('data-switch-theme')),replace_block=$(self.site_wrapper).find('#_lp_block_'+replace_id),replace_row=replace_block.parent('.lp-row'),old_height=replace_block.height(),animate_time=400;replace_row.attr('data-inverse',new_row.attr('data-inverse'));if(replace_row){replace_row.height(old_height).addClass('clipped');new_block.addClass('replacer').css('opacity',0);replace_block.fadeOut(500,function(){replace_block.addClass('replacing').css('margin-bottom',old_height*-1).after(new_block);new_block.animate({'opacity':1},500);self.blockScriptReinit(new_block);setTimeout(function(){new_height=new_block.height();if(new_height>500){animate_time=1000}self.deleteBlock(replace_id,position,'fadeout',true,function(){lp_styles.attr('href',lp_styles_url+rnd);setTimeout(function(){replace_row.animate({'height':new_height,},animate_time,function(){replace_row.height('auto').removeClass('clipped');new_block.fadeIn(400,function(){new_block.removeClass('replacer').append(self.site_controls);self.initPicker(new_block);new_block_row.append(self.add_button);if(!block_data.block_css||$.type(block_data.block_css)=="array"){new_block.find('.site-controls .edit-layout-css').remove()}});$(form).removeAttr('data-switch-theme');$(form).find('input[name="object_id"]').val('');self.setControlsContext(new_block,new_id,new_block_json_id);setTimeout(function(){window.__do__restart__bind()},100);Preloader.hide();$(self.site_wrapper).find('[id^="_lp_block_"]').each(function(index){block_id=parseInt($(this).attr('id').replace('_lp_block_',''));$(this).attr('data-block-index',index)})})},200)})},200)})}}else if($(form).attr('data-insert-before')){var before_id=parseInt($(form).attr('data-insert-before'));let variant_block_id=$form.attr('data-variant-block-id'),selector=`.lp-row[data-block-id="${before_id}"]`;if(variant_block_id){variant_block_id=parseInt(variant_block_id);selector+=`[data-variant-block-id="${variant_block_id}"]`}const before_block=$(self.site_wrapper).find(selector);if(before_block){before_block.before(new_block_row.hide().fadeIn(500))}$('.lp-block-add-wrap').hide();$(form).removeAttr('data-insert-before');if(self.content_lp){LpController.addBlockToLpcIframe(new_block.clone(),new_block_row.attr('data-requires'))}self.updateBlockMenus()}else if($(form).attr('data-insert-after')){var after_id=parseInt($(form).attr('data-insert-after'));let variant_block_id=$form.attr('data-variant-block-id'),selector=`.lp-row[data-block-id="${after_id}"]`;if(variant_block_id){variant_block_id=parseInt(variant_block_id);selector+=`[data-variant-block-id="${variant_block_id}"]`}const after_block=$(self.site_wrapper).find(selector);if(after_block){after_block.after(new_block_row.hide().fadeIn(500));self.updateBlockMenus()}$(form).removeAttr('data-insert-after');$('.lp-block-add-wrap').hide();if(self.content_lp){LpController.addBlockToLpcIframe(new_block.clone(),new_block_row.attr('data-requires'))}}else{$(self.site_wrapper).append(new_block_row.hide().fadeIn(500));self.scrollToBlock(new_block_row.offset().top,new_block_row);self.updateBlockMenus();lp_preset_id=parseInt(new_block_row.attr('data-preset-id'));if(lp_preset_id&&$(self.lp_preset).val()==""){$(self.lp_preset).val(lp_preset_id);self.preset_id=lp_preset_id}$('.lp-block-add-wrap').hide();if(self.content_lp){LpController.addBlockToLpcIframe(new_block.clone(),new_block_row.attr('data-requires'))}}if(new_block_row.attr('data-variant-id')==0){self.reloadThroughBlocksStyles(new_block_row.attr('data-block-id'))}if(new_block_row.attr('data-requires')){self.setRequires(new_block_row.attr('data-requires'));new_block_row.removeAttr('data-requires')}if(new_block_row.outerHeight()<=200){new_block_row.addClass('mini-row')}self.convertImages(new_block);setTimeout(function(){self.convertImages(new_block)},500);if(!$(form).attr('data-switch-theme')){new_block.append(self.site_controls);self.initPicker(new_block);self.blocksReorder();setTimeout(function(){self.blockScriptReinit(new_block)},300)}if(!block_data.block_css||$.type(block_data.block_css)=="array"){new_block.find('.site-controls .edit-layout-css').remove()}if(multiple_add!='true'){self.closeBlockSelector()}$.ajax({url:'/-/cms/v1/lp/block/?act=get_block_data&'+S3_ACCESS,type:'POST',data:{"block_id":new_id,"json_id":new_block_json_id,"ver_id":VER_ID},dataType:'json',success:function(result){if(result){self.lp_blocks[new_id]={};self.lp_blocks[new_id]['data']=result['data'];self.lp_blocks[new_id]['data_json']=result['data_json']}self.setControlsContext(new_block,new_id,new_block_json_id);if(library_id){setTimeout(function(){window.__do__restart__bind()},400)}},error:function(e){console.log('Error',e)}})},error:function(e){console.log(e)}})},error:function(e){console.log(e)},complete:function(){Preloader.hide();self.toggleOverlay('hide')}})}return false},editElemImageSize:function(elem){var self=this;var width=$(self.selected_element).width();var height=$(self.selected_element).height();var $popup=$('.image-size-popup');var $max_width_elem=$(self.selected_element).closest('._lp-max-width');var max_width=$max_width_elem.css('max-width');var width_limit=1000;if(max_width&&max_width.slice(-2)==="px"){width_limit=parseInt(max_width)}if($(self.selected_element).find('iframe').length){$popup.find('.fix-btn').hide()}else{$popup.find('.fix-btn').show()}$popup.find('.image_width-body .range-slider').attr('data-max',width_limit);$popup.find('.image_width-body .range-slider').slider("option","max",width_limit);$popup.find('.range-value').eq(0).val(width);$popup.find('.range-slider').eq(0).slider('value',self.getSliderLogPosition(0,width_limit,width));$popup.find('.range-value').eq(1).val(height);$popup.find('.range-slider').eq(1).slider('value',self.getSliderLogPosition(0,width_limit,height));S3ContextMenuController.openContextMenu('.image-size-popup',function(){self.initDrag($popup)},null,null,null,null,null,null,null,true)},editElemLink:function(elem){var self=this;var href=$(self.selected_element).attr('href')||'';var rel=$(self.selected_element).attr('rel')||'';var target=$(self.selected_element).attr('target')||'';var $popup=$('.lp-link-popup');var $select=$popup.find('.s3-select');var $input=$popup.find('[name="lp_link"]');var $target_input=$popup.find('#target_toggle');var $rel_input=$popup.find('#index_toggle');if(!href){$input.parent().removeClass('disabled');$select.val($select.find('option').eq(0).text())}if(self.hasSelection(true)){var sel_text=window.getSelection().toString().trim();var sel_elem=self.getSelectionElement();if(sel_elem&&sel_elem.nodeName.toLowerCase()==='a'){href=$(sel_elem).attr('href');rel=$(sel_elem).attr('rel');target=$(sel_elem).attr('target');$(sel_elem).addClass('link-wrap')}else if(window.getSelection().focusNode.parentNode.nodeName.toLowerCase()==='a'){var el=window.getSelection().focusNode.parentNode;href=$(el).attr('href');rel=$(el).attr('rel');target=$(el).attr('target');$(el).addClass('link-wrap');sel_text=el.innerText}else if($(sel_elem).is('.lp-fragment-elem')){$(sel_elem).addClass('link-wrap')}else{self.wrapSelection({},'link-wrap')}$popup.find('.link-type').show();$popup.find('.anchor-type').hide();$popup.find('.selection-part').show();$popup.find('.selection-part input').val(sel_text)}else{$popup.find('.selection-part').hide();if(href.indexOf('popup:')===0){$input=$popup.find('[name="lp_anchor_link"]');$select.val($select.find('option').eq(1).text());$popup.find('.link-type').hide();$popup.find('.anchor-type').show();$popup.find('.anchor-type  .s3-btn').attr('data-type','popup')}else if(href.indexOf('#')===0&&href.length>1){$input=$popup.find('[name="lp_anchor_link"]');$select.val($select.find('option').eq(2).text());$popup.find('.link-type').hide();$popup.find('.anchor-type').show();$popup.find('.anchor-type  .s3-btn').attr('data-type','scroll')}else{$select.val($select.find('option').eq(0).text());$popup.find('.link-type').show();$popup.find('.anchor-type').hide()}}$input.val(href);if(target=='_blank'){$target_input.prop('checked',true);$target_input.parents('label').addClass('active')}else{$target_input.prop('checked',false);$target_input.parents('label').removeClass('active')}if(rel=='nofollow'){$rel_input.prop('checked',true);$rel_input.parents('label').addClass('active')}else{$rel_input.prop('checked',false);$rel_input.parents('label').removeClass('active')}$select.trigger("chosen:updated").trigger("liszt:updated");S3ContextMenuController.openContextMenu(".lp-link-popup",function(){self.initDrag($popup)},null,null,null,null,null,null,'.bluepopup-wrapper',true)},removeElemLink:function(btn){var self=this;var $popup=$(btn).parents('.context-popup');$popup.find('input').val('');$popup.find('[type="checkbox"]').prop('checked',false);$popup.find('[type="checkbox"]').parents('label').removeClass('active')},updateLinkPopup:function(){var self=this;var sel_text=window.getSelection().toString().trim();var sel_elem=self.getSelectionElement();var href='',rel,target;var $popup=$('.lp-link-popup');var $input=$popup.find('[name="lp_link"]');var $target_input=$popup.find('#target_toggle');var $rel_input=$popup.find('#index_toggle');if(sel_elem&&sel_elem.nodeName.toLowerCase()==='a'){href=$(sel_elem).attr('href');rel=$(sel_elem).attr('rel');target=$(sel_elem).attr('target');$(sel_elem).addClass('link-wrap')}else if(window.getSelection().focusNode.parentNode.nodeName.toLowerCase()==='a'){var el=window.getSelection().focusNode.parentNode;href=$(el).attr('href');rel=$(el).attr('rel');target=$(el).attr('target');$(el).addClass('link-wrap');sel_text=el.innerText}else if($(sel_elem).is('.lp-fragment-elem')){$(sel_elem).addClass('link-wrap')}else{self.wrapSelection({},'link-wrap')}$input.val(href);if(target=='_blank'){$target_input.prop('checked',true);$target_input.parents('label').addClass('active')}else{$target_input.prop('checked',false);$target_input.parents('label').removeClass('active')}if(rel=='nofollow'){$rel_input.prop('checked',true);$rel_input.parents('label').addClass('active')}else{$rel_input.prop('checked',false);$rel_input.parents('label').removeClass('active')}$popup.find('.selection-part input').val(sel_text)},editElemTag:function(){var self=this;var tag=self.selected_element.tagName.toLowerCase();var $popup=$('.lp-tag-popup');var $select=$popup.find('.s3-select');const elementType=self.selected_element.dataset.elemType;const $option=$select.find('option[value="h1"]');$option.prop('disabled',elementType==='text');$select.val(tag);$select.trigger("chosen:updated").trigger("liszt:updated");S3ContextMenuController.openContextMenu(".lp-tag-popup",function(){self.initDrag($popup)},null,null,null,null,null,null,'.bluepopup-wrapper',true)},replaceTag:function(element,newTag){var elementNew=document.createElement(newTag);elementNew.innerHTML=element.innerHTML;Array.prototype.forEach.call(element.attributes,function(attr){elementNew.setAttribute(attr.name,attr.value)});element.parentNode.insertBefore(elementNew,element);element.parentNode.removeChild(element);return elementNew},editElemTextParams:function(elem){LpController.notApplyPopupParams=true;var self=this;var fw=self.getElemCssProp('font','weight','font-weight');var td=self.getElemCssProp('font','text_decoration','text-decoration');var size=self.getElemCssProp('font','size','font-size');var $popup=$('.text-style-popup');var line_height=self.getElemCssProp('font','lineheight');var family=self.getElemCssProp('font','family','font-family');var f=family.split(",");var al=self.getElemCssProp('font','text_align','text-align');var last_fonts=LS.get('last_fonts');if(last_fonts&&last_fonts.length){$popup.find('.last-fonts').html('');last_fonts.forEach(function(e,i){$popup.find('.last-fonts').append($(e))});$popup.find('.last-fonts').show()}if(!line_height){var lh=$(self.selected_element).css('line-height');line_height=lh==='normal'?120:parseInt(lh)/parseInt(size)*100}self.toggleElement(!self.hasSelection(),$popup.find('.media-box'));if(self.hasSelection()){$popup.find('.align-item').addClass('disabled')}else{$popup.find('.align-item').removeClass('disabled')}$popup.find('.media-box .desktop-media').addClass('active').siblings().removeClass('active');$popup.find('.media-params-box .screen').addClass('active').siblings().removeClass('active');$popup.find('.changed-rule').removeClass('.changed-rule');$popup.find('.selected').removeClass('selected');$popup.find('.family-item .selected-value').attr('data-font',family).text(f[0].replace(/['"]+/g,''));$popup.find('.size-item .selected-value').val(size?parseInt(size):"");$popup.find('.height-item input').val(line_height?parseInt(line_height):"");if(fw==='bold'||parseInt(fw)>=600){$popup.find('.style-item .fsb').addClass('selected')}if(self.getElemCssProp('font','style','font-style')==='italic'||self.getElemCssProp('font','style')){$popup.find('.style-item .fsi').addClass('selected')}if(td.indexOf('underline')!==-1){$popup.find('.style-item .tdu').addClass('selected')}else if(td.indexOf('line-through')!==-1){$popup.find('.style-item .tdlt').addClass('selected')}if(al){$popup.find('.align-item .'+al).parent().addClass('selected')}$popup.find('.colorpicker-color-component').colorpicker('setValue',self.getElemCssProp('font','color','color'));self.media_rules.forEach(function(media,index){var $media_rules=$popup.find('.media-rule-box').not('.screen');var font=self.getElemCssProp('font',null,null,media);var $rules=$media_rules.splice(index,$media_rules.length);if(font&&!$.isEmptyObject(font)){$.each($rules,function(i,r){if(font['family']){family=font['family'];f=family.split(",")}$(r).find('.selected').removeClass('selected');$(r).find('.family-item .selected-value').attr('data-font',family).text(f[0].replace(/['"]+/g,''));$(r).find('.size-item .selected-value').val(parseInt(font['size']));$(r).find('.height-item input').val(parseInt(font['lineheight']));if(fw==='bold'||parseInt(fw)>=600){$(r).find('.style-item .fsb').addClass('selected')}else{$(r).find('.style-item .fsb').removeClass('selected')}if(font.style){$(r).find('.style-item .fsi').addClass('selected')}else{$(r).find('.style-item .fsi').removeClass('selected')}if(font['text_decoration']){if(font['text_decoration'].indexOf('underline')!==-1){$(r).find('.style-item .tdu').addClass('selected')}else{$(r).find('.style-item .tdlt').addClass('selected')}}$(r).find('.align-item .'+font['text_align']).parent().addClass('selected');$(r).find('.colorpicker-color-component').colorpicker('setValue',font['color'])})}});$popup.find('.dropdown-popup').jScrollPane({autoReinitialise:true,verticalGutter:0});S3ContextMenuController.openContextMenu(".text-style-popup",function(){self.initDrag($popup)},null,null,null,null,null,null,'.colorpicker',true);LpController.notApplyPopupParams=false},cleanTextParams:function(){var self=this;var $row=$(self.selected_element).parents('.lp-row');var block_id=$row.attr('data-block-id');var layout_id=$row.attr('data-block-layout-id');var fragments=$(self.selected_element_class+' *').not('br');if(self.hasSelection()){var elem=self.getSelectionElement();fragments=$(elem).find('*').not('br');$(elem).replaceWith($(elem).html());$(self.selected_element).addClass('modified-text')}else{if(self.css_params&&self.css_params[block_id]&&self.css_params[block_id][self.selected_element_class]){var custom_styles_url='/t/css/__landing_page_'+self.variant_id+'.css',$custom_styles=$('link[href^="'+custom_styles_url+'"]');if($custom_styles.length){for(var i in $custom_styles[0].sheet.rules){var rules=$custom_styles[0].sheet.rules[i];if(rules&&rules.selectorText){var selector='#_lp_block_'+block_id+'[data-block-layout="'+layout_id+'"] '+self.selected_element_class;if(rules.selectorText.trim()===selector.trim()){$(self.selected_element).attr('data-cleaned_css',rules.style.cssText);$(self.selected_element).data('cleaned_params',JSON.stringify(self.css_params[block_id][self.selected_element_class]));rules.style.cssText='';break}}}self.css_params[block_id][self.selected_element_class]={}}}$row.find(self.selected_element_class).removeAttr('style')}$(self.selected_element).addClass('modified modified-text');fragments.each(function(){var content=$(this).contents();$(this).replaceWith(content)})},editElemBorder:function(elem){LpController.notApplyPopupParams=true;var self=this;var $popup=$('.lp-bd-popup');var bdtlr=self.getElemCssProp('border_radius','lt','border-top-left-radius');var bdtrr=self.getElemCssProp('border_radius','rt','border-top-right-radius');var bdblr=self.getElemCssProp('border_radius','lb','border-bottom-left-radius');var bdbrr=self.getElemCssProp('border_radius','lb','border-bottom-right-radius');var bdc=self.getElemCssProp('border','color')?self.getElemCssProp('border','color'):self.getElementBorderColor($(self.selected_element));var bdw=self.getElemCssProp('border','width','border-width');var commented_border=self.getCommentedProp('border');var commented_radius=self.getCommentedProp('border_radius');var side=Math.max($(self.selected_element).outerWidth(),$(self.selected_element).outerHeight());$popup.find('.border-radius-control .range-slider').attr('data-max',parseInt(side/2)+1);$popup.find('.border-radius-control .range-slider').slider("option","max",parseInt(side/2)+1);if(!$.isEmptyObject(commented_border)||!$.isEmptyObject(commented_radius)){if(!$.isEmptyObject(commented_border)){bdw=commented_border.width;bdc=commented_border.color}if(!$.isEmptyObject(commented_radius)){bdtlr=commented_radius['lt'];bdtrr=commented_radius['rt'];bdblr=commented_radius['lb'];bdbrr=commented_radius['rb']}$popup.find('.header-body').addClass('disabled');$popup.find('.prop-toggle').removeClass('active');$popup.find('.prop-toggle input').prop('checked',false)}else{$popup.find('.header-body').removeClass('disabled');$popup.find('.prop-toggle').addClass('active');$popup.find('.prop-toggle input').prop('checked',true)}if(bdtlr===bdtrr&&bdtrr===bdblr&&bdblr===bdbrr){$popup.find('.range-value').val(parseInt(bdtlr));$popup.find(".border-radius-slider").slider('value',parseInt(bdtlr))}else{$popup.find('.general-type .range-value').val('--');$popup.find(".general-type .border-radius-slider").slider('value',0);$popup.find('.br-left-part .s3-btn').addClass('active');$popup.find('.left-top-corner .range-value').val(parseInt(bdtlr));$popup.find('.right-top-corner .range-value').val(parseInt(bdtrr));$popup.find('.left-bottom-corner .range-value').val(parseInt(bdblr));$popup.find('.right-bottom-corner .range-value').val(parseInt(bdbrr));$popup.find('.left-top-corner .border-radius-slider').slider('value',parseInt(bdtlr));$popup.find('.right-top-corner .border-radius-slider').slider('value',parseInt(bdtrr));$popup.find('.left-bottom-corner .border-radius-slider').slider('value',parseInt(bdblr));$popup.find('.right-bottom-corner .border-radius-slider').slider('value',parseInt(bdbrr))}$popup.find(".border-slider").slider('value',parseInt(bdw?bdw:0));$popup.find('.border-width-range .range-value').val(parseInt(bdw?bdw:0));$popup.find('.colorpicker-border-component').colorpicker('setValue',bdc);S3ContextMenuController.openContextMenu(".lp-bd-popup",function(){self.initDrag($popup)},null,null,null,null,null,null,'.colorpicker',true);LpController.notApplyPopupParams=false},editElemBackground:function(elem){LpController.notApplyPopupParams=true;var self=this;var $row=$(elem).parents('.lp-row');var $popup=$('.lp-elem-bg-popup');var block_controls=$row.find('.site-controls');var bgc=self.getElemCssProp('background','color','background-color');var bgr=self.getElemCssProp('background','repeat','background-repeat');var bgp=self.getElemCssProp('background','position','background-position');var bga=self.getElemCssProp('background','attachment','background-attachment');var src='/my/s3/images/svg_icons/lp/oah-block-image2.svg';var bg_type=self.getElemCssProp('background','bg_type');var gradient_direction=self.getElemCssProp('background','gradient_direction');var start_color=self.getElemCssProp('background','start_color');var end_color=self.getElemCssProp('background','end_color');bgp=self.parseBgPosition(bgp);var x_pos=bgp.split(" ")[0];var y_pos=bgp.split(" ")[1];if(!bg_type){bg_type='transparent';if(bgc!=="rgba(0, 0, 0, 0)"){bg_type='solid'}}if(self.hasSelection()){var sel_elem=self.getSelectionElement();if($(sel_elem).is('.lp-fragment-elem')){$(sel_elem).addClass('bg-wrap')}else{self.wrapSelection({},'bg-wrap')}if($(sel_elem).css('background-image')!=="none"){var grad_str=$(sel_elem).css('background-image').replace('linear-gradient(','').replace('))',')').replace(/\"/gi,"");var grad_arr=grad_str.split(", rgb");gradient_direction=grad_arr[0];start_color="rgb"+grad_arr[1];end_color="rgb"+grad_arr[2];bg_type="gradient"}}$popup.find('.colorpicker-bg-component').colorpicker('setValue',bgc==="rgba(0, 0, 0, 0)"?"rgba(255, 255, 255, 0.5)":bgc);if(start_color)$popup.find('.colorpicker-grad_start-component').colorpicker('setValue',start_color);if(end_color)$popup.find('.colorpicker-grad_end-component').colorpicker('setValue',end_color);$popup.find('img').attr('src',src);$popup.find('.repeat-control').val(bgr);$popup.find('.pos-control').val(self.parseBgPosition(bgp));$popup.find('.position-params').find('.selected').removeClass('selected');$popup.find('.x-position').find('[data-val="'+x_pos+'"]').addClass('selected');$popup.find('.y-position').find('[data-val="'+y_pos+'"]').addClass('selected');$popup.find('.bg-types select').val(bg_type);$popup.find('.bg-type').hide();$popup.find('.'+bg_type+'-type').show();$popup.find('.gradient-direction  input').val(parseInt(gradient_direction?gradient_direction:0));$popup.find('.gradient-direction  .range-slider').slider('value',parseInt(gradient_direction?gradient_direction:0));if(bga.indexOf('fixed')!=-1){$popup.find('.attachment-param .s3-cb').addClass('active');$popup.find('.attachment-param input[type="checkbox"]').prop("checked",true).attr('checked','checked')}else{$popup.find('.attachment-param .s3-cb').removeClass('active');$popup.find('.attachment-param input[type="checkbox"]').prop("checked",false).removeAttr("checked")}$popup.find('select').trigger("chosen:updated").trigger("liszt:updated");S3ContextMenuController.openContextMenu(".lp-elem-bg-popup",function(){self.initDrag($popup)},null,null,null,null,null,function(){block_controls.removeClass('show')},'.bluepopup-wrapper',true);LpController.notApplyPopupParams=false},editElemShadow:function(elem){LpController.notApplyPopupParams=true;var self=this;var bsh=self.getElemCssProp('box_shadow');var commented=self.getCommentedProp('box_shadow');var $popup=$('.lp-shadow-popup');var bsh_props;if(!$.isEmptyObject(commented)){bsh_props=[commented];$popup.find('.header-body').addClass('disabled');$popup.find('.prop-toggle').removeClass('active');$popup.find('.prop-toggle input').prop('checked',false)}else{if(!$.isEmptyObject(bsh)){bsh_props=[bsh]}else{bsh_props=self.parseBoxShadow($(self.selected_element).css('box-shadow'))}$popup.find('.header-body').removeClass('disabled');$popup.find('.prop-toggle').addClass('active');$popup.find('.prop-toggle input').prop('checked',true)}var color=bsh_props[0].color&&bsh_props[0].color!=='transparent'&&bsh_props[0].color!=='rgba(0, 0, 0, 0)'?bsh_props[0].color:'#ccc';$popup.find('.offset_x .range-slider').slider('value',bsh_props[0].offset_x);$popup.find('.offset_y .range-slider').slider('value',bsh_props[0].offset_y);$popup.find('.spread .range-slider').slider('value',bsh_props[0].spread);$popup.find('.blur .range-slider').slider('value',bsh_props[0].blur);$popup.find('.offset_x .range-value').val(bsh_props[0].offset_x);$popup.find('.offset_y .range-value').val(bsh_props[0].offset_y);$popup.find('.spread .range-value').val(bsh_props[0].spread);$popup.find('.blur .range-value').val(bsh_props[0].blur);$popup.find('.colorpicker-component').colorpicker('setValue',color);S3ContextMenuController.openContextMenu(".lp-shadow-popup",function(){self.initDrag($popup)},null,null,null,null,null,null,'.colorpicker',true);LpController.notApplyPopupParams=false},setIndentsSlider:function($slider,value){const min=this.getMinRangeValue($slider);const max=this.getMaxRangeValue($slider);const numberValue=typeof value==='string'?parseInt(value):value;const logPosition=this.getSliderLogPosition(min,max,numberValue);$slider.slider('value',logPosition)},editElemIndents:function(elem){LpController.notApplyPopupParams=true;var self=this;var pt=self.getElemCssProp('padding','top','padding-top');var pl=self.getElemCssProp('padding','left','padding-left');var pr=self.getElemCssProp('padding','right','padding-right');var pb=self.getElemCssProp('padding','bottom','padding-bottom');var mt=self.getElemCssProp('margin','top','margin-top');var ml=self.getElemCssProp('margin','left','margin-left');var mr=self.getElemCssProp('margin','right','margin-right');var mb=self.getElemCssProp('margin','bottom','margin-bottom');var display=$(self.selected_element).css('display');var $popup=$('.lp-indents-popup');var $padding_wrap=$popup.find('.paddings');var $margin_wrap=$popup.find('.margins');var elem_type=$(self.selected_element).attr('data-elem-type');$popup.find('.hide').removeClass('hide');$popup.find('.range-value').val(0);$popup.find('.media-box .desktop-media').addClass('active').siblings().removeClass('active');$popup.find('.media-params-box .screen').addClass('active').siblings().removeClass('active');$popup.find('.changed-rule').removeClass('.changed-rule');if(self.hide_sub_control.hasOwnProperty(elem_type)){self.hide_sub_control[elem_type].forEach(function(sub_control_name,index){$('.'+sub_control_name+'-control').addClass('hide')})}if(pt===pl&&pl===pr&&pr===pb){$padding_wrap.find('.range-value').val(parseInt(pt)||'--');self.setIndentsSlider($padding_wrap.find('.range-slider'),pt)}else{$padding_wrap.find('.general-type .range-value').val('--');self.setIndentsSlider($padding_wrap.find('.general-type .range-slider'),0);$padding_wrap.find('.top-side .range-value').val(parseInt(pt));$padding_wrap.find('.left-side .range-value').val(parseInt(pl));$padding_wrap.find('.right-side .range-value').val(parseInt(pr));$padding_wrap.find('.bottom-side .range-value').val(parseInt(pb));self.setIndentsSlider($padding_wrap.find('.top-side .range-slider'),pt);self.setIndentsSlider($padding_wrap.find('.left-side .range-slider'),pl);self.setIndentsSlider($padding_wrap.find('.right-side .range-slider'),pr);self.setIndentsSlider($padding_wrap.find('.bottom-side .range-slider'),pb)}if((mt===ml&&ml===mr&&mr===mb)||(display==='inline'&&ml===mr)){var v=display==='inline'?ml:mt;$margin_wrap.find('.range-value').val(parseInt(v)||'--');self.setIndentsSlider($margin_wrap.find('.range-slider'),v)}else{$margin_wrap.find('.general-type .range-value').val('--');self.setIndentsSlider($margin_wrap.find('.general-type .range-slider'),0);$margin_wrap.find('.top-side .range-value').val(parseInt(mt));$margin_wrap.find('.left-side .range-value').val(parseInt(ml));$margin_wrap.find('.right-side .range-value').val(parseInt(mr));$margin_wrap.find('.bottom-side .range-value').val(parseInt(mb));self.setIndentsSlider($margin_wrap.find('.top-side .range-slider'),mt);self.setIndentsSlider($margin_wrap.find('.left-side .range-slider'),ml);self.setIndentsSlider($margin_wrap.find('.right-side .range-slider'),mr);self.setIndentsSlider($margin_wrap.find('.bottom-side .range-slider'),mb)}if(display==='inline'){$margin_wrap.find('.margin_top-control').addClass('hide');$margin_wrap.find('.margin_bottom-control').addClass('hide')}self.media_rules.forEach(function(media,index){var $media_rules=$popup.find('.media-rule-box').not('.screen');var margin=self.getElemCssProp('margin',null,null,media);var padding=self.getElemCssProp('padding',null,null,media);var $rules=$media_rules.splice(index,$media_rules.length-1);if(margin&&!$.isEmptyObject(margin)){$.each($rules,function(i,r){const $margins=$(r).find('.margins');if((margin['top']===margin['left']&&margin['left']===margin['right']&&margin['right']===(margin['bottom']))||(display==='inline'&&margin['left']===margin['right'])){$margins.find('.general-type .range-value').val(margin['top']);self.setIndentsSlider($margins.find('.general-type .range-slider'),margin['top'])}else{$margins.find('.general-type .range-value').val('--');self.setIndentsSlider($margins.find('.general-type .range-slider'),0)}$margins.find('.top-side .range-value').val(parseInt(margin['top']));$margins.find('.left-side .range-value').val(parseInt(margin['left']));$margins.find('.right-side .range-value').val(parseInt(margin['right']));$margins.find('.bottom-side .range-value').val(parseInt(margin['bottom']));self.setIndentsSlider($margins.find('.top-side .range-slider'),margin['top']);self.setIndentsSlider($margins.find('.left-side .range-slider'),margin['left']);self.setIndentsSlider($margins.find('.right-side .range-slider'),margin['right']);self.setIndentsSlider($margins.find('.bottom-side .range-slider'),margin['bottom'])})}if(padding&&!$.isEmptyObject(padding)){$.each($rules,function(i,r){const $paddings=$(r).find('.paddings');if((padding['top']===padding['left']&&padding['left']===padding['right']&&padding['right']===(padding['bottom']))){$paddings.find('.general-type .range-value').val(padding['top']);self.setIndentsSlider($paddings.find('.general-type .range-slider'),padding['top'])}else{$paddings.find('.general-type .range-value').val('--');self.setIndentsSlider($paddings.find('.general-type .range-slider'),0)}$paddings.find('.top-side .range-value').val(parseInt(padding['top']));$paddings.find('.left-side .range-value').val(parseInt(padding['left']));$paddings.find('.right-side .range-value').val(parseInt(padding['right']));$paddings.find('.bottom-side .range-value').val(parseInt(padding['bottom']));self.setIndentsSlider($paddings.find('.top-side .range-slider'),padding['top']);self.setIndentsSlider($paddings.find('.left-side .range-slider'),padding['left']);self.setIndentsSlider($paddings.find('.right-side .range-slider'),padding['right']);self.setIndentsSlider($paddings.find('.bottom-side .range-slider'),padding['bottom'])})}});S3ContextMenuController.openContextMenu(".lp-indents-popup",function(){self.initDrag($popup)},null,null,null,null,null,null,null,true);LpController.notApplyPopupParams=false},setOriginalSizeToImage:function(el){var self=this;var popup=$(el).parents('.context-popup');var img=$(self.selected_element).is('img')?self.selected_element:$(self.selected_element).find('img')[0];var naturalWidth=img.naturalWidth;var naturalHeight=img.naturalHeight;popup.find('input').eq(0).val(naturalWidth);popup.find('input').eq(1).val(naturalHeight);popup.find('.range-slider').eq(0).slider('value',naturalWidth);popup.find('.range-slider').eq(1).slider('value',naturalHeight);self.applyStyles(el,$(self.selected_element),{'width':naturalWidth,'height':naturalHeight})},updateElemTag:function(tag,callback){var self=this;var $row=$(self.selected_element).parents('.lp-row');var renamed=document.createElement(tag);Object.keys(self.selected_element.attributes).forEach(function(a){var e=self.selected_element.attributes[a];renamed.setAttribute(e.nodeName,e.nodeValue)});while(self.selected_element.firstChild){renamed.appendChild(self.selected_element.firstChild)}self.selected_element.parentNode.replaceChild(renamed,self.selected_element);self.selected_element=$('.lp-selected-element')[0];$(self.selected_element).addClass('modified');$(self.block_css_controls).find('.change-tag').text(tag);if(callback&&typeof callback==='function'){callback()}},editBlockBackground:function(elem,item){LpController.notApplyPopupParams=true;const class_popup=item?'.lp-block-bg-popup-item':'.lp-block-bg-popup';const class_elem=item?'.lp-block-bg_item':'.lp-block-bg';const class_overlay_elem=item?'.lp-block-overlay_item':'.lp-block-overlay';var self=this;var $row=$(self.selected_element).parents('.lp-row');var $popup=$(class_popup);var is_promo=$(self.selected_element).attr('data-elem-type')==='promo_block';var image_elem=$(self.selected_element).find(class_elem).length?$(self.selected_element).find(class_elem):$(self.selected_element);var overlay_elem=$(self.selected_element).find(class_overlay_elem).length?$(self.selected_element).find(class_overlay_elem):$(self.selected_element);var bgc=self.getElemCssProp('background','color','background-color',null,overlay_elem,class_elem);var bgr=self.getElemCssProp('background','repeat','background-repeat',null,image_elem,class_elem);var bgs=self.getElemCssProp('background','size','background-size',null,image_elem,class_elem);var bgp=self.getElemCssProp('background','position','background-position',null,image_elem,class_elem);var bga=self.getElemCssProp('background','attachment','background-attachment',null,image_elem,class_elem);var image_info=self.getElemCssProp('background','image','background-image',null,image_elem,class_elem);var src='/my/s3/images/svg_icons/lp/oah-block-image2.svg';var block_controls=$row.find('.site-controls');var bgc_over=self.getElemCssProp('background','color','background-color',null,overlay_elem,class_overlay_elem);var bg_type=self.getElemCssProp('background','bg_type',null,null,overlay_elem,class_overlay_elem);var gradient_direction=self.getElemCssProp('background','gradient_direction',null,null,overlay_elem,class_overlay_elem);var start_color=self.getElemCssProp('background','start_color',null,null,overlay_elem,class_overlay_elem);var end_color=self.getElemCssProp('background','end_color',null,null,overlay_elem,class_overlay_elem);bgp=self.parseBgPosition(bgp);var x_pos=bgp.split(" ")[0];var y_pos=bgp.split(" ")[1];var filename='';var type='image';var video_html='',video_filename,youtube_id;if(image_elem.find('iframe').length){type='youtube'}else if(image_elem.find('video').length){type='custom_video'}if(!bg_type){if(start_color&&end_color&&start_color!=='transparent'&&start_color!=='rgba(0, 0, 0, 0)'&&end_color!=='transparent'&&end_color!=='rgba(0, 0, 0, 0)'){bg_type='gradient'}else if(bgc&&bgc!=='transparent'&&bgc!=='rgba(0, 0, 0, 0)'){bg_type='solid'}else{bg_type='transparent'}}if(type==='youtube'){var $iframe=image_elem.find('iframe');youtube_id=$iframe.attr('data-video-id');video_filename=$iframe.attr('src')}else if(type==='custom_video'){var $video=image_elem.find('video');video_filename=$video.find('source').attr('src');video_html='<video type="video/mp4"><source src="'+video_filename+'"></video>'}$popup.find('.image-change-wrap').removeAttr('data-image-path');$popup.find('.background-type').hide();$popup.find('.'+type+'-type').show();$popup.find('.no-img').show();$popup.find('.has-img').hide();$popup.find('.no-video').show();$popup.find('.has-video').hide();self.toggleElement(is_promo,$popup.find('.background-types-select'));if(image_info&&(typeof image_info==='string'&&image_info!=='none'||typeof image_info==='object'&&image_info['image_id']&&image_info['filename'])){$popup.find('.no-img').hide();$popup.find('.has-img').show();if(typeof image_info==='object'){$popup.find('.image-select .css-value').val(JSON.stringify({'image_id':image_info['image_id'],'filename':image_info['filename']}));src=image_info['thumbnail'];var image_path="/d/"+image_info.filename.trim();$popup.find('.image-change-wrap').attr('data-image-path',image_path)}else{src=image_info!='none'?image_info.slice(4,-1).replace(/["']/g,""):'/my/s3/images/svg_icons/lp/oah-block-image2.svg';var src_array=src.split('/');filename=src_array[src_array.length-1];$popup.find('.image-change-wrap').attr('data-image-path',src);ImageController.getImageByFilename(VER_ID,filename,function(data){if(data.result){$popup.find('.image-select .css-value').val(JSON.stringify({'image_id':data.result,'filename':filename}))}})}}else{bgr="no-repeat"}$popup.find('.colorpicker-bg-component').colorpicker('setValue',self.prepareColor(bgc_over));$popup.find('.colorpicker-grad_start-component').colorpicker('setValue',self.prepareColor(start_color));$popup.find('.colorpicker-grad_end-component').colorpicker('setValue',self.prepareColor(end_color));if(video_filename){$popup.find('.video-change-wrap').html(video_html);$popup.find('.no-video').hide();$popup.find('.has-video').show();if(youtube_id){$popup.find('.youtube_id').val(youtube_id)}self.updateMediaData($(self.selected_element),self.getVideoDataPath('video'),{filename:video_filename});self.updateMediaData($(self.selected_element),self.getVideoDataPath('youtube'),'')}$popup.find('.background-types-select select').val(type);$popup.find('.background-type').hide();$popup.find('.'+type+'-type').show();$popup.find('.image-change-wrap img').attr('src',src);$popup.find('.repeat-control').val(bgr);$popup.find('.size-control').val(bgs);$popup.find('.pos-control').val(self.parseBgPosition(bgp));$popup.find('.position-params').find('.selected').removeClass('selected');$popup.find('.x-position').find('[data-val="'+x_pos+'"]').addClass('selected');$popup.find('.y-position').find('[data-val="'+y_pos+'"]').addClass('selected');$popup.find('.bg-types select').val(bg_type);$popup.find('.bg-type').hide();$popup.find('.'+bg_type+'-type').show();$popup.find('.gradient-direction  input').val(parseInt(gradient_direction?gradient_direction:0));$popup.find('.gradient-direction  .range-slider').slider('value',parseInt(gradient_direction?gradient_direction:0));if(bga.indexOf('fixed')!=-1){$popup.find('.attachment-param .s3-cb').addClass('active');$popup.find('.attachment-param input[type="checkbox"]').prop("checked",true).attr('checked','checked')}else{$popup.find('.attachment-param .s3-cb').removeClass('active');$popup.find('.attachment-param input[type="checkbox"]').prop("checked",false).removeAttr("checked")}$popup.find('select').trigger("chosen:updated").trigger("liszt:updated");block_controls.addClass('show');S3ContextMenuController.openContextMenu(class_popup,function(){self.initDrag($popup)},null,null,null,true,null,function(){block_controls.removeClass('show')},'.bluepopup-wrapper',true);LpController.notApplyPopupParams=false},prepareColor:function(color){return!color||color==="rgba(0, 0, 0, 0)"||color==='transparent'?"rgba(255, 255, 255, 0.5)":color},editBlockPadding:function(elem){LpController.notApplyPopupParams=true;var self=this;var $row=$(self.selected_element).parents('.lp-row');var $popup=$('.lp-block-padding-popup');var pt=self.getElemCssProp('padding','top','padding-top');var pb=self.getElemCssProp('padding','bottom','padding-bottom');var $padding_wrap=$popup.find('.paddings');$popup.find('.range-value').val(0);$popup.find('.media-box .desktop-media').addClass('active').siblings().removeClass('active');$popup.find('.media-params-box .screen').addClass('active').siblings().removeClass('active');$popup.find('.changed-rule').removeClass('.changed-rule');if(pt===pb){$padding_wrap.find('.range-value').val(parseInt(pt));$padding_wrap.find(".range-slider").slider('value',parseInt(pt))}else{$padding_wrap.find('.general-type .range-value').val('--');$padding_wrap.find(".general-type .range-slider").slider('value',0);$padding_wrap.find('.top-side .range-value').val(parseInt(pt));$padding_wrap.find('.bottom-side .range-value').val(parseInt(pb));$padding_wrap.find('.top-side .range-slider').slider('value',parseInt(pt));$padding_wrap.find('.bottom-side .range-slider').slider('value',parseInt(pb))}self.media_rules.forEach(function(media,index){var $media_rules=$popup.find('.media-rule-box').not('.screen');var padding=self.getElemCssProp('padding',null,null,media);var $rules=$media_rules.splice(index,$media_rules.length-1);if(padding&&!$.isEmptyObject(padding)){$.each($rules,function(i,r){if(padding['top']===padding['bottom']){$(r).find('.paddings .general-type .range-value').val(padding['top']);$(r).find(".paddings .general-type .range-slider").slider('value',padding['top'])}else{$(r).find('.paddings .general-type .range-value').val('--');$(r).find(".paddings .general-type .range-slider").slider('value',0)}$(r).find('.paddings .top-side .range-value').val(parseInt(padding['top']));$(r).find('.paddings .bottom-side .range-value').val(parseInt(padding['bottom']));$(r).find('.paddings .top-side .range-slider').slider('value',parseInt(padding['top']));$(r).find('.paddings .bottom-side .range-slider').slider('value',parseInt(padding['bottom']))})}});var block_controls=$row.find('.site-controls');block_controls.addClass('show');S3ContextMenuController.openContextMenu(".lp-block-padding-popup",function(){self.initDrag($popup)},null,null,null,true,null,function(){block_controls.removeClass('show')},'.bluepopup-wrapper',true);LpController.notApplyPopupParams=false},getElementBorderColor:function($elem){var top_style=$elem.css('border-top-style');var left_style=$elem.css('border-left-style');var right_style=$elem.css('border-right-style');var bottom_style=$elem.css('border-bottom-style');var color;if(top_style!=="none"&&top_style===left_style&&left_style===right_style&&right_style===bottom_style){color=$elem.css('border-top-color')}else if(top_style!=="none"){color=$elem.css('border-top-color')}else if(left_style!=="none"){color=$elem.css('border-left-color')}else if(right_style!=="none"){color=$elem.css('border-right-color')}else if(bottom_style!=="none"){color=$elem.css('border-bottom-color')}else{color=$elem.css('border-color')}return color},parseBoxShadow:function(str){var values_reg=/,(?![^\(]*\))/;var parts_reg=/\s(?![^(]*\))/;var length_reg=/^[0-9]+[a-zA-Z%]+?$/;if(str=='none'){return[{inset:0,offset_x:0,offset_y:0,blur:0,spread:0,color:'transparent'}]}var parseValue=function parseValue(str){var parts=str.split(parts_reg);var inset=parts.includes('inset');var nums=parts.filter(function(n){return n!=='inset'}).map(toNum);var offset_x=nums[1],offset_y=nums[2],blur=nums[3],spread=nums[4],color=nums[0];return{inset:parseInt(inset),offset_x:parseInt(offset_x),offset_y:parseInt(offset_y),blur:parseInt(blur),spread:parseInt(spread),color:color}};var toNum=function toNum(v){if(!/px$/.test(v)&&v!=='0')return v;var n=parseFloat(v);return!isNaN(n)?n:v};var parse=function parse(str){return str.split(values_reg).map(function(s){return s.trim()}).map(parseValue)};return parse(str)},triggerType:function(el){var self=this;var $popup=$(el).parents('.control-box');$(el).toggleClass('active');if($(el).hasClass('active')){$popup.find('.personal-type').show().removeClass('disabled');$popup.find('.general-type').addClass('disabled');$(el).parents('.control-box').find('.part-title span').text(s3.loc('LP_DETAILED_CONTROL_TYPE'))}else{$popup.find('.personal-type').hide().addClass('disabled');$popup.find('.general-type').removeClass('disabled');$(el).parents('.control-box').find('.part-title span').text(s3.loc('LP_COMMON_CONTROL_TYPE'))}},setActiveBlock:function(block){var self=this;var block_id=$(block).attr('data-id');var selected_index=$('.lp-link-popup select')[0].selectedIndex;$(block).parent().find('.active').removeClass('active');$(block).addClass('active');if(selected_index==1){$('.lp-link-popup [name="lp_anchor_link"]').val('popup:'+block_id)}else if(selected_index==2){$('.lp-link-popup [name="lp_anchor_link"]').val('#'+block_id)}popupController.closeLastPopup()},editBlockAnchorLink:function(elem){const $parent=$(elem).parents('.lp-row');const is_modal=$parent.hasClass('popup-row-block');var self=this;var block_controls=$parent.find('.site-controls');var $popup=is_modal?$('.lp-anchor-popup-modal'):$('.lp-anchor-popup');var lp_block_anchor=$parent.attr('data-anchor-link');var full_url_with_anchor=is_modal?'popup:'+lp_block_anchor:self.blocks_anchor_prefix+lp_block_anchor;const modal_anchor_id=is_modal?'#lp_block_anchor_modal':'#lp_block_anchor';const modal_anchor_class=is_modal?'.lp-anchor-popup-modal':'.lp-anchor-popup';$popup.find(modal_anchor_id).val(lp_block_anchor);$popup.find('.s3-clipboard-btn').attr('data-clipboard-text',full_url_with_anchor).attr('title',full_url_with_anchor);block_controls.addClass('show');$popup.attr('data-block-id',$parent.attr('data-block-id'));$popup.attr('data-variant-block-id',$parent.attr('data-variant-block-id'));$popup.attr('data-layout-id',$parent.attr('data-block-layout-id'));$popup.attr('data-variant-id',$parent.attr(`data-variant-id`));S3ContextMenuController.openContextMenu(modal_anchor_class,function(){self.initDrag($popup)},null,null,null,true,2,function(){block_controls.removeClass('show')},null,true)},changeAnchorLink:function(event){var $popup=$('.lp-anchor-popup');var full_url_with_anchor=this.blocks_anchor_prefix+event.target.value;$popup.find('.s3-clipboard-btn').attr('data-clipboard-text',full_url_with_anchor).attr('title',full_url_with_anchor)},saveBlockAnchorLink:function(elem){var self=this;var popup=$('.lp-anchor-popup');var block_id=parseInt(popup.attr('data-block-id'));var layout_id=popup.attr('data-layout-id');var variant_id=parseInt(popup.attr('data-variant-id'));var variant_block_id=popup.attr('data-variant-block-id');var val=popup.find('input[name="lp_block_anchor"]').val();const object_id=variant_id?block_id:variant_block_id;$.ajax({url:'/-/cms/v1/lp/block/?act=edit_anchor&'+S3_ACCESS,type:'POST',data:{'object_id':object_id,'layout_id':layout_id,'variant_id':self.variant_id,'block_variant_id':variant_id,'lp_block_anchor':val,},success:function(data){util.msg(s3.loc('JS_CHANGES_SAVED'),'green');$(self.site_wrapper).find('.lp-row[data-block-id="'+block_id+'"]').attr('data-anchor-link',val);S3ContextMenuController.closeContextMenu()},error:function(e){console.log(e)}});return false},updateElemLink:function(elem){var self=this;var popup=$('.lp-link-popup');var href=popup.find('input[name="lp_link"]').val();var nofollow=popup.find('#index_toggle').prop('checked');var target_blank=popup.find('#target_toggle').prop('checked');if(popup.find('select')[0].selectedIndex){href=popup.find('input[name="lp_anchor_link"]').val()}if(href){var change_elem;if($(self.selected_element).find('.link-wrap').length){change_elem=self.replaceTag($(self.selected_element).find('.link-wrap')[0],'a');$(change_elem).removeClass('link-wrap');self.setSelection(change_elem);$(self.selected_element).addClass('modified-text')}else if($(self.selected_element).find('a').length){change_elem=$(self.selected_element).find('a')[0]}else{change_elem=self.selected_element}if($(change_elem).attr('href')&&href!==$(change_elem).attr('href')&&($(change_elem).attr('href').indexOf('popup:')===0||($(change_elem).attr('href').indexOf('#')===0&&$(change_elem).attr('href').length>1))){$(change_elem).attr('data-old-href',$(change_elem).attr('href'))}$(change_elem).attr('href',href);if(nofollow){$(change_elem).attr('rel','nofollow')}else{$(change_elem).removeAttr('rel')}if(target_blank){$(change_elem).attr('target','_blank')}else{$(change_elem).removeAttr('target')}}else{self.removeTextLinks();$(self.selected_element).attr('href',"");$(self.selected_element).find('a').attr('href',"")}$(self.selected_element).addClass('modified').addClass('modified-link');S3ContextMenuController.closeContextMenu()},removeTextLinks:function(){var self=this;$(self.selected_element).find('.link-wrap').each(function(i,e){if(!$(e).attr('href')){$(e).replaceWith($(e).html())}})},editBlockAnimateParams:function(elem){var self=this;var $popup=$('.lp-block-animate-popup');var animate=$(self.selected_element).find('[data-s3-animator]').attr('data-s3-animator');$popup.find('.settings-left-part select option').removeAttr('selected');$popup.find('.settings-right-part .s3-btn').removeClass('active');$popup.find('.settings-left-part select option').each(function(i,option){var value=$(option).attr('value');if(animate&&~animate.indexOf(value)){$popup.find('#animate_options').val(value);return false}});$popup.find('.settings-right-part .s3-btn').each(function(i,btn){var align=$(btn).attr('data-align');if(animate&&~animate.indexOf(align)){$(btn).addClass('active');return false}});$popup.find('select').trigger("chosen:updated").trigger("liszt:updated");S3ContextMenuController.openContextMenu(".lp-block-animate-popup",function(){self.initDrag($popup)},null,null,null,true,null,null,null,true)},updateAnimateEffect:function(){var self=this;var $row=$(self.selected_element).parents('.lp-row');var block_id=$row.attr('data-block-id');var old_animate=$(self.selected_element).find('[data-s3-animator]').attr('data-s3-animator');var $animate_block=$('.lp-block-animate-popup').find('.s3-lp-animate-settings-wrap');var value=$animate_block.find('select').val();var align='InUp';var animate='';var animate_elem=$(self.selected_element).find('[data-s3-animator]');if($animate_block.find('.s3-btn.active').length){align=$animate_block.find('.s3-btn.active').data('align')}if(value=="default"){animate=value}else{animate=value+align}animate_elem.data('s3Animator',animate);animate_elem.attr('data-s3-animator',animate);if(!animate_elem.attr('data-old-s3-animator')){animate_elem.attr('data-old-s3-animator',old_animate)}if(block_id&&typeof s3Animator!='undefined'&&typeof s3Animator.updateElements==='function'){$row.addClass('animate-row').css('overflow','hidden');$.each(s3Animator.elements,function(){if(this.$el.closest('[data-block-id="'+block_id+'"]').length){this.$el.removeClass(this.cls)}});s3Animator.updateElements();$.each(s3Animator.elements,function(){var $this=this;if($this.$el.closest('[data-block-id="'+block_id+'"]').length){$this.$el.addClass('s3-animator-hide');setTimeout(function(){$this.$el.removeClass('s3-animator-hide').addClass($this.cls)},100)}});setTimeout(function(){$row.addClass('animate-row').css('overflow','')},1000)}$(self.selected_element).data('animate',animate)},editBlockMainParams:function(block_id,block_layout_id,anchor_only,variant_id=null,variant_block_id=null){var self=this;if($('.modified').length){self.saveInlineParams(()=>{self._editBlockMainParams(block_id,block_layout_id,anchor_only,variant_id,variant_block_id)})}else{self._editBlockMainParams(block_id,block_layout_id,anchor_only,variant_id,variant_block_id)}},_editBlockMainParams:function(block_id,block_layout_id,anchor_only,variant_id=null,variant_block_id=null){if(!block_id||!block_layout_id){return false}var self=this;if(variant_id===null){variant_id=self.variant_id}var form=$(self.samples_wrapper).find('form#add_block_'+block_layout_id),block_id=parseInt(block_id),url='/-/cms/v1/lp/block/?act=edit&'+S3_ACCESS+'&object_id='+block_id+'&variant_id='+variant_id+'&anchor_only='+anchor_only,callback_done=false,callback=function(){if(!callback_done){callback_done=true;popupController.closeLastPopup();self.updateBlockHtml(block_id,block_layout_id)}};openAjaxForm(url,callback,function(){popupController.closeLastPopup()},function(){console.log('done')})},editBlockCssParams:function(elem){var self=this,block=$(elem).parents('[id^="_lp_block_"]'),block_id=parseInt(block.attr('id').replace('_lp_block_','')),layout_id=parseInt(block.attr('data-block-layout')),url='/-/cms/v1/lp/block/?act=edit_css&'+S3_ACCESS+'&block_id='+block_id+'&layout_id='+layout_id+'&variant_id='+self.variant_id,callback_done=false,callback=function(){if(!callback_done){callback_done=true;self.updateBlockHtml(block_id,layout_id)}};openAjaxForm(url,callback,callback)},saveBlockCssParams:function(css_block_selector,close,global_file,callback){var self=this,css_block=$(css_block_selector),block_id=css_block.attr('data-block-id')?parseInt(css_block.attr('data-block-id')):0,layout_id=css_block.attr('data-block-layout-id')?parseInt(css_block.attr('data-block-layout-id')):0,rnd=new Date().getTime(),path=global_file?'/-/cms/v1/lp/?act=save_css&':'/-/cms/v1/lp/block/?act=save_css&',url=path+S3_ACCESS+'&block_id='+block_id+'&layout_id='+layout_id+'&variant_id='+self.variant_id+'&rnd='+rnd,css_code={},css_settings={},prop,prop_key,prop_value,prop_setting,prop_alias,prop_subalias,prevent_saving=false;css_block.find('.css-prop-block').not('.disable').each(function(){prop_alias=$(this).attr('data-alias');css_code[prop_alias]={};$(this).find('.css-prop.enabled').each(function(){prop=$(this).attr('data-prop');if($(this).attr('data-subalias')){prop_subalias=$(this).attr('data-subalias');if(typeof css_code[prop_alias][prop_subalias]==="undefined"){css_code[prop_alias][prop_subalias]={}}css_code[prop_alias][prop_subalias][prop]={}}else{css_code[prop_alias][prop]={};prop_subalias=false}var prop_wrap=$(this);if(prop=='border_radius'&&$(this).find('.trigger-button').length){if($(this).find('.trigger-button').hasClass('active')){prop_wrap=$(this).find('.personal-type')}else{prop_wrap=$(this).find('.general-type')}}prop_wrap.find('.css-value').not('.disable').each(function(){prop_key=$(this).attr('data-prop-key');prop_value='';if($(this).is('input[type="checkbox"]')){if(prop_key=="attachment"){if($(this).prop('checked')==true){prop_value="fixed"}else{prop_value="scroll"}}else{prop_value=$(this).prop('checked')}}else if($(this).is('input[type="radio"]')){if($(this).attr('checked')=="checked"){prop_value=$(this).val()}if(prop_value=="gradient"){var gradient_parent=$(this).parents('.item.bg-type-wrapper'),gradient_start=gradient_parent.find('input[data-prop-key="start_color"]').val(),gradient_end=gradient_parent.find('input[data-prop-key="end_color"]').val();if(gradient_start!=""&&gradient_end==""){s3.alert(s3.loc('JS_LP_GRADIENT_FILL_END_ERROR'));prevent_saving=true}else if(gradient_start==""&&gradient_end!=""){s3.alert(s3.loc('JS_LP_GRADIENT_FILL_START_ERROR'));prevent_saving=true}}}else if($(this).is('.s3-btn')){if($(this).hasClass('selected')){prop_value=$(this).attr('data-prop-value')}else{if($(this).attr('data-prop-value')=='italic'){return true}prop_value=$(this).attr('data-prop-default-value')?$(this).attr('data-prop-default-value'):$(this).text().trim()}}else if($(this).is('.range-value')){prop_value=$(this).text()}else{prop_value=$(this).val();if($(this).is('.font-family-control')&&prop_value=='default'){prop_value=$(this).data('default-family')}}if(parseInt(prop_value)){if($(this).attr('min')){if(parseInt(prop_value)<parseInt($(this).attr('min'))){prop_value=$(this).attr('min')}}if($(this).attr('max')){if(parseInt(prop_value)>parseInt($(this).attr('max'))){prop_value=$(this).attr('max')}}}if(prop_value&&prop_value!='Нет'){var is_color=prop_key.match(/color/)&&prop_key!='color';if(prop_subalias){if(prop_key=='all'&&$(this).attr('data-prop-keys')){var keys=$(this).attr('data-prop-keys').split(",");keys.forEach(function(key,i){css_code[prop_alias][prop_subalias][prop][key.trim()]=prop_value})}else{css_code[prop_alias][prop_subalias][prop][prop_key]=prop_value}if(is_color){css_code[prop_alias][prop_subalias][prop][prop_key+'_hex']=self.convertRGBAtoHEX(prop_value)}}else{if(prop_key=='all'&&$(this).attr('data-prop-keys')){var keys=$(this).attr('data-prop-keys').split(",");keys.forEach(function(key){css_code[prop_alias][prop][key.trim()]=prop_value})}else{css_code[prop_alias][prop][prop_key]=prop_value}if(is_color){css_code[prop_alias][prop][prop_key+'_hex']=self.convertRGBAtoHEX(prop_value)}}}})});$(this).find('.css-prop.setting').each(function(){prop=$(this).attr('data-prop');$(this).find('.css-setting').each(function(){if($(this).is('input[type="checkbox"]')){prop_setting=$(this).prop('checked')}else if($(this).is('input[type="radio"]')){if($(this).is(':checked')){prop_setting=$(this).val()}}else{prop_setting=$(this).val()}css_settings[prop]=prop_setting})})});var default_font1='';var default_font2='';if(global_file&&css_block.find('.font-pairs input[name="activate_pair"]:checked')){var $inp=css_block.find('.font-pairs input[name="activate_pair"]:checked');default_font1=$inp.parents('.control-line').find('.pair-title').data('font-name');default_font2=$inp.parents('.control-line').find('.pair-text').data('font-name')}if(!prevent_saving){$.ajax({url:url,type:'POST',data:{"block_id":block_id,"layout_id":layout_id,"css_value":JSON.stringify(css_code),"css_settings":JSON.stringify(css_settings),"preset_id":self.preset_id,"default_font1":default_font1,"default_font2":default_font2},dataType:'json',async:false,success:function(data){if(close){if(popupController.getLastPopup()){popupController.closeLastPopup()}}else{util.msg(s3.loc('JS_SAVED'),'green')}if(global_file){self.reloadGlobalStyles()}else{self.reloadCustomStyles()}if(callback&&typeof callback==='function'){callback()}},error:function(e){console.log(e)}})}},saveBlockAnimateParams:function(element){var self=this;var $row=$(element).parents('.lp-row');var block_id=$row.attr('data-block-id');var layout_id=$row.attr('data-block-layout-id');var animate=$(element).data('animate');if($row.find('[data-s3-animator]').length){$row.find('[data-s3-animator]').attr('data-s3-animator',animate);$row.find('[data-s3-animator]').data('s3Animator',animate)}$.ajax({url:'/-/cms/v1/lp/block/?act=edit_animate&'+S3_ACCESS,type:'POST',data:{"block_id":block_id,"variant_id":self.variant_id,"layout_id":layout_id,"animate":animate},dataType:'json',async:false,success:function(data){},error:function(){console.log('Error saving animation settings')}})},toggleCssProp:function(elem){var condition=elem.prop('checked'),css_row=elem.parents('tr.css-prop'),css_value=elem.parents('td.name').next('td.value');if(condition){css_row.addClass('enabled');css_value.addClass('active')}else{css_row.removeClass('enabled');css_value.removeClass('active')}},toggleBackgroundType:function(elem){var bg_type=$(elem).val(),parent=$(elem).parents('.item.bg-type-wrapper');parent.find('.bg-type').removeClass('visible');parent.find('.bg-type.'+bg_type+'-color').addClass('visible');if($(elem).parents('.control-params').length){var change_elem=$('.panel-line.active').find('.panel-editable-element');if(bg_type=='gradient'){parent.find('.gradient-direction  select').change()}else{self.applyStyles(elem,change_elem,{'background':parent.find('.colorpicker-bg-component input').val()})}if($(elem).parents('.control-params').find('.hover-params').length&&$(elem).parents('.control-params').find('.active-params').length){$(elem).parents('.control-params').find('.hover-params .select-bg-type select').val(bg_type);$(elem).parents('.control-params').find('.active-params .select-bg-type select').val(bg_type)}}},convertRGBAtoHEX:function(rgba){if(!rgba){return false}rgba=rgba.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return(rgba&&rgba.length===4)?"#"+("0"+parseInt(rgba[1],10).toString(16)).slice(-2)+("0"+parseInt(rgba[2],10).toString(16)).slice(-2)+("0"+parseInt(rgba[3],10).toString(16)).slice(-2):''},switchLayout:function(block_id,block_layout_id,block_editing){if(!block_id||!block_layout_id){return false}var self=this,form=$(self.site_wrapper).find('form#edit_block_'+block_id).first(),block_row=$(self.site_wrapper).find('.lp-row[data-block-id="'+block_id+'"]');if(block_editing){form.attr('data-main-params',block_id)}form.attr('data-prev-theme',form.find('input[name="layout_id"]').val());form.attr('data-switch-theme',block_id).find('input[name="layout_id"]').val(block_layout_id);form.find('input[name="object_id"]').val(block_id);form.submit()},listLayout:function(elem,direction){if(!elem||!direction){return false}var block=$(elem).parents('[id^="_lp_block_"]'),block_id=parseInt(block.attr('id').replace('_lp_block_','')),context_menu=block.find('.context-menu.select-theme-'+block_id),active_theme=context_menu.find('li.active'),first_theme=context_menu.find('li:first').find('.theme-switcher'),last_theme=context_menu.find('li:last').find('.theme-switcher'),prev_theme=active_theme.prev('li').find('.theme-switcher'),next_theme=active_theme.next('li').find('.theme-switcher');if(direction=="left"){if(prev_theme.size()){prev_theme.click()}else{last_theme.click()}}else if(direction=="right"){if(next_theme.size()){next_theme.click()}else{first_theme.trigger('click')}}},invertBlockColor:function(button){if(!button){return false}var self=this,block=$(button).parents('[id^="_lp_block_"]'),block_id=parseInt(block.attr('id').replace('_lp_block_','')),url='/-/cms/v1/lp/block/?act=invert_color&'+S3_ACCESS;$.ajax({url:url,type:'POST',data:{"block_id":block_id,"variant_id":self.variant_id},dataType:'json',async:false,success:function(inverse){block.toggleClass('inverse').attr('data-inverse',inverse).parent(self.row).find('.inverse-layout .lp-ico.i-inverse').toggleClass('true')},error:function(e){console.log(e)}})},triggerBlockVisibility:function(button){if(!button){return false}const $parent=$(button).parents('.lp-row'),variant_id=parseInt($parent.attr(`data-variant-id`)),block_id=parseInt($parent.attr(`data-block-id`)),variant_block_id=$parent.attr(`data-variant-block-id`),self=this,block=$(button).parents('[id^="_lp_block_"]'),url='/-/cms/v1/lp/block/?act=visibility&'+S3_ACCESS,block_row=block.parent(self.row),block_visibility=parseInt(block_row.attr('data-hidden')),object_id=variant_id?block_id:variant_block_id;if(!object_id){return}$.ajax({url:url,type:'POST',data:{"object_id":object_id,"block_variant_id":variant_id,"variant_id":self.variant_id,"visibility":block_visibility,},dataType:'json',success:function(visibility){block_row.toggleClass('hidden');block_row.attr('data-hidden',visibility);if(visibility){button.find('.s3-ico').removeClass('i-eyehide-svg').addClass('i-eyeshow-svg');button.find('.s3-btn-title').text(s3.loc('LP_SHOW_BLOCK'))}else{button.find('.s3-ico').removeClass('i-eyeshow-svg').addClass('i-eyehide-svg');button.find('.s3-btn-title').text(s3.loc('LP_HIDE_BLOCK'))}self.updateBlockMenus()},error:function(e){console.log(e)}})},triggerBlockLocking:function(button){if(!button){return false}const $parent=$(button).parents('.lp-row'),variant_id=parseInt($parent.attr(`data-variant-id`)),variant_block_id=parseInt($parent.attr(`data-variant-block-id`)),block_id=parseInt($parent.attr(`data-block-id`)),object_id=variant_id?block_id:variant_block_id;var self=this,block=$(button).parents('[id^="_lp_block_"]'),url='/-/cms/v1/lp/block/?act=locking&'+S3_ACCESS;var block_row=block.parent(self.row),block_locking=parseInt(block_row.attr('data-locked'));$.ajax({url:url,type:'POST',data:{"object_id":object_id,"block_variant_id":variant_id,"variant_id":self.variant_id,"locked":block_locking},dataType:'json',success:function(locked){block_row.toggleClass('locked');block_row.attr('data-locked',locked);if(locked){button.find('.s3-ico').removeClass('i-folder-lock-svg').addClass('i-folder-unlock-svg');button.find('.s3-btn-title').text(s3.loc('JS_LP_UNLOCK_BLOCK'))}else{button.find('.s3-ico').removeClass('i-folder-unlock-svg').addClass('i-folder-lock-svg');button.find('.s3-btn-title').text(s3.loc('LOCK'))}},error:function(e){console.log(e)}})},uploadLayoutPreview:function(object_id){const popup=new PopupWindow('layoutUploadPreview');popup.center=true;popup.modal=true;popupController.showPopup(popup);$(popup.obj).find('input[name="layout_id"]').val(object_id);if(!$(popup.obj).data('uploader-init')){this.layoutUploadPreviewInit('#layoutUploadPreview')}},uploadLayoutPreviewClose:function(){popupController.closeLastPopup();s3.reloadContent();util.msg(s3.loc('JS_DONE'))},toggleLayoutTemplate:function(context,event){$(context).parent().find('.layout-item__tab-content--global').toggle();$(context).parent().find('.layout-item__tab-content--local').toggle()},closePreviewUpload:function(){var self=this;self.uploadPreviewForm.hide()},updateLayoutPreview:function(object_id,hideConfirm){var self=this,layout_id=parseInt(object_id),url;if(!layout_id){return false}url='/-/cms/v1/lp/block/layout/?act=update_preview&'+S3_ACCESS+'&layout_id='+layout_id;var renderPreview=function(){$("body").append('<iframe style="border: none; width: 100%; height: 0; overflow: hidden;" id="layout_preview"></iframe>');$('#layout_preview').on('load',function(){self.layout_preview=$(this)});$('#layout_preview').attr('src',url)};if(hideConfirm){renderPreview()}else{s3.confirmGreen(s3.loc('JS_LP_CONFIRM_PREVIEW_UPDATE'),renderPreview)}},convertHtml2canvas:function(layouts,layout_id,index,preview_images){var self=this,preview_layouts=layouts.find('.layout-preview'),lang_code=[];if(!index){preview_images={};index=0}preview_layouts.each(function(){lang_code.push($(this).attr('data-lang-code'))});setTimeout(function(){html2canvas(preview_layouts[index],{onrendered:function(canvas){if(lang_code[index]){preview_images[lang_code[index]]=canvas.toDataURL("image/png");index++;if(index<preview_layouts.size()){self.convertHtml2canvas(layouts,layout_id,index,preview_images)}else{window.parent.LpController.saveLayoutPreview(preview_images,layout_id)}}}})},50)},saveLayoutPreview:function(preview_images,layout_id,isMosaic){var self=this,url='/-/cms/v1/lp/block/layout/?act=save_preview&'+S3_ACCESS;if(!isMosaic){self.layout_preview.remove()}$.ajax({url:url,type:'POST',dataType:'json',data:{'previews':preview_images,'layout_id':layout_id},async:true,success:function(data){var preview_image_path=data.result,preview_container=$('.layout-preview[data-layout-id="'+layout_id+'"]');preview_container.attr('src',preview_image_path);preview_container.closest('.image-container').removeClass('nophoto');util.msg(s3.loc('JS_DONE'));popupController.closeLastPopup();s3.reloadVisibleContent();self.updatePreviewsFolderMosaic()},error:function(){console.log('When updating the error occurred')}})},blockScriptReinit:function(block_html){if(lp_init&&$.isFunction(lp_init)){lp_init(block_html)}},showBlockMore:function(elem,block_id){var self=this;var $more=$('[id="_lp_block_'+block_id+'"] .more-params');var $row=$(elem).parents('.lp-row');var block_controls=$row.find('.site-controls');$('.site-controls').removeClass('show');block_controls.addClass('show');S3ContextMenuController.openContextMenu($more,function(){if($row.height()<250&&$row.index()===$('.lp-row').length){window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})}},null,null,null,null,null,function(){block_controls.removeClass('show')})},setControlsContext:function(block,block_id,json_id){if(!block||!block_id){return false}var self=this,block_id=parseInt(block_id),block_layout_id=parseInt(block.attr('data-block-layout')),$parent=block.parent(self.row),block_name=$parent.attr('data-name'),block_meta_id=$parent.attr('data-meta-id'),anchor_attr=$parent.attr('data-anchor-link'),parent_id=$parent.attr('data-parent-id'),library_id=parseInt($parent.attr('data-library-id'),10),folder_id=parseInt($parent.attr('data-folder-id'),10),block_anchor=anchor_attr?anchor_attr.replace(self.blocks_anchor_prefix,''):'',block_hidden=parseInt($parent.attr('data-hidden')),block_locked=parseInt($parent.attr('data-locked')),layouts_count=0,block_controls=block.find('.site-controls'),block_inversed=parseInt($parent.attr('data-inverse')),block_layouts,layouts_list,data_type_code,type_group_id,plugin_id;const variant_id=parseInt($parent.attr('data-variant-id')),variant_block_id=$parent.attr('data-variant-block-id'),isThrough=!!variant_block_id;if(!block.parent('.lp-row').attr('data-has-params')){block_controls.find('.edit-layout-settings').remove()}else{block_controls.find('.edit-layout-settings').attr('onclick',`LpController.editBlockMainParams(${block_id},${block_layout_id},0,${variant_id},${variant_block_id});`)}if(!isThrough){block_controls.find('.through-block-control').attr('onclick',`LpController.openSetBlockThrough(${block_id},${block_layout_id},0)`);block_controls.find('.through-block-control').find('.s3-btn-title').text(s3.loc('JS_LP_THROUGH_PIN_BUTTON'))}else{block_controls.find('.through-block-control').attr('onclick',`LpController.unpinThroughBlock(${variant_block_id})`);block_controls.find('.through-block-control').find('.s3-btn-title').text(s3.loc('JS_LP_THROUGH_UNPIN_BUTTON'))}if(self.hasVisibleDataInMeta(block_id)){block_controls.find('.edit-layout').show()}else{block_controls.find('.edit-layout').hide()}if(library_id&&(self.can_edit_lp_mosaic||self.can_edit_lp_mosaic_global)&&self.new_presets.includes(self.preset_id)){block_controls.find('.edit-mosaic-block').attr('onclick','LpController.openIframeMosaic('+folder_id+','+library_id+','+block_layout_id+', "'+block_name+'", '+parent_id+' )')}else{block_controls.find('.edit-mosaic-block').remove()}block_controls.find('.more-block').attr('onclick','LpController.showBlockMore(this, '+block_id+')');block_controls.find('.row-layout-id span').text('# '+block_layout_id);block_controls.find('.copy-block-anchor').attr('data-clipboard-text',self.blocks_anchor_prefix+block_anchor).attr('data-clipboard-success-text',JS_COPIED);if(self.content_lp==true||self.preset_id===1461){block_controls.find('.inverse-control').remove()}if(!isThrough){block_controls.find('.edit-through-block').hide()}block_layouts=self.lp_donor_blocks;for(var i in block_layouts){if(block_layouts.hasOwnProperty(i)&&block_layouts[i]['meta_id']==block_meta_id&&block_layouts[i]['preset_id']==self.preset_id){layouts_count++}}if(layouts_count<=1){block.find('.layout-control').remove();data_type_code=(block_layouts[block_layout_id]['global_template']==1)?'json_meta_global':'json_meta';type_group_id=block_layouts[block_layout_id]['meta_id'];plugin_id=0;if(json_id&&json_id!=''){block_controls.find('.edit-layout').attr('onclick','LpController.openDataNavigator(\''+json_id+'\',\''+block_name+'\','+type_group_id+',function(){LpController.updateBlockHtml('+block_id+','+block_layout_id+')}'+');')}}else{layouts_list='<div class="context-menu select-theme-'+block_id+'" data-width="200">';for(var key in block_layouts){if(block_layouts[key]['preset_id']==self.preset_id){type_group_id=block_layouts[key]['type_group_id'];plugin_id=0;data_type_code=(block_layouts[key]['global_template']==1)?'json_meta_global':'json_meta';if(json_id&&json_id!=''){block.find('.site-controls .edit-layout').attr('onclick','LpController.openDataNavigator(\''+json_id+'\',\''+block_name+'\','+type_group_id+','+'function(){LpController.updateBlockHtml('+block_id+','+block_layout_id+')}'+');')}if(block_layout_id==key){layouts_list+='<li class="active"><span class="span-name theme-switcher active">'+block_layouts[key]['layout_name']+'</span></li>'}else if(block_layouts[key]['meta_id']==block_meta_id){layouts_list+='<li><span class="span-name theme-switcher" onclick="LpController.switchLayout('+block_id+','+key+');">'+block_layouts[key]['layout_name']+'</span></li>'}}}layouts_list+='</div>';block_controls.find('.select-theme').attr('onclick','S3ContextMenuController.openContextMenu(".select-theme-'+block_id+'")',null,null,null,null,null,null,null,null,true).after(layouts_list)}block_controls.find('.block-add-after').attr('onclick','LpController.insertBlock(event,'+block_id+', \'after\')');block_controls.find('.delete-block').attr('onclick','LpController.deleteBlock($(this))');if(block_hidden){block_controls.find('.hide-block').find('.s3-ico').removeClass('i-eyehide-svg').addClass('i-eyeshow-svg');block_controls.find('.hide-block').find('.s3-btn-title').text(s3.loc('LP_SHOW_BLOCK'))}else{block_controls.find('.hide-block').find('.s3-ico').removeClass('i-eyeshow-svg').addClass('i-eyehide-svg');block_controls.find('.hide-block').find('.s3-btn-title').text(s3.loc('LP_HIDE_BLOCK'))}if(!self.lp_feature_access){$(self.block_css_controls).find('.indents-control').remove()}if(block_locked){block_controls.find('.lock-block').find('.s3-ico').removeClass('i-folder-lock-svg').addClass('i-folder-unlock-svg');block_controls.find('.lock-block').find('.s3-btn-title').text(s3.loc('JS_LP_UNLOCK_BLOCK'));if(!self.lp_feature_access){block_controls.find('.edit-layout').remove();block_controls.find('.delete-block').remove();block_controls.find('.hide-block').remove();block_controls.find('.duplicate-block').remove()}}else{block_controls.find('.lock-block').find('.s3-btn-title').text(s3.loc('LOCK'));block_controls.find('.lock-block').find('.s3-ico').removeClass('i-folder-unlock-svg').addClass('i-folder-lock-svg')}block_controls.find('.duplicate-block').attr('onclick',`LpController.createBlockCopy(this)`);if(block_inversed){block_controls.find('.inverse-layout .lp-ico.i-inverse').addClass('true')}else{block_controls.find('.inverse-layout .lp-ico.i-inverse').removeClass('true')}if(!self.lp_feature_access){block_controls.find('.edit-layout-css').remove()}block_controls.S3ChangeControls();Preloader.hide();return true},hasVisibleDataInMeta:function(block_id){var self=this;var has_visible=false;const key=block_id;if(self.lp_blocks.hasOwnProperty(key)&&self.lp_blocks[key].hasOwnProperty('data_json')){var meta=JSON.parse(self.lp_blocks[key]['data_json']);for(var item in meta){if(meta.hasOwnProperty(item)&&meta[item].hasOwnProperty('type')&&meta[item]['type']!=="hidden"&&!meta[item].hasOwnProperty('hidden_field')){has_visible=true;break}}}return has_visible},deleteBlock:function(block_id,position,animation,fake_delete,callback){let block_variant_id,selector;if(typeof block_id=='object'){const $block=block_id,$parent=$block.closest(".lp-row");block_id=parseInt($parent.attr('data-block-id'));block_variant_id=parseInt($parent.attr('data-variant-id'));const variant_block_id=parseInt($parent.attr('data-variant-block-id'));if(!block_variant_id){selector=`.lp-row[data-block-id="${block_id}"][data-variant-block-id="${variant_block_id}"]`}}if(!block_id){return false}if(!selector){selector=`.lp-row[data-block-id="${block_id}"]`}var self=this,url='/-/cms/v1/lp/block/?act=delete&'+S3_ACCESS,block=$(selector).find('#_lp_block_'+block_id);block_id=parseInt(block_id);block_variant_id=parseInt(block_variant_id);if(!animation){animation='slideup'}if(fake_delete){block.fadeOut(200,function(){delete_callback()})}else{url+=`&variant_id=${self.variant_id}&block_variant_id=${block_variant_id}`;if(block_variant_id){url+=`&object_id=${block_id}`}else{const variant_block_id=parseInt(block.parent().attr(`data-variant-block-id`));if(!variant_block_id){throw`Invalid variant_block_id`}url+=`&object_id=${variant_block_id}`}s3.confirm(s3.loc('JS_LP_BLOCK_CONFIRM_DELETE'),function(){$.ajax({url:url,type:'POST',dataType:'json',async:false,success:function(data){popupController.closeLastPopup();if(animation=="slideup"){block.animate({'height':0,'opacity':0,},200,function(){block.parent('.lp-row').remove();block.find(`form[data-block-id]`).remove();delete_callback()})}else if(animation=="fadeout"){block.fadeOut(200,function(){delete_callback()})}self.updateBlockMenus()},error:function(e){console.log(e)}})})}function delete_callback(){block.remove();if(!$(self.row).length){self.showAddButton()}if(self.content_lp){self.deleted_block_id=block_id}if(typeof callback=='function'){callback()}}},moveBlock:function(elem,direction){if(!elem||!direction){return false}var self=this,block=$(elem).parents('[id^="_lp_block_"]'),block_index=parseInt(block.attr('data-block-index')),block_box=block.parent('.lp-row'),prev_index=block_index-1,next_index=block_index+1,prev_block=$(self.site_wrapper).find('[id^="_lp_block_"][data-block-index="'+prev_index+'"]').parent('.lp-row'),next_block=$(self.site_wrapper).find('[id^="_lp_block_"][data-block-index="'+next_index+'"]').parent('.lp-row');if(direction=="up"){if(prev_block){self.swapBlocks(block_box,prev_block,'up')}}else if(direction=="down"){if(next_block){self.swapBlocks(block_box,next_block,'down')}}},swapBlocks:function(block,target,direction){if(!block.size()||!target.size()){return false}var self=this,block_height=block.height(),target_height=target.height(),block_position=block.position().top,target_position=target.position().top,block_ghost=$('<div id="block-ghost"></div>'),target_ghost=$('<div id="target-ghost"></div>'),win_scroll=$(window).scrollTop(),block_new_position,target_new_position,scroll_time=300,scroll_to;block_ghost.height(block_height);target_ghost.height(target_height);block.addClass('swaping focus').css('top',block_position).before(block_ghost);target.addClass('swaping').css('top',target_position).before(target_ghost);if(direction=="up"){block_new_position=block_position-target_height;target_new_position=target_position+block_height;scroll_to=win_scroll-target_height}else if(direction=="down"){block_new_position=block_position+target_height;target_new_position=target_position-block_height;scroll_to=win_scroll+target_height}if(block_height>900||target_height>900){scroll_time*=2}block.animate({'top':block_new_position},scroll_time,function(){if(direction=="up"){target.insertAfter(block)}else if(direction=="down"){target.insertBefore(block)}self.blocksReorder();block.removeAttr('style').removeClass('swaping focus');block_ghost.remove()});self.scrollToBlock(scroll_to,block);target.animate({'top':target_new_position},scroll_time,function(){target.removeAttr('style').removeClass('swaping');target_ghost.remove()})},blocksReorder:function(){var self=this,url='/-/cms/v1/lp/?act=reorder_items&'+S3_ACCESS+'&variant_id='+self.variant_id,data=[],block_id;$(self.site_wrapper).find('[id^="_lp_block_"]').each(function(index){const $this=$(this),$parent=$this.parents('.lp-row');$this.attr('data-block-index',index);const variant_id=parseInt($parent.attr('data-variant-id')),attr=variant_id===0?`data-variant-block-id`:`data-block-id`,attr_value=$parent.attr(attr),id=parseInt(attr_value);data.push({id,variant_id});$this.find('form').each(function(){$(this).attr('title',s3.loc('JS_LP_FORM_NOTE')).tooltip();$(this).find('input[type="submit"], button[type="submit"]').on('click',function(){return false})})});$.ajax({url:url,data:{"blocks":data},type:'POST',dataType:'json',success:function(){},error:function(e){console.log(e)}})},lpBlocksRecreate:function(preset_id,preset_ver_id){var self=this,url='/-/cms/v1/lp/?act=recreate_blocks&'+S3_ACCESS+'&preset_id='+preset_id+'&preset_ver_id='+preset_ver_id;Preloader.show({mini:true});$.ajax({url:url,type:'post',dataType:'json',success:function(){Preloader.hide();util.msg(JS_RELOADED,'green');popupController.reloadPreviousPopup()},error:function(){s3.alert(JS_ERROR+' code: 2')}})},closePopupForm:function(){$('.lp-popup-dimming').fadeOut()},toggleOverlay:function(command){var self=this;if(command!='show'&&command!='hide'){return false}switch(command){case'show':$(self.lp_overlay).removeClass('hidden');break;case'hide':$(self.lp_overlay).addClass('hidden');break}},scrollToBlock:function(coord_y,block){var coord_y=parseInt(coord_y),scroll_time=300,win_scroll=$(window).scrollTop(),win_height=$(window).height(),fits_in_win=false;if(coord_y-$(window).scrollTop()>900){scroll_time*=1.5}if(coord_y>win_scroll&&coord_y+block.height()<win_scroll+win_height){fits_in_win=true}if((coord_y<win_scroll||coord_y>win_scroll+win_height||coord_y<win_scroll+win_height)&&!fits_in_win){$("html, body").animate({scrollTop:coord_y},scroll_time)}},openDataNavigator:function(json_id,title,type_group_id,callback){var self=this;if($('.modified').length){self.saveInlineParams(()=>{self._openDataNavigator(json_id,title,type_group_id,callback)})}else{self._openDataNavigator(json_id,title,type_group_id,callback)}},_openDataNavigator:function(json_id,title,type_group_id,callback){var act='edit';var controller='';var self=this;var submit_func=function(){popupController.closeLastPopup()},close_func=false;if(typeof callback=="function"){close_func=callback}if(type_group_id>0){act='editItem'}if(act==='editItem'){controller='/-/cms/v1/json/'}else{controller='/-/cms/v1/json-meta/'}var url=controller+'?act='+act+'&lp_variant_id='+self.variant_id+'&object_id='+json_id+'&'+S3_ACCESS+'&title='+encodeURIComponent(title)+'&type_group_id='+type_group_id;openAjaxForm(url,submit_func,close_func)},openLinkEventBlocks:function(el){var self=this;var type=$(el).attr('data-type');var submit_func=function(){popupController.closeLastPopup()},close_func=false;if(typeof callback=="function"){close_func=callback}popupController.closeLastPopup();var url='/-/cms/v1/lp/?act=event_blocks&'+S3_ACCESS+'&type='+type+'&object_id='+self.lp_id+'&variant_id='+self.variant_id;openAjaxForm(url,submit_func,close_func)},openSettings:function(plugin_id,object_id,title,type_group_id,page_id,first_opening,callback){var submit_func=function(){popupController.closeLastPopup()},close_func=false;if(typeof callback=="function"){close_func=callback}var active_tab=first_opening?'&tab=page_settings':'';var url='/-/cms/v1/lp/?act=edit_group_item&object_id='+object_id+'&page_id='+page_id+'&hide_save_button=1&first_opening='+first_opening+active_tab+'&'+S3_ACCESS+'&title='+encodeURIComponent(title)+'&type_group_id='+type_group_id;openAjaxForm(url,submit_func,close_func)},updateLocation:function(){var new_href=location.href.replace("&first_opening=1",'');location.href=new_href},inlineUpdateImage:function(){var self=this;var func=function(r,selected_obj){var image_ver_id=parseInt($(selected_obj).attr('data-ver-id'));var global=(image_ver_id==1?1:0);var rnd=new Date().getTime();var size_key=$(self.selected_element).attr('data-size-path')?$(self.selected_element).attr('data-size-path'):$(self.selected_element).attr('data-path');var image_info=$.parseJSON(util.makeGetRequest('/-/cms/v1/image/?act=control&'+access+'&rnd='+rnd+'&object_id='+r+'&control_id=2&global='+global).text);var old_html;var new_image_data={image_id:r,filename:image_info.filename,ver_id:image_ver_id,svg_body:self.parseSvgBody(image_info.svg_body),image_width:image_info.width,image_height:image_info.height,ext:image_info.ext};var image_path="/d/"+image_info.filename.trim();var $row=$(self.selected_element).parents('.lp-row');var block_id=$row.attr('data-block-id');old_html=self.selected_element.outerHTML;$(self.selected_element).html("<img src='"+image_path+"'>");self.initCssParamsKeys(block_id,self.selected_element_class);var convertElemImg=function(){var img_src=$(self.selected_element).find('img').attr('src');if(!window.img_convert_cache.hasOwnProperty(img_src))window.img_convert_cache[img_src]={};self.convertImg(window.img_convert_cache[img_src],$(self.selected_element).find('img'))};setTimeout(convertElemImg,200);setTimeout(convertElemImg,1000);if(!$(self.selected_element).data('old_img')){$(self.selected_element).data('old_img',old_html)}if($(self.selected_element).attr('data-slide-item')){var item=$(self.selected_element).attr('data-slide-item');var $mini_pic=$row.find('[data-slide-item="'+item+'"]').not($(self.selected_element));if($mini_pic.length){if(!$mini_pic.data('old_img')){$mini_pic.data('old_img',$mini_pic[0].outerHTML)}$mini_pic.html("<img src='"+image_path+"'>")}}self.setModified();self.updateMediaData($(self.selected_element),$(self.selected_element).attr('data-path'),new_image_data);popupController.closeLastPopup()};let extra="";if($(self.selected_element).find('img').get(0)){const src=$(self.selected_element).find('img').attr('src');if(src&&src.length){const filename=src.split('/').slice(-1).toString();extra+='file_name='+filename}}selector.open('image',0,0,self.selected_element,func,extra)},convertImages:function($container){var self=this;if(!window.hasOwnProperty('img_convert_cache')){window.img_convert_cache={}}$container.find('._lp-image-container').each(function(){var $img=$(this).find('img');if($img.length){var img_src=$img.attr('src');if(!window.img_convert_cache.hasOwnProperty(img_src))window.img_convert_cache[img_src]={};self.convertImg(window.img_convert_cache[img_src],$img)}})},convertImg:function(cache_img,$img){var self=this;$img.css({"max-width":"100%","max-height":"100%"});if(!$img.parent().hasClass('lp-img-contain')){var img_width,img_height;if(!cache_img.hasOwnProperty('width')||!cache_img.hasOwnProperty('height')){if($img.is('svg')||($img.attr('src')&&$img.attr('src').slice(-3)=='svg')){img_width=$img.parent().width();img_height=$img.parent().height()}else{img_width=$img[0].naturalWidth;img_height=$img[0].naturalHeight}}else{img_width=cache_img.width;img_height=cache_img.height}self.setImgStyles($img,img_width,img_height,null)}},setImgStyles:function($img,img_width,img_height,svg){var self=this;var $wrap=$img.parent();var $row=$(self.selected_element).parents('.lp-row');var block_id=$row.attr('data-block-id');var wrap_width=parseInt($wrap.width()),wrap_height=parseInt($wrap.height()),wrap_prop=wrap_width/wrap_height;var min_width=wrap_height/img_height*img_width;if(img_width&&img_height){var img_prop=img_width/img_height;if(wrap_prop>img_prop){img_width=img_width>wrap_width?wrap_width:img_width;img_height="auto";$img.css({"max-width":"100%","width":img_width,"min-width":"0","max-height":"none","height":img_height})}else{img_height=img_height>wrap_height?wrap_height:img_height;$img.css({"max-width":"none","width":"auto","min-width":min_width>img_width?img_width:min_width,"max-height":"100%","height":img_height});if(svg){$img.css('min-height','100%')}}}},parseSvgBody:function(svg_body){if(svg_body&&typeof svg_body==='string'&&$(svg_body).find('mask').length){var mask_id=$(svg_body).find('mask').attr('id');if(mask_id){var new_id=`mask_id_${(+new Date).toString(16)}`;$(svg_body).find('mask').attr('id',new_id);var new_html=$(svg_body)[0].outerHTML;svg_body=new_html.replace(new RegExp(mask_id,'g'),new_id)}}return svg_body},changeVideoType:function(select){const self=this;const selectVal=$(select).val();const $popup=$(select).parents('.context-popup');if(selectVal===self.CUSTOM_VIDEO_TYPE){$popup.find('.custom_video-type').show();$popup.find('.iframe_video-type').hide()}else{$popup.find('.custom_video-type').hide();$popup.find('.iframe_video-type').show()}},editElemVideoParams:function(elem){LpController.notApplyPopupParams=true;const self=this;const $popup=$('.lp-elem-video-popup');const videoType=$(self.selected_element).attr('data-video-type');const $select=$popup.find('.background-types-select select');const $autoplay=+$(self.selected_element).attr('data-video-autoplay');const $controls=+$(self.selected_element).attr('data-video-controls');const $videoId=$(self.selected_element).attr('data-video-id');const $loop=+$(self.selected_element).attr('data-video-loop');const $video=$(self.selected_element).attr('data-video-filename');let video_html='';if(!!$controls){$popup.find('input.show_panel').prop('checked',true).attr('checked','checked').parent().addClass('active')}else{$popup.find('input.show_panel').prop('checked',false).removeAttr('checked').parent().removeClass('active')}if(!!$loop){$popup.find('input.repeat').prop('checked',true).attr('checked','checked').parent().addClass('active')}else{$popup.find('input.repeat').prop('checked',false).removeAttr('checked').parent().removeClass('active')}if(!!$autoplay){$popup.find('input.autoplay').prop('checked',true).attr('checked','checked').parent().addClass('active')}else{$popup.find('input.autoplay').prop('checked',false).removeAttr('checked').parent().removeClass('active')}if($video){$popup.find('.no-video').hide();$popup.find('.has-video').show();video_html=`<video type="video/mp4"><source src="${$video}"></video>`}else{$popup.find('.no-video').show();$popup.find('.has-video').hide();video_html="<img class=\"s3ImageMakerObj\" src=\"/my/s3/images/svg_icons/lp/oah-player2.svg\" width=\"64\"/>"}if(videoType===self.CUSTOM_VIDEO_TYPE){$popup.find('.custom_video-type').show();$popup.find('.iframe_video-type').hide()}else{$popup.find('.custom_video-type').hide();$popup.find('.iframe_video-type').show()}$popup.find('.video-change-wrap').html(video_html);$popup.find('input.video-id').val($videoId??'');$select.val(videoType);$select.trigger("chosen:updated").trigger("liszt:updated");S3ContextMenuController.openContextMenu('.lp-elem-video-popup',function(){self.initDrag($popup)},null,null,null,null,null,null,null,true);LpController.notApplyPopupParams=false},changeBackgroundType:function(select){var self=this;var $popup=$(select).parents('.context-popup');var val=$(select).val();var image_elem=$(self.selected_element).find('.lp-block-bg').length?$(self.selected_element).find('.lp-block-bg'):$(self.selected_element);$(self.selected_element).find('._lp-video').html("");$popup.find('.video-change-wrap').html("<img class=\"s3ImageMakerObj\" src=\"/my/s3/images/svg_icons/lp/oah-player2.svg\" width=\"64\"/>");$popup.find('.background-type').hide();$popup.find('.'+val+'-type').show()},inlineUpdateVideo:function(elem,is_block){const self=this;const $popup=$(elem).parents('.context-popup');const func=function(r,obj){const filename=util.makeGetRequest('/-/cms/v1/media/?act=control&'+access+'&object_id='+r+'&control_id=2').text;const $video_wrapper=$(self.selected_element).is('._lp-video')?$(self.selected_element):$(self.selected_element).find('._lp-video');if($(self.selected_element).find('iframe').length&&!$(self.selected_element).data('youtube_video')){$(self.selected_element).data('youtube_video',$(self.selected_element).find('iframe')[0].outerHTML)}else if($(self.selected_element).find('video').length&&!$(self.selected_element).data('custom_video')){$(self.selected_element).data('custom_video',$(self.selected_element).find('video')[0].outerHTML)}const attrs=is_block?'autoplay="autoplay" loop="loop" muted="muted"':'';$popup.find('.no-video').hide();$popup.find('.has-video').show();$video_wrapper.html('<video type="video/mp4" '+attrs+'><source src="'+filename+'"></video>');$popup.find('.video-change-wrap').html('<video type="video/mp4"><source src="'+filename+'"></video>');popupController.closeLastPopup()};selector.open('media',0,0,self.selected_element,func)},addJsonMetaToList:function(json_id,block_id){var self=this,json_id=parseInt(json_id),block_id=parseInt(block_id),url='/my/s3/cms/v1/lp_block/json/add.item.to.list.php?'+S3_ACCESS;if(!json_id||!block_id){return false}$.ajax({url:url,data:{'json_id':json_id,'block_id':block_id,'variant_id':self.variant_id},type:'post',dataType:'json',success:function(){util.msg(s3.loc('JS_ADDED'),'green');popupController.reloadPreviousPopup()},error:function(){s3.alert(s3.loc('JS_ERROR')+' code: 2')}})},openJsonSelectorList:function(meta_id,block_id){var meta_id=parseInt(meta_id),rnd=new Date().getTime();if(!meta_id){return false}var url='/my/s3/cms/v1/lp_block/json/list.php?'+S3_ACCESS+'&meta_id='+meta_id+'&block_id='+block_id+'&rnd='+rnd;openAjaxForm(url,false,false,false)},deleteJsonMetaFromList:function(meta_id,block_id){var self=this,meta_id=parseInt(meta_id),block_id=parseInt(block_id),url='/my/s3/cms/v1/lp_block/json/delete.item.from.list.php?'+S3_ACCESS;if(!meta_id||!block_id){return false}s3.confirm(s3.loc('JS_CONFIRM_DELETE'),function(){$.ajax({url:url,data:{'meta_id':meta_id,'block_id':block_id,'variant_id':self.variant_id},type:'post',dataType:'json',success:function(data){popupController.closeLastPopup();s3.reloadVisibleContent()},error:function(){s3.alert(s3.loc('JS_ERROR')+' code: 2')}})})},presetSelectDefaultBlock:function(elem,container,layout_id,layout_name){var self=this,layout_item='<li class="box" data-layout-id="'+layout_id+'"><span class="handle"></span><span class="title"><span class="name">'+layout_name+'</span></span><span class="remove" onclick="LpController.deleteLayoutFromPreset($(this));"><span class="s3-ico i-delete-svg"></span></span></li>',form=container.closest('form');if(elem.prop('checked')==false){container.find('li[data-layout-id="'+layout_id+'"]').remove()}else{container.append(layout_item)}self.updatePresetDefaultBlocks(form)},presetOpenSelectDefaultBlocks:function(elem,object_id,global,object_index){var preset_id=parseInt(object_id),preset_variant=parseInt(object_index),container=elem.closest('ul'),selected_ids="",layout_id,url="/-/cms/v1/lp/preset/?act=select_default_blocks&"+S3_ACCESS+"&preset_id="+preset_id+"&preset_variant="+preset_variant+'&global='+global;container.find('li:not(.controls)').each(function(){layout_id=parseInt($(this).attr('data-layout-id'));if(selected_ids==""){selected_ids=layout_id}else{selected_ids+=","+layout_id}});url+="&selected_ids="+selected_ids;openAjaxForm(url)},presetOpenSelectNewBlocks:function(elem,object_id,global,object_index){var preset_id=parseInt(object_id),preset_variant=parseInt(object_index),container=elem.closest('ul'),selected_ids="",layout_id,url="/-/cms/v1/lp/preset/?act=select_default_blocks&"+S3_ACCESS+"&preset_id="+preset_id+"&preset_variant="+preset_variant+'&global='+global+'&select_new=1';container.find('li:not(.controls)').each(function(){layout_id=parseInt($(this).attr('data-layout-id'));if(selected_ids==""){selected_ids=layout_id}else{selected_ids+=","+layout_id}});url+="&selected_ids="+selected_ids;openAjaxForm(url)},updateVariantLocalFiles:function(form){var files_container=form.find('.files-list'),file_path,field=form.find('input[name="settings"]'),preset_settings=JSON.parse(field.val());preset_settings.files={};files_container.find('li:not(.controls)').each(function(){file_path=$(this).attr('data-filepath');preset_settings.files[$(this).index()-1]=file_path});field.val(JSON.stringify(preset_settings))},updatePresetDefaultBlocks:function(form){var layout_containers=form.find('.layouts-list'),layout_container,layout_container_index,layout_new_containers=form.find('.layouts-list-new'),layout_new_container,layout_new_container_index,field=form.find('input[name="settings"]'),files_container=form.find('.files-list'),file_path,done_switcher=form.find('.done-switcher[name="is_done"]'),adaptive_switcher=form.find('.adaptive-switcher[name="is_adaptive"]'),content_switcher=form.find('.content-switcher[name="for_content"]'),preset_settings=JSON.parse(field.val()),layout_id,layout_new_id;preset_settings.layouts={};preset_settings.layouts_new={};preset_settings.files={};layout_containers.each(function(){layout_container=$(this);layout_container_index=parseInt(layout_container.attr('data-index'));layout_container.find('li:not(.controls)').each(function(){layout_id=parseInt($(this).attr('data-layout-id'));if(!preset_settings.layouts[layout_container_index]){preset_settings.layouts[layout_container_index]={}}preset_settings.layouts[layout_container_index][$(this).index()-1]=layout_id})});layout_new_containers.each(function(){layout_new_container=$(this);layout_new_container_index=parseInt(layout_new_container.attr('data-index'));layout_new_container.find('li:not(.controls)').each(function(){layout_new_id=parseInt($(this).attr('data-layout-id'));if(!preset_settings.layouts_new[layout_new_container_index]){preset_settings.layouts_new[layout_new_container_index]={}}preset_settings.layouts_new[layout_new_container_index][$(this).index()-1]=layout_new_id})});files_container.find('li:not(.controls)').each(function(){file_path=$(this).attr('data-filepath');preset_settings.files[$(this).index()-1]=file_path});preset_settings.done=done_switcher.prop('checked');preset_settings.adaptive=adaptive_switcher.prop('checked');preset_settings.for_content=content_switcher.prop('checked');field.val(JSON.stringify(preset_settings))},updatePresetThemes:function(field){var form=field.closest('form'),settings_field=form.find('input[name="settings"]'),preset_settings=JSON.parse(settings_field.val());preset_settings.themes=field.val();settings_field.val(JSON.stringify(preset_settings))},switchPresetProp:function(elem){var self=this,form=elem.closest('form');self.updatePresetDefaultBlocks(form)},deleteLayoutFromPreset:function(elem){var self=this,layout_item=elem.closest('li'),form=layout_item.closest('form');layout_item.remove();self.updatePresetDefaultBlocks(form)},createLPByPreset:function(elem,object_id,object_name,object_default_name,object_index,create_date,switch_preset,query_id){var self=this;if(switch_preset){self.switchLpPreset(object_id,query_id);return false}s3.confirmGreen(s3.loc('JS_CONFIRM_CREATE_LP_BY_PRESET'),function(){var preset_id=parseInt(object_id),preset_variant=parseInt(object_index),form=elem.closest('form'),preset_id_field=form.find('#preset_id'),preset_name_field=form.find('#name'),preset_variant_field=form.find('#preset_variant');preset_id_field.val(preset_id);preset_variant_field.val(preset_variant);preset_name_field.val(object_name);if(!query_id){Metrika.click("topMenuClickPageBuilder_SelectYes")}form.submit()})},switchLpPreset:function(object_id,query_id){var self=this,preset_id=parseInt(object_id),url='/-/cms/v1/lp/?act=switch_preset&'+S3_ACCESS+'&preset_id='+preset_id+'&query_id='+query_id+'&lp_id='+self.lp_id;s3.confirm(s3.loc('JS_LP_PRESET_CHANGE_WARNING'),function(){$.ajax({type:"GET",url:url,async:false,success:function(data){var re=/^error:/,matches=data.match(re);if(matches){popupController.closeLastPopup();s3.alert(data.replace(re,''));return false}else{location.reload()}},error:function(error){s3.alert(error.responseText)}})})},submitLPCreate:function(object,open_editing,popup,not_close_popup,content_lp){var rnd=new Date().getTime(),url='/-/cms/v1/lp/?act=edit&'+S3_ACCESS+'&rnd='+rnd,form_data,coloring=false,self=this;if(typeof object=="string"){if(object==''){return false}form_data=$.parseJSON(object);coloring=true}else if(typeof object=="object"){form_data=$(object).serializeArray()}$.ajax({type:"POST",url:url,data:form_data,async:false,success:function(data){var re=/^error:/,matches=data.match(re);if(matches){var error_text=data.replace(re,'');if(error_text==="Limit exceeded"){var lp_type=(content_lp||self.content_lp)?'lpc':'lp';var service_group=(content_lp||self.content_lp)?'lpc':'lp16';s3.openModalPopup("/-/cms/v1/lp/?act=payment&"+access+'&limit_type='+lp_type+'&service_group='+service_group);return false}popupController.closeLastPopup();s3.alert(error_text);return false}var result_data=data.replace(/^([0-9])/,"");if(popup){util.msg(s3.loc('JS_LP_CREATED_SUCCESSFULLY'));if(!not_close_popup){popupController.closeLastPopup()}popupController.reloadLastPopup()}else{if(coloring){var result_html=$('<div>').html(result_data),edit_link_btn=result_html.find('.lp-edit-link[data-new-lp]').addClass('hidden'),edit_link_btn_url=edit_link_btn.attr('href');if(by_preset){edit_link_btn.attr('href',edit_link_btn_url+'&by_preset=true')}button.after(edit_link_btn);edit_link_btn.get(0).click()}else{s3.setContent(result_data);if(open_editing){$('.lp-edit-link[data-new-lp]').get(0).click()}}popupController.closeLastPopup()}popupController.closeLastPopup();popupController.reloadLastPopup()}});return false},loadLayoutsByPreset:function(preset_id,folder_id){var preset_id=parseInt(preset_id),folder_id=parseInt(folder_id),url="/-/cms/v1/lp/block/layout/?act=index&"+S3_ACCESS;if(folder_id){url+="&folder_id="+folder_id}if(preset_id){url+="&preset_id="+preset_id;util.createCookie('lp_view_preset_id',preset_id)}else{util.eraseCookie('lp_view_preset_id')}s3.loadContent(url)},addPresetRequiredFile:function(container,field){var self=this,form=$(container).closest('form'),file_path=$(field).val(),file_item='<li class="box" data-filepath="'+file_path+'"><span class="handle"></span><span class="title"><span class="name">'+file_path+'</span></span><span class="remove" onclick="LpController.deleteFileFromPreset($(this));"><span class="s3-ico i-delete-svg"></span></span></li>';if(file_path!=''){if(!$(container).find('li[data-filepath="'+file_path+'"]').size()){$(container).append(file_item)}$(field).val('')}self.updatePresetDefaultBlocks(form)},deleteFileFromPreset:function(elem){var self=this,file_item=elem.closest('li'),form=file_item.closest('form');file_item.remove();self.updatePresetDefaultBlocks(form)},addVariantLocalFile:function(container,field){var self=this,form=$(container).closest('form'),file_path=$(field).val(),file_item='<li class="box" data-filepath="'+file_path+'"><span class="handle"></span><span class="title"><span class="name">'+file_path+'</span></span><span class="remove" onclick="LpController.deleteFileFromVariant($(this));"><span class="s3-ico i-delete-svg"></span></span></li>';if(file_path!=''){if(!$(container).find('li[data-filepath="'+file_path+'"]').size()){$(container).append(file_item)}$(field).val('')}self.updateVariantLocalFiles(form)},deleteFileFromVariant:function(elem){var self=this,file_item=elem.closest('li'),form=file_item.closest('form');file_item.remove();self.updateVariantLocalFiles(form)},updatePresetThemeColors:function(field,selector){var form=field.closest('form'),settings_field=form.find('input[name="settings"]'),preset_settings=JSON.parse(settings_field.val()),preset_colors={};form.find(selector).each(function(index){preset_colors[index]=$(this).val()});preset_settings.main_colors=preset_colors;settings_field.val(JSON.stringify(preset_settings))},addPresetTheme:function(container,field){var self=this,form=$(container).closest('form'),theme_path=$(field).val(),file_item='<li class="box" data-themepath="'+theme_path+'"><span class="handle"></span><span class="title"><span class="name">'+theme_path+'</span></span><span class="remove" onclick="LpController.deletePresetTheme($(this));"><span class="s3-ico i-delete-svg"></span></span></li>';if(theme_path!=''){$(container).find('li:not(.controls)').remove();$(container).append(file_item);$(field).val('')}self.updatePresetDefaultBlocks(form)},deletePresetTheme:function(elem){var self=this,file_item=elem.closest('li'),form=file_item.closest('form');file_item.remove();self.updatePresetDefaultBlocks(form)},applyTheme:function(button){var self=this,theme_index=button.attr('data-theme'),theme_global=button.attr('data-global'),theme_meta_path=(theme_global)?self.settings.themes.global:self.settings.themes.local,theme_path=theme_meta_path.replace('meta.json',theme_index+'/patch.css'),rnd=new Date().getTime(),theme_style='<link id="'+self.theme_link+'" rel="stylesheet" type="text/css" charset="UTF-8" href="'+theme_path+'">',url='/-/cms/v1/lp/?act=update_variant_theme&'+S3_ACCESS;if(theme_index=='drop'){$('#'+self.theme_link).remove()}else if(theme_index=='add'){}else{if($('body').find('#'+self.theme_link).size()){$('#'+self.theme_link).attr('href',theme_path+'?v='+rnd)}else{$('body').append(theme_style)}}button.addClass('_theme-list__item--selected').siblings().removeClass('_theme-list__item--selected');$.ajax({url:url,type:'POST',data:{'variant_id':self.variant_id,'lp_id':self.lp_id,'preset_id':self.preset_id,'theme_id':theme_index,'global':(theme_global)?1:0},async:false,success:function(){Preloader.hide()},error:function(e){console.log(e)}})},deleteLPPreset:function(btn,lp_preset_id,preset_name){var preset_id=parseInt(lp_preset_id),url='/-/cms/v1/lp/preset/?act=delete&'+S3_ACCESS;if(!preset_id){return false}s3.confirm(s3.loc('JS_CONFIRM_DELETE'),function(){$.ajax({url:url,type:'GET',data:{'preset_id':preset_id},async:false,success:function(result){var delete_status=parseInt(result);if(delete_status<0){popupController.closeLastPopup();s3.alert('Невозможно удалить "'+preset_name+'", тема используется')}else{$(btn).closest('tr').remove();popupController.closeLastPopup();util.msg('"'+preset_name+'" успешно удалена')}},error:function(){console.log('При удалении возникла ошибка')}})})},deleteGlobalTemplateMosaic:function(btn){var self=this;var parent=btn.parents('.sample-block-item');var layout_id=parent.find('input[name="layout_id"]').val();var layout_name=parent.find('input[name="name"]').val();self.deleteBlockLayout(btn,layout_id,layout_name,self.updatePreviewsFolderMosaic)},deleteBlockLayout:function(btn,block_layout_id,layout_name,callback){var layout_id=parseInt(block_layout_id),is_callback=callback&&typeof callback==='function',url='/-/cms/v1/lp/block/layout/?act=delete&'+S3_ACCESS;if(!layout_id){return false}const message=is_callback?s3.loc('JS_ZERO_BLOCK_DELETE_TEMPLATE'):s3.loc('JS_CONFIRM_DELETE');s3.confirm(message,function(){$.ajax({url:url,type:'GET',data:{'layout_id':layout_id},async:false,success:function(result){var delete_status=parseInt(result);if(delete_status<0){popupController.closeLastPopup();s3.alert('Невозможно удалить "'+layout_name+'", он используется')}else{popupController.closeLastPopup();s3.reloadContent();util.msg('"'+layout_name+'" успешно удален');if(is_callback)callback()}},error:function(){console.log('При удалении возникла ошибка')}})})},updateBlockMenus:function(){var self=this,block_id,layout_id;setTimeout(function(){$(self.site_wrapper).find('.lp-row[data-has-menu="true"]').each(function(index){block_id=parseInt($(this).attr('data-block-id'));layout_id=parseInt($(this).attr('data-block-layout-id'));self.updateBlockHtml(block_id,layout_id)})},500)},changeBlockMenuVisibility:function(toggler,value_container){if(!toggler||!value_container){return false}var item_value=$.parseJSON(value_container.val());if(toggler.prop('checked')==true){item_value['block_hidden']=false;toggler.closest('li').removeClass('invisible-menu-item')}else{item_value['block_hidden']=true;toggler.closest('li').addClass('invisible-menu-item')}value_container.val(JSON.stringify(item_value))},createLocalCopy:function(layout_id,callback){var self=this;var url='/-/cms/v1/lp/?act=create_local_copy&'+S3_ACCESS+'&layout_id='+layout_id;var isCallback=callback&&typeof callback==='function';Preloader.show();$.ajax({url:url,type:'GET',async:isCallback,success:function(result){result=JSON.parse(result);if(result['error']){s3.alert(result['error'])}else{if(result['layout_id']&&self.lp_donor_blocks){var layout_id=result['layout_id'];self.lp_donor_blocks[layout_id]=result;if(isCallback)callback(layout_id)}s3.reloadVisibleContent()}Preloader.hide()},error:function(){console.log('При копировании возникла ошибка');Preloader.hide()}})},copyAllBlocksToPreset:function(from_preset_id,target_preset_id){var url='/-/cms/v1/lp/?copy_blocks_from_preset&'+S3_ACCESS+'&from_preset_id='+from_preset_id+'&target_preset_id='+target_preset_id;s3.confirm('Cкопировать?',function(){popupController.closeLastPopup();s3.confirm('Точно?',function(){popupController.closeLastPopup();$.ajax({url:url,type:'GET',async:false,success:function(result){s3.reloadVisibleContent();util.msg(JS_COPIED)},error:function(){console.log('При копировании возникла ошибка')}})})})},openPopupCopyToPreset:function(layout_id){const popup=new PopupWindow('lp-copy-layout-popup');popup.center=true;popup.modal=true;popupController.showPopup(popup);$(popup.obj).find('select').trigger('change');$(popup.obj).find('.s3-btn-v2').data('layout_id',layout_id)},copyToPreset:function(layout_id,target_preset_id){var url='/-/cms/v1/lp/?copy_block_to_preset&'+S3_ACCESS+'&layout_id='+layout_id+'&target_preset_id='+target_preset_id;Preloader.show();$.ajax({url:url,type:'GET',async:false,success:function(result){util.msg('Скопировано');popupController.closeLastPopup();Preloader.hide()},error:function(){console.log('При копировании возникла ошибка');popupController.closeLastPopup();Preloader.hide()}})},reloadLP:function(json_id,button){var self=this,rnd=new Date().getTime(),json_modified=parseInt(button.attr('data-modified')),url='/-/cms/v1/lp/?act=check_modified&'+S3_ACCESS+'&rnd='+rnd;$.ajax({url:url,type:'POST',data:{"json_id":json_id,"json_modified":json_modified},dataType:'json',async:false,success:function(modified){if(modified){button.attr('data-modified',modified);self.updateLpHtml()}},error:function(e){console.log(e)}})},updateLpHtml:function(){var self=this,result,new_html;Preloader.show();$.ajax({url:location.href,dataType:'html',success:function(data){result=$('<div>').html(data);new_html=$(result).find(self.site_wrapper);$(self.site_wrapper).replaceWith(new_html);var block_id,block_json_id,block_layout_id;$(self.site_wrapper).find('[id^="_lp_block_"]').each(function(index){block_id=parseInt($(this).attr('id').replace('_lp_block_',''));if(!block_id){return}block_layout_id=self.lp_blocks[block_id]['layout_id'];block_json_id=$(this).parent('.lp-row').attr('data-json-id');if(!self.view_only){$(this).attr('data-block-layout',block_layout_id).attr('data-block-index',index).append(self.site_controls)}if(!$(this).parent('.lp-row').attr('data-has-params')){$(this).find('.site-controls .edit-layout-settings').remove()}if(self.preset_id===1461){$(this).find('.site-controls .inverse-control').remove()}if(!$(this).parent('.lp-row').attr('data-has-css')){$(this).find('.site-controls .edit-layout-css').remove()}$(this).find('form').each(function(){$(this).attr('title',s3.loc('JS_LP_FORM_NOTE')).tooltip();$(this).find('input[type="submit"], button[type="submit"]').on('click',function(){return false})});$(this).find('script').each(function(){$(this).addClass('no-reload')});if(!self.view_only){self.setControlsContext($(this),block_id,block_json_id)}});self.blockScriptReinit($(self.site_wrapper));Preloader.hide()},error:function(e){console.log(e)}})},resizeControlsPanel:function(){var self=this;if($('#landing_page_controls .control-wrap').get(0).scrollHeight>$('#landing_page_controls .control-wrap').height()){$('#landing_page_controls').addClass('wide');$('.lp-block-add-wrap, '+self.site_wrapper).addClass('mgl-20')}else{$('#landing_page_controls').removeClass('wide');$('.lp-block-add-wrap, '+self.site_wrapper).removeClass('mgl-20')}},showHelper:function(event){var self=this,target_position,placeholder;if($('.'+self.block_placeholder).get(0)){placeholder=$('.'+self.block_placeholder)}else{placeholder=$(self.block_placehoder_html)}if($(event.target).is('.lp-row.victim')){target_position=self.getHoverPart(event);$(LpController.main_wrapper).find('.lp-row').removeClass('hovered');if(target_position=="before"){$(event.target).before(placeholder)}else if(target_position=="after"){$(event.target).after(placeholder)}$(event.target).attr('data-target-position',target_position).addClass('hovered')}else if($(event.target).is('.'+self.block_placeholder)){$(event.target).after(placeholder)}else if($(event.target).is('.lp-block-add-wrap')||$(event.target).is(self.main_wrapper)){$(self.site_wrapper).append(placeholder)}},getHoverPart:function(event){var elem=$(event.target),elem_size={'height':elem.height(),'width':elem.width()},elem_pos={'left':elem.offset().left,'top':elem.offset().top},curr_pos={'left':event.clientX,'top':event.clientY},part=false;curr_pos.top+=$(document).scrollTop();if(curr_pos.top>=elem_pos.top&&curr_pos.top<=elem_pos.top+elem_size.height/2){part='before'}else if(curr_pos.top>=elem_pos.top+elem_size.height/2&&curr_pos.top<=elem_pos.top+elem_size.height){part='after'}return part},replaceGlobalBlockLayout:function(layout_id,meta_id){var url='/-/cms/v1/lp/block/?act=update_block_layout&'+S3_ACCESS;$.ajax({url:url,type:'POST',data:{'layout_id':layout_id,'meta_id':meta_id},dataType:'json',success:function(result){if(result){util.msg('Блоков заменено: '+result)}else{util.msg('Нет блоков для замены')}},error:function(e){console.log(e)}})},demoStatusAutoUpdate:function(){var self=this,url='/-/cms/v1/lp/?act=check_demo_status&'+access,for_content=self.content_lp?1:0,result;self.triggerLimitsUpgrade();clearTimeout(lpDemoStatusUpdateTimeout);lpDemoStatusUpdateTimeout=setTimeout(function(){checkStatusUpdate()},1000);function checkStatusUpdate(){$.get(url,{for_content:for_content}).done(function(data){result=$.parseJSON(data);if(result.lp_demo_mode){lpDemoStatusUpdateTimeout=setTimeout(function(){checkStatusUpdate()},3000)}else{$('#lp_demo_panel').remove();$('.control-wrap').removeClass('demo-mode')}})}},triggerLimitsUpgrade:function(){var self=this;if($('#lp_demo_panel').get(0)){$('#lp_demo_panel').find('.demo-icon').addClass('auto-update');$('.control-wrap').addClass('auto-update')}self.closeBlockSelector()},updatePresetPreview:function(preset_id){var url='/-/cms/v1/lp/preset/?act=update_image_preview&'+S3_ACCESS;Preloader.show({mini:true});$.ajax({url:url,type:'POST',data:{'preset_id':preset_id},dataType:'json',success:function(result){if(result==1){util.msg(JS_RELOADED)}else{util.msg(JS_ERROR)}Preloader.hide()},error:function(e){console.log(e);Preloader.hide()}})},createLPFullCopy:function(lp_id,ver_id){var url='/-/x-api/v1/protected/?method=lp/makeFullCopy&'+access;$.ajax({url:url,type:'POST',cache:false,dataType:'json',data:{'lp_id':lp_id,'ver_id':ver_id,}}).done(function(response){var result=response.result;if(result.success){s3.reloadVisibleContent();util.msg(JS_COPIED)}else if(result.error){s3.alert(result.message)}})},createBlockCopy:function(data){const block=$(data),block_row=block.parents(`.lp-row`),variant_id=parseInt(block_row.attr(`data-variant-id`)),block_id=parseInt(block_row.attr(`data-block-id`)),variant_block_id=parseInt(block_row.attr(`data-variant-block-id`)),object_id=variant_id?block_id:variant_block_id;var self=this,url='/-/cms/v1/lp/block/?act=copy&'+S3_ACCESS;$.ajax({url:url,type:'POST',cache:false,dataType:'json',data:{'block_variant_id':variant_id,'variant_id':self.variant_id,'object_id':object_id,'for_content':self.content_lp?1:0},success:function(response){if(response.status=="succsess"&&response.block_id){var new_block_id=response.block_id;$.ajax({url:location.href+' #_lp_block_'+new_block_id,dataType:'html',success:function(data){const result=$('<div>').html(data);let new_row,new_block;const rows=$(result).find(self.site_wrapper).find('.lp-row[data-block-id="'+new_block_id+'"]');if(rows.length===1){new_row=rows}else if(rows.length>0){const existsVariantBlockIds=[];$(`.lp-row[data-block-id="${new_block_id}"]`).each(function(){existsVariantBlockIds.push($(this).data('variant-block-id'))});rows.each(function(){const variant_block_id=$(this).data('variant-block-id');if(!existsVariantBlockIds.includes(variant_block_id)){new_row=$(this);return}})}if(!new_row){console.error(`can't find needeed block`);return}new_block=new_row.find('#_lp_block_'+new_block_id);let new_block_json_id=new_row.attr('data-json-id'),new_block_row=new_row.append(new_block);if(!new_block_json_id){new_block_json_id=''}if(block_row){block_row.after(new_block_row);self.scrollToBlock(new_block_row.offset().top,new_block_row);self.updateBlockMenus();new_block.append(self.site_controls);self.initPicker(new_block);self.blocksReorder();if(!new_block_row.attr('data-has-css')){new_block.find('.site-controls .edit-layout-css').remove()}self.reloadCustomStyles();setTimeout(function(){self.blockScriptReinit(new_block)},300);if(self.css_params.hasOwnProperty(block_id)){self.css_params[new_block_id]=self.css_params[block_id]}$.ajax({url:'/-/cms/v1/lp/block/?act=get_block_data&'+S3_ACCESS,type:'POST',data:{"block_id":new_block_id,"json_id":new_block_json_id,"ver_id":VER_ID},dataType:'json',success:function(result){if(result){if(!self.lp_blocks.hasOwnProperty(new_block_id)){self.lp_blocks[new_block_id]={}}self.lp_blocks[new_block_id]['data']=result['data'];self.lp_blocks[new_block_id]['data_json']=result['data_json']}self.setControlsContext(new_block,new_block_id,new_block_json_id)},error:function(e){console.log('Error',e)}})}},error:function(e){console.log(e)}})}else if(response.status=="error"){if(response.message=="limit"){s3.openModalPopup("/-/cms/v1/lp/?act=payment&"+access+'&service_group='+self.service_group)}}},error:function(err){console.log(err)}})},copyGlobalTemplateMosaic:function($elem){const self=this,$form=$elem.parents('form'),layout_id=$form.find('input[name="layout_id"]').val(),library_id=$form.data(`library-id`);if(!$form.length){return console.error('Форма не найдена')}if(!library_id){return false}const url=`/-/cms/v1/lp/?create_local_copy&${S3_ACCESS}`;$.ajax({url:url,type:'GET',data:{'layout_id':layout_id,'in_mosaic_folder':1},async:false,success:function(){self.updatePreviewsFolderMosaic()},error:function(){console.log('При копировании возникла ошибка')}})},copyTemplateMosaicToGlobal:function($elem){const self=this,$form=$elem.parents('form'),layout_id=$form.find('input[name="layout_id"]').val();if(!$form.length){return console.error('Форма не найдена')}if(!layout_id){return false}const url=`/-/cms/v1/lp/layout/?act=createGlobalCopy&${S3_ACCESS}`;$.ajax({url:url,type:'GET',data:{'layout_id':layout_id},async:false,success:function(){self.updatePreviewsFolderMosaic()},error:function(){console.log('При копировании возникла ошибка')}})},saveFolderLayoutsOrder:function(folder_id,lp_layouts_list){var self=this,url='/-/cms/v1/lp/?act=reorder_layouts_list&'+S3_ACCESS+'&folder_id='+folder_id,block_ids,block_id;lp_layouts_list.find('.layout-item').each(function(index){if($(this).data('layout_id')){block_id=parseInt($(this).data('layout_id'));$(this).attr('data-block-index',index);if(index==0){block_ids=block_id}else{block_ids+=','+block_id}}});$.ajax({url:url,data:{"ids":block_ids},type:'POST',success:function(data){util.msg('Order saved');$('#save_lp_layouts_order').hide()},error:function(e){console.log(e);$('#save_lp_layouts_order').hide()}})},loadCMSLocalLayouts:function(preset_id){var url="/-/cms/v1/lp/block/layout/?act=index&"+S3_ACCESS+'&local_only=1';if(preset_id){url+="&preset_id="+preset_id;util.createCookie('lp_view_preset_id',preset_id)}else{util.eraseCookie('lp_view_preset_id')}s3.loadContent(url)},reloadCustomStyles:function(callback){var self=this,custom_styles_url='/t/css/__landing_page_'+self.variant_id+'.css',$custom_styles=$('link[href^="'+custom_styles_url+'"]'),rnd=new Date().getTime();if($custom_styles.size()){$custom_styles.attr('href',custom_styles_url+'?rnd='+rnd);$custom_styles.attr('id','variant_'+self.variant_id+'_styles')}self.reloadThroughBlocksStyles();if(callback&&typeof callback==='function'){callback()}},reloadThroughBlocksStyles:function(block_id=null){let selector=`.lp-row[data-variant-id="0"]`;if(block_id){selector+=`[data-block-id="${block_id}"]`}const $through_blocks=$(selector);$through_blocks.each((i,block)=>{const $block=$(block),layout_id=$block.attr(`data-block-layout-id`),block_id=$block.attr(`data-block-id`),url=`/t/css/__landing_page_block_${layout_id}_${block_id}.css`,rnd=new Date().getTime();let $link=$('link[href^="'+url+'"]');if($link.size()){$link.attr('href',url+'?rnd='+rnd)}else{$link=$(`<link href="${url}"rel="stylesheet"type="text/css"/>`);$link.appendTo($(`body`))}})},getCssUrlGlobalStyles:function(){return this.content_lp?'/t/css/__landing_page_content_global.css':'/t/css/__landing_page_global_'+this.variant_id+'.css'},getIframeUrlGlobalStyles:function(){const self=this;const url=self.content_lp?'/-/cms/v1/lp/?act=index&mode=lpc_global_style&':'/-/cms/v1/lp/?act=index&mode=global_style&';return url+S3_ACCESS+'&preset_id='+self.preset_id+'&variant_id='+self.variant_id},getSaveUrlGlobalStyles:function(){const self=this;const rnd=new Date().getTime();const url=self.content_lp?'/-/cms/v1/lp/?act=save_lp_content_global_css&':'/-/cms/v1/lp/?act=save_css&';return url+S3_ACCESS+'&variant_id='+self.variant_id+'&rnd='+rnd},reloadGlobalStyles:function(){var self=this;var global_styles_url=self.getCssUrlGlobalStyles();var $global_styles=$('link[href^="'+global_styles_url+'"]');var rnd=new Date().getTime();if($global_styles.length){$global_styles.attr('href',global_styles_url+'?rnd='+rnd)}else{const $global_styles=$(`<link href=${global_styles_url}?rnd=${rnd}rel="stylesheet">`);$global_styles.appendTo($(`body`))}},resetFontVariant:function(btn){if(!btn.size()){return false}var btn_parent=btn.parents('.font-style');if(btn.is('#variant_reset')){if(btn.prop('checked')==true){btn_parent.find('label.s3-cb').each(function(){$(this).find('.css-value').prop('checked',false)});btn.prop('checked',true)}}else{if(btn.prop('checked')==true){btn_parent.find('#variant_reset').prop('checked',false)}}btn_parent.S3ChangeControls()},updateFontStyleParams:function(select,params,weights_select){if(!params&&select.hasClass('init')){return false}select.removeClass('init');var $select=select,$weights_select=weights_select,$parent=select.parents('td.value'),params_list=params.split(","),weights={400:'normal'},_w={100:['thin','hairline'],200:['extra-light','ultra-light'],300:['light'],400:['normal'],500:['medium'],600:['demi-bold','semi-bold'],700:['bold'],800:['extra-bold','ultra-bold'],900:['black','heavy']},has_italic=false,key;if(params){if(params_list&&params_list.length){for(var i=0;i<params_list.length;i++){if(params_list[i].indexOf('italic')===-1){for(key in _w){if($.inArray(params_list[i],_w[key])>=0){weights[key]=params_list[i]}}}else if(has_italic==false){has_italic=true}}}}if(has_italic){$parent.find('.item .font-style').removeClass('disabled')}else{$parent.find('.item .font-style').addClass('disabled')}if(Object.keys(weights).length==1){$weights_select.prop('disabled',true)}else{$weights_select.prop('disabled',false)}var weight_val;if($weights_select.find('option').size()){weight_val=400;$parent.find('.item .font-style').find('input[type="checkbox"]').prop('checked',false);$parent.S3ChangeControls()}else{weight_val=$weights_select.attr('data-selected-weight')}$weights_select.html('');var selected='';for(key in weights){if(key==weight_val){selected='selected'}else{selected=''}$weights_select.append('<option '+selected+' value="'+key+'">'+weights[key]+'</option>')}$weights_select.trigger("chosen:updated").trigger("liszt:updated")},fontVariantsInit:function(){$('.font-family-control').each(function(){$(this).addClass('init').trigger('change')})},showVisualPanel:function(){const self=this;const iframe=$('#lp-panel-iframe');Preloader.show();iframe.attr('src',self.getIframeUrlGlobalStyles());if(!$(self.folders_menu_wrapper).hasClass('hidden')){self.closeBlockSelector()}},hideVisualPanel:function(){const iframe=$('#lp-panel-iframe');iframe.css('display','none');$('html, body').css('overflow','');iframe.attr('src','')},toggleButtonType:function(elem){var self=this;if(self.visual&&self.visual['visual_settings']){$(self.selected_element).attr('style','');var row=$(elem).parents('.lp-row');var visual_settings=JSON.parse(self.visual['visual_settings']);var index=$(elem).data('index');if(visual_settings.buttons&&visual_settings.buttons[index]){var el_class=visual_settings.buttons[index].replace('.','');Object.keys(visual_settings.buttons).forEach(function(e){var remove_cl=visual_settings.buttons[e].replace('.','');$(self.selected_element).removeClass(remove_cl)});$(self.selected_element).addClass(el_class);$(self.selected_element).attr('data-type',index);row.find('.btn-type-text').text($(elem).text())}$(self.selected_element).addClass('modified')}},getButtonClassByType:function(type){var self=this;var cl='';if(self.visual&&self.visual['visual_settings']){var visual_settings=JSON.parse(self.visual['visual_settings']);if(visual_settings.buttons&&visual_settings.buttons[type]){cl=visual_settings.buttons[type].replace('.','')}}return cl},getColorBrightness:function(color){var c=tinycolor(color);return{'brightness':c.isDark()&&c.getAlpha()?'dark':'light','alpha':c.getAlpha()}},saveGlobalStyle:function(data){const self=this;const url=self.getSaveUrlGlobalStyles();$.ajax({url:url,type:'POST',data:{"css_value":JSON.stringify(data),"preset_id":self.preset_id,},dataType:'json',async:false,success:function(){util.msg(s3.loc('JS_SAVED'),'green');self.reloadGlobalStyles()},error:function(e){console.log(e)}})},initPanelElementsCss:function(params){var self=this;if(!params){return}self.panel_params=params},convertCssValue:function(props){var self=this;var css={};Object.keys(props).forEach(function(prop,i){var p=props[prop];var value="";switch(prop){case"background":if(p['bg_type']==="solid"){value=p['color']}else if(p['bg_type']==="gradient"){value=self.getGradient(p['gradient_direction'],p['start_color'],p['end_color'])}break;case"border":case"border_top":case"border_left":case"border_right":case"border_bottom":value=parseInt(p['width'])+'px '+p['style']+' '+p['color'];break;case"border_radius":value=p['lt']+'px '+p['rt']+'px '+p['rb']+'px '+p['lb']+'px';break;case"box_shadow":case"box-shadow":value=p['offset_x']+'px '+p['offset_y']+'px '+p['blur']+'px '+p['spread']+'px '+p['color'];break;case"font":if(p['size']){css['font-size']=p['size']}if(p['style']){css['font-style']=p['style']}if(p['weight']){css['font-weight']=p['weight']}if(p['color']){css['color']=p['color']}if(p['family']){css['font-family']=p['family']}if(p['lineheight']){css['line-height']=p['lineheight']}if(p['text_decoration']){css['text-decoration']=p['text_decoration']}break}if(prop!=='font'){css[prop.replace('_','-')]=value}});return css},resetParams:function(btn){var self=this;if(self.panel_params){$(btn).parents('.control-params').find('.css-value').each(function(i,e){if($(e).data('val')||($(e).is('.range-value')&&$(e).parents('.range-wrap').find('.range-slider').data('val'))){var val=$(e).data('val');if($(e).is('input')){$(e).val(val);if($(e).parents('.colorpicker-component').length){$(e).parents('.colorpicker-component').colorpicker('setValue',val)}}else if($(e).is('select')){$(e).val(val);$(e).trigger("chosen:updated").trigger("liszt:updated")}else if($(e).is('.range-value')){val=$(e).parents('.range-wrap').find('.range-slider').data('val');$(e).parents('.range-wrap').find('.range-slider').slider('value',val);$(e).text(val)}else if($(e).is('.s3-btn')){if(val=='normal'){$(e).removeClass('selected')}}}});self.initPanelElementsCss(self.panel_params)}},resetFontParams:function(btn){var self=this;var $params=$('.s3-lp-panel .fonts-params');var font1=$('.font-pairs .panel-line.active .pair-title').data('font-name');var font2=$('.font-pairs .panel-line.active .pair-text').data('font-name');var val1=$params.find('.title-type select option[value^="'+font1+',"]').attr('value');var val2=$params.find('.text-type select option[value^="'+font2+',"]').attr('value');$params.find('option').removeAttr('selected');$params.find('.title-type select').attr('data-val',val1).val(val1);$params.find('.text-type select').attr('data-val',val2).val(val2);$params.find('.title-type .prop-block-title').css('font-family',val1);$params.find('.text-type .prop-block-title').css('font-family',val2);$params.find('select').trigger("chosen:updated").trigger("liszt:updated")},changeGradientDirection(input){var self=this;var $popup=$(input).parents('.context-popup');const class_overlay_elem=$popup.data('type')==='block_background_item'?'.lp-block-overlay_item':'.lp-block-overlay';var direction=$(input).val();var $grad_row=$(input).parents('.gradient-color');var start_color=$grad_row.find('.colorpicker-grad_start-component').data('color');var end_color=$grad_row.find('.colorpicker-grad_end-component').data('color');var elem=$('.panel-line.active .panel-editable-element');var $row=$(self.selected_element).parents('.lp-row');var overlay_elem=$(self.selected_element).find(class_overlay_elem).length?$(self.selected_element).find(class_overlay_elem):$row.find(self.selected_element_class);var $bg_wrap=$(self.selected_element).find('.bg-wrap');if($bg_wrap.length){overlay_elem=$bg_wrap;self.setSelection($bg_wrap[0])}if($(input).parents('.control-params').length&&$(input).parents('.control-params').find('.hover-params').length&&$(input).parents('.control-params').find('.active-params').length){$(input).parents('.control-params').find('.hover-params .gradient-direction select').val(direction);$(input).parents('.control-params').find('.active-params .gradient-direction select').val(direction)}self.applyStyles(input,overlay_elem,{'background-image':self.getGradient(direction,start_color,end_color)})},getGradient(direction,start_color,end_color){return"linear-gradient("+direction+"deg, "+start_color+" , "+end_color+")"},applyBackground:function(obj,image_info){var self=LpController;var $popup=$(obj).parents('.context-popup');const class_elem=$popup.data('type')==='block_background_item'?'.lp-block-bg_item':'.lp-block-bg';var image_path="/d/"+image_info.filename.trim();var image_elem=$(self.selected_element).find(class_elem).length?$(self.selected_element).find(class_elem):$(self.selected_element);self.applyStyles(obj,image_elem,{'background-image':'url('+image_path+')'});$popup.find('.image-change-wrap').attr('data-image-path',image_path);$popup.find('.no-img').hide();$popup.find('.has-img').show();popupController.closeLastPopup();LpController.changeBackgroundPosition(obj,false);LpController.changeBackgroundRepeat(obj,false);LpController.changeBackgroundSize(obj,false);LpController.changeBackgroundAttachment(obj,false);self.applyPopupParams($('.context-popup:visible'))},applyVideoStub:function(obj,image_info){var self=LpController;var $popup=$(obj).parents('.context-popup');var image_path="/d/"+image_info.filename.trim();var image_elem=$(self.selected_element).find('.lp-block-bg').length?$(self.selected_element).find('.lp-block-bg'):$(self.selected_element);var $video_wrapper=$(self.selected_element).is('._lp-video')?$(self.selected_element):$(self.selected_element).find('._lp-video');self.applyStyles(obj,image_elem,{'background-image':'none'});if($video_wrapper.find('video').length){$video_wrapper.find('video').attr('poster',image_path)}else{$video_wrapper.html('<video type="video/mp4" autoplay="autoplay" loop="loop" muted="muted" poster="'+image_path+'"><source src=""></video>')}$popup.find('.no-stub').hide();$popup.find('.has-stub').show()},changeFillType:function(select){var self=this;var $popup=$(select).parents('.context-popup');const class_elem=$popup.data('type')==='block_background_item'?'.lp-block-bg_item':'.lp-block-bg';const class_overlay_elem=$popup.data('type')==='block_background_item'?'.lp-block-overlay_item':'.lp-block-overlay';var val=$(select).val();var image_path=$popup.find('.image-change-wrap').attr('data-image-path');var $row=$(self.selected_element).parents('.lp-row');var image_elem=$(self.selected_element).find(class_elem).length?$(self.selected_element).find(class_elem):$row.find(self.selected_element_class);var overlay_elem=$(self.selected_element).find(class_overlay_elem).length?$(self.selected_element).find(class_overlay_elem):$row.find(self.selected_element_class);var $selected_fill_type=$popup.find('.'+val+'-type');self.closeColorpicker();$popup.find('.bg-type').hide();$selected_fill_type.show();if(self.hasSelection()||$(self.selected_element).find('.bg-wrap').length){self.applyStyles(select,$(self.selected_element).find('.bg-wrap'),{'background-color':'transparent','background-image':'none',});self.applyPopupParams($('.context-popup:visible'));return}if(!image_elem.length&&!overlay_elem.length){image_elem=overlay_elem=$(self.selected_element)}self.applyStyles(select,overlay_elem,{'background-color':'transparent','background-image':'none',});if(image_path){self.applyStyles(select,image_elem,{'background-image':'url('+image_path+')'})}$selected_fill_type.find('input').first().trigger('input');self.applyPopupParams($('.context-popup:visible'))},changeBackgroundPosition:function(el,autoApply=true){var self=this;var $popup=$(el).parents('.context-popup');const class_elem=$popup.data('type')==='block_background_item'?'.lp-block-bg_item':'.lp-block-bg';var image_elem=$(self.selected_element).find(class_elem).length?$(self.selected_element).find(class_elem):$(self.selected_element);var val=$popup.find('.pos-control').val();self.applyStyles(el,image_elem,{'background-position':val});if(autoApply){self.applyPopupParams($('.context-popup:visible'))}},changeBackgroundRepeat:function(el,autoApply=true){var self=this;var $popup=$(el).parents('.context-popup');const class_elem=$popup.data('type')==='block_background_item'?'.lp-block-bg_item':'.lp-block-bg';var image_elem=$(self.selected_element).find(class_elem).length?$(self.selected_element).find(class_elem):$(self.selected_element);var val=$popup.find('.repeat-control').val();self.applyStyles(el,image_elem,{'background-repeat':val});if(autoApply){self.applyPopupParams($('.context-popup:visible'))}},changeBackgroundSize:function(el,autoApply=true){var self=this;var $popup=$(el).parents('.context-popup');const class_elem=$popup.data('type')==='block_background_item'?'.lp-block-bg_item':'.lp-block-bg';var image_elem=$(self.selected_element).find(class_elem).length?$(self.selected_element).find(class_elem):$(self.selected_element);var val=$popup.find('.size-control').val();self.applyStyles(el,image_elem,{'background-size':val});if(autoApply){self.applyPopupParams($('.context-popup:visible'))}},changeBackgroundAttachment:function(el,autoApply=true){var self=this;var $popup=$(el).parents('.context-popup');const class_elem=$popup.data('type')==='block_background_item'?'.lp-block-bg_item':'.lp-block-bg';var image_elem=$(self.selected_element).find(class_elem).length?$(self.selected_element).find(class_elem):$(self.selected_element);var val='';if($(el).prop('checked')){val='fixed'}else{val='initial'}self.applyStyles(el,image_elem,{'background-attachment':val});if(autoApply){self.applyPopupParams($('.context-popup:visible'))}},resetBackgroundImage:function(el){var self=this;var $popup=$(el).parents('.context-popup');const class_elem=$popup.data('type')==='block_background_item'?'.lp-block-bg_item':'.lp-block-bg';var type=$popup.find('.bg-types select').val();var $image_wrap=$popup.find('.image-change-wrap');var $image_elem=$(self.selected_element).find(class_elem).length?$(self.selected_element).find(class_elem):$(self.selected_element);var input_val=$popup.find('.image-change-wrap input').val();if(self.isJsonString(input_val)){var obj=JSON.parse(input_val);obj['no_image']=true;$popup.find('.image-change-wrap input').val(JSON.stringify(obj))}$popup.find('.no-img').show();$popup.find('.has-img').hide();$image_wrap.removeAttr('data-image-path');self.applyStyles(el,$image_elem,{'background-image':'none'});if(type==='gradient'){$popup.find('.gradient-direction .range-value').change()}$popup.find('.lp-reset-btn.image-btn').click();self.applyPopupParams($('.context-popup:visible'))},resetBackgroundVideo:function(el){var self=this;var $popup=$(el).parents('.context-popup');$popup.find('.no-video').show();$popup.find('.has-video').hide();$popup.find('video').replaceWith("<img class=\"s3ImageMakerObj\" src=\"/my/s3/images/svg_icons/lp/oah-player2.svg\" width=\"64\"/>");$(self.selected_element).find('video').remove()},parseBgPosition:function(position){if(position==='center center'){position="50% 50%"}else if(position==="0 0"||position==="left top"){position="0% 0%"}else if(position==="50% 0"||position==="center top"){position="50% 0%"}else if(position==="100% 0"||position==="right top"){position="100% 0%"}else if(position==="0 50%"||position==="left center"){position="0% 50%"}else if(position==="right center"){position="100% 50%"}else if(position==="0 100%"||position==="left bottom"){position="0% 100%"}else if(position==="center bottom"){position="50% 100%"}else if(position==="right bottom"){position="100% 100%"}return position},initPicker:function($container){var self=this;$container.find('.colorpicker-component').colorpicker({color:$(this).find('.color-value').val(),horizontal:true,align:'left',format:'rgba',colorSelectors:self.lp_palette,container:false,slidersHorz:{saturation:{maxLeft:180,maxTop:180,callLeft:'setSaturation',callTop:'setBrightness'},hue:{maxLeft:180,maxTop:0,callLeft:'setHue',callTop:false},alpha:{maxLeft:180,maxTop:0,callLeft:'setAlpha',callTop:false},border_width:{maxLeft:180,maxTop:0,callLeft:'setBorderWidth',callTop:false}},beforeShow:function(){if($('.colorpicker-visible').length){$('.colorpicker-visible').find('.cp-close').click()}},onShow:function(c){$('.s3-lp-panel').find('.color-editable-element').removeClass('color-editable-element');var elem_class=$(c.element[0]).data('editable-element');$(elem_class).addClass('color-editable-element');$(c.picker).find('.colorpicker-selectors').html('');$(c.picker).find('.colorpicker-primary-selectors').html('');$(c.picker).find('.colorpicker-default-selectors').html('');const initial_colors=getComputedStyle(document.body).getPropertyValue('--primary-color-base-all');if(initial_colors){const primary_palette=initial_colors.split(',');LpController.addColorButtonsToPicker(primary_palette,'.colorpicker-primary-selectors',c);if(primary_palette.length>0){$(c.picker).find('.colorpicker-name.name-primary').show();$(c.picker).find('.colorpicker-primary-selectors').show()}}LpController.addColorButtonsToPicker(self.lp_palette.slice(0,7),'.colorpicker-selectors',c);if(self.lp_palette.length>0){$(c.picker).find('.colorpicker-name.name-selectors').show();$(c.picker).find('.colorpicker-selectors').show()}LpController.addColorButtonsToPicker(self.default_palette,'.colorpicker-default-selectors',c)},onInit:function(c){c.picker.draggable({handle:c.picker.find('.drag-handler'),drag:function(e,ui){if(ui.position.top<=0){ui.position.top=0}}})},reposition:function(c){var type=c.container&&c.container[0]!==document.body?'position':'offset';var element=c.component||c.element;var $popup=element.parents('.context-popup, .s3-lp-panel-inner');var left=$popup.offset().left+$popup.outerWidth()+20;c.picker.css({left:left})},template:'<div class="colorpicker dropdown-menu">'+'<div class="drag-handler"></div>'+'<div class="cp-close"></div>'+'<div class="colorpicker-saturation"><i><b></b></i></div>'+'<div class="colorpicker-hue"><i></i></div>'+'<div class="colorpicker-alpha"><i></i></div>'+'<div class="colorpicker-color"><div class="color-preview"></div><div class="input-preview click-body"><input type="text"></div><div class="alpha-preview click-body"><input type="text"></div></div>'+'<div class="colorpicker-palette-wrap">'+'<div class="colorpicker-name name-primary">'+s3.loc('JS_PALETTE_SITE')+'</div>'+'<div class="colorpicker-primary-selectors"></div>'+'<div class="colorpicker-name name-selectors">'+s3.loc('JS_PALETTE_USED')+'</div>'+'<div class="colorpicker-selectors"></div>'+'<div class="colorpicker-default-selectors"></div>'+'</div>'+'</div>'}).on('changeColor',function(e){var elem_class=self.selected_element_class;var $row=$(self.selected_element).parents('.lp-row');var $change_elem=elem_class?$row.find(elem_class):$(self.selected_element);var has_selection=self.hasSelection();var obj={};if($change_elem.find('.bg-wrap').length||$change_elem.find('.colorpicker-text').length){has_selection=true}if(!$('.context-popup').is(':visible')&&!$('.colorpicker-visible').length){return}if($(this).data('type')=='color'){obj['color']=e.color.toString(this.format);$(this).parents('.media-rule-box').nextAll().not('.changed-rule').each(function(i,r){var media=$(this).attr('media');var saved=self.getElemCssProp('font','color',null,media);if(!saved)$(r).find('.change-color input').val(e.color.toString(this.format))})}else if($(this).data('type')=='background'||$(this).data('type')=='block_background'||$(this).data('type')=='block_background_item'){if($(self.selected_element).find('.lp-block-overlay').length){$change_elem=$(self.selected_element).find('.lp-block-overlay')}else if($(self.selected_element).find('.lp-block-overlay_item').length){$change_elem=$(self.selected_element).find('.lp-block-overlay_item')}else if($(self.selected_element).find('.lp-img-overlay').length){$change_elem=$(self.selected_element).find('.lp-img-overlay')}obj['background-color']=e.color.toString(this.format)}else if($(this).data('type')=='border'){$change_elem.css('border-color',e.color.toString(this.format));obj['border-color']=e.color.toString(this.format)}else if($(this).data('type')=='box-shadow'){var $shadow_control=$(e.currentTarget).parents('.control-box');var x=$shadow_control.find('.range-value').eq(0).val();var y=$shadow_control.find('.range-value').eq(1).val();var blur=$shadow_control.find('.range-value').eq(2).val();var spray=$shadow_control.find('.range-value').eq(3).val();var val=x+'px '+y+'px '+blur+'px '+spray+'px '+e.color.toString(this.format);obj['box-shadow']=val}else if($(this).data('type')=='grad_start'||$(this).data('type')=='grad_end'){var row=$(this).parents('.gradient-color');var start_color=row.find('.colorpicker-grad_start-component').data('color');var end_color=row.find('.colorpicker-grad_end-component').data('color');var direction=row.find('.gradient-direction input').val();obj['background-image']=self.getGradient(direction,start_color,end_color);if($(self.selected_element).find('.lp-block-overlay').length){$change_elem=$(self.selected_element).find('.lp-block-overlay')}else if($(self.selected_element).find('.lp-block-overlay_item').length){$change_elem=$(self.selected_element).find('.lp-block-overlay_item')}}if(has_selection&&$('.colorpicker-visible').length){if($change_elem.find('.bg-wrap').length||$change_elem.find('.colorpicker-text').length){var el=$change_elem.find('.bg-wrap').length?$change_elem.find('.bg-wrap'):$change_elem.find('.colorpicker-text');self.setSelection(el[0]);$('.colorpicker-text').removeClass('colorpicker-text')}self.setSelectionParams(obj);self.removeSelection()}else if(has_selection&&$change_elem.find('.bg-wrap').length){self.applyStyles(this,$change_elem.find('.bg-wrap'),obj)}else{self.applyStyles(this,$change_elem,obj)}self.applyPopupParams($('.context-popup:visible'))})},addColorButtonsToPicker:function(palette,containerClass,c){$.each(palette,function(name,color){const $btn=$('<i />').css('background-color',color).data('class',name);$btn.click(function(){c.setValue($(this).css('background-color'))});$(c.picker).find(containerClass).append($btn)})},setSelectionParams:function(css,cls=''){var self=this;var sel=window.getSelection();var text=sel.toString();var element=self.getSelectionElement();if(!$(self.selected_element).data('html')){$(self.selected_element).data('html',$(self.selected_element).html());$(self.selected_element).addClass('modified').addClass('modified-text')}if(element&&element.innerText.trim()===text.trim()){var css_props=$(element).attr('data-props')?$(element).attr('data-props'):'';Object.keys(css).forEach(function(prop){if((css[prop]==='normal'||css[prop]==='none')&&~css_props.indexOf(prop)){var css_arr=css_props.split(",");css_arr.splice(css_arr.indexOf(prop),1);css_props=css_arr.join(",")}else{if(css_props.indexOf(prop)===-1){if(css_props)css_props=css_props+",";css_props+=prop}}});$(element).css(css);$(element).attr('data-props',css_props)}else{self.wrapSelection(css,cls)}},wrapSelection:function(css,cls=''){var self=this;var sel=window.getSelection();var selection=window.getSelection().getRangeAt(0);var selectedText=selection.extractContents();var span=document.createElement("span");var element;cls='lp-fragment-elem '+cls;var i=document.createElement('i');$(i).css(css);var style=$(i).attr('style')?$(i).attr('style'):'';$(i).remove();var css_props='';Object.keys(css).forEach(function(prop){if(css_props)css_props=css_props+",";css_props+=prop});span.appendChild(selectedText);span.setAttribute('style',style);span.setAttribute('data-props',css_props);span.setAttribute('class',cls);selection.insertNode(span);$(self.selected_element).find('span:empty').remove();if($(span).find('.lp-fragment-elem').length){$(span).find('.lp-fragment-elem').each(function(i,fragment_elem){if($(fragment_elem).attr('data-props')){var sub_elem_props=$(fragment_elem).attr('data-props').split(",");Object.keys(css).forEach(function(key){if($.inArray(key,sub_elem_props)>=0){var index=$.inArray(key,sub_elem_props);fragment_elem.style[key]='';sub_elem_props.splice(index,1)}});if(!sub_elem_props.length&&fragment_elem.tagName.toLowerCase()==='span'){$(fragment_elem).replaceWith($(fragment_elem).html())}else{$(fragment_elem).attr('data-props',sub_elem_props.join(","))}}})}element=self.getSelectionElement();if(element){self.setSelection(element)}},getSelectionElement:function(){var self=this;var range,root,start,end;if(window.getSelection){var selection=window.getSelection();var selection_text=selection.toString().trim();if(selection_text&&$(self.selected_element).find('.lp-fragment-elem:contains('+selection_text+')').length){var els=$(self.selected_element).find('.lp-fragment-elem:contains('+selection_text+')');var sel_elem=null;els.each(function(i,el){if($(el).text()===selection_text){sel_elem=el}});if(sel_elem)return sel_elem}range=selection.getRangeAt(0);start=range.startContainer;end=range.endContainer;root=range.commonAncestorContainer;if(start==end)root=start;if(start.nodeName.toLowerCase()=="body")return null;if(start.nodeName=="#text")start=start.parentNode;if(end.nodeName=="#text")end=end.parentNode}else if(window.document.selection){range=window.document.selection.createRange();if(!range.duplicate)return null;var r1=range.duplicate();var r2=range.duplicate();r1.collapse(true);r2.moveToElementText(r1.parentElement());r2.setEndPoint("EndToStart",r1);start=r1.parentElement();r1=range.duplicate();r2=range.duplicate();r2.collapse(false);r1.moveToElementText(r2.parentElement());r1.setEndPoint("StartToEnd",r2);end=r2.parentElement();root=range.parentElement();if(start==end)root=start}if(start&&end&&start==end){return start}else{return null}},removeSelection:function(){if(window.getSelection){if(window.getSelection().empty){window.getSelection().empty()}else if(window.getSelection().removeAllRanges){window.getSelection().removeAllRanges()}}else if(document.selection&&document.selection.empty){document.selection.empty()}},setSelection:function(element){var self=this;var rng,sel;if(document.createRange){rng=document.createRange();rng.selectNode(element);sel=window.getSelection();sel.removeAllRanges();sel.addRange(rng)}else{var rng=document.body.createTextRange();rng.moveToElementText(element);rng.select()}},MAX_PADDING_VALUE:400,MAX_MARGIN_VALUE:600,MAX_RANGE_VALUE:36,MIN_RANGE_VALUE:0,getMinRangeValue:function(element){const $element=$(element);const min=$element.data('min');if(min!==undefined){return min}const param_name=$element.attr('data-param-name')||'';if(param_name.startsWith('margin')){return-this.MAX_MARGIN_VALUE}return this.MIN_RANGE_VALUE},getMaxRangeValue:function(element){const $element=$(element);const max=$element.attr('data-max');if(max!==undefined){return max}const param_name=$element.attr('data-param-name')||'';if(param_name.startsWith('padding')){return this.MAX_PADDING_VALUE}else if(param_name.startsWith('margin')){return this.MAX_MARGIN_VALUE}return this.MAX_RANGE_VALUE},handlerInputSlider:function(input,isLpPanel){var self=this;var $input=$(input);var val=$input.val();var $slider=$input.parents('.box-body').find('.range-slider');var slider_options=$slider.slider("option");var max=slider_options.max||self.getMaxRangeValue($slider);var min=slider_options.min||self.getMinRangeValue($slider);if(!val){val=self.getSliderExponentialPosition(min,max,slider_options.value)}if(parseInt(val)>max){$input.val(max)}else if(parseInt(val)<parseInt(min)){$input.val(min)}const value=parseInt(val);$slider.slider('value',self.getSliderLogPosition(min,max,value));if(isLpPanel){self.changeSlider($slider[0],value)}else{self.rangeSliderCallback($slider[0],value)}},getSliderExponentialPosition:function(min,max,value){if(value===0){return value}else if(min<0&&value<0){const minv=Math.log(Math.abs(min));const maxv=0;const scale=(maxv-minv)/(Math.min(max,0)-min);return-Math.round(Math.exp(minv+scale*(value-min)))}const minv=min>0?Math.log(min):0;const maxv=max>0?Math.log(max):0;const scale=(maxv-minv)/(max-Math.max(min,0));return Math.round(Math.exp(minv+scale*(value-Math.max(min,0))))},getSliderLogPosition:function(min,max,value){if(value===0){return value}else if(min<0&&value<0){const minv=max>0?0:Math.log(Math.abs(max));const maxv=Math.log(Math.abs(min));const scale=(maxv-minv)/(Math.abs(min)-Math.min(max,0));return-((Math.log(Math.abs(value))-minv)/scale+Math.min(max,0))}const minv=min>0?Math.log(min):0;const maxv=max>0?Math.log(max):0;const scale=(maxv-minv)/(max-Math.max(min,0));return(Math.log(value)-minv)/scale+Math.max(min,0)},initRangeSlider:function($container,isLpPanel){var self=this;$container.find('.range-value').on('keyup',function(e){$(this).val($(this).val().replace(/[^\d-]|\b-/,''))});$container.find('.range-value').on('input',$.debounce(800,function(){self.handlerInputSlider(this,isLpPanel);self.applyPopupParams($('.context-popup:visible'))}));$container.find('.range-slider').each(function(){var max=self.getMaxRangeValue(this);var min=self.getMinRangeValue(this);var val=$(this).data('val')?$(this).data('val'):'';$(this).slider({orientation:"horizontal",range:"min",max:max,min:min,value:val,slide:function(event,ui){const slider_options=$(this).slider("option");const max_actual=slider_options.max||max;const min_actual=slider_options.min||min;const value=self.getSliderExponentialPosition(min_actual,max_actual,ui.value);if(isLpPanel){self.changeSlider(this,value)}else{self.rangeSliderCallback(this,value)}$(this).parents('.context-popup').css('background','rgba(255,255,255,.6)')},stop:function(){var $popup=$(this).parents('.context-popup');$popup.css('background','rgba(255,255,255, 1)');self.applyPopupParams($('.context-popup:visible'))}})})},changeSlider:function(slider,value){const self=this;const $slider=$(slider);const $wrapper=$slider.parents('.box-body');if($slider.attr('data-general')){const $parent=$slider.parents('.control-box');$parent.find('.personal-type .range-slider').each(function(){$(this).slider('value',value);self.changeSlider(this,value)});$parent.find('.lp-panel-input-js').trigger('changeInput',value)}else{$wrapper.find('.lp-panel-input-js').trigger('changeInput',value)}$wrapper.find('.range-value').val(value)},rangeSliderCallback:function(slider,value,recurse){var self=this;var elem_class=self.selected_element_class;var $row=$(self.selected_element).parents('.lp-row');var block_id=$row.attr('data-block-id');var $change_elem=elem_class===""?$('#_lp_block_'+block_id):$row.find(elem_class);var popup=$(slider).parents('.context-popup');var type=popup.attr('data-type');var max=self.getMaxRangeValue(slider);var obj={};value=value>max?max:value;if(!$(self.selected_element).length){elem_class='.color-editable-element'}if(!$(self.selected_element).attr('data-rate')){$(self.selected_element).attr('data-rate',parseInt($(self.selected_element).css('width'))/parseInt($(self.selected_element).css('height')))}var param_name=$(slider).attr('data-param-name');$(slider).parents('.box-body').find('.range-value').val(value);if(param_name=='border-radius'&&$(slider).parents('.general-type').length){$(slider).parents('.border-radius-control').find('.personal-type .range-value').val(value);$(slider).parents('.border-radius-control').find('.personal-type .range-slider').slider('value',value)}if(param_name=='box-shadow'){var $shadow_control=$(slider).closest('.shadow-control');var shadow_color=$shadow_control.find('.input-group').data('color');var x=$shadow_control.find('.range-value').eq(0).val();var y=$shadow_control.find('.range-value').eq(1).val();var blur=$shadow_control.find('.range-value').eq(2).val();var spray=$shadow_control.find('.range-value').eq(3).val();var val=x+'px '+y+'px '+blur+'px '+spray+'px '+shadow_color;self.applyStyles(slider,$change_elem,{'box-shadow':val})}else if(param_name==='grad_angle'){$(slider).parents('.box-body').find('.range-value').change()}else if(param_name){if(param_name=='border-width'){var $popup=$(slider).parents('.context-popup');obj['border-style']='solid';obj['border-color']=$popup.find('.colorpicker-component').data('color')}$(slider).parents('.media-rule-box').nextAll().not('.changed-rule').each(function(i,r){var media=$(this).attr('media');var common_param=$(slider).parents('.common-params').find('.general-type .range-slider').attr('data-param-name');var saved=self.getElemCssProp(common_param,null,null,media);if(!saved){var $range_slider=$(r).find('[data-param-name="'+param_name+'"]');var $range_value=$range_slider.parents('.box-body').find('.range-value');$range_value.val(value);$range_slider.slider('value',value);if($(slider).attr('data-general')){$range_slider.parents('.common-params').find('.personal-type .range-value').val(value);$range_slider.parents('.common-params').find('.personal-type .range-slider').slider('value',value)}if($(slider).parents('.personal-type').length){$range_slider.parents('.common-params').find('.general-type .range-value').val('--');$range_slider.parents('.common-params').find('.general-type .range-slider').slider('value',0)}}});if($(slider).parents('.personal-type').length){$(slider).parents('.context-popup').find('.general-type .range-value').val('--');$(slider).parents('.context-popup').find('.general-type .range-slider').slider('value',0)}if($(slider).parents('.general-type').length){$(slider).parents('.general-type').siblings('.personal-type').find('.control-wrap').not('.hide').each(function(i,c){var $s=$(c).find('.range-slider');var p_name=$s.attr('data-param-name');obj[p_name]=value})}else{obj[param_name]=value}if($change_elem.is('._lp-image-container')&&type==='size'){$change_elem.each(function(i,e){if($(e).is('._lp-image-container')){var $img=$(e).find('img').length?$(e).find('img'):$(e).find('svg');if(!$(e).attr('data-thumb-path')&&$(e).find('img').length){var src=$img.attr('src');var origin_path=self.getOriginaPath(src);$(e).attr('data-thumb-path',src);$img.attr('src',origin_path)}if(!window.img_convert_cache.hasOwnProperty(origin_path))window.img_convert_cache[origin_path]={};self.convertImg(window.img_convert_cache[origin_path],$img)}})}self.applyStyles(slider,$change_elem,obj)}if(!recurse&&type==='size'&&popup.find('.fix-btn').length&&popup.find('.fix-btn').hasClass('active')){var param=$(slider).attr('data-param-name');var param2=param=='width'?'height':'width';var slider_option=$(slider).slider('option');var slider_value=slider_option.value;var max=slider_option.max||self.getMaxRangeValue(slider);var $slider2=popup.find('[data-param-name="'+param2+'"]');var val;var rate=$(self.selected_element).attr('data-rate');if(param2=='height'){val=parseInt(value/rate)}else{val=parseInt(value*rate)}if(!val){val=value}$slider2.slider('option','max',max);$slider2.slider('value',slider_value>max?max:slider_value);self.rangeSliderCallback($slider2[0],val>max?max:val,true)}if($(slider).attr('data-general')){const minValue=self.getMinRangeValue(slider);const isLogValue=['padding','margin','border-radius'].some(prefix=>param_name.startsWith(prefix));const sliderValue=isLogValue?self.getSliderLogPosition(minValue,max,value):value;$(slider).parents('.common-params').find('.personal-type .range-value').val(value);$(slider).parents('.common-params').find('.personal-type .range-slider').slider('value',sliderValue)}},showAddButton:function(){var html='<div class="lp-block-add-wrap" onclick="LpController.foldersToggle(event);">\n'+'        <span class="lp-block-add-button"><span class="s3-ico i-add-black-svg"></span></span>\n'+'    </div>';if($('.lp-block-add-wrap').length){$('.lp-block-add-wrap').show()}else{$('#landing_page_site').prepend(html)}},updateFormParams:function(btn){var self=this;var row=$(self.selected_element).parents('.lp-row');var block_id=row.attr('data-block-id');var layout_id=row.attr('data-block-layout-id');const findKeyInObject=function(obj,key){const array=Object.keys(obj).filter(function(item){return item.indexOf(key)!==-1});return array.length>0?array[0]:false};if(self.lp_blocks[block_id]&&self.lp_blocks[block_id].data){var anketa_id;var anketa_key=findKeyInObject(self.lp_blocks[block_id].data,'anketa_');if(self.lp_blocks[block_id].data.form){anketa_id=self.lp_blocks[block_id].data.form.anketa_id}else if(anketa_key){anketa_id=self.lp_blocks[block_id].data[anketa_key].anketa_id}if(anketa_id){openAjaxForm('/-/cms/v1/anketa/?act=view&'+S3_ACCESS+'&object_id='+anketa_id+'&popup=1&ver_id='+VER_ID,null,function(){LpController.updateBlockHtml(block_id,layout_id)})}}},initDrag:function($popup){$popup.draggable({handle:$popup.find('.header-title'),distance:30,refreshPositions:true,drag:function(e,ui){if(ui.position.top<=0){ui.position.top=0}}})},hasSelection:function(not_remove){var self=this;var has_selection=false;if(!not_remove&&window.getSelection().toString()&&$(self.selected_element).text()&&window.getSelection().toString()==$(self.selected_element).text()){window.getSelection().removeAllRanges()}if(window.getSelection().toString()&&$(window.getSelection().focusNode).closest(self.selected_element_class).length){var sel_elem=self.getSelectionElement();has_selection=true;if(sel_elem&&($(sel_elem).closest('[data-elem-type="form"]').length||$(sel_elem).closest('[data-elem-type="button"]').length||$(sel_elem).closest(self.button_default_class).length)){has_selection=false}}return has_selection},togglePopupProp:function(checkbox){var self=this;var $popup=$(checkbox).parents('.context-popup');var type=$popup.attr('data-type');var $row=$(self.selected_element).parents('.lp-row');var block_id=$row.attr('data-block-id');var popup_params;var param;if(!$(checkbox).prop('checked')){self.initCssParamsKeys(block_id,self.selected_element_class);param=self.css_params[block_id][self.selected_element_class];if(!param.hasOwnProperty('commented_props')){param['commented_props']={}}if(!param['commented_props'].hasOwnProperty(self.selected_element_class)){param['commented_props']={}}if(type==='box_shadow'){if(self.selected_element.style.boxShadow){var bsh_props=self.parseBoxShadow($(self.selected_element).css('box-shadow'));param['commented_props']['box_shadow']={color:bsh_props[0].color,offset_x:bsh_props[0].offset_x,offset_y:bsh_props[0].offset_y,blur:bsh_props[0].blur,spread:bsh_props[0].spread};self.applyStyles($popup.find('.range-value').eq(0),$row.find(self.selected_element_class),{'box-shadow':'0 0 0 0 transparent'})}else{self.applyStyles($popup.find('.range-value').eq(0),$row.find(self.selected_element_class),{'box-shadow':'0 0 0 0 transparent'});popup_params=self.getElemCssParams($popup);param['commented_props']['box_shadow']=popup_params['box_shadow'];if(popup_params.hasOwnProperty(self.selected_element_class+":hover")&&popup_params[self.selected_element_class+":hover"].hasOwnProperty('box_shadow')){if(!param['commented_props'].hasOwnProperty(":hover"))param['commented_props'][":hover"]={};param['commented_props'][":hover"]['box_shadow']=popup_params[self.selected_element_class+":hover"]['box_shadow']}if(popup_params[self.selected_element_class+":active"]&&popup_params[self.selected_element_class+":active"].hasOwnProperty('box_shadow')){if(!param['commented_props'].hasOwnProperty(":active"))param['commented_props'][":active"]={};param['commented_props'][":active"]['box_shadow']=popup_params[self.selected_element_class+":active"]['box_shadow']}}}else if(type==='border'){if(self.selected_element.style.border||self.selected_element.style.borderRadius){var bdc=$(self.selected_element).css('border-color');var bdw=$(self.selected_element).css('border-width');param['commented_props']['border_radius']={lt:parseInt($(self.selected_element).css('border-top-left-radius')),rt:parseInt($(self.selected_element).css('border-top-right-radius')),lb:parseInt($(self.selected_element).css('border-bottom-left-radius')),rb:parseInt($(self.selected_element).css('border-bottom-right-radius'))};param['commented_props']['border']={color:bdc,style:'solid',width:parseInt(bdw)};self.applyStyles($popup.find('.range-value').eq(0),$row.find(self.selected_element_class),{'border-width':0,'border-radius':0})}else{self.applyStyles($popup.find('.range-value').eq(0),$row.find(self.selected_element_class),{'border-width':0,'border-radius':0});popup_params=self.getElemCssParams($popup);param['commented_props']['border']=popup_params['border'];param['commented_props']['border_radius']=popup_params['border_radius'];if(popup_params.hasOwnProperty(self.selected_element_class+":hover")&&popup_params[self.selected_element_class+":hover"].hasOwnProperty('border')){if(!param['commented_props'].hasOwnProperty(":hover"))param['commented_props'][":hover"]={};param['commented_props'][":hover"]['border']=popup_params[self.selected_element_class+":hover"]['border']}if(popup_params[self.selected_element_class+":active"]&&popup_params[self.selected_element_class+":active"].hasOwnProperty('border')){if(!param['commented_props'].hasOwnProperty(":active"))param['commented_props'][":active"]={};param['commented_props'][":active"]['border']=popup_params[self.selected_element_class+":active"]['border']}}}}else{param=self.css_params[block_id][self.selected_element_class];if(param.commented_props&&param.commented_props[type]){var data={};if(type==='border'){if(param.commented_props.hasOwnProperty('border')){data['border']=param.commented_props['border']}if(param.commented_props.hasOwnProperty('border_radius')){param['border_radius']=data['border_radius']=param.commented_props['border_radius'];delete param.commented_props['border_radius']}}else{data[type]=param.commented_props[type]}var css=self.convertCssValue(data);self.applyStyles(null,$row.find(self.selected_element_class),css);param[type]=param.commented_props[type];delete param.commented_props[type];if(param.commented_props.hasOwnProperty(":hover")){param[self.selected_element_class+":hover"][type]=param.commented_props[":hover"][type];delete param.commented_props[":hover"][type]}if(param.commented_props.hasOwnProperty(":active")){param[self.selected_element_class+":active"][type]=param.commented_props[":active"][type];delete param.commented_props[":active"][type]}}}$popup.find('.header-body').toggleClass('disabled')},applyStyles:function(control,$elem,css_obj){var not_apply=false;if(control&&$(control).parents('.media-rule-box').length){var $rule=$(control).parents('.media-rule-box');$rule.addClass('changed-rule');if($rule.attr('data-media')!='screen'){not_apply=true}}if(!not_apply){$elem.css(css_obj)}},setModified:function(){var self=this;if($(self.selected_element).is('svg')){var cls=$(self.selected_element).attr('class')?$(self.selected_element).attr('class'):'';$(self.selected_element).attr('class',cls+' modified')}else{$(self.selected_element).addClass('modified')}},reInitCssObject:function(block_id){var self=this;self.css_params[block_id]={};if(self.lp_blocks[block_id]&&self.lp_blocks[block_id]['css_json']){var css_json=JSON.parse(self.lp_blocks[block_id]['css_json']);if(css_json.hasOwnProperty('css')){var theme_id='theme_'+self.lp_blocks[block_id]['layout_id'];if(css_json['css'].hasOwnProperty(theme_id)){for(var selector in css_json['css'][theme_id]){if(css_json['css'][theme_id].hasOwnProperty(selector)){self.css_params[block_id][selector]=css_json['css'][theme_id][selector]}}}}}},getMediaData:function(element,key){var self=this;var media=element.data('media')?JSON.parse(element.data('media')):{};var data={};if(media.hasOwnProperty(key)){data=media[key]}return data},updateMediaData:function(element,key,data){var self=this;var media=element.data('media')?JSON.parse(element.data('media')):{};media[key]=data;element.data('media',JSON.stringify(media))},getVideoDataPath:function(path){const self=this;if($(self.selected_element).attr('data-path')){const pathArray=$(self.selected_element).attr('data-path').split(".");pathArray.pop();return[...pathArray,path].join(".")}return path},removeMediaData:function(element,key){var media=element.data('media')?JSON.parse(element.data('media')):{};if(key&&media.hasOwnProperty(key)){delete media[key]}element.data('media',JSON.stringify(media))},_get:function(url,key){var params=url.replace('?','&').split('&').reduce(function(p,e){var a=e.split('=');p[decodeURIComponent(a[0])]=decodeURIComponent(a[1]);return p},{});return params.hasOwnProperty(key)?params[key]:null},isJsonString:function(str){try{JSON.parse(str)}catch(e){return false}return true},getOriginaPath:function(thumb_path){var self=this;var path_arr=thumb_path.split("/");var filename=path_arr[path_arr.length-1];return"/d/"+filename.trim()},toggleElement:function(condition,$element){if(condition){$element.show()}else{$element.hide()}},initHelp:function(){var self=this;if(!$(self.row).length||!$("[data-elem-type]").length){return}var $title=$(self.row).eq(0).find('[data-elem-type="header"]').length?$(self.row).eq(0).find('[data-elem-type="header"]'):$("[data-lp-selector]").eq(0);var title_selector=$title.attr('data-lp-selector');self.onboarding=new Onboarding({cookie_name:'lp_training_completed',steps:[{title:s3.loc('WELCOME'),text:self.content_lp?s3.loc('LPC_WELCOME_TEXT'):s3.loc('LP_WELCOME_TEXT'),attachTo:{on:'center'}},{title:s3.loc('LP_HELP_STEP1_TITLE'),text:s3.loc('LP_HELP_STEP1_BODY'),beforeShowPromise:function(){$('.lp-greeting-block').hide();$('.block-css-controls').hide()},attachTo:{element:title_selector,on:'bottom'},},{title:s3.loc('LP_HELP_STEP2_TITLE'),text:s3.loc('LP_HELP_STEP2_BODY'),beforeShowPromise:function(){$('.lp-row:nth-child(2) .lp-row-add-wrap').hide().removeClass('show');self.prepareControls($(title_selector),$(title_selector).attr('data-elem-type'));$('.block-css-controls').show()},attachTo:{element:'.block-css-controls',on:'bottom'}},{title:s3.loc('LP_HELP_STEP3_TITLE'),text:s3.loc('LP_HELP_STEP3_BODY'),beforeShowPromise:function(){$('.lp-row:nth-child(2) .lp-row-add-wrap').addClass('show');$('.block-css-controls').hide()},attachTo:{element:'.lp-row:nth-child(2) .lp-row-add-wrap',on:'bottom'}},{title:s3.loc('LP_HELP_STEP4_TITLE'),text:s3.loc('LP_HELP_STEP4_BODY'),beforeShowPromise:function(){$('.lp-row:nth-child(2) .lp-row-add-wrap').hide().removeClass('show')},attachTo:{element:'.preview-btn',on:'bottom'}}],onClose:function(){$('.lp-row:nth-child(2) .lp-row-add-wrap').removeClass('show')},});if(window.innerWidth>767){self.showHelp()}},showHelp:function(timeout,force,days){var self=this;if(self.onboarding){self.onboarding.start(timeout,force,days)}},setLpcParams:function($container,after_set,call_init_function){if(!$container){$container=$('body')}var self=this;var $iframe=$container.find('#lpc_contructor_iframe');if($iframe.length&&$iframe.contents().find('.lpc-content-wrapper').length&&$container.find('.content-lp-wrapper').length){var $lpc_wrap=$iframe.contents().find('.lpc-content-wrapper');var content_width=$lpc_wrap.width();var $article=$container.find('.content-lp-wrapper article');if(self.deleted_block_id&&$lpc_wrap.find('#_lp_block_'+self.deleted_block_id).length){$lpc_wrap.find('#_lp_block_'+self.deleted_block_id).remove();self.deleted_block_id=0}$iframe.contents().find('.lpc-content-wrapper *').css('visibility','hidden');$article.css({'max-width':content_width,'width':content_width,'margin-left':$lpc_wrap.offset().left,'margin-top':$lpc_wrap.offset().top,});self.changeAddButtonPosition(content_width);if(call_init_function&&self.preset_id==2661&&window.lp_init&&typeof window.lp_init==='function'){window.lp_init($container)}setTimeout(function(){setHeight()},200);function setHeight(){var iframeBody=$iframe.contents().find('body');$article.css('min-height','');$lpc_wrap.css('min-height','');$container.find('#lp_constructor').css('min-height','');iframeBody.css('min-height','');var article_height=$article.outerHeight();var $cur_doc=$container.find('#lp_constructor');var doc_height=$($iframe[0].contentDocument).height();if($cur_doc.height()>doc_height){iframeBody.css('min-height',$cur_doc.height())}else{$cur_doc.css('min-height',doc_height)}if($lpc_wrap.height()>article_height){$article.css('min-height',$lpc_wrap.height())}else{$lpc_wrap.css('min-height',article_height)}$article.css('visibility','visible');if(after_set&&typeof after_set==='function'){after_set()}}}},addBlockToLpcIframe:function($block,data){var self=this;if($block&&$('#lpc_contructor_iframe').length&&$('#lpc_contructor_iframe').contents().find('.decor-wrap').length){if(data){self.setRequires(data,$('#lpc_contructor_iframe').contents().find('.lpc-content-wrapper'))}$('#lpc_contructor_iframe').contents().find('.decor-wrap').append($block)}},changeAddButtonPosition:function(content_width){var self=this;if(!$('.site-controls .controls-inner').length){return}if(getMaxPanelWidth().width+20>=content_width/2){$('#landing_page_site').addClass('small-container')}else{$('#landing_page_site').removeClass('small-container')}if(getMaxPanelWidth().width+20>=content_width/2){var l=getMaxPanelWidth().left-24-20;$('.lp-row-add-wrap').css('left',l)}else{$('.lp-row-add-wrap').css('left','')}function getMaxPanelWidth(){var data={'width':0};$('.site-controls .controls-inner').each(function(i,e){if($(e).outerWidth()>data['width']){data['width']=$(e).outerWidth();data['left']=$(e).position().left}});return data}},setRequires:function(data,wrap){if(typeof data==='string'){data=JSON.parse(data)}if(!wrap){wrap=$('#landing_page_site')}data.forEach(function(require_item){if(require_item.ext=='css'){var $old_obj=wrap.find('link[data-url="'+require_item.url+'"]');if($old_obj.length>0){$old_obj.attr('href',require_item.url+'?rnd='+Date.now())}else{var $obj=$('<link rel="stylesheet" type="text/css"/>');$obj.attr('href',require_item.url+'?rnd='+Date.now());$obj.attr('data-url',require_item.url);wrap.prepend($obj)}}else if(require_item.ext=='js'){var obj='<script type="text/javascript" src="'+require_item.url+'"></script>';wrap.prepend(obj)}})},afterSave:function(f){var self=this;if(typeof f==='function'){self.after_save_callback=f}},openSetBlockThrough:function(block_id,block_layout_id,anchor_only){if(!block_id||!block_layout_id){return false}var self=this,form=$(self.samples_wrapper).find('form#add_block_'+block_layout_id),block_id=parseInt(block_id),url='/-/cms/v1/lp/block/?act=edit&'+S3_ACCESS,callback_done=false,callback=function(){if(!callback_done){callback_done=true;popupController.closeLastPopup();self.updateBlockHtml(block_id,block_layout_id)}};openAjaxForm(url,callback,function(){popupController.closeLastPopup()},function(){console.log('done')});const $popup=$(popupController.getLastPopup().obj);$popup.find('#tab-').prepend('<div class="through-blocks-form__tooltip"><span>'+s3.loc('JS_LP_THROUGH_NOTICE')+'</span></div>');$popup.find('.draggable_title .title').text(s3.loc('JS_LP_THROUGH_BLOCKS'));$popup.find('#tab-').append('<div class=""><label><div class="form-item-title"><span class="form_required">*</span><b>'+s3.loc('JS_LP_THROUGH_BLOCKS_NAME')+':</b></div><input class="s3-input-text" type="text" size="37" id="name" name="name" maxlength="100" value=""></label><br><br></div>');$popup.find('.popup-buttons button').attr({'type':'button','onclick':`LpController.setBlockThrough(${block_id})`})},setBlockThrough:function(block_id){const $block=$('#_lp_block_'+block_id),$parent=$block.parents('.lp-row'),layout_id=$parent.attr(`data-block-layout-id`),self=this;if(!block_id||!layout_id)return;const name=$(popupController.getLastPopup().obj).find('#tab- .s3-input-text').val();if(!name){$('#ajaxPopupWindow_1').find('#tab- .s3-input-text').parent().append('<span class="form_error" style="display: block;">'+s3.loc('REQUIRED_FIELD_ERROR')+'</span>');return}const url=`/-/cms/v1/lp/block/?act=set_through&${S3_ACCESS}&variant_id=${this.variant_id}&block_id=${block_id}&layout_id=${layout_id}`;$.ajax({url:url,type:'POST',async:false,data:{name},success:function(e){try{const response=JSON.parse(e);if(response.done){$parent.attr('data-variant-id',0);$parent.attr(`data-variant-block-id`,response.variant_block_id);let $settings=$parent.find(`[data-metrika="landingBlockSettings"]`),onClick=$settings.attr('onclick');onClick=onClick.replace(`undefined`,response.variant_block_id).replace(self.variant_id,0);$settings.attr('onclick',onClick);self.reloadThroughCategory();self.updateThroughBlockControl(response,$block);util.msg(s3.loc('JS_SAVED'),'green')}}catch(e){console.error(e)}},error:function(e){console.log('Error',e)}});$block.find('.site-controls .edit-through-block').show();popupController.closeLastPopup();return false},updateThroughBlockControl:function(response,block){const self=this;const $parent=block.parents('.lp-row'),layoutId=$parent.attr(`data-block-layout-id`),$control=$parent.find(`[data-metrika="landingBlockThrough"]`);if(response.variant_block_id){$control.attr('onclick',`LpController.unpinThroughBlock(${response.variant_block_id})`);$control.find('.s3-btn-title').text(s3.loc('JS_LP_THROUGH_UNPIN_BUTTON'))}else{$control.attr('onclick',`LpController.openSetBlockThrough(${response.data.block_id},${layoutId},0)`);$control.find('.s3-btn-title').text(s3.loc('JS_LP_THROUGH_PIN_BUTTON'))}},unpinThroughBlock:function(variant_block_id){if(!variant_block_id)return;const url=`/-/cms/v1/lp/block/?act=unpin_through&${S3_ACCESS}&variant_id=${this.variant_id}&variant_block_id=${parseInt(variant_block_id)}`,$row=$(`[data-variant-block-id="${variant_block_id}"]`),$block=$row.find(`[id^="_lp_block_"]`),$form=$row.find('form[data-block-id]'),self=this;popupController.closeLastPopup();$('#modal_layer').show();setTimeout(function(){$('#modal_layer').hide();s3.confirm(s3.loc('JS_LP_THROUGH_CONFIRM_UNPIN'),function(){$.ajax({url:url,type:'POST',async:false,success:function(e){$row.attr('data-variant-id',self.variant_id);try{self.reloadCustomStyles(()=>{const response=JSON.parse(e),data=response.data,variant_block_id=$row.attr('data-variant-block-id'),old_block_id=$row.attr(`data-block-id`);$row.attr('data-json-id',data.json_id);$row.attr('data-block-id',data.block_id);$row.attr(`data-variant-block-id`,null);$row.find('.site-controls .edit-through-block').hide();const $edit=$row.find(`[data-metrika="landingBlockEdit"]`),$settings=$row.find(`[data-metrika="landingBlockSettings"]`),$moreBlock=$row.find(`.more-block`);let onClick=$settings.attr('onclick');onClick=onClick.replace(variant_block_id,undefined).replace(`0,0`,`0,${self.variant_id}`).replace(old_block_id,data.block_id);$settings.attr('onclick',onClick);onClick=$edit.attr('onclick');onClick=onClick.replace(old_block_id,data.block_id);$edit.attr('onclick',onClick);onClick=$moreBlock.attr('onclick');onClick=onClick.replace(old_block_id,data.block_id);$moreBlock.attr('onclick',onClick);$block.attr('id',`_lp_block_${data.block_id}`);$form.attr('data-block-id',data.block_id);$form.attr('id',`edit_block_${data.block_id}`);$form.find('input[name="object_id"]').val(data.block_id);$form.find('input[name="block_id"]').val(data.block_id);self.updateThroughBlockControl(response,$block)})}catch(e){console.error(e)}util.msg(s3.loc('JS_SAVED'),'green');popupController.closeLastPopup()},error:function(e){console.log('Error',e)}})})},0);popupController.closeLastPopup();return false},deleteThroughBlockInCategory:function(preview){const $preview=$(preview),$form=$preview.parents('form'),block_id=parseInt($form.find(`input[name="block_id"]`).val()),layout_id=parseInt($form.find(`input[name="layout_id"]`).val());if(!block_id||!layout_id)return;const url=`/-/cms/v1/lp/block/?act=delete_through&${S3_ACCESS}&variant_id=${this.variant_id}&block_id=${block_id}&layout_id=${layout_id}`;s3.confirm(s3.loc('JS_LP_THROUGH_DELETE_BLOCK'),function(){$.ajax({url:url,type:'POST',async:false,success:function(e){try{const response=JSON.parse(e);if(response.done){$form.remove();util.msg(s3.loc('JS_SAVED'),'green')}else{$('body').append('<div id="popup-message"><div class="bluepopup-wrapper"><span class="s3-ico winclose-thin close-btn" onclick="$(\'#popup-message\').remove();"></span><span class="text"><b>Невозможно удалить сквозной блок.</b><br> Блок используется на страницах сайта. Чтобы удалить блок из списка сквозных, сперва открепите или удалите созданные на его основе блоки на страницах сайта.</span></div></div>');setTimeout(function(){$('#popup-message').remove()},7000)}}catch(e){console.error(e)}popupController.closeLastPopup()},error:function(e){console.log('Error',e)}})});return false},reloadThroughCategory:function(){const $folder=$(`#sample_blocks div.sample-block-list div.folder-preset-list[data-folder-id="-1"]`);$folder.remove()},layoutUploadPreviewInit:function(containerId){const $container=$(containerId);const $fileListContainer=$container.find('.upload-file-list');if(!$container&&!$fileListContainer){return}const fileInputs=$container.find('input[type="file"]').toArray();const selectedFiles=new Map();fileInputs.forEach((fileInput)=>{const fileButton=$('<span class="s3-btn-v2 gray">Выбрать файл</span>');const $fileInput=$(fileInput);const $fileInputWrapper=$fileInput.parent();fileButton.appendTo($fileInputWrapper);$fileInput.css({'position':'absolute','visibility':'hidden',});$fileInput.change(function(){if(!fileInput.files.length){return}const selectedFile=selectedFiles.get(fileInput.id);if(selectedFile){selectedFile.remove()}const $deleteIcon=$('<span class="s3-ico-24 i-trash red"></span>');const $uploadFileListItem=$('<span class="upload-file-list__item">'+fileInput.files[0].name+'</span>');$deleteIcon.prependTo($uploadFileListItem);$deleteIcon.click(function(){fileInput.value='';$uploadFileListItem.remove()});$uploadFileListItem.appendTo($fileListContainer);selectedFiles.set(fileInput.id,$uploadFileListItem)})});$container.data('uploader-init',true)},startOnboarding:function(ignoreCookie=false){const cookieName='lp_onboarding_viewed';if(util.readCookie(cookieName)&&!ignoreCookie)return;const steps=[{title:s3.loc('JS_LP_ONBOARDING_TITLE_STEP_1'),text:s3.loc('JS_LP_ONBOARDING_TEXT_STEP_1'),classes:'step-1',},{title:s3.loc('JS_LP_ONBOARDING_TITLE_STEP_2'),text:s3.loc('JS_LP_ONBOARDING_TEXT_STEP_2'),classes:'step-2',},{title:s3.loc('JS_LP_ONBOARDING_TITLE_STEP_3'),text:s3.loc('JS_LP_ONBOARDING_TEXT_STEP_3'),classes:'step-3',},{title:s3.loc('JS_LP_ONBOARDING_TITLE_STEP_4'),text:s3.loc('JS_LP_ONBOARDING_TEXT_STEP_4'),classes:'step-4',},{title:s3.loc('JS_LP_ONBOARDING_TITLE_STEP_5'),text:s3.loc('JS_LP_ONBOARDING_TEXT_STEP_5'),classes:'step-5',},{title:s3.loc('JS_LP_ONBOARDING_TITLE_STEP_6'),text:s3.loc('JS_LP_ONBOARDING_TEXT_STEP_6'),classes:'step-6',}];const tour=new Shepherd.Tour({classPrefix:'lpc-onboarding',useModalOverlay:true,defaultStepOptions:{cancelIcon:{enabled:true},when:{show:function(){if(typeof this.id!=='number')return;const content=this.el.querySelector('.lpc-onboarding-shepherd-content');if(content.querySelector('.dots-wrapper')){return}const dots=document.createElement('div');dots.classList.add('dots-wrapper');steps.forEach((_,index)=>{if(index===0)return;const dot=document.createElement('span');dot.classList.add('dot');if(index===this.id){dot.classList.add('active')}dot.addEventListener('click',()=>{this.tour.show(index)});dots.appendChild(dot)});content.appendChild(dots)},},},});steps.forEach((step,index)=>{let buttons=[];buttons=[{text:s3.loc('JS_CONTINUE'),classes:'s3-btn-v2 green',action(){this.next()}}];if(index===0){buttons=[{text:s3.loc('JS_NOT_NOW'),classes:'s3-btn-v2 gray without-margin',action(){this.cancel()}},{text:s3.loc('JS_YES_CONTINUE'),classes:'s3-btn-v2 green',action(){this.next()}}]}if(steps.length===index+1){buttons=[{text:s3.loc('JS_FINISH'),classes:'s3-btn-v2 green',action(){this.next()}}]}tour.addStep({...step,id:index,buttons:buttons,})});tour.start();if(!ignoreCookie){util.createCookie(cookieName,true,10000)}},syncSiteStyles:function(){const self=this;const iframe=document.getElementById('lpc_contructor_iframe');if(!iframe){return}Preloader.show();const iframeDocument=iframe.contentWindow.document;const mainPageIframe=document.createElement('iframe');mainPageIframe.src=window.location.origin;mainPageIframe.style.width='100%';mainPageIframe.style.height='1px';document.body.appendChild(mainPageIframe);mainPageIframe.onload=function(){try{const GsParams=JSON.parse(self.visual.visual_params);const data={...GsParams,css:{...self.getSiteFontStyles(iframeDocument),...GsParams.css,},variables:{...self.getSiteBaseVariables(iframeDocument,mainPageIframe),...GsParams.variables,}};self.saveGlobalStyle(data);Preloader.hide();mainPageIframe.remove()}catch(e){Preloader.hide();mainPageIframe.remove();console.error(e)}}},getSiteBaseVariables:function(document,mainPageDocument){return{...this.getTextBaseVariables(document),...this.getHeaderBaseVariable(document),...this.getContentBackgroundVariable(document),...this.getSitePrimaryColorVariables(mainPageDocument)}},colorSort:{diffH:10,diffS:10,diffB:10,sMin:5,disableColorFactor:0},parseRGB:function(color){const colorObj=tinycolor(color);if(!colorObj.isValid()){throw new Error('Invalid color format')}const{r,g,b}=colorObj.toRgb();return{R:r,G:g,B:b}},rgbToHsb:function(rgb){let{R,G,B}=rgb;R/=255;G/=255;B/=255;const max=Math.max(R,G,B);const min=Math.min(R,G,B);const delta=max-min;let h,s,b;b=max*100;if(max===min){s=0;h=0}else{s=delta/max*100;if(R===max){h=(G-B)/delta}else if(G===max){h=2+(B-R)/delta}else{h=4+(R-G)/delta}h*=60;if(h<0){h+=360}}return{h,s,b}},calculateColorDifference:function(color1,color2){const{diffH,diffS,diffB}=LpController.colorSort;const etalonHSB=color1;const targetHSB=color2;const hDifference=Math.abs(targetHSB.h-etalonHSB.h)%360;const isSimilar=hDifference<diffH&&Math.abs(targetHSB.s-etalonHSB.s)<diffS&&Math.abs(targetHSB.b-etalonHSB.b)<diffB;return isSimilar},convertToColorArray:function(colorMap){return Object.keys(colorMap).map((color)=>({color,rgb:LpController.parseRGB(color),hsb:LpController.rgbToHsb(LpController.parseRGB(color)),weight:LpController.getWeight(LpController.rgbToHsb(LpController.parseRGB(color))),hex:LpController.rgba2hex(color),count:colorMap[color].count,areas:colorMap[color].areas,}))},processNumber:function(inputNumber){if(inputNumber>180&&inputNumber<300){if(inputNumber<240){return 0.12+(240-inputNumber)/100*0.295}else if(inputNumber==240){return 0.12}else{return 0.12+(inputNumber-241)/100*0.298}}else if(inputNumber>=0&&inputNumber<=180){return 1-inputNumber/100*0.390}else if(inputNumber>=300&&inputNumber<=360){return 0.3+(inputNumber-300)/100*1.17}else{return"Number outside the range 0 to 360"}},getWeight:function(hsb){return Math.sqrt(Math.pow(hsb.s,2)*Math.pow(hsb.b,2.5)*(LpController.colorSort.disableColorFactor?1:LpController.processNumber(hsb.h)))},markSimilarColors:function(colorArray){if(colorArray.length<=1){return colorArray}const groupSimilarColors=(colors)=>{const colorGroups=[];colors.forEach((color)=>{let addedToGroup=false;for(let i=0;i<colorGroups.length;i++){const existingGroup=colorGroups[i];const isSimilar=LpController.calculateColorDifference(color.hsb,existingGroup[0].hsb);if(isSimilar){existingGroup.push(color);addedToGroup=true;break}}if(!addedToGroup){colorGroups.push([color])}});return colorGroups};const sortAndMarkGroups=(colorGroups,method)=>{if(Array.isArray(colorGroups)){colorGroups.sort((group1,group2)=>{const value1=method==='count'?group1[0].count:group1[0].weight;const value2=method==='count'?group2[0].count:group2[0].weight;return value2-value1});colorGroups.forEach((colorGroup)=>{colorGroup.sort((color1,color2)=>color2.count-color1.count);colorGroup.forEach((color,index)=>(color.isSimilar=index!==0))})}};const colorfulColors=groupSimilarColors(colorArray.filter((color)=>LpController.isColorful(color.hsb)));const grayscaleColors=groupSimilarColors(colorArray.filter((color)=>!LpController.isColorful(color.hsb)));sortAndMarkGroups(colorfulColors,'weight');sortAndMarkGroups(grayscaleColors,'count');return colorfulColors.concat(grayscaleColors).flat()},isColorful:function(hsbColor){return hsbColor.s>LpController.colorSort.sMin},rgbaToRgb:function(rgbaColor){const color=tinycolor(rgbaColor);if(color._roundA<1){const{r,g,b}=color.toRgb();return`rgb(${r},${g},${b})`}else{return rgbaColor}},rgba2hex:function(orig){const color=tinycolor(orig);return[color.toHex(),color.getAlpha()]},getBackgroundColor:function(mainPageDocument){const iframeDocument=mainPageDocument.contentWindow.document;const body=iframeDocument.body;const filteredElements=[];function isVisible(element){const style=window.getComputedStyle(element);return((element.offsetWidth>0||element.offsetHeight>0||element.getClientRects().length>0)&&style.display!=='none'&&style.visibility!=='hidden'&&style.opacity!=='0'&&element.textContent.trim())}function isFilteredElement(element){return(!element.classList.contains('lpc-content-wrapper')&&!element.closest('.lpc-content-wrapper')&&!element.classList.contains('product-flags')&&!element.closest('.product-flags')&&!element.classList.contains('product-label')&&!element.closest('.product-label'))}function getAllElements(element){if(!isVisible(element))return;if(isFilteredElement(element)){filteredElements.push(element)}const children=element.children;for(let i=0;i<children.length;i++){getAllElements(children[i])}}getAllElements(body);const backgroundColors={};filteredElements.forEach((element)=>{const styles=getComputedStyle(element);const backgroundColor=styles.backgroundColor;const elementArea=element.clientWidth*element.clientHeight;if(backgroundColor&&tinycolor(backgroundColor).getAlpha()!==0&&backgroundColor!=='transparent'){const backgroundColorKey=LpController.rgbaToRgb(backgroundColor).toLowerCase();if(!backgroundColors[backgroundColorKey]){backgroundColors[backgroundColorKey]={color:backgroundColorKey,count:0,areas:0,}}backgroundColors[backgroundColorKey].count++;backgroundColors[backgroundColorKey].areas+=elementArea}});const backgroundColorsArray=LpController.convertToColorArray(backgroundColors);const markSimilarColor=LpController.markSimilarColors(backgroundColorsArray);const filteredColors=markSimilarColor.filter(color=>!color.isSimilar);return filteredColors},getSitePrimaryColorVariables:function(mainPageDocument){const primaryColors=this.getBackgroundColor(mainPageDocument);if(!tinycolor(primaryColors[0].color).isValid()){return}const colorsOnly=primaryColors.map(colorInfo=>tinycolor(colorInfo.color).toHexString());const variable='--primary-color-base';const prefix='--primary-color';const result={};const alpha=[['005',0.05],['01',0.1],['02',0.2],['03',0.3],['04',0.4],['05',0.5],['06',0.6],['07',0.7],['08',0.8],['09',0.9],];const lightness=[5,10,15,20,25,30,35,40,45,50,55,60];const baseColor=tinycolor(primaryColors[0].color).toHexString();result[variable]=baseColor;result[`${variable}-all`]=colorsOnly.toString();alpha.forEach(function(value){result[`${prefix}-a-${value[0]}`]=tinycolor(baseColor).setAlpha(Number(value[1])).toString()});lightness.forEach(function(value){result[`${prefix}-l-${value}`]=tinycolor(baseColor).lighten(value).toHexString()});result[`${prefix}-d-5`]=tinycolor(baseColor).darken(5).toHexString();result[`${prefix}-d-10`]=tinycolor(baseColor).darken(10).toHexString();return result},getTextBaseVariables:function(document){const container=document.querySelector(".lpc-content-wrapper").parentElement;if(!container){return}const elem=document.createElement('p');container.append(elem);const color=getComputedStyle(elem).getPropertyValue('color');elem.remove();if(!tinycolor(color).isValid()){return}const variable='--text-color-base';const prefix='--text-color';const result={};const alpha=[['005',0.05],['01',0.1],['02',0.2],['03',0.3],['04',0.4],['05',0.5],['06',0.6],['07',0.7],['08',0.8],['09',0.9],];result[variable]=tinycolor(color).toHexString();alpha.forEach(function(value){result[`${prefix}-a-${value[0]}`]=tinycolor(color).setAlpha(Number(value[1])).toString()});return result},getHeaderBaseVariable:function(document){const container=document.querySelector(".lpc-content-wrapper").parentElement;if(!container){return}const variable='--text-color-base-header';const elem=document.createElement('h2');container.append(elem);const color=getComputedStyle(elem).getPropertyValue('color');elem.remove();if(!tinycolor(color).isValid()){return}return{[variable]:tinycolor(color).toString()}},getSiteFontStyles:function(document){const container=document.querySelector(".lpc-content-wrapper").parentElement;if(!container){return}const result={};const elements=[{tag:'p',selector:'.lpc-wrap .lp-header-text-1, .lpc-wrap .lp-header-text-2, .lpc-wrap .lp-header-text-3, .lpc-wrap .lp-header-text-4',properties:['font-family','font-style','font-weight'],},{tag:'p',selector:'.lp-button',properties:['font-family','font-style']},{tag:'h1',selector:'.lpc-wrap h1, .lpc-wrap .lp-header-title-1',properties:['font-family','font-style','font-weight'],},{tag:'h2',selector:'.lpc-wrap h2, .lpc-wrap .lp-header-title-2',properties:['font-family','font-style','font-weight'],},{tag:'h3',selector:'.lpc-wrap h3, .lpc-wrap .lp-header-title-3',properties:['font-family','font-style','font-weight'],},{tag:'h4',selector:'.lpc-wrap h4, .lpc-wrap .lp-header-title-4',properties:['font-family','font-style','font-weight'],},{tag:'h5',selector:'.lpc-wrap h5, .lpc-wrap .lp-header-title-5',properties:['font-family','font-style','font-weight'],},{tag:'h6',selector:'.lpc-wrap h6, .lpc-wrap .lp-header-title-6',properties:['font-family','font-style','font-weight'],},];elements.forEach(function({tag,selector,properties}){if(!result.hasOwnProperty(selector)){result[selector]={}}const elem=document.createElement(tag);container.append(elem);const cssObj=getComputedStyle(elem);properties.forEach((prop)=>{const style=prop.split('-')[0];const name=prop.split('-')[1];if(name){if(!result[selector].hasOwnProperty(style)){result[selector][style]={}}if(style==='font'&&name==='style'){result[selector][style][name]=cssObj.getPropertyValue(prop)==='italic'}else{result[selector][style][name]=cssObj.getPropertyValue(prop)}}else{result[selector][style]=cssObj.getPropertyValue(prop)}});elem.remove()});return result},getContentBackgroundVariable:function(document){const isColorOpaque=function(color){return tinycolor(color).getAlpha()!==0};const getBackgroundColor=function(color){if(!tinycolor(color).isValid()){return null}return isColorOpaque(color)?tinycolor(color).toRgbString():null};const content=document.querySelector('.lpc-content-wrapper');if(!content){return null}const variable='--content-background-lpc';let result='';let parent=content.parentElement;while(parent&&parent.tagName!=='HTML'&&!result.length){const computedStyle=getComputedStyle(parent);const currentBackground=computedStyle.backgroundColor;const currentBackgroundImage=computedStyle.backgroundImage;let currentBackgroundGradient='';if(currentBackgroundImage&&currentBackgroundImage.includes("gradient")){const imageUrlRegex=/url\("([^"]+)"\)/g;const imageUrlMatches=currentBackgroundImage.match(imageUrlRegex);if(imageUrlMatches){for(const imageUrlMatch of imageUrlMatches){currentBackgroundGradient=currentBackgroundGradient.replace(imageUrlMatch,'none')}result=currentBackgroundGradient}}else{const bgColor=getBackgroundColor(currentBackground);if(bgColor){result=bgColor}}parent=parent.parentNode}return{[variable]:result}},goals:{addButtonSelector:'#lp-goal-block-add-btn',inputSelector:'#lp-goals-block-id',getBlockItemTpl:function(id,name){return`<li class="box"id="lp-goal-block-${id}"><input type="hidden"value="${name}"name="goal[name]"/><span class="title"><span class="name">${name}</span></span><span class="remove"onclick="LpController.goals.removeBlock(this);"><span class="s3-ico i-delete-svg"></span></span></li>`},chooseBlock:function(ctx){const id=ctx.getAttribute('data-id');const name=ctx.getAttribute('data-name');const popup=popupController.getPreviousPopup();if(!id){return}this.setId(popup,id,name);util.msg(s3.loc('JS_ADDED'));popupController.closeLastPopup()},removeBlock:function(ctx){const popup=popupController.getLastPopup();util.detachElement(util.getElement(ctx,'LI'));this.setId(popup)},setId:function(popup,id,name){if(!popup.obj){return}const input=popup.obj.querySelector(this.inputSelector);const addBtn=popup.obj.querySelector(this.addButtonSelector);if(!input||!addBtn){return}if(id){const tpl=this.getBlockItemTpl(id,name);$(util.getParent(input,'UL')).append(tpl);addBtn.style.display='none';input.value=id}else{addBtn.removeAttribute('style');input.value=''}},}}})(jQuery);(function(factory){"use strict";if(typeof exports==='object'){module.exports=factory(window.jQuery)}else if(typeof define==='function'&&define.amd){define(['jquery'],factory)}else if(window.jQuery&&!window.jQuery.fn.colorpicker){factory(window.jQuery)}}(function($){'use strict';var Color=function(val,predefinedColors){this.value={h:0,s:0,b:0,a:1};this.origFormat=null;if(predefinedColors){$.extend(this.colors,predefinedColors)}if(val){if(val.toLowerCase!==undefined){val=val+'';this.setColor(val)}else if(val.h!==undefined){this.value=val}}};Color.prototype={constructor:Color,colors:{"aliceblue":"#f0f8ff","antiquewhite":"#faebd7","aqua":"#00ffff","aquamarine":"#7fffd4","azure":"#f0ffff","beige":"#f5f5dc","bisque":"#ffe4c4","black":"#000000","blanchedalmond":"#ffebcd","blue":"#0000ff","blueviolet":"#8a2be2","brown":"#a52a2a","burlywood":"#deb887","cadetblue":"#5f9ea0","chartreuse":"#7fff00","chocolate":"#d2691e","coral":"#ff7f50","cornflowerblue":"#6495ed","cornsilk":"#fff8dc","crimson":"#dc143c","cyan":"#00ffff","darkblue":"#00008b","darkcyan":"#008b8b","darkgoldenrod":"#b8860b","darkgray":"#a9a9a9","darkgreen":"#006400","darkkhaki":"#bdb76b","darkmagenta":"#8b008b","darkolivegreen":"#556b2f","darkorange":"#ff8c00","darkorchid":"#9932cc","darkred":"#8b0000","darksalmon":"#e9967a","darkseagreen":"#8fbc8f","darkslateblue":"#483d8b","darkslategray":"#2f4f4f","darkturquoise":"#00ced1","darkviolet":"#9400d3","deeppink":"#ff1493","deepskyblue":"#00bfff","dimgray":"#696969","dodgerblue":"#1e90ff","firebrick":"#b22222","floralwhite":"#fffaf0","forestgreen":"#228b22","fuchsia":"#ff00ff","gainsboro":"#dcdcdc","ghostwhite":"#f8f8ff","gold":"#ffd700","goldenrod":"#daa520","gray":"#808080","green":"#008000","greenyellow":"#adff2f","honeydew":"#f0fff0","hotpink":"#ff69b4","indianred":"#cd5c5c","indigo":"#4b0082","ivory":"#fffff0","khaki":"#f0e68c","lavender":"#e6e6fa","lavenderblush":"#fff0f5","lawngreen":"#7cfc00","lemonchiffon":"#fffacd","lightblue":"#add8e6","lightcoral":"#f08080","lightcyan":"#e0ffff","lightgoldenrodyellow":"#fafad2","lightgrey":"#d3d3d3","lightgreen":"#90ee90","lightpink":"#ffb6c1","lightsalmon":"#ffa07a","lightseagreen":"#20b2aa","lightskyblue":"#87cefa","lightslategray":"#778899","lightsteelblue":"#b0c4de","lightyellow":"#ffffe0","lime":"#00ff00","limegreen":"#32cd32","linen":"#faf0e6","magenta":"#ff00ff","maroon":"#800000","mediumaquamarine":"#66cdaa","mediumblue":"#0000cd","mediumorchid":"#ba55d3","mediumpurple":"#9370d8","mediumseagreen":"#3cb371","mediumslateblue":"#7b68ee","mediumspringgreen":"#00fa9a","mediumturquoise":"#48d1cc","mediumvioletred":"#c71585","midnightblue":"#191970","mintcream":"#f5fffa","mistyrose":"#ffe4e1","moccasin":"#ffe4b5","navajowhite":"#ffdead","navy":"#000080","oldlace":"#fdf5e6","olive":"#808000","olivedrab":"#6b8e23","orange":"#ffa500","orangered":"#ff4500","orchid":"#da70d6","palegoldenrod":"#eee8aa","palegreen":"#98fb98","paleturquoise":"#afeeee","palevioletred":"#d87093","papayawhip":"#ffefd5","peachpuff":"#ffdab9","peru":"#cd853f","pink":"#ffc0cb","plum":"#dda0dd","powderblue":"#b0e0e6","purple":"#800080","red":"#ff0000","rosybrown":"#bc8f8f","royalblue":"#4169e1","saddlebrown":"#8b4513","salmon":"#fa8072","sandybrown":"#f4a460","seagreen":"#2e8b57","seashell":"#fff5ee","sienna":"#a0522d","silver":"#c0c0c0","skyblue":"#87ceeb","slateblue":"#6a5acd","slategray":"#708090","snow":"#fffafa","springgreen":"#00ff7f","steelblue":"#4682b4","tan":"#d2b48c","teal":"#008080","thistle":"#d8bfd8","tomato":"#ff6347","turquoise":"#40e0d0","violet":"#ee82ee","wheat":"#f5deb3","white":"#ffffff","whitesmoke":"#f5f5f5","yellow":"#ffff00","yellowgreen":"#9acd32","transparent":"transparent"},_sanitizeNumber:function(val){if(typeof val==='number'){return val}if(isNaN(val)||(val===null)||(val==='')||(val===undefined)){return 1}if(val===''){return 0}if(val.toLowerCase!==undefined){if(val.match(/^\./)){val="0"+val}return Math.ceil(parseFloat(val)*100)/100}return 1},isTransparent:function(strVal){if(!strVal){return false}strVal=strVal.toLowerCase().trim();return(strVal==='transparent')||(strVal.match(/#?00000000/))||(strVal.match(/(rgba|hsla)\(0,0,0,0?\.?0\)/))},rgbaIsTransparent:function(rgba){return((rgba.r===0)&&(rgba.g===0)&&(rgba.b===0)&&(rgba.a===0))},setColor:function(strVal){strVal=strVal.toLowerCase().trim();if(strVal){if(this.isTransparent(strVal)){this.value={h:0,s:0,b:0,a:0}}else{this.value=this.stringToHSB(strVal)||{h:0,s:0,b:0,a:1}}}},stringToHSB:function(strVal){strVal=strVal.toLowerCase();var alias;if(typeof this.colors[strVal]!=='undefined'){strVal=this.colors[strVal];alias='alias'}var that=this,result=false;$.each(this.stringParsers,function(i,parser){var match=parser.re.exec(strVal),values=match&&parser.parse.apply(that,[match]),format=alias||parser.format||'rgba';if(values){if(format.match(/hsla?/)){result=that.RGBtoHSB.apply(that,that.HSLtoRGB.apply(that,values))}else{result=that.RGBtoHSB.apply(that,values)}that.origFormat=format;return false}return true});return result},setHue:function(h){this.value.h=1-h},setSaturation:function(s){this.value.s=s},setBrightness:function(b){this.value.b=1-b},setAlpha:function(a){this.value.a=Math.round((parseInt((1-a)*100,10)/100)*100)/100},toRGB:function(h,s,b,a){if(!h){h=this.value.h;s=this.value.s;b=this.value.b}h*=360;var R,G,B,X,C;h=(h%360)/60;C=b*s;X=C*(1-Math.abs(h%2-1));R=G=B=b-C;h=~~h;R+=[C,X,0,0,X,C][h];G+=[X,C,C,X,0,0][h];B+=[0,0,X,C,C,X][h];return{r:Math.round(R*255),g:Math.round(G*255),b:Math.round(B*255),a:a||this.value.a}},toHex:function(h,s,b,a){var rgb=this.toRGB(h,s,b,a);if(this.rgbaIsTransparent(rgb)){return'transparent'}return'#'+((1<<24)|(parseInt(rgb.r)<<16)|(parseInt(rgb.g)<<8)|parseInt(rgb.b)).toString(16).substr(1)},toHSL:function(h,s,b,a){h=h||this.value.h;s=s||this.value.s;b=b||this.value.b;a=a||this.value.a;var H=h,L=(2-s)*b,S=s*b;if(L>0&&L<=1){S/=L}else{S/=2-L}L/=2;if(S>1){S=1}return{h:isNaN(H)?0:H,s:isNaN(S)?0:S,l:isNaN(L)?0:L,a:isNaN(a)?0:a}},toAlias:function(r,g,b,a){var rgb=this.toHex(r,g,b,a);for(var alias in this.colors){if(this.colors[alias]===rgb){return alias}}return false},RGBtoHSB:function(r,g,b,a){r/=255;g/=255;b/=255;var H,S,V,C;V=Math.max(r,g,b);C=V-Math.min(r,g,b);H=(C===0?null:V===r?(g-b)/C:V===g?(b-r)/C+2:(r-g)/C+4);H=((H+360)%6)*60/360;S=C===0?0:C/V;return{h:this._sanitizeNumber(H),s:S,b:V,a:this._sanitizeNumber(a)}},HueToRGB:function(p,q,h){if(h<0){h+=1}else if(h>1){h-=1}if((h*6)<1){return p+(q-p)*h*6}else if((h*2)<1){return q}else if((h*3)<2){return p+(q-p)*((2/3)-h)*6}else{return p}},HSLtoRGB:function(h,s,l,a){if(s<0){s=0}var q;if(l<=0.5){q=l*(1+s)}else{q=l+s-(l*s)}var p=2*l-q;var tr=h+(1/3);var tg=h;var tb=h-(1/3);var r=Math.round(this.HueToRGB(p,q,tr)*255);var g=Math.round(this.HueToRGB(p,q,tg)*255);var b=Math.round(this.HueToRGB(p,q,tb)*255);return[r,g,b,this._sanitizeNumber(a)]},toString:function(format){format=format||'rgba';var c=false;switch(format){case'rgb':{c=this.toRGB();if(this.rgbaIsTransparent(c)){return'transparent'}return'rgb('+c.r+','+c.g+','+c.b+')'}break;case'rgba':{c=this.toRGB();return'rgba('+c.r+','+c.g+','+c.b+','+c.a+')'}break;case'hsl':{c=this.toHSL();return'hsl('+Math.round(c.h*360)+','+Math.round(c.s*100)+'%,'+Math.round(c.l*100)+'%)'}break;case'hsla':{c=this.toHSL();return'hsla('+Math.round(c.h*360)+','+Math.round(c.s*100)+'%,'+Math.round(c.l*100)+'%,'+c.a+')'}break;case'hex':{return this.toHex()}break;case'alias':return this.toHex()||this.toAlias();default:{return c}break}},stringParsers:[{re:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*?\)/,format:'rgb',parse:function(execResult){return[execResult[1],execResult[2],execResult[3],1]}},{re:/rgb\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:'rgb',parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],1]}},{re:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:'rgba',parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]]}},{re:/rgba\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:'rgba',parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],execResult[4]]}},{re:/hsl\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:'hsl',parse:function(execResult){return[execResult[1]/360,execResult[2]/100,execResult[3]/100,execResult[4]]}},{re:/hsla\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:'hsla',parse:function(execResult){return[execResult[1]/360,execResult[2]/100,execResult[3]/100,execResult[4]]}},{re:/#?([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,format:'hex',parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16),1]}},{re:/#?([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,format:'hex',parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16),1]}}],colorNameToHex:function(name){if(typeof this.colors[name.toLowerCase()]!=='undefined'){return this.colors[name.toLowerCase()]}return false}};var defaults={horizontal:false,inline:false,color:false,format:false,input:'input',container:false,component:'.add-on, .input-group-addon',sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:'setSaturation',callTop:'setBrightness'},hue:{maxLeft:0,maxTop:100,callLeft:false,callTop:'setHue'},alpha:{maxLeft:0,maxTop:100,callLeft:false,callTop:'setAlpha'}},slidersHorz:{saturation:{maxLeft:100,maxTop:100,callLeft:'setSaturation',callTop:'setBrightness'},hue:{maxLeft:100,maxTop:0,callLeft:'setHue',callTop:false},alpha:{maxLeft:100,maxTop:0,callLeft:'setAlpha',callTop:false}},template:'<div class="colorpicker dropdown-menu">'+'<div class="colorpicker-saturation"><i><b></b></i></div>'+'<div class="colorpicker-hue"><i></i></div>'+'<div class="colorpicker-alpha"><i></i></div>'+'<div class="colorpicker-color"><div /></div>'+'<div class="colorpicker-selectors"></div>'+'</div>',align:'right',customClass:null,colorSelectors:null};var Colorpicker=function(element,options){var self=this;this.element=$(element).addClass('colorpicker-element');this.options=$.extend(true,{},defaults,this.element.data(),options);this.component=this.options.component;this.component=(this.component!==false)?this.element.find(this.component):false;if(this.component&&(this.component.length===0)){this.component=false}this.container=(this.options.container===true)?this.element:this.options.container;this.container=(this.container!==false)?$(this.container):false;this.input=this.element.is('input')?this.element:(this.options.input?this.element.find(this.options.input):false);if(this.input&&(this.input.length===0)){this.input=false}this.color=new Color(this.options.color!==false?this.options.color:this.getValue(),this.options.colorSelectors);this.format=this.options.format!==false?this.options.format:this.color.origFormat;if(this.options.color!==false){this.updateInput(this.color);this.updateData(this.color)}this.picker=$(this.options.template);if(this.options.customClass){this.picker.addClass(this.options.customClass)}if(this.options.inline){this.picker.addClass('colorpicker-inline colorpicker-visible')}else{this.picker.addClass('colorpicker-hidden')}if(this.options.horizontal){this.picker.addClass('colorpicker-horizontal')}if(this.format==='rgba'||this.format==='hsla'||this.options.format===false){this.picker.addClass('colorpicker-with-alpha')}if(this.options.align==='right'){this.picker.addClass('colorpicker-right')}if(this.options.inline===true){this.picker.addClass('colorpicker-no-arrow')}if(this.options.colorSelectors){var colorpicker=this;$.each(this.options.colorSelectors,function(name,color){var $btn=$('<i />').css('background-color',color).data('class',name);$btn.click(function(){colorpicker.setValue($(this).css('background-color'))});colorpicker.picker.find('.colorpicker-selectors').append($btn)});this.picker.find('.colorpicker-selectors').show()}this.picker.on('mousedown.colorpicker touchstart.colorpicker',$.proxy(this.mousedown,this));this.picker.find('.cp-close').on('click',function(){self.hide()});this.element.find('.preview-icon').on('click',function(){$(this).parents('.input-group').find('.input-group-addon').trigger('click')});this.preview_input=this.picker.find('.input-preview input');this.alpha_input=this.picker.find('.alpha-preview input');this.picker.appendTo(this.container?this.container:$('body'));if(this.input!==false){this.input.on({'keyup.colorpicker':$.proxy(this.keyup,this)});var self=this;this.preview_input.on('paste',function(e){setTimeout(function(){self.preview_input.val(function(){return this.value.replace(/[^a-zA-Z0-9]/g,"")})})});this.preview_input.on('input',$.debounce(2000,function(e){if($(this).val()!=""){self.setValue('#'+$(this).val());$.proxy(self.change,self)}}));this.alpha_input.on('input',$.debounce(2000,function(e){var val=Math.max(Math.min(parseInt($(this).val()),100),0);self.color.value.a=val/100;self.setValue(self.color.toString());$.proxy(self.change,self)}));this.preview_input.on('keydown',function(event){var input=$(event.currentTarget);if(/[^a-zA-Z0-9]/g.test(input.val())){return false}});this.input.on('paste',function(e){setTimeout(function(){self.preview_input.val(function(){return this.value.replace(/[^a-zA-Z0-9]/g,"")})})});this.input.on('input',$.debounce(1500,function(e){self.setValue('#'+$(this).val());$.proxy(self.change,self,'test')}));this.input.on('keydown',function(event){var input=$(event.currentTarget);if(/[^a-zA-Z0-9]/g.test(input.val())){return false}});this.input.on({'change.colorpicker':$.proxy(this.change,this)});if(this.component===false){this.element.on({'focus.colorpicker':$.proxy(this.show,this)})}if(this.options.inline===false){this.element.on({'focusout.colorpicker':$.proxy(this.hide,this)})}}if(this.component!==false){this.component.on({'click.colorpicker':$.proxy(this.show,this)})}if((this.input===false)&&(this.component===false)){this.element.on({'click.colorpicker':$.proxy(this.show,this)})}if((this.input!==false)&&(this.component!==false)&&(this.input.attr('type')==='color')){this.input.on({'click.colorpicker':$.proxy(this.show,this),'focus.colorpicker':$.proxy(this.show,this)})}this.update();$($.proxy(function(){this.element.trigger('create')},this));if(this.options&&this.options.onInit&&typeof this.options.onInit==='function'){this.options.onInit(this)}};Colorpicker.Color=Color;Colorpicker.prototype={constructor:Colorpicker,destroy:function(){this.picker.remove();this.element.removeData('colorpicker','color').off('.colorpicker');if(this.input!==false){this.input.off('.colorpicker')}if(this.component!==false){this.component.off('.colorpicker')}this.element.removeClass('colorpicker-element');this.element.trigger({type:'destroy'})},reposition:function(){if(this.options.inline!==false||this.options.container){return false}if(this.options.reposition&&typeof this.options.reposition==='function'){this.options.reposition(this)}else{var type=this.container&&this.container[0]!==document.body?'position':'offset';var element=this.component||this.element;var offset=element[type]();if(this.options.align==='right'){offset.left-=this.picker.outerWidth()-element.outerWidth()}var top=offset.top+element.outerHeight();var picker_height=this.picker.outerHeight();var picker_width=this.picker.outerWidth();var left=offset.left;if((top+picker_height-$(window).scrollTop())>$(window).outerHeight()&&offset.top>picker_height){top=top-picker_height-60}if((left+picker_width)>$(window).outerWidth()){this.picker.css({top:top,right:$(window).outerWidth()-left,left:'auto'})}else{this.picker.css({top:top,left:offset.left})}}},show:function(e){if(this.isDisabled()){return false}if(this.options&&this.options.beforeShow&&typeof this.options.beforeShow==='function'){this.options.beforeShow(this)}var self=this;this.picker.addClass('colorpicker-visible').removeClass('colorpicker-hidden');this.reposition();$(window).on('resize.colorpicker',$.proxy(this.reposition,this));if(e&&(!this.hasInput()||this.input.attr('type')==='color')){if(e.stopPropagation&&e.preventDefault){e.stopPropagation();e.preventDefault()}}if((this.component||!this.input)&&(this.options.inline===false)){}this.element.trigger({type:'showPicker',color:this.color});this.element.addClass('current-picker');if(this.options&&this.options.onShow&&typeof this.options.onShow==='function'){this.options.onShow(this)}},hide:function(){this.picker.addClass('colorpicker-hidden').removeClass('colorpicker-visible');$(window).off('resize.colorpicker',this.reposition);$(document).off({'mousedown.colorpicker':this.hide});this.update();this.element.trigger({type:'hidePicker',color:this.color});this.element.removeClass('current-picker');if(this.options&&this.options.onHide&&typeof this.options.onHide==='function'){this.options.onHide(this)}},updateData:function(val){val=val||this.color.toString(this.format);this.element.data('color',val);return val},updateInput:function(val){val=val||this.color.toString(this.format);if(this.input!==false){if(this.options.colorSelectors){var color=new Color(val,this.options.colorSelectors);var alias=color.toAlias();if(typeof this.options.colorSelectors[alias]!=='undefined'){}}this.input.prop('value',this.color.toString('hex').replace('#',''))}return val},updatePicker:function(val){if(val!==undefined){this.color=new Color(val,this.options.colorSelectors)}var sl=(this.options.horizontal===false)?this.options.sliders:this.options.slidersHorz;var icns=this.picker.find('i');if(icns.length===0){return}if(this.options.horizontal===false){sl=this.options.sliders;var t1=sl.hue.maxTop*(1-this.color.value.h);var t2=sl.alpha.maxTop*(1-this.color.value.a);if(t1>=sl.hue.maxTop){t1-=icns.eq(1).outerHeight()}else if(t1<0){t1=0}if(t2>=sl.hue.maxTop){t2-=icns.eq(2).outerHeight()}else if(t2<0){t2=0}icns.eq(1).css('top',t1).end().eq(2).css('top',t2)}else{sl=this.options.slidersHorz;var l1=sl.hue.maxLeft*(1-this.color.value.h);var l2=sl.alpha.maxLeft*(this.color.value.a);l1-=icns.eq(1).outerWidth();l2-=icns.eq(2).outerWidth();if(l1<0){l1=0}if(l2<0){l2=0}icns.eq(1).css('left',l1).end().eq(2).css('left',l2)}var t3=sl.saturation.maxTop-this.color.value.b*sl.saturation.maxTop;var l3=this.color.value.s*sl.saturation.maxLeft;if(t3>=sl.saturation.maxTop){t3-=icns.eq(0).outerHeight()}else if(t3<0){t3=0}if(l3>=sl.saturation.maxLeft){l3-=icns.eq(0).outerWidth()}else if(l3<0){l3=0}icns.eq(0).css({'top':t3,'left':l3});this.picker.find('.colorpicker-saturation').css('backgroundColor',this.color.toHex(this.color.value.h,1,1,1));this.picker.find('.colorpicker-alpha').css('backgroundColor',this.color.toHex(this.color.value.h,1,1,1));this.picker.find('.colorpicker-color .color-preview').css('backgroundColor',this.color.toHex(this.color.value.h,1,1,1));if(this.input.parent().find('.preview-icon').length){this.input.parent().find('.preview-icon').css('backgroundColor',this.color.toHex())}var v=this.color.toHex()=='transparent'?'#fff':this.color.toHex();this.picker.find('.colorpicker-color .input-preview input').val(v.replace('#',''));var alph=parseInt(this.color.value.a*100);this.picker.find('.colorpicker-color .alpha-preview input').val(alph);return val},updateComponent:function(val){val=val||this.color.toString(this.format);if(this.component!==false){var icn=this.component.find('i').eq(0);if(icn.length>0){icn.css({'backgroundColor':val})}else{this.component.css({'backgroundColor':val})}}return val},update:function(force){var val;if((this.getValue(false)!==false)||(force===true)){val=this.updateComponent();this.updateInput(val);this.updateData(val);this.updatePicker()}return val},setValue:function(val){this.color=new Color(val,this.options.colorSelectors);this.update(true);this.element.trigger({type:'changeColor',color:this.color,value:val})},getValue:function(defaultValue){defaultValue=(defaultValue===undefined)?'#000000':defaultValue;var val;if(this.hasInput()){val=this.input.val()}else{val=this.element.data('color')}if((val===undefined)||(val==='')||(val===null)){val=defaultValue}return val},hasInput:function(){return(this.input!==false)},isDisabled:function(){if(this.hasInput()){return(this.input.prop('disabled')===true)}return false},disable:function(){if(this.hasInput()){this.input.prop('disabled',true);this.element.trigger({type:'disable',color:this.color,value:this.getValue()});return true}return false},enable:function(){if(this.hasInput()){this.input.prop('disabled',false);this.element.trigger({type:'enable',color:this.color,value:this.getValue()});return true}return false},currentSlider:null,mousePointer:{left:0,top:0},mousedown:function(e){if(!$(e.target).closest('.click-body').length){if(!e.pageX&&!e.pageY&&e.originalEvent&&e.originalEvent.touches){e.pageX=e.originalEvent.touches[0].pageX;e.pageY=e.originalEvent.touches[0].pageY}e.stopPropagation();e.preventDefault();var target=$(e.target);var zone=target.closest('div');var sl=this.options.horizontal?this.options.slidersHorz:this.options.sliders;if(!zone.is('.colorpicker')){if(zone.is('.colorpicker-saturation')){this.currentSlider=$.extend({},sl.saturation)}else if(zone.is('.colorpicker-hue')){this.currentSlider=$.extend({},sl.hue)}else if(zone.is('.colorpicker-alpha')){this.currentSlider=$.extend({},sl.alpha)}else{return false}var offset=zone.offset();this.currentSlider.guide=zone.find('i')[0].style;this.currentSlider.left=e.pageX-offset.left;this.currentSlider.top=e.pageY-offset.top;this.mousePointer={left:e.pageX,top:e.pageY};if(zone.is('.colorpicker-alpha')){this.currentSlider.left=180-this.currentSlider.left}$(document).on({'mousemove.colorpicker':$.proxy(this.mousemove,this),'touchmove.colorpicker':$.proxy(this.mousemove,this),'mouseup.colorpicker':$.proxy(this.mouseup,this),'touchend.colorpicker':$.proxy(this.mouseup,this)}).trigger('mousemove')}return false}},mousemove:function(e){if(!$(e.target).closest('.click-body').length){if(!e.pageX&&!e.pageY&&e.originalEvent&&e.originalEvent.touches){e.pageX=e.originalEvent.touches[0].pageX;e.pageY=e.originalEvent.touches[0].pageY}e.stopPropagation();e.preventDefault();var left=Math.max(0,Math.min(this.currentSlider.maxLeft,this.currentSlider.left+((e.pageX||this.mousePointer.left)-this.mousePointer.left)));var top=Math.max(0,Math.min(this.currentSlider.maxTop,this.currentSlider.top+((e.pageY||this.mousePointer.top)-this.mousePointer.top)));if(this.currentSlider.callLeft=="setAlpha"){left=Math.max(0,Math.min(this.currentSlider.maxLeft,this.currentSlider.left+(this.mousePointer.left-(e.pageX||this.mousePointer.left))))}this.currentSlider.guide.left=left+'px';this.currentSlider.guide.top=top+'px';if(this.currentSlider.callLeft){this.color[this.currentSlider.callLeft].call(this.color,left/this.currentSlider.maxLeft)}if(this.currentSlider.callTop){this.color[this.currentSlider.callTop].call(this.color,top/this.currentSlider.maxTop)}if(this.currentSlider.callTop==='setAlpha'&&this.options.format===false){if(this.color.value.a!==1){this.format='rgba';this.color.origFormat='rgba'}else{this.format='hex';this.color.origFormat='hex'}}this.update(true);this.element.trigger({type:'changeColor',color:this.color});return false}},mouseup:function(e){if(!$(e.target).closest('.click-body').length){e.stopPropagation();e.preventDefault();$(document).off({'mousemove.colorpicker':this.mousemove,'touchmove.colorpicker':this.mousemove,'mouseup.colorpicker':this.mouseup,'touchend.colorpicker':this.mouseup});return false}},change:function(e){this.keyup(e)},keyup:function(e){if((e.keyCode===38)){if(this.color.value.a<1){this.color.value.a=Math.round((this.color.value.a+0.01)*100)/100}this.update(true)}else if((e.keyCode===40)){if(this.color.value.a>0){this.color.value.a=Math.round((this.color.value.a-0.01)*100)/100}this.update(true)}else{this.color=new Color(this.input.val(),this.options.colorSelectors);if(this.color.origFormat&&this.options.format===false){this.format=this.color.origFormat}if(this.getValue(false)!==false){this.updateData();this.updateComponent();this.updatePicker()}}this.element.trigger({type:'changeColor',color:this.color,value:this.input.val()})}};$.colorpicker=Colorpicker;$.fn.colorpicker=function(option){var pickerArgs=arguments,rv=null;var $returnValue=this.each(function(){var $this=$(this),inst=$this.data('colorpicker'),options=((typeof option==='object')?option:{});if((!inst)&&(typeof option!=='string')){$this.data('colorpicker',new Colorpicker(this,options))}else{if(typeof option==='string'){rv=inst[option].apply(inst,Array.prototype.slice.call(pickerArgs,1))}}});if(option==='getValue'){return rv}return $returnValue};$.fn.colorpicker.constructor=Colorpicker}));(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory)}else if(typeof exports==='object'){factory(require('jquery'))}else{factory(jQuery)}})(function($){'use strict';var $window=$(window);var $document=$(document);var location=window.location;var navigator=window.navigator;var ArrayBuffer=window.ArrayBuffer;var Uint8Array=window.Uint8Array;var DataView=window.DataView;var btoa=window.btoa;var NAMESPACE='cropper';var CLASS_MODAL='cropper-modal';var CLASS_HIDE='cropper-hide';var CLASS_HIDDEN='cropper-hidden';var CLASS_INVISIBLE='cropper-invisible';var CLASS_MOVE='cropper-move';var CLASS_CROP='cropper-crop';var CLASS_DISABLED='cropper-disabled';var CLASS_BG='cropper-bg';var EVENT_MOUSE_DOWN='mousedown touchstart pointerdown MSPointerDown';var EVENT_MOUSE_MOVE='mousemove touchmove pointermove MSPointerMove';var EVENT_MOUSE_UP='mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel';var EVENT_WHEEL='wheel mousewheel DOMMouseScroll';var EVENT_DBLCLICK='dblclick';var EVENT_LOAD='load.'+NAMESPACE;var EVENT_ERROR='error.'+NAMESPACE;var EVENT_RESIZE='resize.'+NAMESPACE;var EVENT_BUILD='build.'+NAMESPACE;var EVENT_BUILT='built.'+NAMESPACE;var EVENT_CROP_START='cropstart.'+NAMESPACE;var EVENT_CROP_MOVE='cropmove.'+NAMESPACE;var EVENT_CROP_END='cropend.'+NAMESPACE;var EVENT_CROP='crop.'+NAMESPACE;var EVENT_ZOOM='zoom.'+NAMESPACE;var REGEXP_ACTIONS=/e|w|s|n|se|sw|ne|nw|all|crop|move|zoom/;var REGEXP_DATA_URL=/^data\:/;var REGEXP_DATA_URL_HEAD=/^data\:([^\;]+)\;base64,/;var REGEXP_DATA_URL_JPEG=/^data\:image\/jpeg.*;base64,/;var DATA_PREVIEW='preview';var DATA_ACTION='action';var ACTION_EAST='e';var ACTION_WEST='w';var ACTION_SOUTH='s';var ACTION_NORTH='n';var ACTION_SOUTH_EAST='se';var ACTION_SOUTH_WEST='sw';var ACTION_NORTH_EAST='ne';var ACTION_NORTH_WEST='nw';var ACTION_ALL='all';var ACTION_CROP='crop';var ACTION_MOVE='move';var ACTION_ZOOM='zoom';var ACTION_NONE='none';var SUPPORT_CANVAS=$.isFunction($('<canvas>')[0].getContext);var IS_SAFARI_OR_UIWEBVIEW=navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(navigator.userAgent);var num=Number;var min=Math.min;var max=Math.max;var abs=Math.abs;var sin=Math.sin;var cos=Math.cos;var sqrt=Math.sqrt;var round=Math.round;var floor=Math.floor;var fromCharCode=String.fromCharCode;function isNumber(n){return typeof n==='number'&&!isNaN(n)}function isUndefined(n){return typeof n==='undefined'}function toArray(obj,offset){var args=[];if(isNumber(offset)){args.push(offset)}return args.slice.apply(obj,args)}function proxy(fn,context){var args=toArray(arguments,2);return function(){return fn.apply(context,args.concat(toArray(arguments)))}}function isCrossOriginURL(url){var parts=url.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return parts&&(parts[1]!==location.protocol||parts[2]!==location.hostname||parts[3]!==location.port)}function addTimestamp(url){var timestamp='timestamp='+(new Date()).getTime();return(url+(url.indexOf('?')===-1?'?':'&')+timestamp)}function getCrossOrigin(crossOrigin){return crossOrigin?' crossOrigin="'+crossOrigin+'"':''}function getImageSize(image,callback){var newImage;if(image.naturalWidth&&!IS_SAFARI_OR_UIWEBVIEW){return callback(image.naturalWidth,image.naturalHeight)}newImage=document.createElement('img');newImage.onload=function(){callback(this.width,this.height)};newImage.src=image.src}function getTransform(options){var transforms=[];var rotate=options.rotate;var scaleX=options.scaleX;var scaleY=options.scaleY;if(isNumber(scaleX)&&isNumber(scaleY)){transforms.push('scale('+scaleX+','+scaleY+')')}if(isNumber(rotate)){transforms.push('rotate('+rotate+'deg)')}return transforms.length?transforms.join(' '):'none'}function getRotatedSizes(data,isReversed){var deg=abs(data.degree)%180;var arc=(deg>90?(180-deg):deg)*Math.PI/180;var sinArc=sin(arc);var cosArc=cos(arc);var width=data.width;var height=data.height;var aspectRatio=data.aspectRatio;var newWidth;var newHeight;if(!isReversed){newWidth=width*cosArc+height*sinArc;newHeight=width*sinArc+height*cosArc}else{newWidth=width/(cosArc+sinArc/aspectRatio);newHeight=newWidth/aspectRatio}return{width:newWidth,height:newHeight}}function getSourceCanvas(image,data){var canvas=$('<canvas>')[0];var context=canvas.getContext('2d');var dstX=0;var dstY=0;var dstWidth=data.naturalWidth;var dstHeight=data.naturalHeight;var rotate=data.rotate;var scaleX=data.scaleX;var scaleY=data.scaleY;var scalable=isNumber(scaleX)&&isNumber(scaleY)&&(scaleX!==1||scaleY!==1);var rotatable=isNumber(rotate)&&rotate!==0;var advanced=rotatable||scalable;var canvasWidth=dstWidth*abs(scaleX||1);var canvasHeight=dstHeight*abs(scaleY||1);var translateX;var translateY;var rotated;if(scalable){translateX=canvasWidth/2;translateY=canvasHeight/2}if(rotatable){rotated=getRotatedSizes({width:canvasWidth,height:canvasHeight,degree:rotate});canvasWidth=rotated.width;canvasHeight=rotated.height;translateX=canvasWidth/2;translateY=canvasHeight/2}canvas.width=canvasWidth;canvas.height=canvasHeight;if(advanced){dstX=-dstWidth/2;dstY=-dstHeight/2;context.save();context.translate(translateX,translateY)}if(scalable){context.scale(scaleX,scaleY)}if(rotatable){context.rotate(rotate*Math.PI/180)}context.drawImage(image,floor(dstX),floor(dstY),floor(dstWidth),floor(dstHeight));if(advanced){context.restore()}return canvas}function getTouchesCenter(touches){var length=touches.length;var pageX=0;var pageY=0;if(length){$.each(touches,function(i,touch){pageX+=touch.pageX;pageY+=touch.pageY});pageX/=length;pageY/=length}return{pageX:pageX,pageY:pageY}}function getStringFromCharCode(dataView,start,length){var str='';var i;for(i=start,length+=start;i<length;i++){str+=fromCharCode(dataView.getUint8(i))}return str}function getOrientation(arrayBuffer){var dataView=new DataView(arrayBuffer);var length=dataView.byteLength;var orientation;var exifIDCode;var tiffOffset;var firstIFDOffset;var littleEndian;var endianness;var app1Start;var ifdStart;var offset;var i;if(dataView.getUint8(0)===0xFF&&dataView.getUint8(1)===0xD8){offset=2;while(offset<length){if(dataView.getUint8(offset)===0xFF&&dataView.getUint8(offset+1)===0xE1){app1Start=offset;break}offset++}}if(app1Start){exifIDCode=app1Start+4;tiffOffset=app1Start+10;if(getStringFromCharCode(dataView,exifIDCode,4)==='Exif'){endianness=dataView.getUint16(tiffOffset);littleEndian=endianness===0x4949;if(littleEndian||endianness===0x4D4D){if(dataView.getUint16(tiffOffset+2,littleEndian)===0x002A){firstIFDOffset=dataView.getUint32(tiffOffset+4,littleEndian);if(firstIFDOffset>=0x00000008){ifdStart=tiffOffset+firstIFDOffset}}}}}if(ifdStart){length=dataView.getUint16(ifdStart,littleEndian);for(i=0;i<length;i++){offset=ifdStart+i*12+2;if(dataView.getUint16(offset,littleEndian)===0x0112){offset+=8;orientation=dataView.getUint16(offset,littleEndian);if(IS_SAFARI_OR_UIWEBVIEW){dataView.setUint16(offset,1,littleEndian)}break}}}return orientation}function dataURLToArrayBuffer(dataURL){var base64=dataURL.replace(REGEXP_DATA_URL_HEAD,'');var binary=atob(base64);var length=binary.length;var arrayBuffer=new ArrayBuffer(length);var dataView=new Uint8Array(arrayBuffer);var i;for(i=0;i<length;i++){dataView[i]=binary.charCodeAt(i)}return arrayBuffer}function arrayBufferToDataURL(arrayBuffer){var dataView=new Uint8Array(arrayBuffer);var length=dataView.length;var base64='';var i;for(i=0;i<length;i++){base64+=fromCharCode(dataView[i])}return'data:image/jpeg;base64,'+btoa(base64)}function Cropper(element,options){this.$element=$(element);this.options=$.extend({},Cropper.DEFAULTS,$.isPlainObject(options)&&options);this.isLoaded=false;this.isBuilt=false;this.isCompleted=false;this.isRotated=false;this.isCropped=false;this.isDisabled=false;this.isReplaced=false;this.isLimited=false;this.wheeling=false;this.isImg=false;this.originalUrl='';this.canvas=null;this.cropBox=null;this.init()}Cropper.prototype={constructor:Cropper,init:function(){var $this=this.$element;var url;if($this.is('img')){this.isImg=true;this.originalUrl=url=$this.attr('src');if(!url){return}url=$this.prop('src')}else if($this.is('canvas')&&SUPPORT_CANVAS){url=$this[0].toDataURL()}this.load(url)},trigger:function(type,data){var e=$.Event(type,data);this.$element.trigger(e);return e},load:function(url){var options=this.options;var $this=this.$element;var read;var xhr;if(!url){return}$this.one(EVENT_BUILD,options.build);if(this.trigger(EVENT_BUILD).isDefaultPrevented()){return}this.url=url;this.image={};if(!options.checkOrientation||!ArrayBuffer){return this.clone()}read=$.proxy(this.read,this);if(REGEXP_DATA_URL.test(url)){return REGEXP_DATA_URL_JPEG.test(url)?read(dataURLToArrayBuffer(url)):this.clone()}xhr=new XMLHttpRequest();xhr.onerror=xhr.onabort=$.proxy(function(){this.clone()},this);xhr.onload=function(){read(this.response)};if(options.checkCrossOrigin&&isCrossOriginURL(url)&&$this.prop('crossOrigin')){url=addTimestamp(url)}xhr.open('get',url);xhr.responseType='arraybuffer';xhr.send()},read:function(arrayBuffer){var options=this.options;var orientation=getOrientation(arrayBuffer);var image=this.image;var rotate;var scaleX;var scaleY;if(orientation>1){this.url=arrayBufferToDataURL(arrayBuffer);switch(orientation){case 2:scaleX=-1;break;case 3:rotate=-180;break;case 4:scaleY=-1;break;case 5:rotate=90;scaleY=-1;break;case 6:rotate=90;break;case 7:rotate=90;scaleX=-1;break;case 8:rotate=-90;break}}if(options.rotatable){image.rotate=rotate}if(options.scalable){image.scaleX=scaleX;image.scaleY=scaleY}this.clone()},clone:function(){var options=this.options;var $this=this.$element;var url=this.url;var crossOrigin='';var crossOriginUrl;var $clone;if(options.checkCrossOrigin&&isCrossOriginURL(url)){crossOrigin=$this.prop('crossOrigin');if(crossOrigin){crossOriginUrl=url}else{crossOrigin='anonymous';crossOriginUrl=addTimestamp(url)}}this.crossOrigin=crossOrigin;this.crossOriginUrl=crossOriginUrl;this.$clone=$clone=$('<img'+getCrossOrigin(crossOrigin)+' src="'+(crossOriginUrl||url)+'">');if(this.isImg){if($this[0].complete){this.start()}else{$this.one(EVENT_LOAD,$.proxy(this.start,this))}}else{$clone.one(EVENT_LOAD,$.proxy(this.start,this)).one(EVENT_ERROR,$.proxy(this.stop,this)).addClass(CLASS_HIDE).insertAfter($this)}},start:function(){var $image=this.$element;var $clone=this.$clone;if(!this.isImg){$clone.off(EVENT_ERROR,this.stop);$image=$clone}getImageSize($image[0],$.proxy(function(naturalWidth,naturalHeight){$.extend(this.image,{naturalWidth:naturalWidth,naturalHeight:naturalHeight,aspectRatio:naturalWidth/naturalHeight});this.isLoaded=true;this.build()},this))},stop:function(){this.$clone.remove();this.$clone=null},build:function(){var options=this.options;var $this=this.$element;var $clone=this.$clone;var $cropper;var $cropBox;var $face;if(!this.isLoaded){return}if(this.isBuilt){this.unbuild()}this.$container=$this.parent();this.$cropper=$cropper=$(Cropper.TEMPLATE);this.$canvas=$cropper.find('.cropper-canvas').append($clone);this.$dragBox=$cropper.find('.cropper-drag-box');this.$cropBox=$cropBox=$cropper.find('.cropper-crop-box');this.$viewBox=$cropper.find('.cropper-view-box');this.$face=$face=$cropBox.find('.cropper-face');$this.addClass(CLASS_HIDDEN).after($cropper);if(!this.isImg){$clone.removeClass(CLASS_HIDE)}this.initPreview();this.bind();options.aspectRatio=max(0,options.aspectRatio)||NaN;options.viewMode=max(0,min(3,round(options.viewMode)))||0;if(options.autoCrop){this.isCropped=true;if(options.modal){this.$dragBox.addClass(CLASS_MODAL)}}else{$cropBox.addClass(CLASS_HIDDEN)}if(!options.guides){$cropBox.find('.cropper-dashed').addClass(CLASS_HIDDEN)}if(!options.center){$cropBox.find('.cropper-center').addClass(CLASS_HIDDEN)}if(options.cropBoxMovable){$face.addClass(CLASS_MOVE).data(DATA_ACTION,ACTION_ALL)}if(!options.highlight){$face.addClass(CLASS_INVISIBLE)}if(options.background){$cropper.addClass(CLASS_BG)}if(!options.cropBoxResizable){$cropBox.find('.cropper-line, .cropper-point').addClass(CLASS_HIDDEN)}this.setDragMode(options.dragMode);this.render();this.isBuilt=true;this.setData(options.data);$this.one(EVENT_BUILT,options.built);setTimeout($.proxy(function(){this.trigger(EVENT_BUILT);this.trigger(EVENT_CROP,this.getData());this.isCompleted=true},this),0)},unbuild:function(){if(!this.isBuilt){return}this.isBuilt=false;this.isCompleted=false;this.initialImage=null;this.initialCanvas=null;this.initialCropBox=null;this.container=null;this.canvas=null;this.cropBox=null;this.unbind();this.resetPreview();this.$preview=null;this.$viewBox=null;this.$cropBox=null;this.$dragBox=null;this.$canvas=null;this.$container=null;this.$cropper.remove();this.$cropper=null},render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();if(this.isCropped){this.renderCropBox()}},initContainer:function(){var options=this.options;var $this=this.$element;var $container=this.$container;var $cropper=this.$cropper;$cropper.addClass(CLASS_HIDDEN);$this.removeClass(CLASS_HIDDEN);$cropper.css((this.container={width:max($container.width(),num(options.minContainerWidth)||200),height:max($container.height(),num(options.minContainerHeight)||100)}));$this.addClass(CLASS_HIDDEN);$cropper.removeClass(CLASS_HIDDEN)},initCanvas:function(){var viewMode=this.options.viewMode;var container=this.container;var containerWidth=container.width;var containerHeight=container.height;var image=this.image;var imageNaturalWidth=image.naturalWidth;var imageNaturalHeight=image.naturalHeight;var is90Degree=abs(image.rotate)===90;var naturalWidth=is90Degree?imageNaturalHeight:imageNaturalWidth;var naturalHeight=is90Degree?imageNaturalWidth:imageNaturalHeight;var aspectRatio=naturalWidth/naturalHeight;var canvasWidth=containerWidth;var canvasHeight=containerHeight;var canvas;if(containerHeight*aspectRatio>containerWidth){if(viewMode===3){canvasWidth=containerHeight*aspectRatio}else{canvasHeight=containerWidth/aspectRatio}}else{if(viewMode===3){canvasHeight=containerWidth/aspectRatio}else{canvasWidth=containerHeight*aspectRatio}}canvas={naturalWidth:naturalWidth,naturalHeight:naturalHeight,aspectRatio:aspectRatio,width:canvasWidth,height:canvasHeight};canvas.oldLeft=canvas.left=(containerWidth-canvasWidth)/2;canvas.oldTop=canvas.top=(containerHeight-canvasHeight)/2;this.canvas=canvas;this.isLimited=(viewMode===1||viewMode===2);this.limitCanvas(true,true);this.initialImage=$.extend({},image);this.initialCanvas=$.extend({},canvas)},limitCanvas:function(isSizeLimited,isPositionLimited){var options=this.options;var viewMode=options.viewMode;var container=this.container;var containerWidth=container.width;var containerHeight=container.height;var canvas=this.canvas;var aspectRatio=canvas.aspectRatio;var cropBox=this.cropBox;var isCropped=this.isCropped&&cropBox;var minCanvasWidth;var minCanvasHeight;var newCanvasLeft;var newCanvasTop;if(isSizeLimited){minCanvasWidth=num(options.minCanvasWidth)||0;minCanvasHeight=num(options.minCanvasHeight)||0;if(viewMode){if(viewMode>1){minCanvasWidth=max(minCanvasWidth,containerWidth);minCanvasHeight=max(minCanvasHeight,containerHeight);if(viewMode===3){if(minCanvasHeight*aspectRatio>minCanvasWidth){minCanvasWidth=minCanvasHeight*aspectRatio}else{minCanvasHeight=minCanvasWidth/aspectRatio}}}else{if(minCanvasWidth){minCanvasWidth=max(minCanvasWidth,isCropped?cropBox.width:0)}else if(minCanvasHeight){minCanvasHeight=max(minCanvasHeight,isCropped?cropBox.height:0)}else if(isCropped){minCanvasWidth=cropBox.width;minCanvasHeight=cropBox.height;if(minCanvasHeight*aspectRatio>minCanvasWidth){minCanvasWidth=minCanvasHeight*aspectRatio}else{minCanvasHeight=minCanvasWidth/aspectRatio}}}}if(minCanvasWidth&&minCanvasHeight){if(minCanvasHeight*aspectRatio>minCanvasWidth){minCanvasHeight=minCanvasWidth/aspectRatio}else{minCanvasWidth=minCanvasHeight*aspectRatio}}else if(minCanvasWidth){minCanvasHeight=minCanvasWidth/aspectRatio}else if(minCanvasHeight){minCanvasWidth=minCanvasHeight*aspectRatio}canvas.minWidth=minCanvasWidth;canvas.minHeight=minCanvasHeight;canvas.maxWidth=Infinity;canvas.maxHeight=Infinity}if(isPositionLimited){if(viewMode){newCanvasLeft=containerWidth-canvas.width;newCanvasTop=containerHeight-canvas.height;canvas.minLeft=min(0,newCanvasLeft);canvas.minTop=min(0,newCanvasTop);canvas.maxLeft=max(0,newCanvasLeft);canvas.maxTop=max(0,newCanvasTop);if(isCropped&&this.isLimited){canvas.minLeft=min(cropBox.left,cropBox.left+cropBox.width-canvas.width);canvas.minTop=min(cropBox.top,cropBox.top+cropBox.height-canvas.height);canvas.maxLeft=cropBox.left;canvas.maxTop=cropBox.top;if(viewMode===2){if(canvas.width>=containerWidth){canvas.minLeft=min(0,newCanvasLeft);canvas.maxLeft=max(0,newCanvasLeft)}if(canvas.height>=containerHeight){canvas.minTop=min(0,newCanvasTop);canvas.maxTop=max(0,newCanvasTop)}}}}else{canvas.minLeft=-canvas.width;canvas.minTop=-canvas.height;canvas.maxLeft=containerWidth;canvas.maxTop=containerHeight}}},renderCanvas:function(isChanged){var canvas=this.canvas;var image=this.image;var rotate=image.rotate;var naturalWidth=image.naturalWidth;var naturalHeight=image.naturalHeight;var aspectRatio;var rotated;if(this.isRotated){this.isRotated=false;rotated=getRotatedSizes({width:image.width,height:image.height,degree:rotate});aspectRatio=rotated.width/rotated.height;if(aspectRatio!==canvas.aspectRatio){canvas.left-=(rotated.width-canvas.width)/2;canvas.top-=(rotated.height-canvas.height)/2;canvas.width=rotated.width;canvas.height=rotated.height;canvas.aspectRatio=aspectRatio;canvas.naturalWidth=naturalWidth;canvas.naturalHeight=naturalHeight;if(rotate%180){rotated=getRotatedSizes({width:naturalWidth,height:naturalHeight,degree:rotate});canvas.naturalWidth=rotated.width;canvas.naturalHeight=rotated.height}this.limitCanvas(true,false)}}if(canvas.width>canvas.maxWidth||canvas.width<canvas.minWidth){canvas.left=canvas.oldLeft}if(canvas.height>canvas.maxHeight||canvas.height<canvas.minHeight){canvas.top=canvas.oldTop}canvas.width=min(max(canvas.width,canvas.minWidth),canvas.maxWidth);canvas.height=min(max(canvas.height,canvas.minHeight),canvas.maxHeight);this.limitCanvas(false,true);canvas.oldLeft=canvas.left=min(max(canvas.left,canvas.minLeft),canvas.maxLeft);canvas.oldTop=canvas.top=min(max(canvas.top,canvas.minTop),canvas.maxTop);this.$canvas.css({width:canvas.width,height:canvas.height,left:canvas.left,top:canvas.top});this.renderImage();if(this.isCropped&&this.isLimited){this.limitCropBox(true,true)}if(isChanged){this.output()}},renderImage:function(isChanged){var canvas=this.canvas;var image=this.image;var reversed;if(image.rotate){reversed=getRotatedSizes({width:canvas.width,height:canvas.height,degree:image.rotate,aspectRatio:image.aspectRatio},true)}$.extend(image,reversed?{width:reversed.width,height:reversed.height,left:(canvas.width-reversed.width)/2,top:(canvas.height-reversed.height)/2}:{width:canvas.width,height:canvas.height,left:0,top:0});this.$clone.css({width:image.width,height:image.height,marginLeft:image.left,marginTop:image.top,transform:getTransform(image)});if(isChanged){this.output()}},initCropBox:function(){var options=this.options;var canvas=this.canvas;var aspectRatio=options.aspectRatio;var autoCropArea=num(options.autoCropArea)||0.8;var cropBox={width:canvas.width,height:canvas.height};if(aspectRatio){if(canvas.height*aspectRatio>canvas.width){cropBox.height=cropBox.width/aspectRatio}else{cropBox.width=cropBox.height*aspectRatio}}this.cropBox=cropBox;this.limitCropBox(true,true);cropBox.width=min(max(cropBox.width,cropBox.minWidth),cropBox.maxWidth);cropBox.height=min(max(cropBox.height,cropBox.minHeight),cropBox.maxHeight);cropBox.width=max(cropBox.minWidth,cropBox.width*autoCropArea);cropBox.height=max(cropBox.minHeight,cropBox.height*autoCropArea);cropBox.oldLeft=cropBox.left=canvas.left+(canvas.width-cropBox.width)/2;cropBox.oldTop=cropBox.top=canvas.top+(canvas.height-cropBox.height)/2;this.initialCropBox=$.extend({},cropBox)},limitCropBox:function(isSizeLimited,isPositionLimited){var options=this.options;var aspectRatio=options.aspectRatio;var container=this.container;var containerWidth=container.width;var containerHeight=container.height;var canvas=this.canvas;var cropBox=this.cropBox;var isLimited=this.isLimited;var minCropBoxWidth;var minCropBoxHeight;var maxCropBoxWidth;var maxCropBoxHeight;if(isSizeLimited){minCropBoxWidth=num(options.minCropBoxWidth)||0;minCropBoxHeight=num(options.minCropBoxHeight)||0;minCropBoxWidth=min(minCropBoxWidth,containerWidth);minCropBoxHeight=min(minCropBoxHeight,containerHeight);maxCropBoxWidth=min(containerWidth,isLimited?canvas.width:containerWidth);maxCropBoxHeight=min(containerHeight,isLimited?canvas.height:containerHeight);if(aspectRatio){if(minCropBoxWidth&&minCropBoxHeight){if(minCropBoxHeight*aspectRatio>minCropBoxWidth){minCropBoxHeight=minCropBoxWidth/aspectRatio}else{minCropBoxWidth=minCropBoxHeight*aspectRatio}}else if(minCropBoxWidth){minCropBoxHeight=minCropBoxWidth/aspectRatio}else if(minCropBoxHeight){minCropBoxWidth=minCropBoxHeight*aspectRatio}if(maxCropBoxHeight*aspectRatio>maxCropBoxWidth){maxCropBoxHeight=maxCropBoxWidth/aspectRatio}else{maxCropBoxWidth=maxCropBoxHeight*aspectRatio}}cropBox.minWidth=min(minCropBoxWidth,maxCropBoxWidth);cropBox.minHeight=min(minCropBoxHeight,maxCropBoxHeight);cropBox.maxWidth=maxCropBoxWidth;cropBox.maxHeight=maxCropBoxHeight}if(isPositionLimited){if(isLimited){cropBox.minLeft=max(0,canvas.left);cropBox.minTop=max(0,canvas.top);cropBox.maxLeft=min(containerWidth,canvas.left+canvas.width)-cropBox.width;cropBox.maxTop=min(containerHeight,canvas.top+canvas.height)-cropBox.height}else{cropBox.minLeft=0;cropBox.minTop=0;cropBox.maxLeft=containerWidth-cropBox.width;cropBox.maxTop=containerHeight-cropBox.height}}},renderCropBox:function(){var options=this.options;var container=this.container;var containerWidth=container.width;var containerHeight=container.height;var cropBox=this.cropBox;if(cropBox.width>cropBox.maxWidth||cropBox.width<cropBox.minWidth){cropBox.left=cropBox.oldLeft}if(cropBox.height>cropBox.maxHeight||cropBox.height<cropBox.minHeight){cropBox.top=cropBox.oldTop}cropBox.width=min(max(cropBox.width,cropBox.minWidth),cropBox.maxWidth);cropBox.height=min(max(cropBox.height,cropBox.minHeight),cropBox.maxHeight);this.limitCropBox(false,true);cropBox.oldLeft=cropBox.left=min(max(cropBox.left,cropBox.minLeft),cropBox.maxLeft);cropBox.oldTop=cropBox.top=min(max(cropBox.top,cropBox.minTop),cropBox.maxTop);if(options.movable&&options.cropBoxMovable){this.$face.data(DATA_ACTION,(cropBox.width===containerWidth&&cropBox.height===containerHeight)?ACTION_MOVE:ACTION_ALL)}this.$cropBox.css({width:cropBox.width,height:cropBox.height,left:cropBox.left,top:cropBox.top});if(this.isCropped&&this.isLimited){this.limitCanvas(true,true)}if(!this.isDisabled){this.output()}},output:function(){this.preview();if(this.isCompleted){this.trigger(EVENT_CROP,this.getData())}},initPreview:function(){var crossOrigin=getCrossOrigin(this.crossOrigin);var url=crossOrigin?this.crossOriginUrl:this.url;var $clone2;this.$preview=$(this.options.preview);this.$clone2=$clone2=$('<img'+crossOrigin+' src="'+url+'">');this.$viewBox.html($clone2);this.$preview.each(function(){var $this=$(this);$this.data(DATA_PREVIEW,{width:$this.width(),height:$this.height(),html:$this.html()});$this.html('<img'+crossOrigin+' src="'+url+'" style="'+'display:block;width:100%;height:auto;'+'min-width:0!important;min-height:0!important;'+'max-width:none!important;max-height:none!important;'+'image-orientation:0deg!important;">')})},resetPreview:function(){this.$preview.each(function(){var $this=$(this);var data=$this.data(DATA_PREVIEW);$this.css({width:data.width,height:data.height}).html(data.html).removeData(DATA_PREVIEW)})},preview:function(){var image=this.image;var canvas=this.canvas;var cropBox=this.cropBox;var cropBoxWidth=cropBox.width;var cropBoxHeight=cropBox.height;var width=image.width;var height=image.height;var left=cropBox.left-canvas.left-image.left;var top=cropBox.top-canvas.top-image.top;if(!this.isCropped||this.isDisabled){return}this.$clone2.css({width:width,height:height,marginLeft:-left,marginTop:-top,transform:getTransform(image)});this.$preview.each(function(){var $this=$(this);var data=$this.data(DATA_PREVIEW);var originalWidth=data.width;var originalHeight=data.height;var newWidth=originalWidth;var newHeight=originalHeight;var ratio=1;if(cropBoxWidth){ratio=originalWidth/cropBoxWidth;newHeight=cropBoxHeight*ratio}if(cropBoxHeight&&newHeight>originalHeight){ratio=originalHeight/cropBoxHeight;newWidth=cropBoxWidth*ratio;newHeight=originalHeight}$this.css({width:newWidth,height:newHeight}).find('img').css({width:width*ratio,height:height*ratio,marginLeft:-left*ratio,marginTop:-top*ratio,transform:getTransform(image)})})},bind:function(){var options=this.options;var $this=this.$element;var $cropper=this.$cropper;if($.isFunction(options.cropstart)){$this.on(EVENT_CROP_START,options.cropstart)}if($.isFunction(options.cropmove)){$this.on(EVENT_CROP_MOVE,options.cropmove)}if($.isFunction(options.cropend)){$this.on(EVENT_CROP_END,options.cropend)}if($.isFunction(options.crop)){$this.on(EVENT_CROP,options.crop)}if($.isFunction(options.zoom)){$this.on(EVENT_ZOOM,options.zoom)}$cropper.on(EVENT_MOUSE_DOWN,$.proxy(this.cropStart,this));if(options.zoomable&&options.zoomOnWheel){$cropper.on(EVENT_WHEEL,$.proxy(this.wheel,this))}if(options.toggleDragModeOnDblclick){$cropper.on(EVENT_DBLCLICK,$.proxy(this.dblclick,this))}$document.on(EVENT_MOUSE_MOVE,(this._cropMove=proxy(this.cropMove,this))).on(EVENT_MOUSE_UP,(this._cropEnd=proxy(this.cropEnd,this)));if(options.responsive){$window.on(EVENT_RESIZE,(this._resize=proxy(this.resize,this)))}},unbind:function(){var options=this.options;var $this=this.$element;var $cropper=this.$cropper;if($.isFunction(options.cropstart)){$this.off(EVENT_CROP_START,options.cropstart)}if($.isFunction(options.cropmove)){$this.off(EVENT_CROP_MOVE,options.cropmove)}if($.isFunction(options.cropend)){$this.off(EVENT_CROP_END,options.cropend)}if($.isFunction(options.crop)){$this.off(EVENT_CROP,options.crop)}if($.isFunction(options.zoom)){$this.off(EVENT_ZOOM,options.zoom)}$cropper.off(EVENT_MOUSE_DOWN,this.cropStart);if(options.zoomable&&options.zoomOnWheel){$cropper.off(EVENT_WHEEL,this.wheel)}if(options.toggleDragModeOnDblclick){$cropper.off(EVENT_DBLCLICK,this.dblclick)}$document.off(EVENT_MOUSE_MOVE,this._cropMove).off(EVENT_MOUSE_UP,this._cropEnd);if(options.responsive){$window.off(EVENT_RESIZE,this._resize)}},resize:function(){var restore=this.options.restore;var $container=this.$container;var container=this.container;var canvasData;var cropBoxData;var ratio;if(this.isDisabled||!container){return}ratio=$container.width()/container.width;if(ratio!==1||$container.height()!==container.height){if(restore){canvasData=this.getCanvasData();cropBoxData=this.getCropBoxData()}this.render();if(restore){this.setCanvasData($.each(canvasData,function(i,n){canvasData[i]=n*ratio}));this.setCropBoxData($.each(cropBoxData,function(i,n){cropBoxData[i]=n*ratio}))}}},dblclick:function(){if(this.isDisabled){return}if(this.$dragBox.hasClass(CLASS_CROP)){this.setDragMode(ACTION_MOVE)}else{this.setDragMode(ACTION_CROP)}},wheel:function(event){var e=event.originalEvent||event;var ratio=num(this.options.wheelZoomRatio)||0.1;var delta=1;if(this.isDisabled){return}event.preventDefault();if(this.wheeling){return}this.wheeling=true;setTimeout($.proxy(function(){this.wheeling=false},this),50);if(e.deltaY){delta=e.deltaY>0?1:-1}else if(e.wheelDelta){delta=-e.wheelDelta/120}else if(e.detail){delta=e.detail>0?1:-1}this.zoom(-delta*ratio,event)},cropStart:function(event){var options=this.options;var originalEvent=event.originalEvent;var touches=originalEvent&&originalEvent.touches;var e=event;var touchesLength;var action;if(this.isDisabled){return}if(touches){touchesLength=touches.length;if(touchesLength>1){if(options.zoomable&&options.zoomOnTouch&&touchesLength===2){e=touches[1];this.startX2=e.pageX;this.startY2=e.pageY;action=ACTION_ZOOM}else{return}}e=touches[0]}action=action||$(e.target).data(DATA_ACTION);if(REGEXP_ACTIONS.test(action)){if(this.trigger(EVENT_CROP_START,{originalEvent:originalEvent,action:action}).isDefaultPrevented()){return}event.preventDefault();this.action=action;this.cropping=false;this.startX=e.pageX||originalEvent&&originalEvent.pageX;this.startY=e.pageY||originalEvent&&originalEvent.pageY;if(action===ACTION_CROP){this.cropping=true;this.$dragBox.addClass(CLASS_MODAL)}}},cropMove:function(event){var options=this.options;var originalEvent=event.originalEvent;var touches=originalEvent&&originalEvent.touches;var e=event;var action=this.action;var touchesLength;if(this.isDisabled){return}if(touches){touchesLength=touches.length;if(touchesLength>1){if(options.zoomable&&options.zoomOnTouch&&touchesLength===2){e=touches[1];this.endX2=e.pageX;this.endY2=e.pageY}else{return}}e=touches[0]}if(action){if(this.trigger(EVENT_CROP_MOVE,{originalEvent:originalEvent,action:action}).isDefaultPrevented()){return}event.preventDefault();this.endX=e.pageX||originalEvent&&originalEvent.pageX;this.endY=e.pageY||originalEvent&&originalEvent.pageY;this.change(e.shiftKey,action===ACTION_ZOOM?event:null)}},cropEnd:function(event){var originalEvent=event.originalEvent;var action=this.action;if(this.isDisabled){return}if(action){event.preventDefault();if(this.cropping){this.cropping=false;this.$dragBox.toggleClass(CLASS_MODAL,this.isCropped&&this.options.modal)}this.action='';this.trigger(EVENT_CROP_END,{originalEvent:originalEvent,action:action})}},change:function(shiftKey,event){var options=this.options;var aspectRatio=options.aspectRatio;var action=this.action;var container=this.container;var canvas=this.canvas;var cropBox=this.cropBox;var width=cropBox.width;var height=cropBox.height;var left=cropBox.left;var top=cropBox.top;var right=left+width;var bottom=top+height;var minLeft=0;var minTop=0;var maxWidth=container.width;var maxHeight=container.height;var renderable=true;var offset;var range;if(!aspectRatio&&shiftKey){aspectRatio=width&&height?width/height:1}if(this.isLimited){minLeft=cropBox.minLeft;minTop=cropBox.minTop;maxWidth=minLeft+min(container.width,canvas.left+canvas.width);maxHeight=minTop+min(container.height,canvas.top+canvas.height)}range={x:this.endX-this.startX,y:this.endY-this.startY};if(aspectRatio){range.X=range.y*aspectRatio;range.Y=range.x/aspectRatio}switch(action){case ACTION_ALL:left+=range.x;top+=range.y;break;case ACTION_EAST:if(range.x>=0&&(right>=maxWidth||aspectRatio&&(top<=minTop||bottom>=maxHeight))){renderable=false;break}width+=range.x;if(aspectRatio){height=width/aspectRatio;top-=range.Y/2}if(width<0){action=ACTION_WEST;width=0}break;case ACTION_NORTH:if(range.y<=0&&(top<=minTop||aspectRatio&&(left<=minLeft||right>=maxWidth))){renderable=false;break}height-=range.y;top+=range.y;if(aspectRatio){width=height*aspectRatio;left+=range.X/2}if(height<0){action=ACTION_SOUTH;height=0}break;case ACTION_WEST:if(range.x<=0&&(left<=minLeft||aspectRatio&&(top<=minTop||bottom>=maxHeight))){renderable=false;break}width-=range.x;left+=range.x;if(aspectRatio){height=width/aspectRatio;top+=range.Y/2}if(width<0){action=ACTION_EAST;width=0}break;case ACTION_SOUTH:if(range.y>=0&&(bottom>=maxHeight||aspectRatio&&(left<=minLeft||right>=maxWidth))){renderable=false;break}height+=range.y;if(aspectRatio){width=height*aspectRatio;left-=range.X/2}if(height<0){action=ACTION_NORTH;height=0}break;case ACTION_NORTH_EAST:if(aspectRatio){if(range.y<=0&&(top<=minTop||right>=maxWidth)){renderable=false;break}height-=range.y;top+=range.y;width=height*aspectRatio}else{if(range.x>=0){if(right<maxWidth){width+=range.x}else if(range.y<=0&&top<=minTop){renderable=false}}else{width+=range.x}if(range.y<=0){if(top>minTop){height-=range.y;top+=range.y}}else{height-=range.y;top+=range.y}}if(width<0&&height<0){action=ACTION_SOUTH_WEST;height=0;width=0}else if(width<0){action=ACTION_NORTH_WEST;width=0}else if(height<0){action=ACTION_SOUTH_EAST;height=0}break;case ACTION_NORTH_WEST:if(aspectRatio){if(range.y<=0&&(top<=minTop||left<=minLeft)){renderable=false;break}height-=range.y;top+=range.y;width=height*aspectRatio;left+=range.X}else{if(range.x<=0){if(left>minLeft){width-=range.x;left+=range.x}else if(range.y<=0&&top<=minTop){renderable=false}}else{width-=range.x;left+=range.x}if(range.y<=0){if(top>minTop){height-=range.y;top+=range.y}}else{height-=range.y;top+=range.y}}if(width<0&&height<0){action=ACTION_SOUTH_EAST;height=0;width=0}else if(width<0){action=ACTION_NORTH_EAST;width=0}else if(height<0){action=ACTION_SOUTH_WEST;height=0}break;case ACTION_SOUTH_WEST:if(aspectRatio){if(range.x<=0&&(left<=minLeft||bottom>=maxHeight)){renderable=false;break}width-=range.x;left+=range.x;height=width/aspectRatio}else{if(range.x<=0){if(left>minLeft){width-=range.x;left+=range.x}else if(range.y>=0&&bottom>=maxHeight){renderable=false}}else{width-=range.x;left+=range.x}if(range.y>=0){if(bottom<maxHeight){height+=range.y}}else{height+=range.y}}if(width<0&&height<0){action=ACTION_NORTH_EAST;height=0;width=0}else if(width<0){action=ACTION_SOUTH_EAST;width=0}else if(height<0){action=ACTION_NORTH_WEST;height=0}break;case ACTION_SOUTH_EAST:if(aspectRatio){if(range.x>=0&&(right>=maxWidth||bottom>=maxHeight)){renderable=false;break}width+=range.x;height=width/aspectRatio}else{if(range.x>=0){if(right<maxWidth){width+=range.x}else if(range.y>=0&&bottom>=maxHeight){renderable=false}}else{width+=range.x}if(range.y>=0){if(bottom<maxHeight){height+=range.y}}else{height+=range.y}}if(width<0&&height<0){action=ACTION_NORTH_WEST;height=0;width=0}else if(width<0){action=ACTION_SOUTH_WEST;width=0}else if(height<0){action=ACTION_NORTH_EAST;height=0}break;case ACTION_MOVE:this.move(range.x,range.y);renderable=false;break;case ACTION_ZOOM:this.zoom((function(x1,y1,x2,y2){var z1=sqrt(x1*x1+y1*y1);var z2=sqrt(x2*x2+y2*y2);return(z2-z1)/z1})(abs(this.startX-this.startX2),abs(this.startY-this.startY2),abs(this.endX-this.endX2),abs(this.endY-this.endY2)),event);this.startX2=this.endX2;this.startY2=this.endY2;renderable=false;break;case ACTION_CROP:if(!range.x||!range.y){renderable=false;break}offset=this.$cropper.offset();left=this.startX-offset.left;top=this.startY-offset.top;width=cropBox.minWidth;height=cropBox.minHeight;if(range.x>0){action=range.y>0?ACTION_SOUTH_EAST:ACTION_NORTH_EAST}else if(range.x<0){left-=width;action=range.y>0?ACTION_SOUTH_WEST:ACTION_NORTH_WEST}if(range.y<0){top-=height}if(!this.isCropped){this.$cropBox.removeClass(CLASS_HIDDEN);this.isCropped=true;if(this.isLimited){this.limitCropBox(true,true)}}break}if(renderable){cropBox.width=width;cropBox.height=height;cropBox.left=left;cropBox.top=top;this.action=action;this.renderCropBox()}this.startX=this.endX;this.startY=this.endY},crop:function(){if(!this.isBuilt||this.isDisabled){return}if(!this.isCropped){this.isCropped=true;this.limitCropBox(true,true);if(this.options.modal){this.$dragBox.addClass(CLASS_MODAL)}this.$cropBox.removeClass(CLASS_HIDDEN)}this.setCropBoxData(this.initialCropBox)},reset:function(){if(!this.isBuilt||this.isDisabled){return}this.image=$.extend({},this.initialImage);this.canvas=$.extend({},this.initialCanvas);this.cropBox=$.extend({},this.initialCropBox);this.renderCanvas();if(this.isCropped){this.renderCropBox()}},clear:function(){if(!this.isCropped||this.isDisabled){return}$.extend(this.cropBox,{left:0,top:0,width:0,height:0});this.isCropped=false;this.renderCropBox();this.limitCanvas(true,true);this.renderCanvas();this.$dragBox.removeClass(CLASS_MODAL);this.$cropBox.addClass(CLASS_HIDDEN)},replace:function(url,onlyColorChanged){if(!this.isDisabled&&url){if(this.isImg){this.$element.attr('src',url)}if(onlyColorChanged){this.url=url;this.$clone.attr('src',url);if(this.isBuilt){this.$preview.find('img').add(this.$clone2).attr('src',url)}}else{if(this.isImg){this.isReplaced=true}this.options.data=null;this.load(url)}}},enable:function(){if(this.isBuilt){this.isDisabled=false;this.$cropper.removeClass(CLASS_DISABLED)}},disable:function(){if(this.isBuilt){this.isDisabled=true;this.$cropper.addClass(CLASS_DISABLED)}},destroy:function(){var $this=this.$element;if(this.isLoaded){if(this.isImg&&this.isReplaced){$this.attr('src',this.originalUrl)}this.unbuild();$this.removeClass(CLASS_HIDDEN)}else{if(this.isImg){$this.off(EVENT_LOAD,this.start)}else if(this.$clone){this.$clone.remove()}}$this.removeData(NAMESPACE)},move:function(offsetX,offsetY){var canvas=this.canvas;this.moveTo(isUndefined(offsetX)?offsetX:canvas.left+num(offsetX),isUndefined(offsetY)?offsetY:canvas.top+num(offsetY))},moveTo:function(x,y){var canvas=this.canvas;var isChanged=false;if(isUndefined(y)){y=x}x=num(x);y=num(y);if(this.isBuilt&&!this.isDisabled&&this.options.movable){if(isNumber(x)){canvas.left=x;isChanged=true}if(isNumber(y)){canvas.top=y;isChanged=true}if(isChanged){this.renderCanvas(true)}}},zoom:function(ratio,_event){var canvas=this.canvas;ratio=num(ratio);if(ratio<0){ratio=1/(1-ratio)}else{ratio=1+ratio}this.zoomTo(canvas.width*ratio/canvas.naturalWidth,_event)},zoomTo:function(ratio,_event){var options=this.options;var canvas=this.canvas;var width=canvas.width;var height=canvas.height;var naturalWidth=canvas.naturalWidth;var naturalHeight=canvas.naturalHeight;var originalEvent;var newWidth;var newHeight;var offset;var center;ratio=num(ratio);if(ratio>=0&&this.isBuilt&&!this.isDisabled&&options.zoomable){newWidth=naturalWidth*ratio;newHeight=naturalHeight*ratio;if(_event){originalEvent=_event.originalEvent}if(this.trigger(EVENT_ZOOM,{originalEvent:originalEvent,oldRatio:width/naturalWidth,ratio:newWidth/naturalWidth}).isDefaultPrevented()){return}if(originalEvent){offset=this.$cropper.offset();center=originalEvent.touches?getTouchesCenter(originalEvent.touches):{pageX:_event.pageX||originalEvent.pageX||0,pageY:_event.pageY||originalEvent.pageY||0};canvas.left-=(newWidth-width)*(((center.pageX-offset.left)-canvas.left)/width);canvas.top-=(newHeight-height)*(((center.pageY-offset.top)-canvas.top)/height)}else{canvas.left-=(newWidth-width)/2;canvas.top-=(newHeight-height)/2}canvas.width=newWidth;canvas.height=newHeight;this.renderCanvas(true)}},rotate:function(degree){this.rotateTo((this.image.rotate||0)+num(degree))},rotateTo:function(degree){degree=num(degree);if(isNumber(degree)&&this.isBuilt&&!this.isDisabled&&this.options.rotatable){this.image.rotate=degree%360;this.isRotated=true;this.renderCanvas(true)}},scale:function(scaleX,scaleY){var image=this.image;var isChanged=false;if(isUndefined(scaleY)){scaleY=scaleX}scaleX=num(scaleX);scaleY=num(scaleY);if(this.isBuilt&&!this.isDisabled&&this.options.scalable){if(isNumber(scaleX)){image.scaleX=scaleX;isChanged=true}if(isNumber(scaleY)){image.scaleY=scaleY;isChanged=true}if(isChanged){this.renderImage(true)}}},scaleX:function(scaleX){var scaleY=this.image.scaleY;this.scale(scaleX,isNumber(scaleY)?scaleY:1)},scaleY:function(scaleY){var scaleX=this.image.scaleX;this.scale(isNumber(scaleX)?scaleX:1,scaleY)},getData:function(isRounded){var options=this.options;var image=this.image;var canvas=this.canvas;var cropBox=this.cropBox;var ratio;var data;if(this.isBuilt&&this.isCropped){data={x:cropBox.left-canvas.left,y:cropBox.top-canvas.top,width:cropBox.width,height:cropBox.height};ratio=image.width/image.naturalWidth;$.each(data,function(i,n){n=n/ratio;data[i]=isRounded?round(n):n})}else{data={x:0,y:0,width:0,height:0}}if(options.rotatable){data.rotate=image.rotate||0}if(options.scalable){data.scaleX=image.scaleX||1;data.scaleY=image.scaleY||1}return data},setData:function(data){var options=this.options;var image=this.image;var canvas=this.canvas;var cropBoxData={};var isRotated;var isScaled;var ratio;if($.isFunction(data)){data=data.call(this.element)}if(this.isBuilt&&!this.isDisabled&&$.isPlainObject(data)){if(options.rotatable){if(isNumber(data.rotate)&&data.rotate!==image.rotate){image.rotate=data.rotate;this.isRotated=isRotated=true}}if(options.scalable){if(isNumber(data.scaleX)&&data.scaleX!==image.scaleX){image.scaleX=data.scaleX;isScaled=true}if(isNumber(data.scaleY)&&data.scaleY!==image.scaleY){image.scaleY=data.scaleY;isScaled=true}}if(isRotated){this.renderCanvas()}else if(isScaled){this.renderImage()}ratio=image.width/image.naturalWidth;if(isNumber(data.x)){cropBoxData.left=data.x*ratio+canvas.left}if(isNumber(data.y)){cropBoxData.top=data.y*ratio+canvas.top}if(isNumber(data.width)){cropBoxData.width=data.width*ratio}if(isNumber(data.height)){cropBoxData.height=data.height*ratio}this.setCropBoxData(cropBoxData)}},getContainerData:function(){return this.isBuilt?this.container:{}},getImageData:function(){return this.isLoaded?this.image:{}},getCanvasData:function(){var canvas=this.canvas;var data={};if(this.isBuilt){$.each(['left','top','width','height','naturalWidth','naturalHeight'],function(i,n){data[n]=canvas[n]})}return data},setCanvasData:function(data){var canvas=this.canvas;var aspectRatio=canvas.aspectRatio;if($.isFunction(data)){data=data.call(this.$element)}if(this.isBuilt&&!this.isDisabled&&$.isPlainObject(data)){if(isNumber(data.left)){canvas.left=data.left}if(isNumber(data.top)){canvas.top=data.top}if(isNumber(data.width)){canvas.width=data.width;canvas.height=data.width/aspectRatio}else if(isNumber(data.height)){canvas.height=data.height;canvas.width=data.height*aspectRatio}this.renderCanvas(true)}},getCropBoxData:function(){var cropBox=this.cropBox;var data;if(this.isBuilt&&this.isCropped){data={left:cropBox.left,top:cropBox.top,width:cropBox.width,height:cropBox.height}}return data||{}},setCropBoxData:function(data){var cropBox=this.cropBox;var aspectRatio=this.options.aspectRatio;var isWidthChanged;var isHeightChanged;if($.isFunction(data)){data=data.call(this.$element)}if(this.isBuilt&&this.isCropped&&!this.isDisabled&&$.isPlainObject(data)){if(isNumber(data.left)){cropBox.left=data.left}if(isNumber(data.top)){cropBox.top=data.top}if(isNumber(data.width)){isWidthChanged=true;cropBox.width=data.width}if(isNumber(data.height)){isHeightChanged=true;cropBox.height=data.height}if(aspectRatio){if(isWidthChanged){cropBox.height=cropBox.width/aspectRatio}else if(isHeightChanged){cropBox.width=cropBox.height*aspectRatio}}this.renderCropBox()}},getCroppedCanvas:function(options){var originalWidth;var originalHeight;var canvasWidth;var canvasHeight;var scaledWidth;var scaledHeight;var scaledRatio;var aspectRatio;var canvas;var context;var data;if(!this.isBuilt||!SUPPORT_CANVAS){return}if(!this.isCropped){return getSourceCanvas(this.$clone[0],this.image)}if(!$.isPlainObject(options)){options={}}data=this.getData();originalWidth=data.width;originalHeight=data.height;aspectRatio=originalWidth/originalHeight;if($.isPlainObject(options)){scaledWidth=options.width;scaledHeight=options.height;if(scaledWidth){scaledHeight=scaledWidth/aspectRatio;scaledRatio=scaledWidth/originalWidth}else if(scaledHeight){scaledWidth=scaledHeight*aspectRatio;scaledRatio=scaledHeight/originalHeight}}canvasWidth=floor(scaledWidth||originalWidth);canvasHeight=floor(scaledHeight||originalHeight);canvas=$('<canvas>')[0];canvas.width=canvasWidth;canvas.height=canvasHeight;context=canvas.getContext('2d');if(options.fillColor){context.fillStyle=options.fillColor;context.fillRect(0,0,canvasWidth,canvasHeight)}context.drawImage.apply(context,(function(){var source=getSourceCanvas(this.$clone[0],this.image);var sourceWidth=source.width;var sourceHeight=source.height;var canvas=this.canvas;var params=[source];var srcX=data.x+canvas.naturalWidth*(abs(data.scaleX||1)-1)/2;var srcY=data.y+canvas.naturalHeight*(abs(data.scaleY||1)-1)/2;var srcWidth;var srcHeight;var dstX;var dstY;var dstWidth;var dstHeight;if(srcX<=-originalWidth||srcX>sourceWidth){srcX=srcWidth=dstX=dstWidth=0}else if(srcX<=0){dstX=-srcX;srcX=0;srcWidth=dstWidth=min(sourceWidth,originalWidth+srcX)}else if(srcX<=sourceWidth){dstX=0;srcWidth=dstWidth=min(originalWidth,sourceWidth-srcX)}if(srcWidth<=0||srcY<=-originalHeight||srcY>sourceHeight){srcY=srcHeight=dstY=dstHeight=0}else if(srcY<=0){dstY=-srcY;srcY=0;srcHeight=dstHeight=min(sourceHeight,originalHeight+srcY)}else if(srcY<=sourceHeight){dstY=0;srcHeight=dstHeight=min(originalHeight,sourceHeight-srcY)}params.push(floor(srcX),floor(srcY),floor(srcWidth),floor(srcHeight));if(scaledRatio){dstX*=scaledRatio;dstY*=scaledRatio;dstWidth*=scaledRatio;dstHeight*=scaledRatio}if(dstWidth>0&&dstHeight>0){params.push(floor(dstX),floor(dstY),floor(dstWidth),floor(dstHeight))}return params}).call(this));return canvas},setAspectRatio:function(aspectRatio){var options=this.options;if(!this.isDisabled&&!isUndefined(aspectRatio)){options.aspectRatio=max(0,aspectRatio)||NaN;if(this.isBuilt){this.initCropBox();if(this.isCropped){this.renderCropBox()}}}},setDragMode:function(mode){var options=this.options;var croppable;var movable;if(this.isLoaded&&!this.isDisabled){croppable=mode===ACTION_CROP;movable=options.movable&&mode===ACTION_MOVE;mode=(croppable||movable)?mode:ACTION_NONE;this.$dragBox.data(DATA_ACTION,mode).toggleClass(CLASS_CROP,croppable).toggleClass(CLASS_MOVE,movable);if(!options.cropBoxMovable){this.$face.data(DATA_ACTION,mode).toggleClass(CLASS_CROP,croppable).toggleClass(CLASS_MOVE,movable)}}}};Cropper.DEFAULTS={viewMode:0,dragMode:'crop',aspectRatio:NaN,data:null,preview:'',responsive:true,restore:true,checkCrossOrigin:true,checkOrientation:true,modal:true,guides:true,center:true,highlight:true,background:true,autoCrop:true,autoCropArea:0.8,movable:true,rotatable:true,scalable:true,zoomable:true,zoomOnTouch:true,zoomOnWheel:true,wheelZoomRatio:0.1,cropBoxMovable:true,cropBoxResizable:true,toggleDragModeOnDblclick:true,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null};Cropper.setDefaults=function(options){$.extend(Cropper.DEFAULTS,options)};Cropper.TEMPLATE=('<div class="cropper-container">'+'<div class="cropper-wrap-box">'+'<div class="cropper-canvas"></div>'+'</div>'+'<div class="cropper-drag-box"></div>'+'<div class="cropper-crop-box">'+'<span class="cropper-view-box"></span>'+'<span class="cropper-dashed dashed-h"></span>'+'<span class="cropper-dashed dashed-v"></span>'+'<span class="cropper-center"></span>'+'<span class="cropper-face"></span>'+'<span class="cropper-line line-e" data-action="e"></span>'+'<span class="cropper-line line-n" data-action="n"></span>'+'<span class="cropper-line line-w" data-action="w"></span>'+'<span class="cropper-line line-s" data-action="s"></span>'+'<span class="cropper-point point-e" data-action="e"></span>'+'<span class="cropper-point point-n" data-action="n"></span>'+'<span class="cropper-point point-w" data-action="w"></span>'+'<span class="cropper-point point-s" data-action="s"></span>'+'<span class="cropper-point point-ne" data-action="ne"></span>'+'<span class="cropper-point point-nw" data-action="nw"></span>'+'<span class="cropper-point point-sw" data-action="sw"></span>'+'<span class="cropper-point point-se" data-action="se"></span>'+'</div>'+'</div>');Cropper.other=$.fn.cropper;$.fn.cropper=function(option){var args=toArray(arguments,1);var result;this.each(function(){var $this=$(this);var data=$this.data(NAMESPACE);var options;var fn;if(!data){if(/destroy/.test(option)){return}options=$.extend({},$this.data(),$.isPlainObject(option)&&option);$this.data(NAMESPACE,(data=new Cropper(this,options)))}if(typeof option==='string'&&$.isFunction(fn=data[option])){result=fn.apply(data,args)}});return isUndefined(result)?this:result};$.fn.cropper.Constructor=Cropper;$.fn.cropper.setDefaults=Cropper.setDefaults;$.fn.cropper.noConflict=function(){$.fn.cropper=Cropper.other;return this}});(function(){$.fn.keyFilter=function(def,callback){return this.each(function(){var obj=$(this);obj.keypress(function(e){if(e.which==0)return true;var isDigit=e.which>=48&&e.which<=57;var isBack=e.which==8;if(!isDigit&&!isBack)return false}).keyup(function(e){var max=obj.attr('max');if(max){max=Number(max);if(obj.val()>max){obj.val(max);widgets.msg("В наличии только "+max,obj.get(0))}}if(callback)callback(obj)}).blur(function(){if(obj.val()==''||obj.getVal()==0){obj.val(def);if(callback)callback(obj)}})})};$.fn.getVal=function(){var v=$(this).val();v=parseFloat(v);if(v)return v;return 0}})(jQuery);var imageMaker={};(function($){imageMaker={init:function(options){var self=this;self.dataHeight=$('#dataHeight');self.dataWidth=$('#dataWidth');self.dataScale=$('#dataScale');self.dataRotate=0;self.dataX=0;self.dataY=0;self.editor='.image-editor';self.editorControls='.image-maker-controls';self.editorInfo='.image-info.crop';self.editorInfoProp='.image-info.properties';self.editorPreview='.image-maker-preview';self.hiddenControls='.btn-group.right';self.options=options;self.image_id=options.imageId||0;self.$image=$('.image-editor img');self.flag=false;self.aspR=1;$(self.editorInfoProp).find('input:text').keyFilter(1);$(self.editorInfo).find('input:text').keyFilter(1);if(self.options.cropper){options.cropperOptions={aspectRatio:0,dragMode:'move',cropBoxResizable:false,zoomable:false,data:{"width":self.options.cropper['width'],"height":self.options.cropper['height']},crop:function(e){$(self.dataHeight).val(Math.round(e.height));$(self.dataWidth).val(Math.round(e.width));$(self.dataScale).val((parseFloat(e.scaleX)*100).toFixed(0));self.dataX=Math.round(e.x);self.dataY=Math.round(e.y);self.dataRotate=parseInt(e.rotate);$(self.dataHeight).removeClass('error');$(self.dataWidth).removeClass('error')},built:function(){var cropBoxData=self.$image.cropper('getCropBoxData');var aspectRatio=cropBoxData.width/cropBoxData.height;var canvasData=self.$image.cropper('getCanvasData');self.$image.cropper("setCropBoxData",{"left":Math.round((canvasData.width-cropBoxData.width)/2+canvasData.left),"top":Math.round((canvasData.height-cropBoxData.height)/2+canvasData.top),});$(self.editorInfo).show();$(self.hiddenControls).show()}}}else{self.options.cropperOptions={aspectRatio:0,autoCrop:false,dragMode:'move',cropBoxResizable:true,crop:function(e){$(self.dataHeight).val(Math.round(e.height));$(self.dataWidth).val(Math.round(e.width));$(self.dataScale).val(parseFloat(e.scaleX)*100);self.dataX=Math.round(e.x);self.dataY=Math.round(e.y);self.dataRotate=parseInt(e.rotate)},built:function(){var cropBoxData=self.$image.cropper('getCropBoxData');var aspectRatio=cropBoxData.width/cropBoxData.height;var canvasData=self.$image.cropper('getCanvasData');if(Math.round(canvasData.width*100/canvasData.naturalWidth)>100){self.$image.cropper('zoomTo',1);$('.zoom-info').text('100%')}else{var n=Math.pow(10,-1),z=Math.round(parseInt(canvasData.width*100/canvasData.naturalWidth)*n)/n;self.$image.cropper('zoomTo',z/100);$('.zoom-info').text(z+'%')}}}};self.$image.on({'zoom.cropper':function(e){$('.zoom-info').text(parseInt(parseFloat(e.ratio).toFixed(1)*100)+'%')},'cropend.cropper':function(e){var cropData=self.$image.cropper('getCropBoxData');if(Object.keys(cropData).length){$(self.hiddenControls).show();$(self.editorInfo).show();self.setData('crop')}},'crop.cropper':function(e){var canvasData=self.$image.cropper('getCanvasData');self.aspR=parseFloat(canvasData.naturalWidth/canvasData.naturalHeight)},'built.cropper':function(){$('.image-maker .loader').fadeOut('fast')}}).cropper(self.options.cropperOptions);self.cropperOptions=self.options.cropperOptions},debounce:(function(){var timer=0;return function(fn,delay){clearTimeout(timer);timer=setTimeout(fn,delay)}})(),setProperties:function(width,height){var self=this;$(self.editorInfoProp).find('input.image-width').val(width);$(self.editorInfoProp).find('input.image-height').val(height)},setData:function(mode,click){var self=this,imageData=self.$image.cropper('getData'),canvasData=self.$image.cropper('getCanvasData'),cropData=self.$image.cropper('getCropBoxData'),nWidth=parseFloat(canvasData.naturalWidth),nHeight=parseFloat(canvasData.naturalHeight),rotate=parseFloat(imageData.rotate),scaleX=parseFloat(imageData.scaleX),scaleY=parseFloat(imageData.scaleY),inputWidth=parseInt($(self.editorInfoProp).find('input.image-width').val()),inputHeight=parseInt($(self.editorInfoProp).find('input.image-height').val()),linkButton=$(self.editorInfoProp).find('button:first');isLinked=$(self.editorInfoProp).find('button .i-editor-linked').length,fromRotate=false;data={};switch(mode){case'scale':if(isNaN(inputWidth)||isNaN(inputHeight)){inputWidth=canvasData.naturalWidth;inputHeight=canvasData.naturalHeight}if(inputWidth<30){inputWidth=30}if(inputHeight<30){inputHeight=30}if(isLinked){if(Math.round(canvasData.naturalWidth*scaleX)==inputWidth){scaleX=parseFloat(inputHeight/canvasData.naturalHeight)}else{scaleX=parseFloat(inputWidth/canvasData.naturalWidth)};scaleX=(scaleX>1)?1:scaleX;scaleY=scaleX}else{scaleX=parseFloat(inputWidth/canvasData.naturalWidth);scaleY=parseFloat(inputHeight/canvasData.naturalHeight)}data={'scaleX':scaleX,'scaleY':scaleY};if(data.scaleX==1){$('.btn-group.scale button:last').addClass('disable')}else{$('.btn-group.scale button:last').removeClass('disable')}if(inputWidth<=30||inputHeight<=30){$('.btn-group.scale button:first').addClass('disable')}else{$('.btn-group.scale button:first').removeClass('disable')};break;case'rotate':var fromRotate=true;scaleX=parseFloat(inputHeight/canvasData.naturalWidth),scaleY=parseFloat(inputWidth/canvasData.naturalHeight);data={'scaleX':scaleX,'scaleY':scaleY};if(Object.keys(cropData).length){}break;case'crop':linkButton=$(self.editorInfo).find('button:first');inputWidth=parseInt($(self.editorInfo).find('input.image-width').val());inputHeight=parseInt($(self.editorInfo).find('input.image-height').val());self.aspR=parseFloat((canvasData.naturalWidth*imageData.scaleX)/(canvasData.naturalHeight*imageData.scaleY));if(inputWidth<30){inputWidth=30}if(inputHeight<30){inputHeight=30}data={"width":inputWidth,"height":inputHeight};if(linkButton.hasClass('active')){data.height=parseFloat(data.width/self.aspR)}break}self.$image.cropper('setData',data);if(isLinked){if(rotate==90||rotate==-90||rotate==270||rotate==-270){self.setProperties(Math.round(nWidth*scaleY),Math.round(nHeight*scaleX))}else{self.setProperties(Math.round(nWidth*scaleX),Math.round(nHeight*scaleY))}if(canvasData.naturalWidth!=$(self.editorInfoProp).find('input.image-width').val()||canvasData.naturalHeight!=$(self.editorInfoProp).find('input.image-height').val()){$(self.hiddenControls).show()}}else{if(fromRotate){self.setProperties(inputHeight,inputWidth)}$(self.hiddenControls).show()}if(parseInt($(self.editorInfoProp).find('input.image-width').val())>30&&parseInt($(self.editorInfoProp).find('input.image-height').val())>30){$('.btn-group.scale button:first').removeClass('disable')}},imagePropertiesLinked:function(parent){var self=this,inputWidth=$(parent).find('input.image-width'),linkButton=$(parent).find('button:first'),canvasData=self.$image.cropper('getCanvasData'),imageData=self.$image.cropper('getData'),scaleX=imageData.scaleX,scaleY=imageData.scaleY;if(linkButton.hasClass('active')){linkButton.removeClass('active')}else{scaleX=parseFloat(inputWidth.val()*100/canvasData.naturalWidth/100);self.imageScale(scaleX,scaleX,true);linkButton.addClass('active')}},imageCropLinked:function(parent){var self=this,linkButton=$(parent).find('button:first');linkButton.toggleClass('active');self.setData('crop')},changeScaleFromInputs:function(parent){var self=this;self.debounce(function(){self.setData('scale')},500)},changeCropFromInputs:function(parent){var self=this;self.debounce(function(){self.setData('crop')},500)},imageSwitchControls:function(w,f,src){var self=this;if(f){$(w).find('.image-editor-wrapper').addClass('preview');$(w).find(self.editor).hide();$(w).find(self.editorInfo).hide();$(w).find(self.editorInfoProp).hide();$(w).find(self.editorControls).hide();$(w).find(self.editorPreview).prepend('<img src="'+src+'">');$(w).find(self.editorPreview).show()}else{$(w).find('.image-editor-wrapper').removeClass('preview');$(w).find(self.editorPreview).hide();$(w).find(self.editorPreview).find('img:first').remove();$(w).find(self.editor).show();$(w).find(self.editorControls).show();$(w).find(self.editorInfoProp).show()}},setDragModeMove:function(){var self=this;self.$image.cropper('setDragMode','move')},setDragModeCrop:function(){var self=this;self.$image.cropper('setDragMode','crop')},imageRotateMove:function(step){var self=this;self.$image.cropper("rotate",step);if(!self.flag){$(self.hiddenControls).show();self.flag=true};self.setData('rotate')},imageZoom:function(step){var self=this,step=parseFloat(step),zoomVal=parseFloat($('.zoom-info').text())/100,res;res=zoomVal+step;if(res<=0)return;self.$image.cropper("zoomTo",res);$('.zoom-info').text(Math.round(res*100)+'%')},imageScale:function(scaleX,scaleY,scale,elem){var self=this,imgData=self.$image.cropper('getData'),cnvData=self.$image.cropper('getCanvasData'),res={};if($(elem).hasClass('disable'))return false;if(scale){res={"scaleX":parseFloat(scaleX),"scaleY":parseFloat(scaleY)}}else{res={"scaleX":parseFloat(imgData.scaleX+scaleX),"scaleY":parseFloat(imgData.scaleY+scaleY)}};if(res.scaleX<1||res.scaleY<1){$(elem).siblings('button').removeClass('disable')}else{$(elem).addClass('disable');res.scaleX=1;res.scaleY=1};if(parseInt(cnvData.naturalWidth*res.scaleX)<=30){res.scaleX=30/parseInt(cnvData.naturalWidth);res.scaleY=res.scaleX;$(elem).addClass('disable')}if(parseInt(cnvData.naturalHeight*res.scaleY)<=30){res.scaleY=30/parseInt(cnvData.naturalHeight);res.scaleX=res.scaleY;$(elem).addClass('disable')}self.$image.cropper('setData',res);self.setProperties(parseInt(cnvData.naturalWidth*res.scaleX),parseInt(cnvData.naturalHeight*res.scaleY));if(cnvData.naturalWidth!=$(self.editorInfoProp).find('input.image-width').val()||cnvData.naturalHeight!=$(self.editorInfoProp).find('input.image-height').val()){$(self.hiddenControls).show()}},imageClear:function(){var self=this,canvasData=self.$image.cropper('getImageData');self.$image.cropper('clear');$(self.hiddenControls).hide();$(self.editorInfo).hide();self.$image.cropper('clear');self.flag=false;$(self.editorInfo).find('.input-group button').removeClass('active');self.setProperties(Math.round(canvasData.naturalWidth),Math.round(canvasData.naturalHeight))},imageReset:function(){var self=this;self.imageClear();self.$image.cropper('reset');self.$image.cropper('destroy').cropper(self.cropperOptions);$('.btn-group.scale button:last').addClass('disable')},imagePreview:function(validate){var self=this,src=self.$image.cropper('getCroppedCanvas').toDataURL(),w=popupController.getLastPopup().obj,cropBoxData=self.$image.cropper('getCropBoxData'),canvasData=self.$image.cropper('getCanvasData'),dataWidth=parseInt($(self.dataWidth).val()),dataHeight=parseInt($(self.dataHeight).val()),error=false,imageData={};if(validate){$(self.editorInfo).find('input').each(function(){if(parseInt($(this).val())<parseInt($(this).data('min'))){$(this).addClass('error');error=true}});if(error)return};imageData={left:Math.round($('.cropper-crop-box img').position().left)*(-1),top:Math.round($('.cropper-crop-box img').position().top)*(-1),width:Math.round($('.cropper-crop-box img').innerWidth()*$(self.dataScale).val()/100),height:Math.round($('.cropper-crop-box img').innerHeight()*$(self.dataScale).val()/100),};if(self.dataRotate==90||self.dataRotate==270||self.dataRotate==-90||self.dataRotate==-270){imageData={left:Math.round($('.cropper-crop-box img').position().left)*(-1),top:Math.round($('.cropper-crop-box img').position().top)*(-1),width:Math.round($('.cropper-crop-box img').innerHeight()*$(self.dataScale).val()/100),height:Math.round($('.cropper-crop-box img').innerWidth()*$(self.dataScale).val()/100),}};imageData.left=Math.round((imageData.width-canvasData.width)/2);imageData.top=Math.round((imageData.height-canvasData.height)/2);if(Math.round(canvasData.left-imageData.left)>Math.round(cropBoxData.left)||Math.round(canvasData.top-imageData.top)>Math.round(cropBoxData.top)||Math.round(canvasData.left-imageData.left+imageData.width)<Math.round(cropBoxData.left+cropBoxData.width)||Math.round(canvasData.top-imageData.top+imageData.height)<Math.round(cropBoxData.top+cropBoxData.height)){s3.alert(JS_ERROR_IMAGE_MAKER_CROP_FRAME);return};self.imageSwitchControls(w,true,src)},closePreview:function(){var self=this,w=popupController.getLastPopup().obj,cropBoxData=self.$image.cropper('getCropBoxData');self.imageSwitchControls(w,false);if(Object.keys(cropBoxData).length){$(w).find(self.editorInfo).show()}},onSuccess:function(){var self=this,image=$('#image'+self.image_id+' span.image-thumb'),url=image.css('background-image'),d=new Date(),new_url=url.replace(/(\?\d*)/g,'?'+Math.random());image.css({"background-image":new_url});$('img.s3ImageMakerObj_'+self.image_id).attr('src',image.data('thumb')+'?'+d.getTime())},addNewImage:function(url,name,fn,replace,image_name){var self=this,canvas=self.$image.cropper('getCroppedCanvas'),type='image/',xhr=new XMLHttpRequest(),lowerCase='',boundary='ohaiimaboundary',data={};lowerCase=fn.toLowerCase();if(lowerCase.indexOf("png")!==-1){type+='png'}else if(lowerCase.indexOf("jpg")!==-1||lowerCase.indexOf("jpeg")!==-1){type+='jpeg'}else if(lowerCase.indexOf("gif")!==-1){type+='png'}else{type+='png'}data=canvas.toDataURL(type);data=data.replace('data:'+type+';base64,','');if(!XMLHttpRequest.prototype.sendAsBinary){XMLHttpRequest.prototype.sendAsBinary=function(sData){var nBytes=sData.length,ui8Data=new Uint8Array(nBytes);for(var nIdx=0;nIdx<nBytes;nIdx++){ui8Data[nIdx]=sData.charCodeAt(nIdx)&0xff}this.send(ui8Data)}}if(replace){s3.confirm(JS_IMAGE_MAKER_CONFIRM_REPLACE_IMAGE,function(){popupController.closeLastPopup();xhr.open('POST',url,true);xhr.setRequestHeader('Content-Type','multipart/form-data; charset=utf-8; boundary='+boundary);xhr.sendAsBinary(['--'+boundary,'Content-Disposition: form-data; name="'+name+'"; filename="'+unescape(encodeURIComponent(fn))+'"','Content-Type: '+type+'; charset=utf-8;','',atob(data),'--'+boundary+'--'].join('\r\n'));xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){popupController.closeLastPopup();var ul=util.getElementFromText(this.responseText,"UL"),child=$(ul).find('li:first'),parent=$('li.image'+self.image_id),img_thumb=$('#image_control_'+self.image_id+' > img'),d=new Date();$(child).insertBefore(parent);$(parent).empty().remove();$('img.s3ImageMakerObj_'+self.image_id).attr('src',$(child).find('span.image-thumb').data('thumb')+'?'+d.getTime());img_thumb.attr('src',$(child).find('span.image-thumb').data('thumb')+'?'+d.getTime());treeController.reloadTree();$(child).S3ChangeControls()}}})}else{s3.prompt(JS_IMAGE_MAKER_PROMPT_IMAGE_NAME,image_name,function(){var result=$('#prompt-input').val(),ext=fn.split('.').pop();fn=result+'.'+ext;if(!result)s3.alert(JS_ERROR_IMAGE_MAKER_ENTER_IMAGE_NAME);if(result&&result!=''){popupController.closeLastPopup();xhr.open('POST',url,true);xhr.setRequestHeader('Content-Type','multipart/form-data; charset=utf-8; boundary='+boundary);xhr.sendAsBinary(['--'+boundary,'Content-Disposition: form-data; name="'+name+'"; filename="'+unescape(encodeURIComponent(fn))+'"','Content-Type: '+type+'; charset=utf-8;','',atob(data),'--'+boundary+'--'].join('\r\n'));xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){popupController.closeLastPopup();var win=$(document);if(popupController.getLastPopup()){win=popupController.getLastPopup().obj}var ul=util.getElementFromText(this.responseText,"UL"),child=$(ul).find('li:first'),parent=$(win).find('#image'+self.image_id),img_control=$(win).find('#image_control_'+self.image_id),image_data={},d=new Date(),extra_get='';$(child).insertBefore(parent);image_data={"image_id":$(child).data('image-id'),"filename":$(child).data('filename'),"ver_id":$(child).data('ver-id'),};if(self.options.cropper){image_data.cropper_width=self.options.cropper['width'];image_data.cropper_height=self.options.cropper['height'];extra_get='&cropper_width='+self.options.cropper['width']+'&cropper_height='+self.options.cropper['height']}if(img_control.get(0)){var control=$(img_control).parent(),image_ver_id=image_data.ver_id,global_get_param=(image_ver_id==1?"&global=1":""),replaceBtn=$(control).find('span.image-replace'),editBtn=$(control).find('span.image-edit'),cropBtn=$(control).find('span.image-crop'),image_replace_link=replaceBtn.attr('onclick'),image_edit_link=editBtn.attr('onclick'),image_crop_link=cropBtn.attr('onclick'),replaceBtn_new_link="selectFormImage2($('#image_control_"+image_data.image_id+"').get(0),0)",editBtn_new_link="openAjaxForm('/-/cms/v1/image/?act=edit&object_id="+image_data.image_id+"&"+S3_ACCESS+global_get_param+"', false, function() {popupController.reloadLastPopup();}, false);",cropBtn_new_link="s3.openModalPopup('/-/cms/v1/image/?act=maker&"+S3_ACCESS+"&popup="+image_data.image_id+extra_get+"');";if(self.options.cropper){replaceBtn_new_link="selectFormImage2($('#image_control_"+image_data.image_id+"').get(0),0, {'width':"+image_data.cropper_width+", 'height' :"+image_data.cropper_height+"})"};$(img_control).find('>img').attr('src',$(child).find('span.image-thumb').data('thumb')+'?'+d.getTime());$(img_control).find('>img').attr('class','s3ImageMakerObj_'+JSON.stringify(image_data));$(img_control).attr('id','image_control_'+image_data.image_id);$(img_control).attr('data-image-id',image_data.image_id);replaceBtn.attr('onclick',replaceBtn_new_link);editBtn.attr('onclick',editBtn_new_link);cropBtn.attr('onclick',cropBtn_new_link);image_data=JSON.stringify(image_data);$(img_control).find('input:hidden:first').val(image_data)}else{popupController.closeLastPopup()}treeController.reloadTree();$(child).S3ChangeControls()}}}})}},replaceImage:function(){var self=this,imageWidth,imageHeight,cropImage=[],url='/-/cms/v1/image/?act=maker',canvasData=self.$image.cropper('getCroppedCanvas');url+='&image_id='+self.image_id+'&'+S3_ACCESS;imageWidth=canvasData.width;imageHeight=canvasData.height;cropImage['width']=imageWidth;cropImage['height']=imageHeight;$.ajax({url:url,type:'POST',data:{image_id:self.image_id,img:canvasData.toDataURL(),crop:{width:cropImage['width'],height:cropImage['height']},},contentType:'application/x-www-form-urlencoded;charset=UTF-8',success:function(data){if(data){util.msg("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043e");self.onSuccess();popupController.reloadPreviousPopup();popupController.closeLastPopup()}},error:function(){util.log("Image was not saved!")}})},toggleLink:function(parent){var self=this;var isLinked=$(self.editorInfoProp).find('button .i-editor-linked').length;if(isLinked){$(self.editorInfoProp).find('button .i-editor-linked').removeClass('i-editor-linked').addClass('i-editor-unlinked')}else{$(self.editorInfoProp).find('button .i-editor-unlinked').removeClass('i-editor-unlinked').addClass('i-editor-linked');var canvasData=self.$image.cropper('getCanvasData'),inputWidth=$(parent).find('input.image-width'),scaleX=parseFloat(inputWidth.val()*100/canvasData.naturalWidth/100);self.imageScale(scaleX,scaleX,true)}}}})(jQuery);var paymentController={},hasListener=false;(function($){paymentController={listenPaymentWindow:function(site_id,service_group){var self=this,paymentPopup=popupController.getLastModalPopup();paymentPopup.onClose=self.clearPaymentListener();self.site_id=site_id;self.service_group=service_group;Preloader.hide()},postMessageListener:function(event){var self=paymentController,result=event.data,payment_window=$('#s3_payment'),site_id=self.site_id,service_group=self.service_group,payments_list_url='/-/cms/v1/payment/?act=list&'+access+'&site_id='+site_id+'&service_group='+service_group;setTimeout(function(){if(result.pay_transition){paymentController.clearPaymentListener();popupController.closeLastPopup();switch(service_group){case'disc_space':s3.openModalPopup(payments_list_url);break;case'image_order_depositphotos':if(popupController.getLastPopup()){popupController.closeLastPopup()}ImageController.updateImageSource(self.order_data,true);break;case'lpc':case"lp16":if(popupController.getLastPopup()){popupController.closeLastPopup()}LpController.demoStatusAutoUpdate();break;case's3_custom_logo_assisted':if(popupController.getLastPopup()){popupController.reloadLastPopup()}logotizer.loadLogotypesList();break;case's3_favicon':if(popupController.getLastPopup()){popupController.reloadLastPopup()}logo.loadFaviconsList();break;case'enable_tls':case'enable_acl':s3.reloadContent();break;case's3_fast_pay':if(popupController.getLastPopup()){popupController.reloadLastPopup()}else{s3.reloadContent()}break}}else if(result.window_height){var window_height=parseInt(result.window_height);if(window_height&&window_height>10){payment_window.height(result.window_height)}else{payment_window.height(500)}}else if(result.close_iframe){popupController.closeLastPopup()}},50)},addPaymentListener:function(order_data){var self=this;self.order_data=order_data;if(!hasListener){if(window.addEventListener){window.addEventListener("message",self.postMessageListener)}else{window.attachEvent("onmessage",self.postMessageListener)}hasListener=true}},clearPaymentListener:function(){var callback=function(){};if(window.removeEventListener){window.removeEventListener("message",callback)}else{window.detachEvent("onmessage",callback)}hasListener=false},showPaymentStats:function(site_id,service_group){var payments_list_url='/-/cms/v1/payment/?act=list&'+access+'&site_id='+site_id+'&service_group='+service_group;s3.openModalPopup(payments_list_url)},refreshPaymentsStatus:function(service_group){var current_limit_box,total_limit_box,total_limit,current_limit;s3.reloadContent();popupController.reloadLastPopup();if(service_group=="disc_space"){current_limit_box=$('#disc-space_current_limit');total_limit_box=$('#disc-space_total_limit');total_limit=parseInt(total_limit_box.val());current_limit=$('#disc-space_total_limit').val();if(total_limit!=current_limit){current_limit_box.text(current_limit)}}else{location.reload()}util.msg(JS_RELOADED)}}})(jQuery);var Gallery2Controller;(function($){Gallery2Controller={url:'/-/cms/v1/gallery2/?'+S3_ACCESS,album:{element:{view:function(object,album_id,album_album_id,gallery_id,sort_mode){var data='gallery2_albums'+(sort_mode=='position'?'_dragable':'')+'_'+album_id,url='/-/cms/v1/gallery2/?act=view&'+S3_ACCESS+'&object_id='+gallery_id+'&album_id='+album_album_id+'&popup=true';s3.editObject(object,'LI',data,url,false)},edit:function(album_id,gallery_id,sort_mode,site){var data='gallery2_images_container'+(sort_mode=='position'?'_dragable':'')+'_'+album_id,url='/-/cms/v1/gallery2/?act=image_edit&'+site+'&gallery_id='+gallery_id+'&album_id='+album_id,onClose=function(){var lastPopup=popupController.getPreviousPopup();popupController.reloadLastPopup();if(lastPopup){lastPopup.reload()}else{s3.reloadContent()}};s3.editObject(false,'LI',data,url,false,false,false,onClose,false)}},image:{element:{edit:function(object,album_id,gallery_id,gallery_image_id,sort_mode){var data='gallery2_images_container'+(sort_mode=='position'?'_dragable':'')+'_'+album_id,url='/-/cms/v1/gallery2/?act=image_edit&object_id='+gallery_image_id+'&'+S3_ACCESS+'&gallery_id='+gallery_id+'&album_id='+album_id,onClose=function(){popupController.reloadPreviousPopup()},onUpdate=function(){s3.reloadContent()};s3.editObject(object,'LI',data,url,false,false,false,onClose,false,onUpdate)}}}},brokenImage:{remove:function(gallery_id){var url='/-/cms/v1/gallery2/?act=delete_broken_image&'+S3_ACCESS+'&object_id='+gallery_id;s3.confirm(s3.loc('JS_CONFIRM_DELETE_BROKEN_IMAGES'),function(){util.makePostRequest(url,'gallery_id='+gallery_id);popupController.closeLastPopup();s3.reloadVisibleContent()})}},setCover:function(obj,folder_id,image_id){var self=this,res;res=util.makeGetRequest(self.url+'&act=set_cover&album_id='+folder_id+'&image_id='+image_id+'&set=1');if(res&&!res.error){util.msg(s3.loc('JS_SAVED'))}},regallery:{addImage:function(folder_id,gallery_id,sort_mode){var data='gallery2_images_container'+(sort_mode=='position'?'_dragable':'')+'_'+folder_id,url='/-/cms/v1/gallery2/?act=image_edit&'+S3_ACCESS+'&gallery_id='+gallery_id+'&folder_id='+folder_id,onClose=function(){s3.reloadVisibleContent()};s3.editObject(false,'LI',data,url,false,false,false,onClose,false)},editImage:function(object,folder_id,gallery_id,gallery_image_id,sort_mode){var data='gallery2_images_container'+(sort_mode=='position'?'_dragable':'')+'_'+folder_id,url='/-/cms/v1/gallery2/?act=image_edit&object_id='+gallery_image_id+'&'+S3_ACCESS+'&gallery_id='+gallery_id+'&folder_id='+folder_id,onClose=function(){s3.reloadVisibleContent()},onUpdate=function(){s3.reloadContent()};s3.editObject(object,'LI',data,url,false,false,false,onClose,false,onUpdate)},deleteImage:function(object,image_id,gallery_id){var url='/-/cms/v1/gallery2/?act=image_delete&'+S3_ACCESS+'&image_id='+image_id+'&gallery_id='+gallery_id,func=function(){s3.reloadVisibleContent()};s3.deleteObject(object,'LI',url,func)}}}})(jQuery);var GalleryController;(function($){GalleryController={copyGallery:function(gallery_id,msg){var self=this,gallery_id=s3.getInt(gallery_id),url='/-/cms/v1/gallery/?act=copy&'+S3_ACCESS+'&object_id='+gallery_id;var f=function(){popupController.closeLastPopup();s3.updateObject(null,'TR','gallery_list',url,false,true)};s3.confirm(msg,f)}}})(jQuery);var UsersController;(function($){UsersController={NAMES_FIELD_RERENDER:{PHONE_FIELD:"phone_field",AUTH_MAPPING:"auth_mapping"},CLASSNAMES_FIELD_RERENDER:{USER_MATCH_SETTINGS:".user-match-settings-field",USER_PHONE:".user-phone-field"},baseUrl:'/-/cms/v1/user/?'+S3_ACCESS,checked:false,folder_id:false,user_count:false,container:false,addUser:function(url){openAjaxForm(url,function(r){popupController.closeLastPopup();s3.reloadVisibleContent()},null,null)},editUser:function(user_id,folder_id,object,parent){var self=this,user_id=s3.getInt(user_id,0),folder_id=s3.getInt(folder_id,0),url='/-/cms/v1/user/?act=edit&object_id='+user_id+'&folder_id='+folder_id+'&'+S3_ACCESS;openAjaxForm(url,function(r){var object=$('tr#users_'+user_id);$(r.text).insertAfter(object).S3ChangeControls();object.empty().remove();popupController.closeLastPopup();treeController.reloadTree('.tree-wrapper');fadeController.init($(parent).get(0))},null,function(r){var object=$('tr#users_'+user_id);$(r.text).insertAfter(object).S3ChangeControls();object.empty().remove();treeController.reloadTree('.tree-wrapper');fadeController.init($(parent).get(0))})},deleteUser:function(user_id,folder_id,object,parent,msg){var self=this,user_id=s3.getInt(user_id,0),folder_id=s3.getInt(folder_id,0),object=$(object).closest(parent),url='/-/cms/v1/user/?act=delete&'+S3_ACCESS+'&folder_id='+folder_id+'&object_id='+user_id,res;s3.confirm((msg?msg:JS_CONFIRM_DELETE),function(){res=util.makePostRequest(url,'');popupController.closeLastPopup();if(res.text=='OK'){object.empty().remove();s3.reloadContent()}})},selectUser:function(obj,text){var self=this;$(obj).html(text).addClass('added').removeAttr('onclick')},discountUsersInit:function(container,text){var self=this,container=$(container),selected_users=[],form_name,p=popupController.getPreviousPopup();if(p.obj){var ff=util.getElementsByClassName(p.obj,'DIV','discount-users');if(ff){form_name=$(ff).attr('id');$('#'+form_name).find("a").each(function(){var id=$(this).attr('id');selected_users.push(id.replace('pp_user',''))});if(selected_users.length){for(var i in selected_users){var tr=container.find('>tr#users_'+selected_users[i]);$(tr).find('td.controls span.objectAction').html(text).addClass('added').removeAttr('onclick')}}}}},checkAll:function(checkbox,folder_id,idPrefix){var self=this,checkbox=$(checkbox),label=checkbox.parent(),folder_id=(folder_id!=undefined)?parseInt(folder_id):undefined;if(!label.size())return false;if(typeof folder_id=='number'){self.folder_id=folder_id}else{self.folder_id=false}if(idPrefix){if(!self.container)self.container=self._getContainer(idPrefix);$(self.container).attr('data-form',idPrefix+'search_form')}else{if(self.container){$(self.container).removeAttr('data-form')}}label.checkboxClickFunction(null,true,null,folder_id)},_getContainer:function(idPrefix){return util.getObject(idPrefix+'container')},_getCurrentFolder:function(){var self=this,currentFolder=self.folder_id;return currentFolder},groupSetActivity:function(mode){var self=this,current_folder=self._getCurrentFolder(),url='/-/cms/v1/user/?act=group_operations&mode='+mode+'&'+S3_ACCESS;s3.cronJobs(self._getContainer('users_'),'TR','user_',url,null,'input',{checked:true},false,current_folder);self.folder_id=false},groupSetDeleted:function(mode){var self=this,current_folder=self._getCurrentFolder(),url='/-/cms/v1/user/?act=group_operations&mode='+mode+'&'+S3_ACCESS;s3.cronJobs(self._getContainer('users_'),'TR','user_',url,null,'input',{checked:true},false,current_folder);self.folder_id=false},groupModerate:function(mode){var self=this,current_folder=self._getCurrentFolder(),url='/-/cms/v1/user/?act=group_operations&mode='+mode+'&'+S3_ACCESS;s3.cronJobs(self._getContainer('users_'),'TR','user_',url,null,'input',{checked:true},false,current_folder);self.folder_id=false},groupCopyToCategory:function(){var self=this,url='/-/cms/v1/user/?act=group_operations&'+S3_ACCESS,current_folder=self._getCurrentFolder();openAjaxForm(url+'&action=choose&mode_action=add&popup=1',function(r){s3.cronJobs(self._getContainer('users_'),'TR','user_',url+'&mode=append_to_folders&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupMoveToCategory:function(){var self=this,url='/-/cms/v1/user/?act=group_operations&'+S3_ACCESS,current_folder=self._getCurrentFolder();openAjaxForm(url+'&action=choose&mode_action=move&popup=1',function(r){s3.cronJobs(self._getContainer('users_'),'TR','user_',url+'&mode=set_to_folders&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupResetCategory:function(){var self=this,url='/-/cms/v1/user/?act=group_operations&'+S3_ACCESS,current_folder=self._getCurrentFolder();openAjaxForm(url+'&mode=choose&popup=1',function(r){s3.cronJobs(self._getContainer('users_'),'TR','user_',url+'&mode=reset_from_folders&folder_ids='+r.text,function(){popupController.closeLastPopup()},'input',{checked:true},false,current_folder)});self.folder_id=false},groupDelete:function(){var self=this,url='/-/cms/v1/user/?act=group_operations&mode=delete&'+S3_ACCESS,current_folder=self._getCurrentFolder();s3.cronJobs(self._getContainer('users_'),'TR','user_',url,null,'input',{checked:true},true,current_folder);self.folder_id=false},editBonusUser:function(user_id,bonus_sum){var self=this,user_id=s3.getInt(user_id,0),bonus_sum=parseFloat(bonus_sum)||0.00,url='/-/cms/v1/user/?act=edit_bonus&object_id='+user_id+'&bonus_sum='+bonus_sum+'&'+S3_ACCESS,res=util.makePostRequest(url,'');if(Number.isInteger(parseInt(res.text))){var object=$(document).find('#bonus_sum');object.text(res.text+(parseInt(res.text)==res.text?'.00':''))}popupController.closeLastPopup()},setPassword:function(user_id,password){var self=this,user_id=s3.getInt(user_id,0),url='/-/cms/v1/user/?act=set_password&object_id='+user_id+'&'+S3_ACCESS;if((!password||typeof password=='undefined'||password=='')&&password!==0){s3.alert(s3.loc('JS_ERROR_EMPTY_USER_PASSWORD'))}else{util.makePostRequest(url,'pwd='+password);util.msg(s3.loc('JS_PASSWORD_CHANGED'));popupController.closeLastPopup()}},rerenderFieldsFormSettings:function(jsonFields){const self=this;const url=this.baseUrl+"&act=settings_mapping";const settingsPopup=popupController.getLastPopup();if(!settingsPopup){return}const $settingsPopup=$(settingsPopup.obj);const $userPhoneField=$settingsPopup.find(this.CLASSNAMES_FIELD_RERENDER.USER_PHONE);const $userMatchSettingsField=$settingsPopup.find(this.CLASSNAMES_FIELD_RERENDER.USER_MATCH_SETTINGS);let currentFieldValues={};if($userPhoneField.length){const value=$settingsPopup.find(this.CLASSNAMES_FIELD_RERENDER.USER_PHONE).find('[name='+this.NAMES_FIELD_RERENDER.PHONE_FIELD+']').val();currentFieldValues={[this.NAMES_FIELD_RERENDER.PHONE_FIELD]:value,}}if($userMatchSettingsField.length){const value=$settingsPopup.find(this.CLASSNAMES_FIELD_RERENDER.USER_MATCH_SETTINGS).find('[name='+this.NAMES_FIELD_RERENDER.AUTH_MAPPING+']').val();currentFieldValues=$.extend({},currentFieldValues,{[this.NAMES_FIELD_RERENDER.AUTH_MAPPING]:value,})}$.post(url,{json_fields:jsonFields,values:currentFieldValues,}).done(function(data){if($userPhoneField.length){const htmlNewControl=$(data).find(self.CLASSNAMES_FIELD_RERENDER.USER_PHONE).html();$userPhoneField.html(htmlNewControl).S3ChangeControls()}if($userMatchSettingsField){const htmlNewControl=$(data).find(self.CLASSNAMES_FIELD_RERENDER.USER_MATCH_SETTINGS).html();$userMatchSettingsField.html(htmlNewControl).S3ChangeControls()}})},openModalWindowForSelectingUsers:function(nameListContainer){const idListContainer='#'+nameListContainer+'_users';const selectedId=[];function selectHandlerCallback(objectId,obj){const name=$(obj).find('.user_name').text();ListSelectedItemsController.addItem(objectId,name,'users[]',idListContainer)}$(idListContainer).find(ListSelectedItemsController.CLASS_SELECTED_ITEM).each(function(_,e){selectedId.push('selected[]='+encodeURIComponent($(e).data('id')))});selector.open('users',0,false,null,selectHandlerCallback,selectedId.join('&')+'&ff='+nameListContainer)},openModalWindowForSelectingUserFolder:function(ctx,nameListContainer){const idListContainer='#'+nameListContainer;function selectHandlerCallback(objectId,obj){const name=obj.data('name')?obj.data('name'):$(obj.context).text();ListSelectedItemsController.addItem(objectId,name,'user_folder',idListContainer,null,true);popupController.closeLastPopup()}treeController.load('select2',23,0,ctx.parentElement,selectHandlerCallback)}}})(jQuery);var TagsController;(function($){TagsController={baseUrl:'/-/cms/v1/tag/?'+S3_ACCESS,checked:false,folder_id:false,tag_count:false,container:false,_getContainer:function(idPrefix){return util.getObject(idPrefix+'container')},group:function(mode,type_id,module_id){var self=this,all=parseInt(this.folder_id)===0?1:0,url='/-/cms/v1/tag/?act=group&mode='+mode+'&'+S3_ACCESS+'&all='+all+'&type_id='+type_id+'&module_id='+module_id;s3.cronJobs(self._getContainer('shop2_tags_'),'TR','shop2_tag_',url,null,'input',{checked:true},mode==='delete',false)},search:function(text,url){if(!url){return}if(text){url+="&search="+text}popupController.reloadLastPopup(url)},editTag:function(ctx,tagId,typeId,module_id){const url=this.baseUrl+'&act=edit&object_id='+tagId+'&type_id='+typeId+'&module_id='+module_id;s3.editObject(ctx,'TR','TABLE',url,true)},deleteTag:function(ctx,tagId,typeId){const url=this.baseUrl+'&act=delete&tag_id='+tagId+'&type_id='+typeId;function successCallback(){popupController.reloadLastPopup(false)}s3.deleteObject(ctx,'TR',url,successCallback)},openAddTagPopup:function(typeId,module_id){const url=this.baseUrl+'&act=edit'+'&type_id='+typeId+'&module_id='+module_id;function submitHandler(){popupController.closeLastPopup();popupController.reloadLastPopup()}openAjaxForm(url,submitHandler)}}})(jQuery);var Shop2VendorsController;(function($){Shop2VendorsController={checked:false,folder_id:false,vendor_count:false,container:false,_getContainer:function(idPrefix){return util.getObject(idPrefix+'container')},groupSetNoindex:function(mode){var self=this,all=parseInt(this.folder_id)===0?1:0,url='/-/cms/v1/shop2/vendor/?act=group_operations&mode='+mode+'&'+S3_ACCESS+'&all='+all;s3.cronJobs(self._getContainer('shop2_vendors_'),'LI','shop2_vendor_',url,null,'input',{checked:true},false,false)},groupDelete:function(mode){var self=this,all=parseInt(this.folder_id)===0?1:0,url='/-/cms/v1/shop2/vendor/?act=group_operations&mode='+mode+'&'+S3_ACCESS+'&all='+all;s3.cronJobs(self._getContainer('shop2_vendors_'),'LI','shop2_vendor_',url,null,'input',{checked:true},true,false)},}})(jQuery);var CaptchaController={};(function($){"use strict";CaptchaController={captchaUrl:'/-/cms/v1/settings/security/captcha/?act=',change:function(obj){var self=this,select=$(obj),captcha=$.trim(select.find('option:selected').val()),url=self.captchaUrl+'index&captcha='+captcha+'&'+S3_ACCESS;s3.reloadVisibleContent(url)},save:function(act,form){var self=this,url=self.captchaUrl+act+'&'+S3_ACCESS;var res=util.makePostRequest(url,getFormData(form));if(!res.error&&res.text=='OK'){util.msg(s3.loc('SAVED'));s3.reloadVisibleContent()}else{s3.alert(res.text)}return false}}})(jQuery);var CommentsController={};(function($){'use strict';CommentsController={init:function(){this.localStorageInit()},approveComments:function(){s3.deleteObjects(util.getObject('comment_container'),'TR','comment_','/-/cms/v1/comments/?act=approve&'+S3_ACCESS,false,'input',{checked:true},s3.loc('JS_SURE_APPROVE_COMMENT'))},deleteComments:function(){s3.deleteObjects(util.getObject('comment_container'),'TR','comment_','/-/cms/v1/comments/?act=delete&'+S3_ACCESS,false,'input',{checked:true})}}})(jQuery);var ArticlesController={};(function($){'use strict';ArticlesController={ls_key:'articles_view_params',group_operations_url:'/-/cms/v1/article-category/?act=groupEditPost',init:function(){this.localStorageInit()},localStorageInit:function(){var self=this,postsList=$('table.posts-list'),ls=LS.get(self.ls_key),viewParams=[];if(postsList.get(0)){if(!$.isEmptyObject(ls)){viewParams=ls.split(',')}else{viewParams=[]}if(viewParams.length>0){for(var i=0;i<=viewParams.length;i++){var label=$('.article-list-view-params').find('form>div.'+viewParams[i]).find('label.s3-cb');label.addClass('active');label.find('input').attr('checked','checked');postsList.find('th.'+viewParams[i]).addClass('view');postsList.find('td.'+viewParams[i]).addClass('view')}}}},articleListViewParams:function(form){var self=this,formdata=$(form).serializeArray(),data='';LS.remove(self.ls_key);$(formdata).each(function(index,obj){if(index==0){data+=obj.name}else{data+=','+obj.name}});LS.set(self.ls_key,data);S3ContextMenuController.closeContextMenu();s3.reloadVisibleContent();return false},groupIndexingOptions:function(object_id,mode){var url=this.group_operations_url+'&article_category_id='+object_id+'&action=set_noindex&mode='+mode+'&'+S3_ACCESS;s3.cronJobs(util.getObject('article_container'),'TR','article_',url,null,'input',{checked:true},false)},groupDelete:function(object_id){var url=this.group_operations_url+'&article_category_id='+object_id+'&action=delete&'+S3_ACCESS;s3.cronJobs(util.getObject('article_container'),'TR','article_',url,null,'input',{checked:true},false)}}})(jQuery);var Article2Controller={};(function($){'use strict';Article2Controller={checked:false,folder_id:false,file_count:false,container:false,url:'/-/cms/v1/article2/',init:function(){this.localStorageInit()},article:{toggle:function(el,all){var parent=el.closest('li');if(all){parent=el.closest('td')}if(el.is('.close')){el.hide();if(all){$.cookie('article2_toggle',0);$('.objectContentWrapper').hide();$('#article_container li').each(function(){$(this).find('span.close').hide();$(this).find('span.open').show()})}else{parent.find('.objectContentWrapper').hide()}parent.find('.open').show()}else{el.hide();if(all){$.cookie('article2_toggle',1);$('.objectContentWrapper').show();$('#article_container li').each(function(){$(this).find('span.open').hide();$(this).find('span.close').show()})}else{parent.find('.objectContentWrapper').show()}parent.find('.close').show()}},},comments:{element:function(obj,objTagName,url,func,msg,msgError,url2){obj=util.getElement(obj,objTagName);if(!obj){return false}if(selector.focused()){util.detachElement(obj);return}var f=function(){if(util.touchUrl(url)){util.detachElement(obj);popupController.closeLastPopup();popupController.childsPopupsHasChanged();if(func){func()}util.touchUrl(url2)}else{popupController.closeLastPopup();s3.alertHTML((msgError?msgError:s3.loc('JS_ERROR')))}};s3.confirm((msg?msg:s3.loc('JS_CONFIRM_DELETE')),f)},elements:function(src_obj,objTagName,objIdPrefix,url,func,targetTagName,props,msg,url2,container_name){if(!src_obj){return false}var f=function(){var result=false;var batchOpInfo=s3.getBatchOpInfo(src_obj,objTagName,objIdPrefix,url,func,targetTagName,props);var posts=[];$('#'+container_name+' tr input[type=checkbox]:checked').each(function(){posts.push($(this).closest('tr').data('item'))});if(batchOpInfo.dstObjs.length&&batchOpInfo.ids&&batchOpInfo.ids.length>0){util.makePostRequest(url,'ids='+batchOpInfo.ids);util.makePostRequest(url2,'ids='+posts);for(var i=0;i<batchOpInfo.dstObjs.length;++i){window.setTimeout(util.detachElement,10,batchOpInfo.dstObjs[i])}popupController.closeLastPopup();if(func){func()}s3.reloadVisibleContent(false);result=true}if(!batchOpInfo.ids.length){popupController.closeLastPopup();s3.alert(s3.loc('JS_NO_OBJECTS_CHOSEN_ERROR'));return}if(result==false){popupController.closeLastPopup();s3.alert(s3.loc('JS_GROUP_OPERATIONS_ERROR_MESSAGE'))}};s3.confirm((msg?msg:s3.loc('JS_CONFIRM_DELETE')),f)},},_getSearchForm:function(idPrefix){return util.getObject(idPrefix+'search_form')},_getSearchFormQuery:function(idPrefix){var f=this._getSearchForm(idPrefix);if(!(f&&f.elements.submitted.value)){return''}var q='';$.each(f.elements,function(k,v){if(/^s\[/.test(v.name)){q+='&'+encodeURIComponent(v.name)+'='+encodeURIComponent(v.value)}});return q},editPost:function(object,lenta_id,post_id,moderation,parent,offered){var self=this,lenta_id=s3.getInt(lenta_id,0),post_id=s3.getInt(post_id,0),url=this.url+'?act=edit_post&'+S3_ACCESS+'&object_id='+post_id+'&lenta_id='+lenta_id+'&meta_id='+lenta_id;if(moderation){url+='&moderation=1'}if(offered){url+='&offered_post=1'}openAjaxForm(url,function(r){var object=$('tr#article_'+post_id);$(r.text).insertAfter(object);object.empty().remove();popupController.closeLastPopup();treeController.reloadTree('.tree-wrapper');fadeController.init($(parent).get(0));self.localStorageInit();s3.reloadContent()},null,function(r){var object=$('tr#article_'+post_id);$(r.text).insertAfter(object);object.empty().remove();treeController.reloadTree('.tree-wrapper');fadeController.init($(parent).get(0));$(parent).S3ChangeControls();self.localStorageInit()},)},localStorageInit:function(){var self=this,postsList=$('table.posts-list'),ls=LS.get('article2_view_params'),viewParams=[];if(postsList.get(0)){if(!$.isEmptyObject(ls)){viewParams=ls.split(',')}else{viewParams=[]}if(viewParams.length>0){for(var i=0;i<=viewParams.length;i++){var label=$('.article-list-view-params').find('form>div.'+viewParams[i]).find('label.s3-cb');label.addClass('active');label.find('input').attr('checked','checked');postsList.find('th.'+viewParams[i]).addClass('view');postsList.find('td.'+viewParams[i]).addClass('view')}}}},articleListViewParams:function(form){var self=this,formdata=$(form).serializeArray(),data='';LS.remove('article2_view_params');$(formdata).each(function(index,obj){if(index==0){data+=obj.name}else{data+=','+obj.name}});LS.set('article2_view_params',data);S3ContextMenuController.closeContextMenu();s3.reloadVisibleContent();return false},toggleAnonce:function(object,parent){var self=this,object=$(object),parent=$(parent),show=(parent.hasClass('show'))?true:false;if(show){object.text(object.data('hide-text'))}else{object.text(object.data('show-text'))}parent.toggleClass('show')},hideArticleNote:function(){util.createCookie('article_view_note',1,7);s3.reloadVisibleContent();return false},groupIndexingOptions:function(object_id,mode){var url=this.url+'?act=group_edit&lenta_id='+object_id+'&action=set_noindex&mode='+mode+'&'+S3_ACCESS;s3.cronJobs(util.getObject('article_container'),'TR','article_',url,null,'input',{checked:true},false)},groupDelete:function(object_id){var url=this.url+'?act=group_edit&lenta_id='+object_id+'&action=delete&'+S3_ACCESS;s3.cronJobs(util.getObject('article_container'),'TR','article_',url,null,'input',{checked:true},false)}}})(jQuery);var Shop2ReferenceController={};(function($){"use strict";Shop2ReferenceController={access:S3_ACCESS,referenceUrlPrefix:'/-/cms/v1/shop2/reference/',shop2_color_ref_elements:'#shop2_color_ref_elements',color_ref_elements:'#color_ref_elements',color_ref_new_item:'#color_ref_new_item',dummy_color_ref_item:'#dummy_color_ref_item',dummy_ref_item_count:1,ref_edit_list_delim:{'new_line':'\n','comma':',','semicolon':';','slash':'/'},addReference:function(tag,container,url){var self=this;openAjaxForm(url,function(r){var item=$('#'+container).find('li.controls:first'),object=$(r.text);object.insertAfter(item).S3ChangeControls();popupController.closeLastPopup();fadeController.init(object.get(0))},null,null)},deleteReference:function(url,ref_id,shop_id){var self=this;$.post(url,function(d,e){if(d=='2OK'){$('#shop_ref_'+ref_id).remove();if(popupController.getLastPopup()){popupController.reloadLastPopup()}}else{if(d=='is used!'){var url=self.referenceUrlPrefix+'?act=links'+'&shop_id='+shop_id+'&ref_id='+ref_id+'&'+self.access;s3.openModalPopup(url,true)}else{var url_edit=self.referenceUrlPrefix+'?act=edit'+'&shop_id='+shop_id+'&ref_id='+ref_id+'&'+self.access;s3.openModalPopup(url_edit,true)}}})},toggleLock:function(url,ref_id){var self=this;$.post(url,function(d,e){if(d=='2OK'){$('#shop_ref_'+ref_id).remove();if(popupController.getLastPopup()){popupController.reloadLastPopup()}}else{s3.alert('Error!')}})},copyReference:function(url,container){var self=this;openAjaxForm(url,function(r){var item=$('#'+container).find('li.controls:first'),object=$(r.text);object.insertAfter(item).S3ChangeControls();popupController.closeLastPopup();fadeController.init(object.get(0))},null,null)},editReference:function(object,tag,container,url){var self=this;s3.editObject(object,tag,container,url)},updateReferenceSort:function(obj,url,ref_id,sort,update){if(update==="1"){$.ajax(url+"&access="+S3_ACCESS+"&ver_id="+VER_ID+"&ref_id="+ref_id+"&sort="+sort).done(function(){popupController.reloadLastPopup(false);util.msg('Обновлено')})}else{var parent=$('.controls .s3-sort-v2');var input=$('input.sort');var select=parent.find('.sort-btn-select');parent.find('.s3-sort-ico').removeClass('active');if($(obj).hasClass('name')){var text=$(obj).text();select.text(text);$(obj).prev('.s3-sort-ico').addClass('active')}else{$(obj).addClass('active');var text=$(obj).siblings('.name').text();select.text(text)}input.val(sort);if(sort==3||sort==5){select.addClass('desc')}else{select.removeClass('desc')}}},addColorRefElement:function(color_choose_error,color_name_error){var self=this;var params="";var items=$(self.color_ref_new_item).serializeArray();for(var i=0;i<3;i++){items[i].value=items[i].value.trim()}if(items[0].value==''&&items[1].value==''&&(items[2].value==''||items[2].value=='[]')){s3.alert(color_choose_error);return}else if(items[1].value==''){s3.alert(color_name_error);return}var $list=$(self.color_ref_elements);var code='';var $dummy=$(self.dummy_color_ref_item).clone().contents();if(items[0].value!=''){code=items[0].value;$dummy.find('input[name="color_ref_el[][code]"]').val(code);$dummy.find('.color_ref_color').css('background',code);params+="&item_code="+encodeURIComponent(code)}else{$dummy.find('.color_ref_color').hide()}$dummy.attr('id','dummy_'+self.dummy_ref_item_count);$dummy.find('.color_ref_name').text(items[1].value);params+="&item_text="+encodeURIComponent(items[1].value).replace(/'/g,"%27");$dummy.find('input[name="color_ref_el[][text]"]').val(items[1].value);if(items[2].value!=''){var obj=$.parseJSON(items[2].value);params+="&item_image="+encodeURIComponent(items[2].value);$dummy.find('input[name="color_ref_el[][image]"]').val(items[2].value);$dummy.find('.color_ref_image img').prop('src',$('.image','#color_ref_new_item').attr("src"))}else{$dummy.find('.color_ref_image').hide()}$dummy.find('.title').attr('onclick',"s3.openModalPopup('/-/cms/v1/shop2/reference/?act=add_color_ref&"+self.access+"&dummy="+self.dummy_ref_item_count+params+"', false)");$(self.shop2_color_ref_elements).append($dummy);dragController.removeSource('shop2_color_ref_elements');$('li',self.shop2_color_ref_elements).show();$('#shop2_unable_to_save_color_ref_elements_sort_order').show();if($(self.shop2_color_ref_elements).hasClass('ui-sortable')){$(self.shop2_color_ref_elements).sortable('disable')}++self.dummy_ref_item_count;$('#shop2_color_ref_elements .clear-button').show();popupController.closeLastPopup()},editColorRefElement:function(id,dummy,color_choose_error,color_name_error){var self=this;var params="";var prefix='element_'+id;if(dummy){prefix='dummy_'+id}var items=$(self.color_ref_new_item).serializeArray();for(var i=0;i<3;i++){items[i].value=items[i].value.trim()}if(items[0].value==''&&items[1].value==''&&(items[2].value==''||items[2].value=='[]')){s3.alert(color_choose_error);return}else if(items[1].value==''){s3.alert(color_name_error);return}if(items[0].value!=''){$('#'+prefix+' .color_ref_color').css('background',items[0].value).css('display','inline-block');$('#'+prefix+' .code').val(items[0].value)}else{$('#'+prefix+' .color_ref_color').hide();$('#'+prefix+' .code').val('')}params+="&item_code="+encodeURIComponent(items[0].value);$('#'+prefix+' .color_ref_name').text(items[1].value);params+="&item_text="+encodeURIComponent(items[1].value).replace(/'/g,"%27");$('#'+prefix+' .text').val(items[1].value);if(items[2].value!=''&&items[2].value!='[]'){var obj=$.parseJSON(items[2].value);params+="&item_image="+encodeURIComponent(items[2].value);$('#'+prefix+' .image').val(items[2].value);$('#'+prefix+' .color_ref_image img').prop('src',$('.image',self.color_ref_new_item).attr("src"));$('#'+prefix+' .color_ref_image').css('display','inline-block')}else{$('#'+prefix+' .color_ref_image').hide();$('#'+prefix+' .image').val("[]")}if(dummy){$('#'+prefix).find('.title').attr('onclick',"s3.openModalPopup('/-/cms/v1/shop2/reference/?act=add_color_ref&"+self.access+"&dummy="+id+params+"', false)")}else{$('#'+prefix).find('.title').attr('onclick',"s3.openModalPopup('/-/cms/v1/shop2/reference/?act=add_color_ref&"+self.access+"&object_id="+id+params+"', false)")}popupController.closeLastPopup()},editColor2Element:function(color2_id,color_choose_error,color_name_error,edit_text){var self=this;var params="";var prefix='element_'+color2_id;var items=$(self.color_ref_new_item).serializeArray();for(var i in items){items[i].value=items[i].value.trim()}if(items[0].value==''&&items[1].value==''&&(items[2].value==''||items[2].value=='[]')){s3.alert(color_choose_error);return}else if(items[1].value==''){s3.alert(color_name_error);return}var color2=$('.color2_content','#color2_'+color2_id).show();if(items[0].value!=''){$('.color_ref_color',color2).css('background',items[0].value).css('display','inline-block')}else{$('.color_ref_color',color2).hide()}$('.code',color2).val(items[0].value);params+="&item_code="+encodeURIComponent(items[0].value);$('.color_ref_name',color2).text(items[1].value);params+="&item_text="+encodeURIComponent(items[1].value);$('.text',color2).val(items[1].value);if(items[2].value!=''&&items[2].value!='[]'){var obj=$.parseJSON(items[2].value);params+="&item_image="+encodeURIComponent(items[2].value);$('.color_ref_image img',color2).prop('src',$('.image',self.color_ref_new_item).attr("src"));$('.color_ref_image',color2).css('display','inline-block')}else{$('.color_ref_image',color2).hide()}$('.image',color2).val(items[2].value);$('.objectEdit','#color2_'+color2_id).text(edit_text);$('.objectRemove','#color2_'+color2_id).show();popupController.closeLastPopup()},shop2ReferenceAddElement:function(){var self=this;var c,d,e,f,nd;c=util.getObject('shop2_ref_elements');nd=document.createElement('li');nd.setAttribute('class','box');d=document.createElement('span');d.setAttribute('class','handle');nd.appendChild(d);nd.innerHTML+=' ';e=document.createElement('input');e.type='text';e.setAttribute('class','s3-input-text');e.name='element_new[]';e.setAttribute('onkeydown','return Shop2ReferenceController.shop2ReferenceItemKeyDown(event)');nd.appendChild(e);e=document.createElement('span');e.setAttribute('class','remove objectRemove');f=document.createElement('span');f.setAttribute('class','s3-ico i-delete-svg');e.appendChild(f);e.onclick=function(){$(this).parent().remove()};if(!Shop2ReferenceController.checkReferenceItemsLimit('shop2_ref_elements')){return false}nd.appendChild(e);nd.id='';c.appendChild(nd);$('#shop2_unable_to_save_ref_elements_sort_order').show();$('#shop2_ref_elements .clear-button').show();$('.refs_items_sort_js').hide();$(c).sortable('disable');return nd},shop2ReferenceItemKeyDown:function(evt){var self=this;if(!evt)evt=window.event;var c=util.getObject('shop2_ref_elements');$('#shop2_unable_to_save_ref_elements_sort_order').show();$('.refs_items_sort_js').hide();$(c).sortable('disable');if(evt.keyCode==13){var nd=self.shop2ReferenceAddElement();$(nd).find('input:last').focus();evt.stopPropagation();evt.preventDefault()}return true},deleteReferenceColorElement:function(object){var self=this,li=$(object).closest('li'),elementName=li.find('span.color_ref_name').text(),msg=s3.loc('JS_DELETE')+' '+elementName+'?';s3.confirm(msg,function(){popupController.closeLastPopup();if($('#shop2_color_ref_elements li').length<2){$('#shop2_color_ref_elements .clear-button').hide()}li.remove()})},deleteReferenceElement:function(object){var self=this,li=$(object).closest('li'),elementName=li.find('input.s3-input-text').val(),msg=s3.loc('JS_DELETE')+' '+elementName+'?';s3.confirm(msg,function(){popupController.closeLastPopup();li.hide();li.find('.s3-input-text').attr('disabled','disabled');if($('#shop2_ref_elements li:visible').length<2){$('#shop2_ref_elements .clear-button').hide()}li.find('.element_del').attr('checked','checked')})},deleteReferenceAll:function(id,type){var li=$('#'+id).find('li.box'),msg=s3.loc('JS_DELETE')+'?';s3.confirm(msg,function(){popupController.closeLastPopup();if(type=="color"){li.remove()}else{li.hide()}li.find('.element_del').attr('checked','checked');$('.clear-button').hide()})},hideSortingPanel:function(){$('#shop2_unable_to_save_color_ref_elements_sort_order').show();$('.refs_items_sort_js').hide()},checkReferenceItemsLimit:function(id,popup_link){var list_el=$('#'+id),items_limit=list_el.data('max-elements'),items_count=parseInt(list_el.find('li:visible').length)-1;if(items_count>=items_limit){s3.alert(list_el.data('msg-limit'));return false}$('.refs_items_sort_js').hide();if(popup_link){s3.openModalPopup(popup_link,false)}return true},referenceEditListPopup:function(obj){var self=this;var popup=new PopupWindow('ajaxPopupWindow_'+popupController.popups.length);popup.drag=true;popup.modal=true;popup.center=true;popup.elemDiv=$('#shop2_reference_edit_list_popup');popup.onClose=function(){self.closereferenceEditListPopup($(popup.obj).find('.shop2-reference-edit-list-wrapper'))};popupController.showPopup(popup);return popup},closereferenceEditListPopup:function(obj){$(obj).removeClass('popup');var append=$('<div id="shop2_reference_edit_list_popup"></div>').append($(obj));var popupDiv=$('table#reference2-table').find('#shop2_reference_edit_list_popup');if(popupDiv.get(0)){popupDiv.empty().remove()}$('#reference2-table').parents('form:first').after(append)},referenceEditListSave:function(form){var self=this,formElements=$(form).serializeArray(),data=[],list=[],html='',li;if(formElements){$.each(formElements,function(key,elem){data[elem.name]=$.trim(elem.value)});if(data['text']&&data['text']!==""){list=data['text'].split(self.ref_edit_list_delim[data['delim']]);list=filterArray(list);for(var i=0;i<=list.length;i++){if(list[i]){li='<li class="box" id=""><span class="handle"></span> <input type="text" class="s3-input-text" name="element_new[]" onkeydown="return Shop2ReferenceController.shop2ReferenceItemKeyDown(event)" value="'+list[i]+'"><span class="remove objectRemove" onclick="Shop2ReferenceController.deleteReferenceElement(this);"><span class="s3-ico i-delete-svg"></span></span></li>';html+=li}}popupController.closeLastPopup();var p=popupController.getLastPopup();if(p&&p.obj){$(p.obj).find('#shop2_ref_elements').append(html);self.uniqueList($(p.obj).find('#shop2_ref_elements'))}var c=$(p.obj).find('#shop2_ref_elements');$('#shop2_unable_to_save_ref_elements_sort_order').show();$('.refs_items_sort_js').hide();$(c).sortable('disable')}}function filterArray(list){list=list.filter(function(v){return $.trim(v)});var a=[];for(var i=0,l=list.length;i<l;i++){var name=$.trim(list[i]).toLowerCase();if(a.indexOf(name)!==-1){list.splice(i,1)}else{a.push(name)}}return list}},uniqueList:function(ref_list){var self=this,elements=$(ref_list).find('> li:not(.controls)'),a=[];$(elements).each(function(){var value=$(this).find('input:first').val().toLowerCase();if(a.indexOf(value)!==-1){$(this).empty().remove()}else{a.push(value)}})},deleteUnused:function(url,cmd,delete_references,delete_options){delete_references=delete_references?1:0;delete_options=delete_options?1:0;if(!delete_references&&!delete_options){s3.alert(s3.loc('CHOOSE_ANY_OPTION'));return false}url+='&cmd=delete&delete_references='+delete_references+'&delete_options='+delete_options;openAjaxForm(url,function(r){},function(r){if(cmd!=='show'){popupController.closeLastPopup()}})},checkIsSorted:function(obj,ref_id,folder_id,shop_id,url,is_delete){if(!obj.is(':checked')){var status=false,r=util.makeGetRequest(url+'&ref_id='+ref_id+'&folder_id='+folder_id+'&shop_id='+shop_id);if(r&&r.text==='OK'){s3.confirm(s3.loc('JS_SHOP2_SORT_UNCHECKED_WARNING'),function(){status=true;popupController.closeLastPopup()},obj,function(){if(!status){obj.prop('checked',true)}else{obj.prop('checked',false);if(is_delete){obj.parent().remove()}}})}else if(is_delete){obj.parent().remove()}}}}})(jQuery);var MediaController={};(function($){"use strict";MediaController={httpRequest:null,file_size_limit:500,file_types:"flv;f4v;.mkv;mp4;h264;m4v;mpeg4;mpg;webm;ogv;avi;3gp;mov;swf;mp3;ogg;wav;mid;vob;drc;gif;gifv;mng;qt;wmv;yuv;rm;rmvb;asf;amv;mp2;mpeg;mpe;mpv;m2v;svi;3g2;mxf;roq;nsv;f4p;f4a;f4b;",add_video_url:'',_initUpload:function(){var self=this,lp=popupController.getLastPopup().obj,popupTitle=$(lp).find('.bluepopup-wrapper > table td.draggable_title span.title'),formUpload=$(lp).find('form:first'),urlUpload=formUpload.data('url'),uploadBlock=$(lp).find('form:first').find('.media-upload'),fsUploadCountFiles=uploadBlock.find('#fsUploadCountFiles'),fileTypeError=uploadBlock.find('#fileTypeError'),fileInput=formUpload.find('[type=file]'),uploadStatusBlock=formUpload.find('#uploadStatusBlock'),uploaderStatus=formUpload.find('#uploaderStatus'),uploaderStatusBar=formUpload.find('#uploaderStatusBar'),uploaderStatusSize=$('#uploaderStatusSize'),fileButton=$(lp).find('.s3-file').find('.s3-btn'),cancelButton=formUpload.find('#cancelUpload');fileInput.on('change',function(){var fileItemCount=this.files.length,filesText=uploader.declOfNum(fileItemCount,s3.loc('JS_FILE_FORMS').split('|')),filesSize=this.files[0].size,formData=new FormData(formUpload[0]);if(self.checkFileType(this.files[0].name)!==-1){fileTypeError.hide();$(popupTitle).text(s3.loc('JS_LOADING'));uploadStatusBlock.show();fileButton.hide();uploadBlock.hide();$(uploaderStatus).html(s3.loc('JS_UPLOAD_UPLOADED_FILES2',{count:0,max:1}));$(uploaderStatusSize).removeAttr('style');$(uploaderStatusSize).html('0 KB / '+Math.round(filesSize/1024)+' KB');self.httpRequest=new XMLHttpRequest();self.httpRequest.open("POST",urlUpload,true);if(self.httpRequest.upload){self.httpRequest.upload.onprogress=function(e){if(e.lengthComputable){var percent=Math.floor((e.loaded/e.total)*100),uploadSize=percent*Math.round(filesSize/1024)/100;uploaderStatusBar.children('div:first').attr('style','width: '+percent+'%');$(uploaderStatusSize).html(Math.round(uploadSize)+' KB / '+Math.round(filesSize/1024)+' KB')}};self.httpRequest.upload.onloadstart=function(e){uploaderStatusBar.show();uploaderStatusBar.children('div:first').attr('style','width: 0')};self.httpRequest.upload.onloadend=function(e){console.log('onloadend')}};self.httpRequest.onreadystatechange=function(){if(self.httpRequest.readyState===4){if(self.httpRequest.status===200){$(uploaderStatus).html(s3.loc('JS_UPLOAD_UPLOADED_FILES2',{count:1,max:1}));$(uploadStatusBlock).find('.upload-ico').addClass('done');util.makePostRequest(self.add_video_url,'server_response='+self.httpRequest.responseText);setTimeout(function(){popupController.closeLastPopup();s3.reloadVisibleContent()},300)}else{$(uploadStatusBlock).find('.upload-ico').addClass('error');console.log("Error",self.httpRequest.statusText)};self.httpRequest=null}};self.httpRequest.send(formData)}else{fsUploadCountFiles.hide();fileTypeError.children('div:first').text(s3.loc('JS_BAD_EXTENSION'));fileTypeError.show()}});cancelButton.on('click',function(){if(self.httpRequest){self.httpRequest.abort()}else{popupController.closeLastPopup()}})},uploadRemoveItem:function(obj,src){if(obj.id==src)return false;var p=obj.parentNode;if(p.getElementsByTagName(obj.tagName).length>1){obj.parentNode.removeChild(obj)}},uploadAddItem:function(container,rowTagName,placeholder){var self=this,objContainer=document.getElementById(container),objSrc=null,objNew,tpl='<div class="uploadItem"><label class="s3-file"><input type="file" name="files[]"></label><input placeholder="'+placeholder+'" class="s3-input-text" size="30" type="text" name="names[]" id="names[]"><span class="objectEdit" onClick="MediaController.uploadRemoveItem(this.parentNode)"><span class="s3-ico i-delete-svg"></span> </span></div>';if(!objContainer)return false;for(objSrc=objContainer.firstChild;objSrc;objSrc=objSrc.nextSibling){if(objSrc.tagName){if(rowTagName!=undefined&&objSrc.tagName!=rowTagName)continue;break}}if(!objSrc)return false;$(objContainer).append(tpl);$(objContainer).find('.uploadItem:last').S3ChangeControls()},makeVideoPopup:function(url,callback){var self=this;self.add_video_url=url;openAjaxForm(url,function(){popupController.closeLastPopup()},false)},uploadVideo:function(form,url,filename){var self=this,uploaderStatusBar=$(form).find('#uploaderStatusBar'),formData=new FormData(form);self.httpRequest=new XMLHttpRequest();self.httpRequest.open("POST",url,true);if(self.httpRequest.upload){self.httpRequest.upload.onprogress=function(e){if(e.lengthComputable){uploaderStatusBar.children('div:first').attr('style','width: '+Math.floor((e.loaded/e.total)*100)+'%')}};self.httpRequest.upload.onloadstart=function(e){uploaderStatusBar.show();uploaderStatusBar.children('div:first').attr('style','width: 0')};self.httpRequest.upload.onloadend=function(e){}};self.httpRequest.onreadystatechange=function(){if(self.httpRequest.readyState===4){console.log(self.httpRequest)}};self.httpRequest.send(formData);return false},checkFileType:function(filename){var self=this,extension=filename.split('.').pop(),filetypes=self.file_types.split(';');return $.inArray(extension,filetypes)||false},}})(jQuery);"use strict";$(function(){$(document).on("click",".cd-checkbox__label",function(){var e=$(this);e.find('input[type="checkbox"]').prop("disabled")||e.parents(".cd-checkbox").removeClass("_error")})}),$(function(){$(document).on("click",".cd-radio__label",function(){var e=$(this);e.find('input[type="radio"]').prop("disabled")||e.parents(".cd-radio").removeClass("_error")})}),$(function(){$(document).on("click","body",function(){$("._opened").selectToggle()}),$(document).on("click",".cd-selectbox__item",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),c=t.closest(".cd-selectbox"),o=c.hasClass("_multiselect"),n=t.closest(".cd-selectbox__list"),s=c.find("input"),l=c.find(".cd-selectbox__text");if(o){var i=c.find(".cd-selectbox__amount");t.toggleClass("_active"),i.text(n.find("._active").length),s.val(n.selectValue())}else{var d=t.text();l.text(d),s.val(d),n.slideUp(function(){c.removeClass("_opened")})}s.trigger("blur")}),$(document).on("click",".cd-selectbox__selected",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).closest(".cd-selectbox"),c=$("._opened").not(t);c.length?c.find(".cd-selectbox__list").slideUp(function(){c.removeClass("_opened"),t.selectToggle()}):t.selectToggle()}),$.fn.selectToggle=function(){return this.each(function(){var e=$(this),t=e.find(".cd-selectbox__list");e.hasClass("_opened")?t.slideUp(function(){e.removeClass("_opened")}):(e.addClass("_opened"),t.slideDown())})},$.fn.selectValue=function(){var o=[];return this.find(".cd-selectbox__item").each(function(e,t){var c=$(this);c.hasClass("_active")&&o.push(c.data('value'))}),o.join(", ")}});"use strict";var backupsController={url:'/-/cms/v1/backups/?'+S3_ACCESS,restore:function(type,date,timestamp,settings=null){var url=this.url+"&act=task&task_type=restore"+"&timestamp="+timestamp+"&type="+type;var $titleText="<div id=\"confirm_green_title\">"+s3.loc("JS_BACKUP_RECOVERY")+"</div>";var $subText="<div id=\"confirm_green_text\">"+s3.loc("JS_BACKUP_SYSTEM_UNAVAILBALE")+"</div>";var $marketplaceWarning=settings&&settings.hasMarketplace?"<div class='s3-context-message s3-context-message--notice'>"+s3.loc("JS_BACKUP_MARKETPLACE_WARNING")+"</div>":'';var confirmMsg=$titleText+$subText+s3.loc("JS_BACKUP_ROLLBACK")+": <br>"+date+"?"+"<br>"+$marketplaceWarning;s3.confirmGreen(confirmMsg,function(){var res=util.makeGetRequest(url);popupController.closeLastPopup();popupController.closeLastPopup();if(res.text){s3.alert(res.text)}})},create:function(){var url=this.url+'&act=task&task_type=create';s3.confirmGreen('<div class="create_backups_text">'+s3.loc('JS_CREATE_BACKUP')+'?</div>',function(){var res=util.makeGetRequest(url);popupController.closeLastPopup();popupController.closeLastPopup();if(res.text){s3.alert(res.text)}})},getStatus:function(task_id){var url=this.url+'&act=get_status&task_id='+task_id,res=util.makeGetRequest(url);if(res.text){$('#alert_message').html(res.text)}},get_history:function(){var url=this.url+'&act=get_history&task_type=create';s3.openModalPopup(url,true)}};var NewsController={};(function($){'use strict';NewsController={group_operations_url:'/-/cms/v1/news-lenta/?act=groupEditPost',groupIndexingOptions:function(object_id,mode){var url=this.group_operations_url+'&lenta_id='+object_id+'&action=set_noindex&mode='+mode+'&'+S3_ACCESS;s3.cronJobs(util.getObject('news_container'),'TR','news_',url,null,'input',{checked:true},false)},groupDelete:function(object_id){var url=this.group_operations_url+'&lenta_id='+object_id+'&action=delete&'+S3_ACCESS;s3.cronJobs(util.getObject('news_container'),'TR','news_',url,null,'input',{checked:true},false)}}})(jQuery);var MarketplaceController={};(function($){'use strict';MarketplaceController={SEARCH_FOUND_CLASS:'tree-checkbox__search--found',ACTIVE_CLASS:'active',HIDE_CLASS:'hide',folder_id:false,url:'/-/cms/v1/shop2/marketplace/',has_category_only:false,marketEditKind:function(product_id,kind_id,is_master,shop_id,object,parent){var self=this,product_id=s3.getInt(product_id,0),kind_id=s3.getInt(kind_id,0),is_master=s3.getInt(is_master,0),shop_id=s3.getInt(shop_id,0),url='/-/cms/v1/shop2/product/?act=edit_kind&'+S3_ACCESS+'&kind_id='+kind_id+'&is_master_kind='+is_master+'&shop_id='+shop_id+'&product_id='+product_id;openAjaxForm(url,function(r){popupController.closeLastPopup();popupController.reloadLastPopup()},null,function(r){popupController.reloadLastPopup()},)},marketEditProduct:function(product_id,shop_id){var self=this,product_id=s3.getInt(product_id,0),shop_id=s3.getInt(shop_id,0),url='/-/cms/v1/shop2/product/?act=edit&help=edit&'+S3_ACCESS+'&shop_id='+shop_id+'&product_id='+product_id;openAjaxForm(url,function(r){popupController.closeLastPopup();popupController.reloadLastPopup()},null,function(r){popupController.reloadLastPopup()})},group:function(action,integration_id,shop_id,container,prefix,list,warning_msg){const containerGroupOperations=$(util.getObject(container)).closest('tr').find('.s3-group-operations');const isSelectAllInPage=containerGroupOperations.find('.checked-all').hasClass('active');const isSelectAll=containerGroupOperations.find('.checked-all-wcond').hasClass('active');let self=this,url='',msg='',current_folder=self.folder_id;switch(action){case'create':msg='SEND_TO_UNLOADING';break;case'recreate':msg='SEND_TO_REUNLOADING';break;case'delete':msg='DELETE_PRODUCT_FROM_UNLOADING';break;case'hide':msg='SHOP2_HIDE_PRODUCT';break;case'show':msg='RESUME_DISPLAYING_PRODUCT';break;case'check_status':msg='CHECK_MODERATION_STATUS';break;case'warnings_clean':msg='SHOP2_PRODUCT_WARNINGS_CLEAN';break;case'errors_clean':msg='SHOP2_PRODUCT_ERRORS_CLEAN';break;case'reset_in_work':msg='SHOP2_PRODUCT_RESET_IN_WORK';break;case'get_skus':msg='GET_SKUS';break;default:return}url=self.url+'?act=group_edit&action=marketplace_product_'+action;if(self.has_category_only!==false){url+='&has_category_only='+self.has_category_only}url+='&integration_id='+integration_id+'&shop_id='+shop_id+'&list='+list+'&'+S3_ACCESS;let f=function(){popupController.closeLastPopup();s3.cronJobs(util.getObject(container),'TR',prefix,url,null,'input',{checked:true},false,current_folder,);self.folder_id=false;self.has_category_only=false};if(warning_msg&&(isSelectAllInPage||isSelectAll)){msg=s3.loc(msg)+'? <br />'+warning_msg}else{msg=s3.loc(msg)+'?'}s3.confirmGreen(msg,f)},openFieldMappingSettings:function(ctx){const attribute=$(ctx).attr('attribute');const dictionary=$(ctx).attr('dictionary');const integration_id=$(ctx).attr('integration_id');const fields=$(ctx).closest('tr').find('select[name="mapping['+attribute+'][field][]"]').val();if(integration_id===""||attribute===""||dictionary===""||fields.length===0){s3.alert('JS_FIELD_MATCHING_NOT_SELECTED');return}let fields_uri=fields.map(function(el,idx){return'fields['+idx+']='+el}).join('&');s3.openModalPopup('/-/cms/v1/shop2/marketplace/?act=mappingDictionaries'+'&integration_id='+integration_id+'&attribute='+attribute+'&dictionary='+dictionary+'&'+fields_uri+'&'+S3_ACCESS,false)},changeFieldMappingSettings:function(ctx){const attribute=$(ctx).data('attribute');const dictionary=$(ctx).data('dictionary');const current_field=$(ctx).data('current_field');const integration_id=$(ctx).data('integration_id');const selected_field=$(ctx).val();const fields=$(ctx).closest('div').find('input[name="fields[]"]');if(current_field===selected_field){return}if(integration_id===""||attribute===""||dictionary===""||fields.length===0){$(ctx).val(current_field).trigger('liszt:updated');s3.alert('JS_FIELD_MATCHING_NOT_SELECTED');return}let fields_arr=[];fields.each(function(el){fields_arr.push($(this).val())});let fields_uri=fields_arr.map(function(el,idx){return'fields['+idx+']='+el}).join('&');popupController.reloadLastPopup('/-/cms/v1/shop2/marketplace/?act=mappingDictionaries'+'&integration_id='+integration_id+'&attribute='+attribute+'&dictionary='+dictionary+'&current_field='+selected_field+'&'+fields_uri+'&'+S3_ACCESS,false)},getDictionaryValues:function(ctx){const select=$(ctx).closest('td').find('select');const attribute=select.data('attribute');const dictionary=select.data('dictionary');const integration_id=select.data('integration_id');const selected=select.find("option:selected");if(integration_id===""||attribute===""||dictionary===""){s3.alert('JS_FIELD_MATCHING_NOT_SELECTED')}else{$.get('/-/cms/v1/shop2/marketplace/?act=getDictionaryValues'+'&integration_id='+integration_id+'&attribute='+attribute+'&dictionary='+dictionary+'&'+S3_ACCESS,function(html){select.html(html).append(selected).trigger('liszt:updated')})}},togglesCategoryMenuItemWildberriesCharacteristics:function(integration_id,parent_id,id,is_mapping,ctx=null){var url="/-/cms/v1/shop2/marketplace/?act=mapping&type_mapping=characteristics&"+S3_ACCESS+"&integration_id="+integration_id;if(ctx){var $expander=$(ctx);var $itemMenu=$expander.parent();var $nestedUl=$itemMenu.next();if($nestedUl.length){var opened=$expander.hasClass(this.ACTIVE_CLASS);if(opened){$expander.removeClass(this.ACTIVE_CLASS);$nestedUl.hide()}else{$expander.addClass(this.ACTIVE_CLASS);$nestedUl.show()}return false}}if(!parent_id){url+="&mp_category_parent_id="+id}else{url+="&mp_category_id="+id}if((+is_mapping||+is_mapping===0)&&is_mapping!==null){url+="&is_mapping="+is_mapping}popupController.reloadLastPopup(url)},togglesCategoryMenuItemWildberries:function(ctx,parentId){var $this=$(ctx);var childClass='.child-'+parentId;$this.find('.tree-checkbox__expander').toggleClass(this.ACTIVE_CLASS);$this.closest('ul').find(childClass).toggleClass(this.ACTIVE_CLASS)},searchByCategoryWildberriesKeydownHandler:function(event,ctx,integrationId,searchText){if(event.keyCode!==13){return true}this.searchByCategoryWildberries(ctx,integrationId,searchText);return false},searchByCategoryWildberries:function(ctx,integrationId,searchText){var $wrapper=$(ctx).closest('#wb_tree-category');var $treeCategory=$wrapper.find('>ul');var $searchInput=$wrapper.find('.tree-checkbox__search');var $searchReset=$wrapper.find('.tree-checkbox__search-back');var url="/-/cms/v1/shop2/marketplace/?act=mpCategoriesList&"+S3_ACCESS+"&integration_id="+integrationId+"&search="+searchText;var r=util.makeGetRequest(url);if(r.error){return false}if(!searchText){$searchInput.val('').removeClass(this.SEARCH_FOUND_CLASS);$searchReset.addClass(this.HIDE_CLASS)}else{$searchInput.addClass(this.SEARCH_FOUND_CLASS);$searchReset.removeClass(this.HIDE_CLASS)}$treeCategory.remove();$wrapper.append(r.text).S3ChangeControls();this.activateButtonAssignCategory()},rerenderCategoryMenuOnSelection:function(ctx,integrationId,mpCategoryParentId){var $wrapper=$(ctx).closest('#wb_tree-category');var $treeCategory=$wrapper.find('>ul');var $searchInput=$wrapper.find('.tree-checkbox__search');var url="/-/cms/v1/shop2/marketplace/?act=mpCategoriesList&"+S3_ACCESS+"&integration_id="+integrationId+"&mp_category_parent_id="+mpCategoryParentId;if($searchInput.val()){url+="&search="+$searchInput.val()}var r=util.makeGetRequest(url);if(r.error){return false}$treeCategory.remove();$wrapper.append(r.text).S3ChangeControls();this.activateButtonAssignCategory()},activateButtonAssignCategory:function(){var selectedProductsInfo=s3.getBatchOpInfo(util.getObject('mp_products_container'),'TR','mp_','',null,'input',{checked:true});var selectedCategoryInfo=s3.getBatchOpInfo(util.getObject('wb_tree-category'),'LI','','',null,'input',{checked:true});var assignCategoryBtn=$('#wb_assign-category-btn');var assignCategorySaveBtn=$('#wb_assign-category-save-btn');if(!selectedProductsInfo.dstObjs.length||!selectedCategoryInfo.dstObjs.length){assignCategoryBtn.attr('disabled','disabled');assignCategorySaveBtn.attr('disabled','disabled');return false}assignCategoryBtn.removeAttr('disabled');assignCategorySaveBtn.removeAttr('disabled')},getDefaultDictionaryValue:function(button){let $button=$(button);if($button.hasClass('disabled')){return false}$button.addClass('disabled');let url="/-/cms/v1/shop2/marketplace/?act=set_default_dict_item&"+S3_ACCESS+"&integration_id="+$button.data("integration_id")+'&item_id='+$button.data('item_id')+'&field='+$button.data('field')+'&attribute='+$button.data('attribute')+'&dictionary='+$button.data('dictionary');Preloader.show({mini:true});const requestDef=$.get(url);requestDef.then(function(data,textStatus,jqXHR){const r=util.parseRequestResult(jqXHR);if(r.error||r.code==1){Preloader.hide();$button.find('i').removeClass('oah-search').addClass('oah-noticedenied');$button.addClass('s3-tooltip');$button.attr('title',s3.loc('JS_NOTHING_FOUND'));util.msg(s3.loc('JS_NOTHING_FOUND'),'red');return false}var object=$button.closest('tr');$(r.text).insertAfter(object).S3ChangeControls();object.empty().remove();Preloader.hide();util.msg(s3.loc('JS_SAVED'),'green')})},changeDefaultValueOfCharacteristic:function(event,elementName){const select=event.target;const inputs=$(select).parent().find(`input[name^='${elementName}']`);if(!select.multiple){$(inputs[0]).val(select.options[select.selectedIndex].text);return}inputs.toArray().forEach((input)=>input.remove());Object.values(select.options).forEach((option)=>{if(!option.selected)return;$(select).before(`<input type="hidden"name="${elementName}[]"value="${option.text}">`)})}}})(jQuery);var MarketplaceOrderController={};(function($){'use strict';MarketplaceOrderController={URL:'/-/cms/v1/shop2/order/marketplace/',folder_id:false,groupConfirmNew:function(integration_id,shop_id){var self=this,url=self.URL+'?'+S3_ACCESS,url_params={'act':'group_edit','action':'confirm_new_order','integration_id':integration_id,'shop_id':shop_id},current_folder=self.folder_id;if(current_folder===0){url_params.order_all=1}url+='&'+new URLSearchParams(url_params).toString();var f=function(){popupController.closeLastPopup();s3.cronJobs(util.getObject('shop_mp_orders_container'),'TR','shop2_mp_order_',url,null,'input',{checked:true},false,current_folder);self.folder_id=false};s3.confirmGreen(s3.loc('JS_MP_CONFIRM_NEW_ORDERS'),f)}}})(jQuery);var IntegrationsController={};(function($){'use strict';IntegrationsController={dropdown_classname:'js-settings-dropdown',dropdown_active_classname:'js-dropdown-active',dropdown_onclick_handler_registered:false,openSettings:function(e,event){var self=this;$('.'+this.dropdown_active_classname).not(e).each(function(){$(this).removeClass('active '+self.dropdown_active_classname);$(this).find('.'+self.dropdown_classname).hide()});$(e).toggleClass('active '+this.dropdown_active_classname);$(e).find('.'+this.dropdown_classname).toggle();if($(e).hasClass(this.dropdown_active_classname)&&!this.dropdown_onclick_handler_registered){$(window).on('click',this.closeSettings);this.dropdown_onclick_handler_registered=true}event.preventDefault();event.stopPropagation()},closeSettings:function(){$('.'+IntegrationsController.dropdown_active_classname).each(function(){$(this).removeClass('active '+IntegrationsController.dropdown_active_classname);$(this).find('.'+IntegrationsController.dropdown_classname).hide()});$(window).off('click',IntegrationsController.closeSettings);IntegrationsController.dropdown_onclick_handler_registered=false},disconnect:function(urn){$.post(urn,function(data){var error=false;try{var result=JSON.parse(data);if(!(result&&typeof result==="object")){error=true}else{if(!(result.hasOwnProperty('success')&&result.success)){error=true}}}catch(e){error=true}if(error){s3.alert(JS_ERROR)}s3.reloadContent()})}}})(jQuery);var GroupOperationsController;(function($){GroupOperationsController={TYPES_MODULES:{USERS:'users',SHOP2_TAGS:'shop2_tags',SHOP2_SUPPLIER:'shop2_supplier',SHOP2_VENDORS:'shop2_vendors',BOARD:'board',FILES:'files',SHOP2_ORDERS:'shop2_orders',SHOP2_PRODUCTS:'shop2_products',IMAGES:'images',MP_PRODUCTS:'mp_products',MP_PRODUCTS_ERROR:'mp_products_error',MP_PRODUCTS_UNLOAD:'mp_products_unload',MP_ORDERS:'mp_orders'},clickTitleSelector:function(typeModule,checkboxSelector,containerSelector,wrapSelector,isOnePage,ctx){if(!isOnePage){S3ContextMenuController.openContextMenu(`.${wrapSelector}-menu`);return false}var $label=$(ctx).prev();var $checkbox=$label.find('input');if($label.hasClass('active')){$checkbox.click();return false}this.selectAll(typeModule,checkboxSelector,containerSelector)},selectAll:function(typeModule,checkboxSelector,containerSelector,folderId,prefix=''){var $checkbox=$(checkboxSelector);var $label=$checkbox.parent();if(!$label){return false}folderId=folderId!==undefined?parseInt(folderId):undefined;this._setFolderIdInModuleController(typeModule,folderId);this._setParamsInModuleController(typeModule,containerSelector,folderId);if(prefix){$(containerSelector).attr('data-form',prefix+'search_form')}else{$(containerSelector).removeAttr('data-form')}$label.checkboxClickFunction(null,true,null,folderId)},selectorCallback:function(selectorWrap,containerSelector){if(!$(selectorWrap+' .checked-all-wcond').hasClass('active')){$(containerSelector).removeAttr('data-form')}},_setParamsInModuleController:function(typeModule,containerSelector,folderId){switch(typeModule){case this.TYPES_MODULES.MP_PRODUCTS_UNLOAD:if(folderId===0&&typeof $(containerSelector).data('has_category_only')!=='undefined'){MarketplaceController.has_category_only=$(containerSelector).data('has_category_only')}else{MarketplaceController.has_category_only=false}break}},_setFolderIdInModuleController:function(typeModule,folderId){folderId=this._checkFolderIdIsNumber(folderId);switch(typeModule){case this.TYPES_MODULES.USERS:UsersController.folder_id=folderId;break;case this.TYPES_MODULES.SHOP2_TAGS:TagsController.folder_id=folderId;break;case this.TYPES_MODULES.SHOP2_VENDORS:Shop2VendorsController.folder_id=folderId;break;case this.TYPES_MODULES.BOARD:BoardController.folder_id=folderId;break;case this.TYPES_MODULES.FILES:FileController.folder_id=folderId;break;case this.TYPES_MODULES.SHOP2_ORDERS:OrderController.folder_id=folderId;break;case this.TYPES_MODULES.SHOP2_PRODUCTS:Shop2Controller.folder_id=folderId;break;case this.TYPES_MODULES.IMAGES:ImageController.folder_id=folderId;break;case this.TYPES_MODULES.MP_PRODUCTS:MarketplaceController.folder_id=folderId;break;case this.TYPES_MODULES.MP_PRODUCTS_ERROR:MarketplaceController.folder_id=folderId;break;case this.TYPES_MODULES.MP_PRODUCTS_UNLOAD:MarketplaceController.folder_id=folderId;break;case this.TYPES_MODULES.MP_ORDERS:MarketplaceOrderController.folder_id=folderId;break}},_checkFolderIdIsNumber:function(folderId){if(typeof folderId!='number'){return false}return folderId}}})(jQuery);var ProfilerController;(function($){ProfilerController={PROFILER_BTN_SELECTOR:'#profilerBtn',NAME_GET_PARAM:'profiling',COOKIE_NAME:'s3_enable_profiler',COOKIE_EXPIRES:0.010,PROFILER_ON_BTN_TEXT:s3.loc('ENABLE_PROFILER'),PROFILER_OFF_BTN_TEXT:s3.loc('DISABLE_PROFILER'),PROFILER_URL:location.origin+'/-/profiler-api/show?profiling=',enable:function(){util.createCookie(this.COOKIE_NAME,true,this.COOKIE_EXPIRES);this.replaceBtnHandler();return false},disable:function(){util.eraseCookie(this.COOKIE_NAME);this.replaceBtnHandler();return false},isEnabled:function(){return!!util.readCookie(this.COOKIE_NAME)},replaceBtnHandler:function(){var $profilerBtn=$(this.PROFILER_BTN_SELECTOR);var profilerBtnTitleSelector='.title';if(this.isEnabled()){$profilerBtn.on('click',this.disable.bind(this)).find(profilerBtnTitleSelector).text(this.PROFILER_OFF_BTN_TEXT)}else{$profilerBtn.on('click',this.enable.bind(this)).find(profilerBtnTitleSelector).text(this.PROFILER_ON_BTN_TEXT)}},createUrl:function(url){var searchParams=new URLSearchParams(url);var randomId=Math.round(Math.random()*10000);var profilerUrl=this.PROFILER_URL+randomId;if(searchParams.has(this.NAME_GET_PARAM)){searchParams.delete(this.NAME_GET_PARAM)}searchParams.append(this.NAME_GET_PARAM,randomId.toString());url=decodeURIComponent(searchParams.toString());this._printUrlInConsole(profilerUrl,url);return url},_printUrlInConsole:function(profilerUrl,url){console.log('%c%s%c%s%c%s','background: dodgerblue; padding: 5px 10px; color: white; margin: 5px 10px 5px 0; border-radius: 5px; font-weight: bold;','Profiler URL:','color: grey; font-weight: bold;',profilerUrl,'font-weight: bold; color: dodgerblue; margin-left: 10px;','('+url+')')}}})(jQuery);(function(open){XMLHttpRequest.prototype.open=function(method,uri,async=true,user,pass){if(ProfilerController.isEnabled()){uri=ProfilerController.createUrl(uri)}open.call(this,method,uri,async,user,pass)}})(XMLHttpRequest.prototype.open);var Metrika={};(function($){"use strict";Metrika={_init:false,type:'',isMetrika:function(){return is_metrika||false},setType:function(type){this.type=type},click:function(name){var self=this;if(self.isMetrika&&name){try{switch(self.type){case"yandex":ym(53557393,'reachGoal',name);break;default:break}}catch(e){console.log(e)}}},init:function(type){var self=this,name=false;self.setType(type||'yandex');if(self.isMetrika&&!self._init){$(document).on('click','[data-metrika]',function(){name=$(this).data('metrika')||false;self.click(name)});self._init=true}}}})(jQuery);var ContextHelp={};(function($){"use strict";ContextHelp={overlay:null,cnxHelp:null,helpUrl:"https://help.megagroup.ru",helpMenuId:6048051,cnxMenu:null,pageId:null,href:null,cmsHelpUrl:null,prevCmsHelpUrl:null,pageTitle:null,step:null,_init:function(params){var self=this,urlParams=['act','mode','help'],$params=[];self.cnxMenu=LS.get('context_help_menu');if(params.url){var help_key=params.url.replace(/\?.*$/,'');params.url.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){if(urlParams.indexOf(key)!==-1){$params.push(key+"="+value)}});if($params.length){help_key+="?"+$params.join("&")}if(help_urls[help_key]){if(help_urls[help_key].indexOf('help.megagroup.ru')!==-1){help_urls[help_key]=help_urls[help_key].replace(/^http:\/\//i,'https://');help_urls[help_key]=help_urls[help_key].trim();if(help_urls[help_key].indexOf('#')!==-1){help_urls[help_key]=help_urls[help_key].substring(0,help_urls[help_key].indexOf('#'))}self.cmsHelpUrl=help_urls[help_key]}else{self.cmsHelpUrl=null;if(isStaffUser){console.log('Нужно изменить ссылку на инструкцию!')}}}else{self.cmsHelpUrl=null}}document.body.classList.remove('context-help-opened');self.overlay=document.querySelector('.s3-context-help__overlay');self.cnxHelp=document.querySelector('.s3-context-help');if(self.overlay&&self.cnxHelp){self.overlay.classList.remove('opened','top0');self.cnxHelp.classList.remove('opened','top0');if(params.popup){self.overlay.classList.add('top0');self.cnxHelp.classList.add('top0')}document.querySelector('.context__menu').classList.remove('opened');$(self.cnxHelp).find('.help__content').empty();self.pageId=null;self._scroll(window.scrollY);window.addEventListener('scroll',function(){self._scroll(this.scrollY)})}},_scroll:function(scroll){var self=this;if(scroll>72){self.overlay.classList.add('top0');self.cnxHelp.classList.add('top0')}else{self.overlay.classList.remove('top0');self.cnxHelp.classList.remove('top0')}},_open:function(){var self=this;if($.isEmptyObject(self.cnxMenu)){Preloader.show();$.get(self.helpUrl+'/-/x-api/v1/public/?method=menu/getTree&param[menu_id]='+self.helpMenuId+'&param[depth]=10',function(data){self.cnxMenu=data.result.items;Preloader.hide();document.body.classList.add('context-help-opened');self.cnxHelp.classList.add('opened');self.overlay.classList.add('opened');LS.set('context_help_menu',self.cnxMenu);self.menuToggle(false,self.cmsHelpUrl)})}else{document.body.classList.add('context-help-opened');self.cnxHelp.classList.add('opened');self.overlay.classList.add('opened');if($(self.cnxHelp).find('.help__content').is(':empty')){$(self.cnxHelp).find('.help__path').empty();$(self.cnxHelp).find('.help__title').empty();$(self.cnxHelp).find('.help__sublist').empty();$(self.cnxHelp).find('.top__panel').removeClass('opened');$(self.cnxHelp).find('#contextHelpMenu').scrollTop(0);if(self.cmsHelpUrl&&self.cmsHelpUrl===self.prevCmsHelpUrl){if(self.cmsHelpUrl===self.href){self.menuToggle(false,self.cmsHelpUrl,self.step)}else{self.menuToggle(false,self.href,self.step)}}else{self.menuToggle(false,self.cmsHelpUrl)}}}self.prevCmsHelpUrl=null;self.step=null},_close:function(){var self=this;document.body.classList.remove('context-help-opened');self.cnxHelp.classList.remove('opened','expand');self.overlay.classList.remove('opened');$(self.cnxHelp).find('.context__menu').removeClass('opened');$(self.cnxHelp).find('.i-menu-svg').removeClass('opened');self.prevCmsHelpUrl=self.cmsHelpUrl;let $contentWrap=$(self.cnxHelp).find('.help'),helpTop=$contentWrap.offset().top,helpInnerHeight=$contentWrap.innerHeight();$(self.cnxHelp).find('h2[id]').each(function(i){let headerTop=$(this).offset().top,step=$(this).attr('id');if(headerTop-helpTop>=0){if(headerTop-helpTop<helpInnerHeight){self.step='#'+step;return false}else{if(i===0){self.step=null;return false}else{self.step='#step-'+i;return false}}}self.step='#'+step})},menuToggle:function(close,url,step){var self=this,menuWrap=document.querySelector('.context__menu'),menu=document.querySelector('#contextHelpMenu'),btn=document.querySelector('.i-menu-svg'),topPanel=document.querySelector('.top__panel');if(!menuWrap.classList.contains('opened')){if(!close){self.buildMenu(self.cnxMenu,menu);$(menu).find('a, .first-level').each(function(){let li=$(this).parent();if(li.has('ul').get(0)){li.addClass('has_sublist');$(this).after('<span></span>')}});self.setActive()}if(url){Preloader.show({hideClass:'s3-preloader-hide',to:'.s3-context-help',local:true,mini:true});$.get(url+'?for_cms='+document.location.hostname,function(data){$(self.cnxHelp).find('.top__panel a.full').attr('href',url);$(self.cnxHelp).find('.help__content').html(data);self.pageId=$(self.cnxHelp).find('.help__content').find('#pageId').text();self.href=url;self.changeContentWrap();self.changeContentLinks($(self.cnxHelp).find('.help'),step);if(!topPanel.classList.contains('opened')){topPanel.classList.add('opened')}Preloader.hide()})}if(!close&&!url){menuWrap.classList.add('opened');btn.classList.add('opened');$(menu).find('a + span, .first-level + span').on('click',function(e){var $li=$(this).parent();$li.toggleClass('opened');if($li.hasClass('opened')){var top=parseInt($(this).prev('a, .first-level').innerHeight());if($li.parent('ul.nav-main').length){$(this).css('top',top/2)}else{$(this).css('top',top/2+2)}}});$(menu).find('a').on('click',function(e){var url=self.helpUrl+this.getAttribute('href');if(e.target.classList.contains('blank')){e.target.setAttribute('target','_blank');if(e.target.getAttribute('href').indexOf('http')===-1){e.target.setAttribute('href',url)}return true}e.preventDefault();if(this.getAttribute('data-link')){url=this.getAttribute('data-link')}self.loadContent(this,url,function(){menuWrap.classList.remove('opened');btn.classList.remove('opened')});menuWrap.classList.remove('opened');btn.classList.remove('opened');if(!topPanel.classList.contains('opened')){topPanel.classList.add('opened')}});return false}}else{menuWrap.classList.remove('opened');btn.classList.remove('opened')}},buildMenu:function(pages,target){var self=this,$ul="<ul class='nav-main'>",$prev_level=1;pages.forEach(function(page,$k){var data_link='';if(page.url_link!=''){if(page.url_link.indexOf('help.megagroup.ru')===-1){data_link="class='blank'"}else{if(page.url_link.indexOf('http://')===0){page.url_link=page.url_link.replace(/^http:\/\//i,'https://')}data_link="data-link='"+page.url_link+"'"}}if(page._level>$prev_level){for(var i=$prev_level;i<page._level-1;i++){$ul+="<ul><li><a></a>"}$ul+="<ul>"}else{$ul+="</li>";for(var i=page._level;i<$prev_level;i++){$ul+="</ul></li>"}}$ul+="<li class='page-"+page.page_id+"' data-page-id='"+page.page_id+"'>";if(page._level==1){$ul+="<div class='first-level'"+data_link+">"+page.name+"</div>"}else{$ul+="<a "+data_link+" href='"+page.url+"'>"+page.name+"</a>"}$prev_level=page._level});for(var i=1;i<$prev_level;i++){$ul+="</ul></li>"}$ul+="</li></ul>";$(target).html($ul);$(target).find('li.page-94446051').remove();$(target).find('li.page-94445651').remove();$(target).find('li.page-94446251').remove()},changeContentLinks:function(content,step){var self=this,links=content.find('a'),images=content.find('img');content.find('h2').each(function(i){$(this).attr('id','step-'+(i+1))});images.each(function(ind,img){var src=img.getAttribute('src');if(src&&src.indexOf('/d/')!==-1&&src.indexOf('help.megagroup.ru')===-1){src=self.helpUrl+src;img.setAttribute('src',src)}});links.each(function(ind,a){var href=a.getAttribute('href'),step=null;if(href&&href.indexOf('../')!==-1){href="/"+href.replace(/\.\.\//gi,'')}if(href&&href.indexOf('#step')!==-1){step=href.substring(href.indexOf('#step'),href.length);href=href.substring(0,href.indexOf(step));step=step.replace('--','-')}if(href&&href.indexOf('http')===-1){href=self.helpUrl+href;a.setAttribute('href',href);a.addEventListener('click',function(event){event.preventDefault();self.loadContent(a,href)},false)}else if(href&&href.indexOf('help.megagroup')!==-1){href=href.replace(/^http:\/\//i,'https://');a.addEventListener('click',function(event){event.preventDefault();self.loadContent(a,href,null,step)},false)}else{if(!a.getAttribute('target')){a.setAttribute('target','_blank')}}});if(step&&$(step)&&content.find(step).length){setTimeout(function(){let contentTop=content.addBack().find('.help').offset().top;content.animate({scrollTop:$(step).offset().top-contentTop},500,'swing')},1000)}let $lastPage=$(self.cnxHelp).find('.s3_pagelist_container').find('a.s3_pagelist_lnk').last();if(!$lastPage.next('b').length){$lastPage.children('span').css('border-radius','0 4px 4px 0')}},loadContent:function(a,url,callback,step){var self=this,u=url;if(url.indexOf('for_cms')===-1){url+='?for_cms='+document.location.hostname}var prevLink='<a href="'+self.href+'" data-page-id="'+self.pageId+'">'+s3.loc('BACK')+'</a>';$.get(url,function(data){$(self.cnxHelp).find('.top__panel a.full').attr('href',u);$(self.cnxHelp).find('.help__content').html(data);self.pageId=$(self.cnxHelp).find('.help__content').find('#pageId').text();self.href=u;self.changeContentWrap(a,prevLink);self.changeContentLinks($(self.cnxHelp).find('.help'),step);document.querySelector('form.context__search').reset();if(typeof callback=='function'){callback()}})},changeContentWrap:function(a,prevLink){var self=this,$contentWrap=$(self.cnxHelp).find('.help'),title=$(self.cnxHelp).find('.help__content>.main__title').text(),$link=$(a).clone(),path=[],$menu=$(self.cnxHelp).find('#contextHelpMenu'),$li=$(a).parent('li'),$liFromMenu=$menu.find('li.page-'+self.pageId);if($link.children('b').length){$link.children('b').contents().unwrap()}if($li.length&&$li.data('page-id')){path.push($link.text())}else{if($(a).parent('.help__path').length||$(a).parents('.fast-result__content').length){path.push($link.text())}else{if($liFromMenu.length){path.push($liFromMenu.children('a').text())}}}$liFromMenu.parents('li').each(function(){if($(this).children('a').length){let clone=$(this).children('a').clone();$(clone).attr('data-page-id',$(this).data('page-id'));path.push(clone)}else if($(this).children('.first-level').length){let first_level=$(this).children('.first-level').text();path.push(first_level)}});$contentWrap.scrollTop(0).find('.help__title').empty();$contentWrap.find('.help__path').empty();$contentWrap.find('.help__sublist').empty();if(path.length>1){for(let i=0;i<path.length;i++){if(i===0){$contentWrap.find('.help__path').prepend(path[i])}else{$contentWrap.find('.help__path').prepend('<span>/</span>').prepend(path[i])}}}let hasSubpages=$contentWrap.find('.content').children('ul.subpages:only-of-type:first-child').length;let hasGSubmenu=$contentWrap.find('.content').find('.sorting>ul.g-submenu').length;if($liFromMenu.has('ul').get(0)&&!hasSubpages&&!hasGSubmenu){var ulContent=$liFromMenu.clone();ulContent.children(':not(ul)').remove();ulContent.children('ul').children('li').find(':not(a)').remove();$contentWrap.find('.help__sublist').html(ulContent.html())}$contentWrap.find('.help__title').text(title);if(!$contentWrap.find('.search__list').length){$(self.cnxHelp).removeClass('search')}$(self.cnxHelp).find('.context__menu').removeClass('opened');$(self.cnxHelp).find('.i-menu-svg').removeClass('opened')},search:function(form){var self=this,text=form.elements['search'].value.trim(),url=self.helpUrl+'/search?for_cms='+document.location.hostname+'&'+formcontents(form)+'&pagelist_has_dots=0'+'&pagelist_offset=6';if(text){$.get(url,function(data){$(self.cnxHelp).find('.help__content').html(data);self.changeContentLinks($(self.cnxHelp).find('.help__content'))});$(self.cnxHelp).find('.help').scrollTop(0);$(self.cnxHelp).find('.help__path').empty();$(self.cnxHelp).find('.help__title').empty();$(self.cnxHelp).find('.help__sublist').empty();$(self.cnxHelp).find('.context__menu').toggleClass('opened',false).find('#contextHelpMenu').scrollTop(0).find('a.active').toggleClass('active',false);$(self.cnxHelp).find('.top__panel').toggleClass('opened',true).find('.i-menu-svg').toggleClass('opened',false);$(self.cnxHelp).toggleClass('search',true);$(self.cnxHelp).find('.fast-result').removeClass('opened');form.reset()}return false},fastSearch:function(input){var self=this,text=$(input).val(),$form=$(input).parent('form'),$fastResult=$form.parent('.search__wrap').find('.fast-result'),topPanel=document.querySelector('.top__panel');var url=self.helpUrl+'/-/x-api/v1/public/?method=page/getSuggest';if(text.length>2){$.ajax({type:"POST",url:url,data:{text:text,full_branch:true},dataType:"json",cache:false,success:function(data){if(data.result.length>0){let list='<ul>';for(let i=0;i<data.result.length;i++){let item=data.result[i],pageId=item.page_id,suggest=item.suggest,url=item.branch[item.branch.length-1].url,firstLevel=item.branch[0],menu=item.menu,textWords=text.split(' '),reg=RegExp(textWords.join('|'),'gi');let listItem='<li>';if(item.branch.length>1){listItem+='<span>'+firstLevel.name+'</span>'}listItem+='</span>';listItem+='<a href="'+url+'" data-page-id="'+pageId+'">'+suggest.replace(reg,"<b>$&</b>")+'</a></li>';list+=listItem}list+='</ul>';$fastResult.find('.fast-result__content').html(list);$fastResult.find('.fast-result__count span').text(data.result.length);$fastResult.addClass('opened');$fastResult.find('.fast-result__content').find('a').on('click',function(e){let url=self.helpUrl+this.getAttribute('href');e.preventDefault();self.loadContent(this,url);$fastResult.removeClass('opened');$(input).val('');if(!topPanel.classList.contains('opened')){topPanel.classList.add('opened')}})}else{$fastResult.removeClass('opened')}}})}else{$fastResult.removeClass('opened')}$fastResult.find('.fast-result__full').on('click',function(){$form.submit()})},setActive:function(){var self=this,$contentWrap=$(self.cnxHelp).find('.help'),$menu=$(self.cnxHelp).find('#contextHelpMenu');var pageId=$contentWrap.find('#pageId').text();$menu.find('li').toggleClass('opened',false);$menu.find('a').toggleClass('active',false);if(pageId){$menu.find('li.page-'+pageId).children('a').addClass('active');var $activeParents=$menu.find('li.page-'+pageId).parents('li').addClass('opened');$activeParents.each(function(){var top=parseInt($(this).children('a, .first-level').innerHeight());if($(this).parent('ul.nav-main').length){$(this).children('span').css('top',top/2)}else{$(this).children('span').css('top',top/2+2)}})}},toggleExpand:function(obj){var self=this;self.cnxHelp.classList.toggle('expand')}}})(jQuery);var JsonCodeController={};(function($){"use strict";JsonCodeController={jsonTypeChange:function(select){var self=this,type=select.value,form=select.closest('form'),classNames='json-edit-table '+type;form.setAttribute('class',classNames)},jsonCodeWarning:function(){var self=this,p=popupController.getLastPopup();if(util.readCookie('need_save_json_changes')&&p.obj&&$(p.obj).find('#jsheme_attached_items').get(0)){s3.alert(s3.loc('JS_SAVE_JSON_CHANGES'),function(){util.eraseCookie('need_save_json_changes')});return false};return true},updateJsonSheme:function(container){var self=this,items=$(container).find('li:not(.controls)'),jsonSheme={};items.each(function(index){var input=$(this).find('#setting')[0];if(input){var value=input.value,id=$(this)[0].getAttribute('setting-id');jsonSheme[id]=JSON.parse(value)}});util.createCookie('need_save_json_changes',1);return jsonSheme},addJsonCode:function(data,txtClass,containerID,update){popupController.closeLastPopup();var self=this,p=popupController.getLastPopup();if(p.obj){var textarea=$(p.obj).find('textarea.'+txtClass)[0],container=$(p.obj).find('#'+containerID);if(container){var settingId=$(data).attr('setting-id'),items=$(container).find('li:not(.controls)'),ids=[];if(update){var oldItem=$(container).find("li.box[setting-id="+settingId+"]");$(data).insertAfter(oldItem).S3ChangeControls();oldItem.empty().remove()}else{items.each(function(){ids.push($(this).attr('setting-id'))});function getFreeCode(code,ids){code=code.trim();if(code==''||$.isNumeric(code)){code='jsheme'+Math.floor(Math.random()*Math.floor(7))};var $i=100,$base=code;while(--$i){if(!_isBusyCode(code,ids)){break}code=$base+'_'+Math.floor(Math.random()*Math.floor(7))}return code}function _isBusyCode(code,ids){return(ids.indexOf(code)!=-1)?true:false}var newSettingId=getFreeCode(settingId,ids);container.append(data).S3ChangeControls();$(container).find('li:last').attr('setting-id',newSettingId)}textarea.value=JSON.stringify(self.updateJsonSheme(container),null,4);if($(p.obj).find(UsersController.CLASSNAMES_FIELD_RERENDER.USER_PHONE).length||$(p.obj).find(UsersController.CLASSNAMES_FIELD_RERENDER.USER_MATCH_SETTINGS).length){UsersController.rerenderFieldsFormSettings(textarea.value)}}}},deleteJsonCode:function(item,txtClass,containerID){if(!isStaffUser){if(UserCmsAdvanced&&$(item).hasClass('json-field__system')){return}}var self=this,p=popupController.getLastPopup();if(p.obj){var textarea=$(p.obj).find('textarea.'+txtClass)[0],container=$(p.obj).find('#'+containerID);uploadRemoveItem(item);textarea.value=JSON.stringify(self.updateJsonSheme(container),null,4);if($(p.obj).find(UsersController.CLASSNAMES_FIELD_RERENDER.USER_PHONE).length||$(p.obj).find(UsersController.CLASSNAMES_FIELD_RERENDER.USER_MATCH_SETTINGS).length){UsersController.rerenderFieldsFormSettings(textarea.value)}}},sortJsonCode:function(txtClass,containerID){var self=this,p=popupController.getLastPopup();if(p.obj){var textarea=$(p.obj).find('textarea.'+txtClass)[0],container=$(p.obj).find('#'+containerID);textarea.value=JSON.stringify(self.updateJsonSheme(container),null,4);util.msg(s3.loc('JS_SAVED'))}},switchRequiredJsonCode:function(item,checked,txtClass,containerID){if(!isStaffUser){if(UserCmsAdvanced&&$(item).hasClass('json-field__system')){return false}}var self=this,p=popupController.getLastPopup();if(p.obj){var textarea=$(p.obj).find('textarea.'+txtClass)[0],container=$(p.obj).find('#'+containerID),required=(checked)?true:false,json=JSON.parse($(item).find('#setting').val());json.required=required;$(item).find('#setting').val(JSON.stringify(json));textarea.value=JSON.stringify(self.updateJsonSheme(container),null,4);util.msg(s3.loc('JS_SAVED'))}},switchLockedJsonCode:function(item,txtClass,containerID){var self=this,p=popupController.getLastPopup();if(p.obj){var textarea=$(p.obj).find('textarea.'+txtClass)[0],container=$(p.obj).find('#'+containerID),locked=($(item).find('.oah-lock').hasClass('open'))?true:false,json=JSON.parse($(item).find('#setting').val());json.locked=locked;$(item).find('#setting').val(JSON.stringify(json));textarea.value=JSON.stringify(self.updateJsonSheme(container),null,4);$(item).find('.oah-lock').toggleClass('open');util.msg(s3.loc('JS_SAVED'))}},switchVisibilityJsonCode:function(item,txtClass,containerID){var self=this,p=popupController.getLastPopup();if(p.obj){var textarea=$(p.obj).find('textarea.'+txtClass)[0],container=$(p.obj).find('#'+containerID),visibility=($(item).find('.oah-view').length>0)?false:true,json=JSON.parse($(item).find('#setting').val());json.visibility=visibility;$(item).find('#setting').val(JSON.stringify(json));textarea.value=JSON.stringify(self.updateJsonSheme(container),null,4);if(visibility){$(item).find('.oah-hide').removeClass('oah-hide').addClass('oah-view')}else{$(item).find('.oah-view').removeClass('oah-view').addClass('oah-hide')}util.msg(s3.loc('JS_SAVED'))}},editJsonCode:function(item,url,containerID){var self=this,params=$(item).find('#setting').val(),setting_id=$(item).attr('setting-id');url+='&setting_id='+setting_id;openAjaxForm(url,function(r){console.log(r)},null,null,"&setting="+params)},is_number:function(n){n=n.trim();if(n=='')return false;if(n==0)return false;return(n/n)?true:false},validateForm:function(){var self=this,p=popupController.getLastPopup(),is_valid=true,name=$(p.obj).find('input#name').val(),type=$(p.obj).find('select#type option:selected').val(),size=$(p.obj).find('#size').val(),maxlength=$(p.obj).find('#maxlength').val(),cols=$(p.obj).find('#cols').val(),rows=$(p.obj).find('#rows').val();name=name.trim();if((name=='')){$('#name_error').show();is_valid=false}else{$('#name_error').hide()}if((type=='')){$('#type_error').show();is_valid=false}else{$('#type_error').hide()}if(!self.is_number(size)||!self.is_number(maxlength)){$('#size_error').show();is_valid=false}else{$('#size_error').hide()}if(!self.is_number(cols)||!self.is_number(rows)){$('#cols_rows_error').show();is_valid=false}else{$('#cols_rows_error').hide()}return is_valid},submitSettings:function(url,setting_id){var self=this,p=popupController.getLastPopup(),delivery_settings=$(p.obj).find('#delivery_settings');if(self.validateForm()){delivery_settings.find('table.table-min').each(function(){if($(this).is(':hidden')){$(this).find('input, textarea, select').prop('disabled',true)}else{$(this).find('input, textarea, select').prop('disabled',false)}});var formData=delivery_settings.serializeArray();$.post(url,formData,function(data){self.addJsonCode(data,'jsheme_area','jsheme_attached_items',setting_id)})}}}})(jQuery);let ReactWidgetsController={};(function($){ReactWidgetsController={route:{seoTemplates:'seo/templates',fcmPushNotification:'fcm/notifications',loadContent:function(url){$(s3.contentDiv).S3DestroyControls();s3.contentDiv.innerHTML='';switch(true){case url.includes(this.seoTemplates):s3.contentDiv.insertAdjacentHTML('beforeend',this.getContainer(ReactWidgetsController.seoTemplates.containerWidgetId));ReactWidgetsController.seoTemplates.open();break;case url.includes(this.fcmPushNotification):s3.contentDiv.insertAdjacentHTML('beforeend',this.getContainer(ReactWidgetsController.fcm.containerWidgetId));ReactWidgetsController.fcm.open();break}},getContainer:function(id){return`<div id="${id}"></div>`}},seoVars:{containerWidgetId:'SeoVarsModal',isWidgetLoaded:false,open:function(){Preloader.show();SeoVarsModalWidget.manager.mountWidget(this.containerWidgetId);if(this.isWidgetLoaded){SeoVarsModalWidget.open();Preloader.hide();return}const unsubscribe=EventBus.subscribe('seo-vars-widget-loaded',()=>{SeoVarsModalWidget.open();Preloader.hide();this.isWidgetLoaded=true;unsubscribe()})},},seoTemplates:{containerWidgetId:'SeoTemplatesWidget',isWidgetLoaded:false,open:function(){const widget=WidgetsInModal.manager.getWidgetById('SeoTemplates');if(!widget){return}widget.mount();if(this.isWidgetLoaded){SeoTemplatesWidget.open();return}const unsubscribe=EventBus.subscribe('seo-templates-widget-loaded',()=>{SeoTemplatesWidget.open();this.isWidgetLoaded=true;unsubscribe()})},},vk:{containerWidgetId:'VkIdModalWidget',widgetId:'VkIdModal',isWidgetLoaded:false,open:function(){const widget=VkIdModalWidget.manager.getWidgetById(this.widgetId);if(!widget){return}widget.mount();if(this.isWidgetLoaded){VkIdModalWidget.open();return}const unsubscribe=EventBus.subscribe('vk-id-modal-widget-loaded',()=>{VkIdModalWidget.open();this.isWidgetLoaded=true;unsubscribe()})}},fcm:{containerWidgetId:'FCMPushNotificationsWidget',widgetId:'FCMPushNotifications',isWidgetLoaded:false,open:function(){const widget=FCMPushNotificationsWidget.manager.getWidgetById(this.widgetId);if(!widget){return}widget.mount();if(this.isWidgetLoaded){FCMPushNotificationsWidget.open();return}const unsubscribe=EventBus.subscribe('fcm-push-notification-widget-loaded',()=>{FCMPushNotificationsWidget.open();this.isWidgetLoaded=true;unsubscribe()})},},}})(jQuery)